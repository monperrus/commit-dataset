{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12477769","self":"https://issues.apache.org/jira/rest/api/latest/issue/12477769","key":"DERBY-4856","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316362","id":"12316362","description":"First release on the 10.8 branch","name":"10.8.1.2","archived":false,"released":true,"releaseDate":"2011-04-29"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-10-19 18:35:57.853","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24498","customfield_12310222":"1_*:*_1_*:*_8666016787_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-01-28T01:38:47.095+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4856/watchers","watchCount":0,"isWatching":false},"created":"2010-10-19T18:25:10.308+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"23.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12382494","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12382494","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12681947","key":"DERBY-6426","self":"https://issues.apache.org/jira/rest/api/2/issue/12681947","fields":{"summary":"Fix isLoginException","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/5","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/trivial.png","name":"Trivial","id":"5"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}},{"id":"12337127","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12337127","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12496860","key":"DERBY-4986","self":"https://issues.apache.org/jira/rest/api/2/issue/12496860","fields":{"summary":"Document the new property derby.stream.error.extendedDiagSeverityLevel for thread dump and extend diagnostic information","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}},{"id":"12336307","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12336307","type":{"id":"10001","name":"dependent","inward":"is depended upon by","outward":"depends upon","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"},"inwardIssue":{"id":"12491936","key":"DERBY-4929","self":"https://issues.apache.org/jira/rest/api/2/issue/12491936","fields":{"summary":"Engine code should not use java/shared/org/apache/derby/shared/common/error/ErrorUtil.java ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-02-05T22:40:47.374+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11415","id":"11415","name":"Services"}],"timeoriginalestimate":null,"description":"On system crash or session ending error, Derby should dump as much information as possible. Such as: forcing a javacore if possible or at least thread dump and system environment information. This should only occur if a running session crashes not on boot error due to fail recovery etc.\r\nThe IBM jvm provides a way to programmatically dump a javacore. i.e. com.ibm.jvm.Dump.JavaDump() And, the SUN jvm will force a thread dump using the Unsafe class and there may be a better way. \r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36515","summary":"Add thread dump information when derby crash","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10422","value":"High Value Fix","id":"10422"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10102","value":"Patch Available","id":"10102"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10101","value":"Release Note Needed","id":"10101"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":45,"total":45,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12922656","id":"12922656","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I recently had to do a programatic dump of information on a Sun JVM and found this:\r\nhttp://forums.oracle.com/forums/thread.jspa?threadID=1237584&tstart=15\r\n\r\nThe file did not have the system properties or shell environment.   I printed the system properties as below, but between the two seemed to still be missing a of information, like the shell environment and the command line,\r\n\r\n\tSystem.out.println(\"\\n\\n------ Java System Properties -----\");\r\n\tProperties sprops = System.getProperties();\r\n\tSet listem;\r\n\tString str;\r\n\r\n\tlistem = sprops.keySet();\r\n\tIterator itr = listem.iterator();\t\r\n\r\n\tSystem.out.println(\"props test\");\r\n\twhile (itr.hasNext())\r\n\t{\r\n\t\tstr = (String) itr.next();\r\n\t\tSystem.out.println(\"key: \" + str +\"\\t;value: \" + sprops.getProperty(str));\r\n\t}\r\n\r\n\tSystem.out.println(\"---- end System Properties output ----\\n\\n\");\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-10-19T18:35:57.853+0000","updated":"2010-10-19T18:35:57.853+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12922780","id":"12922780","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thread.getAllStackTraces may be useful? (>= 1.5 though)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2010-10-19T23:17:21.920+0000","updated":"2010-10-19T23:17:21.920+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12928898","id":"12928898","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I think ultimately the information should dump  only for ExceptionSeverity.SESSION_SEVERITY errors or higher if the derby engine is booted, but while developing you may want to leave the boot check out and the use this corrupt database which will fail to connect and produce a ExceptionSeverity.DATABASE_SEVERITY error.\r\n\r\nLily also mentioned to me two other types of errors that might need to be reported, java exceptions that don't get caught and wrapped in SQLExceptions  like some NullPointerExceptions and also it would be nice ultimate to include low cost asserts in insane builds. I am not quite sure how this should be accomplished.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-11-06T00:28:33.343+0000","updated":"2010-11-06T00:28:33.343+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12932804","id":"12932804","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks to Kathey. I am able to construct first attempt to add thread dump on insane build for embedded server. \r\nI am puzzling on whether the StandardException.printStackTrace(PrintWriter s) for severity >= ExceptionSeverity.SESSION_SEVERITY is the best place to print out thread dump or place like ErrorStringBuilder.stackTrace is better. Personally, I think it shouldn't be that much noise to put in StandardException.printStackTrace(PrinterWriter s) Any opinion is welcome. Please review the code and give me your opinion. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-11-17T03:58:49.502+0000","updated":"2010-11-17T03:58:49.502+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12932806","id":"12932806","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"The changes included: \r\n1. Move ThreadDump.java from java/shared/org/apache/derby/shared/common/sanity to java/shard/org/apache/derby/shared/common/error\r\n2. move dumpThreads method from AssertFailure to ExceptionUtil\r\n3. Add printStackTrace to StandardException when severity >= ExceptionSeverity.SESSION_SEVERITY\r\nYou can find thread dump information in derby.log for corruptdb database \r\n\r\nHope this is helpful.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-11-17T04:07:05.452+0000","updated":"2010-11-17T04:07:05.452+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12932892","id":"12932892","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I'd prefer that we don't change the behaviour of StandardException.printStackTrace(), as that may be confusing to the users and may also make the output from the applications noisy and harder to read. To me it sounds sufficient to dump this information to derby.log and not include the thread dump in the exception itself. What about adding the code to ContextManager.cleanupOnError() instead? That's where the writing of errors to derby.log happens.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-17T10:45:50.583+0000","updated":"2010-11-17T10:45:50.583+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12932967","id":"12932967","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"+1 to placing this information in a file of some sort.\r\n\r\nderby.log is a reasonable suggestion.\r\n\r\nAnother idea is create a separate file JUST for this this crash information.\r\nSince it's similar in notion to a \"crash dump\" file, how about a uniquely\r\ngenerated name for a standalone \"dump\" file of some sort, as in:\r\n\r\n    derby_minidump_YYMMDD_n.txt\r\n\r\nWhere the YYMMDD is today's date, and the 'N' is\r\na number incremented each time we produce a dump on\r\nthat date.\r\n\r\nA nicely packaged standalone dump file produced on a system crash\r\nwould provide a very helpful tool for users to interact with the\r\ncommunity when trying to diagnose Derby problems.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2010-11-17T14:49:51.312+0000","updated":"2010-11-17T14:49:51.312+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12932993","id":"12932993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"Another point supporting Bryan's suggestion, is that derby.log is by default overwritten.\r\nThis can be, and hopefully is, changed in production environments, but I still think a separate file is an approach worth considering (we may have to deal with write privileges then).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2010-11-17T15:48:42.934+0000","updated":"2010-11-17T15:48:42.934+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12933337","id":"12933337","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"We can definitely consider writing the information to a separate file and consider the deal with write privileges. If we do add the code in ContextManager.cleanupOnError(), how do we make sure the database is already boot. I keep seeing the threadDump information get print out before the database is booted. How to avoid it?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-11-18T07:11:29.563+0000","updated":"2010-11-18T07:11:29.563+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12965578","id":"12965578","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks to Kathey, due to the scope of the changes, I would like to purpose three steps check-in to address this issue :\r\nI.\r\n1.1. Move ThreadDump.java from java/shared/org/apache/derby/shared/common/sanity to            java/shard/org/apache/derby/shared/common/error \r\n1.2. move dumpThreads method from AssertFailure to ExceptionUtil \r\n1.3  Have this available for insane build only.\r\nII.\r\n 2.1 Add ThreadDump information to sane build in ContextManager. cleanupOnError(). it will print the thread dump information to derby.log\r\nIII.\r\n3.1 Add file handling as Bryan and Kristian's suggestion for ThreadDump info. The current thinking is to add the file handling code as the method as utility tool and calls it in ContextManager\r\n\r\nI am attaching DERBY-4856-part_1_1a.diff for code review. The patching is covering the part one change. I am running Suites.All and derbyall now. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-01T06:20:46.767+0000","updated":"2010-12-01T18:51:51.799+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12965686","id":"12965686","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"+1 to the technique of the multi-step approach.\r\n\r\nI read through your part-1 patch and it looks fine to me.\r\n\r\nThanks for working on this infrastructure, it will be very helpful!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2010-12-01T14:18:21.719+0000","updated":"2010-12-01T14:18:21.719+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12965759","id":"12965759","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thank you so much, Bryan. I run Suites.all and derbyall and I did not see any error. If it is okay with everybody, I will check into trunk today.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-01T17:41:37.267+0000","updated":"2010-12-01T17:41:37.267+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12965772","id":"12965772","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I think this is OK as long as the classes are only used by the sane jars. If you plan to use the classes in the production jars too, you should be aware of the discussion in DERBY-289, which raises some concerns about having code in the shared packages.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-12-01T18:07:22.659+0000","updated":"2010-12-01T18:07:22.659+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12965861","id":"12965861","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I think the point of the move is to make them available for insane builds so they can be used by the engine on a crash, so if it cannot be in shared,  I guess instead of moving the SanityManager code, there will have to be separate new code for producing thread dumps in  java/engine/org/apache/derby/iapi/services/info.  It would be good to include comments in both explaining that any bug fixes will likely have to be fixed in both places.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-12-01T21:51:44.586+0000","updated":"2010-12-01T21:51:44.586+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12966133","id":"12966133","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks Knut and Kathey. \r\nFor phrase one, the goal is to use ExceptionUtil.dumpThread() in AssertFailure.java. AssertFailure.java is in shared/common/sanity for insane build.\r\nFor phrase two, the goal is to use ExceptionUtil.dumpThread() in ContextManager for engine. ExceptionUtil is in shared/common/error which is an existing class for derby.jar and derbyclient.jar. I am including ContextManaer.java now to help me understand does it fit into the David's concern on DERBY-289 https://issues.apache.org/jira/browse/DERBY-289?focusedCommentId=12415429&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#action_12415429. If phrase two's change is only to ContextManager.java(working progress) which uses ExceptionUtil.java and ExceptionUtil.java is an existing class, do I still need to introduce code in java/engine/org/apache/derby/iapi/services/info to have similar class? I would think it is safe to use since it is an existing class on shared/common/error that derby.jar and derbyclient.jar both had. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-02T14:44:08.904+0000","updated":"2010-12-02T14:44:08.904+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12966299","id":"12966299","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"\r\nHi Lily,\r\n\r\nI see what you mean about ExceptionUtil.java. I think the short story is that that it should not have ever been used by the engine.  David's original comment said:\r\n\r\n\"DERBY-838: Establish an internationalization framework for the network\r\nclient.\r\n\r\nAdded a new shared directory and shared packages.  These shared packages\r\nare only used by the derbyclient.jar until we establish a shared code framework\"\r\n\r\nI recall conversations long ago that until we figured out how to really handle common code, things that would be potentially  good to share would be put under shared, but only be used by client until the whole framework was worked out. Unfortunately this history was lost when during the LOB work too years later, ExceptionUtil obviously looked very convenient for this  engine work, but we should probably file a bug to take references to ExceptionUtil out of the engine.\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-12-02T21:59:55.011+0000","updated":"2010-12-02T21:59:55.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12967071","id":"12967071","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks Kathey for point out the history and how to proceed. Thanks Knut for helping me on IRC. Due to the fact that java/shared/org/apache/derby/shared/common is really for derbyclient.jar. And, my part 1 and part 2 are really only for engine. I will not be changing the java/shared/org/apache/derby/shared/common/sanity/ThreadDump.java. or any of the shared files.\r\nInstead, I am adding a new java/engine/org/apache/derby/iapi/error/ThreadDumpUtil.java and java/engine/org/apache/derby/iapi/error/ExceptionUtil.java Since these two files are very similar to the ThreadDump.java and ExceptionUtil.java in java/shared/ . In the future, if the code affect both engine and client, developer has to fix in two places.\r\n \r\nI changed the name from ThreadDump.java to ThreadDumpUtil.java.  If there is no extra instruction in extraDBMSclasses.properties or rename to ThreadDumpUtil.java, With the change iapi/build.xml, build process will always build ThreadDump.class in classes/org/apache/derby/shared/common/error/ThreadDump.class. \r\nWith derby.module.engine.threaddumputil=org.apache.derby.iapi.error.ThreadDumpUtil in extraDBMSclasses.properties and rename ThreadDump.java to ThreadDumpUtil.java in iapi/error, the build process will build classes/org/apache/derby/iapi/error/ThreadDumpUtil.class\r\n\r\nContextManager.java change is so thread dump information will be in insane build. I install updates for eclipse with my eclipse. The new behavior keeps sorting the import files when I press safe. I tried to make it not sort the import files and not very successful. I thought we can use sorted import files. If we prefer not to have it sort, I need help to figure out how to make eclipse not sort the import files. :)\r\n\r\nThe code is ready for review. I run Suites.all and derybyall for insane and sane build and they all run okay. I also tested it with 'corruptdb' database and see the thread dump information.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-06T03:07:10.223+0000","updated":"2010-12-06T03:07:10.223+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12968935","id":"12968935","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thanks Lily for the patch.\r\n\r\nFor the new engine ExceptionUtil, I don't think  the field threadDump is needed or used.  The reflection call should use the ThreadDump in engine, not the shared one. I think then it will be fine for the engine ThreadDump class to keep the original name,  ThreadDump.\r\n\r\n\r\nIn ContextManager, there seem to be some javadoc formatting issues with the new getErrorCode method, which might better be callse dgetErrorSeverity.  I would add a comment that errors that are not Standard or SQLExcetions are not handled at this time.\r\n]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-12-07T20:09:15.486+0000","updated":"2010-12-07T20:09:15.486+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12968995","id":"12968995","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks Kathey for reviewing the code. \r\nI attached the part_2_2b patch.\r\nThe threadDump varilable is removed from ExceptionUtil and the reflection is using ThreadDump. The ThreadDumpUtil is rename to ThreadDump in iapi/error.\r\n\r\nIn ContextManager, the import is not being sorted. The getErrorCode Method is renamed to getErrorSeverity and the javadoc format issues is modified. Add commend says error only StandardException and SQLException are being handled at this time. \r\n\r\nbuild.xml and extraDBMSclasses.properties had been changed to reflect rename of ThreadDumpUtil to ThreadDump.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-07T21:19:22.121+0000","updated":"2010-12-07T21:19:22.121+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12969173","id":"12969173","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Run fine for suites.all and derbyall for insane build. Thread dump info is log to derby.log. \r\nCommit fix for part 2 of this issue and DERBY-4929 at subversion revision 1043290. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-08T04:06:42.345+0000","updated":"2010-12-08T04:06:42.345+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12969249","id":"12969249","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The two new files added in the patch didn't have the svn:eol-style property set. I fixed that and committed revision 1043334.\r\n\r\nHere's a description of how to configure Subversion to set this property automatically for you: http://www.apache.org/dev/svn-eol-style.txt","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-12-08T08:52:38.536+0000","updated":"2010-12-08T08:52:38.536+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12971918","id":"12971918","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks to Kathey. I am attach DERBY-4856_part_3_1a.diff patch.\r\nThe changes in this patch:\r\n1. Allow use enter property derby.stream.error.extendedDiagSeverityLevel. The default value is 40000\r\n2. If the error(StandardException, SQLException) has error severity level >= derby.stream.error.extendedDiagSeverityLevel, thread dump information and extend diagnosis information will be handle by Derby.\r\n3. Change SimpleTest to have derby.stream.error.extendedDiagSeverityLevel=45000\r\n\r\nI am running Suites and derbyall tests now.\r\n\r\nQuestion: If the database is not booted and error occurs, thread dump information and extend diagnosis information will still be handle with proper extenedDiagSeverityLevel . Should the code be some where else than ContextManager.cleanupOnError()? Any suggestion is welcome. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-16T01:05:56.886+0000","updated":"2010-12-16T01:05:56.886+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12975399","id":"12975399","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks to IRC discussion with Kathey and Knut. This is the prototype for checking whether database is active or it is okay to trace thread dump information in ContextManager.cleanupOnError on top of part_3_1a patch. The change includes:\r\n1.\tcleanupOnError takes two parameters: error and isdbactive. If isdbactive, it will print out threadudmp info and diagnosis information for ibm jvm\r\n2.\tThe guide line to get isdbactive information is to just pass the Boolean value when it make sense, get it from the isactive information from the database associated with the object, get it from  the isactive Boolean value from the database associated with LanguageConnectionContext,  or the isactive value from EmbedPooledConnection value. \r\n\r\nThe patch passed Suites.all and derbyall for sun jvm.  However, it hangs on replication tests for ibm jvm such as ReplicationRun_Local in ReplicationRun_Local.connectPing somewhere near conn=DriverManager.getConnection(dbURL); \r\n\r\nThe patch is ready for review. Thank you for reviewing in advance.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-28T01:02:54.739+0000","updated":"2010-12-28T01:02:54.739+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12976361","id":"12976361","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks to Kathey for reviewing the code. The new patch is ready for review.\r\nChange in this patch compare to last one\r\n1.\tFor all the tests, assume we don't want the thread dump info except T_b2i.java test. For T_b2i.java, I am testing the test can function correctly if we get the database active information from LanguageConnectionContext object.\r\n2.\tFor the code path we know it is okay not to get the thread dump information, we will assume database is not active\r\n3.\tChange getSystenProperty to private in JVMInfo.java\r\n\r\nPatch run clean on suites.all for sun jvm. I am still running derbyall test suite for sun jvm.\r\n\r\nThere are two issues that are under investigation:\r\n1.\tFor ibm 1.6 jvm, ReplicationRun_Local still hang on ReplicationRun.connectPing(...) where we try to do DriverManager.getConnection(dbURL) on windows 7. The test did not hang with ibm 1.6 jvm on windows xp. The dbURL value is jdbc:derby://localhost:1531/c:\\derby3\\trunk\\testtmp\\db_slave\\wombat I am thinking out loud here. Will change the path for the master and slave server and using the new way to remove directory make the hang issue and intermediate failure on replication tests behave better?  Any suggestion is welcome.\r\n2.\tFor replication failover case, there are some javacore* files created due to the current design of handling javaDump for ibm. Maybe we should just not dump thread info in these cases?\r\n\r\nHappy New Year!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-12-31T22:49:52.456+0000","updated":"2010-12-31T22:49:52.456+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12976954","id":"12976954","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Change in this patch compare to 3a patch:\r\n1. Change TransactionResourceImpl.cleanupOnError(Throwable e) to assume database is not active to avoid the hanging problem for replicationRun_Local test one windows 7. Also, not create thread dump info and diagnoisis files on replication failover situation.\r\n\r\nSuites.all runs clean with ibm 1.6 jvm with svn 1054737. derbyall failed on unit/T_RawStoreFactory.unit due to not able to shutdown database.\r\n\r\nSuites.all and derbyall run clean with sun jvm.\r\n\r\n\r\nThe patch is ready for review.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-03T20:56:42.564+0000","updated":"2011-01-03T20:56:42.564+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12977644","id":"12977644","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks to Kathey for reviewing the code and found problem for not able to get thread dump and diagnostic information when there is deadlock error. Please refer to test Derby3980DeadlockTest.\r\n\r\nThe changes for this patch compare to 3b are:\r\n1.\tUse isactive variable in SequenceUpdater.java\r\n2.\tRevise TransactionResourceImpl.cleanupOnError(Throwable error, Boolean diagActive) method to take one more parameter to further detect whether to process diagnostic information.\r\n•\tPass whether database is active information in TransactionResourceImpl.handleException\r\n3.\tAssume database is not active when calling TransactionResourceImpl.cleanupOnError on EmbeddedConnection(...) init stage and EmbeddedConnection.close\r\n4.\tChange comments and variable name\r\n5.\tAdd test to Derby3980DeadlockTest.java\r\n\r\nCurrent result: There is one javacore* file after Derby3980DeadlockTest\r\n\r\nI am running suites.all and derbyall tests. Please review the code.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-05T06:28:52.427+0000","updated":"2011-01-05T06:28:52.427+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12978005","id":"12978005","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"After running derbyall and suites.all with ibm 1.6 jvm, I made the following adjustment and attach 3d patch:\r\n1.\tCheck whether database is null at TransactionResourceImple.handleException as sometimes the database can be null and we will not want to print any thread dump or diagnostic information\r\n2.\tModify MaxLogNumberRecovery.java to set derby.stream.error.extendedDiagSeverityLevel to 50000 so no thread dump or diagnostic information as test exceed the max log file number. \r\n3.\tRevert the change for SimpleTest.java since the flag value is being used in Derby3980DeadlockTest and MaxLogNumberRecovery.\r\n\r\nDerbyall and suites.all does not have any unexpected failure with ibm 1.6 jvm. I am running with sun jvm now. The patch is ready for review.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-05T22:31:17.367+0000","updated":"2011-01-05T22:31:17.367+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12979964","id":"12979964","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Add removing the javacore* file from Derby3980DeadlockTest and add the proper .policy file for it.\r\nHowever, due to the current behavior regarding error for  40001 or 40XL1: A lock could not be obtained. The test output is different from ibm jvm or sun jvm. There might be more work to be done to make the test more stable to be part of regression test. There is no change on code change for 3e patch. Suites and derbyall run clean on 3e patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-11T06:28:36.028+0000","updated":"2011-01-11T06:28:36.028+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12980415","id":"12980415","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks to Kathey, patch 3g modify Derby3980DeadlockTest.decorateTest to preserve the derby.log on failure. Due to extra timing to create javacore* files, ibm jvm produce deadlock error instead of log time out error. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-11T23:09:50.360+0000","updated":"2011-01-11T23:09:50.360+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981122","id":"12981122","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Check in svn #1058404 for part_3_3g patch with space/tab changes and AuthenticationTest.java change.\r\nIt is possible the database.isActive() information could need more work. Please watch that for me. When running suites.all with ibm jvm, there are left over javacore* files. I still need to do clean up work. More information is needed to find out which tests create the javacore*file. There are two ways to clean up the javacore* files - create teardown() method to clean up the javacore* files or set the flag by calling \r\nsetSystemProperty(\"derby.stream.error.extendedDiagSeverityLevel\",\"50000\")\r\n\r\nDerby3980DeadlockTest might not always produce deadlock error and it is not part of nightly run test.\r\n\r\nThank Kathey so much for keep helping me review and write this part of fix. Thank Knut for giving very helpful tips in IRC and everywhere else.  Hopefully, the javacore* files will not cause the machine to run out of disk space. Post-commit reviews still welcome. :)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-13T04:10:19.943+0000","updated":"2011-01-13T04:10:19.943+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981180","id":"12981180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"It would be good to add a comment in AuthenticationTest to explain why the system property has to be set for the test. There's no code to reset the property, so doesn't that mean it will affect subsequent tests too? Thinking more about it, since the code to set the system property is in baseSuite(), it will be executed before any tests have started, so it will probably affect all the tests. Would it work to wrap the test in a SystemPropertyTestSetup instead?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2011-01-13T08:44:19.450+0000","updated":"2011-01-13T08:44:19.450+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981252","id":"12981252","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks Knut for reviewing. I will add the comment to explain why the system property has to be set for AuthenticationTest. When I run suites.all with 1.6 ibm jvm, it created 145 javacore* files. I review most of them and most of them come from AuthenticationTest for getConnection that will get error/SQLException with negative tests. So, it makes sense for the thread dump information and diagnostic information. However, we really don't want to have too many left over javacore* files after test run. So, I set it in baseSuite() to trigger not producing such behavior.  I will look into wrap the test in a SystemPropertyTestSetup to see whether it is more appropriate. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-13T14:03:52.308+0000","updated":"2011-01-13T14:03:52.308+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981439","id":"12981439","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"It is better to wrap extendedDiagSeverityLevel property in SystemPropertyTestSetup for AuthenticationTest. Add the comment and the change to DERBY-4856_part_3_3g_1a.diff patch. I am running suites.All to see we don't produce too many javacore* files. Please review the change.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-13T19:34:17.921+0000","updated":"2011-01-13T19:34:17.921+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981601","id":"12981601","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks Kathey for giving her blessing for DERBY-4856_part_3_3g_1a.diff patch. There is only one javacore* file left after running suites.all with ibm 1.6 jvm. The test runs clean. The file is from LockInterruptTest. Add property to avoid thread dump and diagnostic information with DERBY-4856_part_3_3g_2a.diff patch. Please review the code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-14T01:34:48.358+0000","updated":"2011-01-14T01:34:48.358+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981616","id":"12981616","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Lilly at what point in the test was the the javacore occurring? Was it really a crash?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-01-14T03:03:24.738+0000","updated":"2011-01-14T03:03:24.738+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981622","id":"12981622","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks Kathey for reviewing. At LockInterruptTest.runWaiter() line 150 with ps.executeUpdate, the test receive an interrupt and raise an error/exception \"ERROR 08000: Connection closed by unknown interrupt\". I think this is a negative test case again. So, I set the flag to turn off thread dump and diagnostic information.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-14T03:44:57.119+0000","updated":"2011-01-14T03:44:57.119+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981771","id":"12981771","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I think this is indeed a session ending exception so it makes sense to get the javadump when it occurs and the thread dump might be very useful at this point.   If under some circumstance someone had intentional interrupts where this was expected, they could set property higher to avoid the javacores, so +1 to the change.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-01-14T14:33:29.426+0000","updated":"2011-01-14T14:33:29.426+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12981772","id":"12981772","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks Kathey for reviewing. I'll check-in the patch now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-14T14:41:37.959+0000","updated":"2011-01-14T14:41:37.959+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12987875","id":"12987875","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Attach the releaseNote.html. Please review the release note. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-28T01:38:03.266+0000","updated":"2011-01-28T01:38:03.266+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12988185","id":"12988185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Hi, thanks for the release notes, Lily!\r\n\r\nCaveat, my comments below are not based on a thorough knowledge of\r\nthis new feature, I have just read about if cursorily, so if I got my\r\nfact wrong, please forgive. Mostly, my change proposals are for\r\nimproved legibility.\r\n\r\n> Summary of Change\r\n> \r\n> Derby will dump as much thread dump and diagnostic information as\r\n> possible on system crash or session error. i.e. Users will find\r\n> thread dump information with error severity higher than session\r\n> error in derby.log.  \r\n\r\n\"will\" -> \"will by default\" \r\n\"Users\" -> \"users\"\r\n\r\nMaybe add a sentence: \"It is also possible to get thread dump and\r\ndiagnostic information\" of errors with lower severity by adjusting a\r\nproperty\".\r\n\r\n> Symptoms Seen by Applications Affected by\r\n> Change\r\n> \r\n> If errors have error severity level greater or equal than value\r\n> derby.stream.error.extendedDiagSeverityLevel is set, thread dump\r\n> information and extened diagnostic information will be handle by\r\n> Derby. Users can find thread dump information on derby.log. For ibm\r\n> jvm users, a javacore file will be created.\r\n\r\nI am not sure this content is correct for this section: The \"symptom\"\r\nif any of existing systems would be that we don't get (or there is not\r\nway to get ) enough state information when the system crashes or a\r\nsession level error happens.\r\n\r\n> Incompatibilities with Previous Release\r\n> \r\n> N/A \r\n\r\n\"N/A -> None  \r\n\r\nI think \"none\" is better here, since incompatibilities is always a\r\nrelevant (\"applicable\") question for database changes.\r\n\r\n> Rationale for Change\r\n> \r\n> The change intend to get more detail information relate to the staus\r\n\r\n\"The change intend\" -> The intention of the change\r\n\"staus\" -> status\r\n\r\n> of Derby server when user hit system crash or server session error.\r\n\r\n\"Derby server\" -> This applies to embedded usages as well? (i.e. not\r\nlimited to running with client/server. If so, maybe you can just use\r\n\"Derby\" instead.\r\n\r\n> Application Changes Required\r\n> \r\n> Users do not need to change anything for this change. If more thread\r\n> dump information requires for error is has severity level less than\r\n \r\n\"requires\" -> \"is required\"\r\n\"is has\" -> that have\"\r\n\r\n> session error, derby.stream.error.extendedDiagSeverityLevel can be\r\n\r\nSpecify scope (database or system level) of property and whether it is\r\na dynamic or static property.\r\n\r\n> set on derby.properties or as part of jvm argument. For example, if\r\n\r\n\"on derby.properties\" -> in the file \"derby.properties\"\r\n\"jvm\" -> \"JVM\"\r\n\r\n> there is a deadlock issue and users would like to see thread dump\r\n> information while deadlock is happening. Users can then set\r\n\r\n2nd \"deadlock\" above -> \"the deadlock\"\r\n\r\n\". Users\" -> \", users\"\r\n\r\n> derby.stream.error.extendedDiagSeverityLevel=30000 on either\r\n\r\n\"on\" -> \"in\"\r\n\r\n> derby.properties or as part of jvm argument.\r\n\r\n\"jvm argument\" -> \"JVM argument, e.g. -Dderby.stream.error.extendedDiagSeverityLevel=30000\"\r\n\r\n\r\n> They can find the tread dump information on derby.log.\r\n\r\nChange to \"The thread dump information is found in the Derby error\r\nlog, typically this is the file \"derby.log\".\r\n\r\n\r\n> derby.stream.error.extendedDiagSeverityLevel=30000 means\r\n> turn on TRANSACTION_SEVERITY type of error.\r\n\r\nlast line -> \"that the extended thread dump information for errors of\r\ntransaction severity or higher. Please consult the Derby documentation for explanation of error severity and for\r\nother possible settings of extendedDiagSeverityLevel.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2011-01-28T19:12:55.679+0000","updated":"2011-01-28T19:12:55.679+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12988348","id":"12988348","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks for the reviewing the release notes, Dag!!!\r\n\r\nCaveat, my comments below are not based on a thorough knowledge of \r\nthis new feature, I have just read about if cursorily, so if I got my \r\nfact wrong, please forgive. Mostly, my change proposals are for \r\nimproved legibility. \r\nYou are so kind. I really appreciated. \r\nMy comments are as follow:\r\n\r\n> Summary of Change \r\n> \r\n> Derby will dump as much thread dump and diagnostic information as \r\n> possible on system crash or session error. i.e. Users will find \r\n> thread dump information with error severity higher than session \r\n> error in derby.log. \r\n\r\n\"will\" -> \"will by default\" \r\n\"Users\" -> \"users\" \r\nThese have been changed.\r\n\r\nMaybe add a sentence: \"It is also possible to get thread dump and \r\ndiagnostic information\" of errors with lower severity by adjusting a \r\nproperty\". \r\nI think I did this. However, if it still need adjustment, please just let me knows.\r\n\r\n> Symptoms Seen by Applications Affected by \r\n> Change \r\n> \r\n> If errors have error severity level greater or equal than value \r\n> derby.stream.error.extendedDiagSeverityLevel is set, thread dump \r\n> information and extened diagnostic information will be handle by \r\n> Derby. Users can find thread dump information on derby.log. For ibm \r\n> jvm users, a javacore file will be created. \r\n\r\nI am not sure this content is correct for this section: The \"symptom\" \r\nif any of existing systems would be that we don't get (or there is not \r\nway to get ) enough state information when the system crashes or a \r\nsession level error happens. \r\nI am not sure about the content either. However, for this version, I decide to have the description here.\r\nIf users only view this section of release note, it might be good to have the information here too.\r\n\r\n> Incompatibilities with Previous Release \r\n> \r\n> N/A \r\n\r\n\"N/A -> None \r\nI changed this to \"None\".\r\n\r\nI think \"none\" is better here, since incompatibilities is always a \r\nrelevant (\"applicable\") question for database changes. \r\n+1\r\n\r\n> Rationale for Change \r\n> \r\n> The change intend to get more detail information relate to the staus \r\n\r\n\"The change intend\" -> The intention of the change \r\n\"staus\" -> status \r\n\r\n> of Derby server when user hit system crash or server session error. \r\n\r\n\"Derby server\" -> This applies to embedded usages as well? (i.e. not \r\nlimited to running with client/server. If so, maybe you can just use \r\n\"Derby\" instead. \r\nThese have been changed.\r\n\r\n\r\n\r\n> Application Changes Required \r\n> \r\n> Users do not need to change anything for this change. If more thread \r\n> dump information requires for error is has severity level less than \r\n  \r\n\"requires\" -> \"is required\" \r\n\"is has\" -> that have\" \r\n\r\n> session error, derby.stream.error.extendedDiagSeverityLevel can be \r\n\r\nSpecify scope (database or system level) of property and whether it is \r\na dynamic or static property. \r\n\r\n> set on derby.properties or as part of jvm argument. For example, if \r\n\r\n\"on derby.properties\" -> in the file \"derby.properties\" \r\n\"jvm\" -> \"JVM\" \r\n\r\n> there is a deadlock issue and users would like to see thread dump \r\n> information while deadlock is happening. Users can then set \r\n\r\n2nd \"deadlock\" above -> \"the deadlock\" \r\n\r\n\". Users\" -> \", users\" \r\n\r\n> derby.stream.error.extendedDiagSeverityLevel=30000 on either \r\n\r\n\"on\" -> \"in\" \r\n\r\n> derby.properties or as part of jvm argument. \r\n\r\n\"jvm argument\" -> \"JVM argument, e.g. -Dderby.stream.error.extendedDiagSeverityLevel=30000\" \r\n\r\n\r\n> They can find the tread dump information on derby.log. \r\n\r\nChange to \"The thread dump information is found in the Derby error \r\nlog, typically this is the file \"derby.log\". \r\n\r\n\r\n> derby.stream.error.extendedDiagSeverityLevel=30000 means \r\n> turn on TRANSACTION_SEVERITY type of error. \r\n\r\nlast line -> \"that the extended thread dump information for errors of \r\ntransaction severity or higher. Please consult the Derby documentation for explanation of error severity and for \r\nother possible settings of extendedDiagSeverityLevel.\r\n\r\nThese have been changed. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-01-29T01:09:41.542+0000","updated":"2011-01-29T01:09:41.542+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12989253","id":"12989253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Some further legibility improvement suggestions:\r\n\r\n> Summary of Change\r\n> \r\n> Derby will by default dump as much thread dump and diagnostic\r\n> information as possible on system crash or session error.\r\n> i.e. users will find thread dump information with error severity\r\n> higher than session error in derby.log.\r\n\r\nPossible improvement:\r\n\r\nOn experiencing a system crash or session error, Derby will print as\r\nmuch diagnostic information as possible to the Derby error log,\r\nincluding stack traces of all threads.\r\n\r\n\r\n> It is also possible to get thread dump and diagnostic information of\r\n> errors with lower severity by adjusting a property.\r\n\r\nThis one is good, maybe change \"of\" to \"for\",\r\n\r\n> Symptoms Seen by Applications Affected by Change \r\n\r\n> If errors have error severity level greater or equal than value\r\n> derby.stream.error.extendedDiagSeverityLevel is set, thread dump\r\n> information and extened diagnostic information will be handle by\r\n> Derby. Users can find thread dump information in derby.log. For ibm\r\n> JVM users, a javacore file will be created.\r\n\r\nI still feel this information belongs in the first section, and that\r\nthis section should be N/A. I agree this is useful \r\n\r\n\"handle\" -> \"printed\"\r\n\"in derby.log\" -> \"in the Derby error log\"\r\n\r\nibm -> IBM \r\n\r\n> Incompatibilities with Previous Release\r\n> \r\n> None\r\n\r\n> Rationale for Change\r\n> \r\n> The intention of the change to get more detail information relate to\r\n\r\n\"relate\" -> \"related\"\r\n\r\n> the status of Derby when user hit system crash or server session\r\n> error.  \r\n\r\nSuggest_\r\n\r\n\"the status of Derby when important errors happen, \"important\" by\r\ndefault meaning errors with session severity and higher. This will\r\nhelp users, DBAs and support personnel to determine the exact cause of\r\nthe error condition.\"\r\n\r\n\r\n> Application Changes Required\r\n> \r\n> Users do not need to change anything for this change. If more thread\r\n> dump information is required for error that have severity level less\r\n> than session error, derby.stream.error.extendedDiagSeverityLevel can\r\n\r\n\"derby.stream.error.extendedDiagSeverityLevel\" ->\r\n\"the property derby.stream.error.extendedDiagSeverityLevel\"\r\n\r\n> be set in the file \"derby.properties\" or as part of the JVM\r\n> argument. \r\n\r\nIn stead of specifying \"derby.properties\" or JVM argument here,\r\nwouldn't it be better to just state this is a Derby system property\r\nand give a link to the documentation? System wide properties can also\r\nbe set programmatically. You could also say, here as an example, \"for\r\nexample, in derby.properties\" but not try to enumerate all ways it can\r\nbe set.\r\n\r\nhttp://db.apache.org/derby/docs/10.7/devguide/cdevsetprop16827.html\r\n\r\n\r\n> For example, if there is a deadlock issue and users would\r\n> like to see thread dump information while the deadlock is happening,\r\n> users can then set\r\n> derby.stream.error.extendedDiagSeverityLevel=30000 in the file\r\n> \"derby.properties\" or as part of JVM argument,\r\n> e.g. -Dderby.stream.error.extendedDiagSeverityLevel=30000.\r\n\r\nSee above comment, drop how to to set it here altogether, just show\r\nthe value required.\r\n\r\n> The thread dump information is found in the Derby error log,\r\n\r\n\"The thread dump information\" ->\r\n\"The diagnostics and the thread dump information\"\r\n\r\n> typically this is the file \"derby.log\".\r\n\r\n> derby.stream.error.extendedDiagSeverityLevel=30000\r\n> means turn on TRANSACTION_SEVERITY type of error that the extended\r\n> thread dump information for errors of transaction severity or\r\n> higher. \r\n\r\nSuggest:\r\n\r\n\"derby.stream.error.extendedDiagSeverityLevel=30000 means that extra\r\ndiagnostics and thread dump will be activated for errors with\r\nseverity equal to og higher than transaction severity (30000).\"\r\n\r\n> Please consult the Derby documentation for explanation of error\r\n> severity and for other possible settings of\r\n> extenedDiagSeverityLevel.\r\n\r\nThanks,\r\nDag\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2011-02-01T15:39:19.777+0000","updated":"2011-02-01T15:39:19.777+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/12989819","id":"12989819","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Thanks Dag for reviewing in such details. I feel I shall help more on DERBY-4741 since you help me so much. :-)\r\nSome further legibility improvement suggestions: \r\n\r\n> Summary of Change \r\n> \r\n> Derby will by default dump as much thread dump and diagnostic \r\n> information as possible on system crash or session error. \r\n> i.e. users will find thread dump information with error severity \r\n> higher than session error in derby.log. \r\n\r\nPossible improvement: \r\n\r\nOn experiencing a system crash or session error, Derby will print as \r\nmuch diagnostic information as possible to the Derby error log, \r\nincluding stack traces of all threads. \r\n>>I change to reflect the suggestion.\r\n\r\n> It is also possible to get thread dump and diagnostic information of \r\n> errors with lower severity by adjusting a property. \r\n\r\nThis one is good, maybe change \"of\" to \"for\", \r\n>>Thanks. Done!\r\n\r\n> Symptoms Seen by Applications Affected by Change \r\n\r\n> If errors have error severity level greater or equal than value \r\n> derby.stream.error.extendedDiagSeverityLevel is set, thread dump \r\n> information and extened diagnostic information will be handle by \r\n> Derby. Users can find thread dump information in derby.log. For ibm \r\n> JVM users, a javacore file will be created. \r\n\r\nI still feel this information belongs in the first section, and that \r\nthis section should be N/A. I agree this is useful \r\n\r\n\"handle\" -> \"printed\" \r\n\"in derby.log\" -> \"in the Derby error log\" \r\n\r\nibm -> IBM\r\n>>I see your point. I still feel it does not hurt to be here for users who only view this section for release note.\r\n\r\n> Incompatibilities with Previous Release \r\n> \r\n> None \r\n\r\n> Rationale for Change \r\n> \r\n> The intention of the change to get more detail information relate to \r\n\r\n\"relate\" -> \"related\" \r\n>>Done.\r\n\r\n> the status of Derby when user hit system crash or server session \r\n> error. \r\n\r\nSuggest_ \r\n\r\n\"the status of Derby when important errors happen, \"important\" by \r\ndefault meaning errors with session severity and higher. This will \r\nhelp users, DBAs and support personnel to determine the exact cause of \r\nthe error condition.\" \r\n>>I change the release note to reflect to the suggestion.\r\n\r\n\r\n> Application Changes Required \r\n> \r\n> Users do not need to change anything for this change. If more thread \r\n> dump information is required for error that have severity level less \r\n> than session error, derby.stream.error.extendedDiagSeverityLevel can \r\n\r\n\"derby.stream.error.extendedDiagSeverityLevel\" -> \r\n\"the property derby.stream.error.extendedDiagSeverityLevel\" \r\n\r\n> be set in the file \"derby.properties\" or as part of the JVM \r\n> argument. \r\n\r\nIn stead of specifying \"derby.properties\" or JVM argument here, \r\nwouldn't it be better to just state this is a Derby system property \r\nand give a link to the documentation? System wide properties can also \r\nbe set programmatically. You could also say, here as an example, \"for \r\nexample, in derby.properties\" but not try to enumerate all ways it can \r\nbe set. \r\n\r\nhttp://db.apache.org/derby/docs/10.7/devguide/cdevsetprop16827.html \r\n \r\n>>Thank you so much for the link. I was trying find the link and add it to it. The users will see the link in this releaseNote.html.\r\n\r\n> For example, if there is a deadlock issue and users would \r\n> like to see thread dump information while the deadlock is happening, \r\n> users can then set \r\n> derby.stream.error.extendedDiagSeverityLevel=30000 in the file \r\n> \"derby.properties\" or as part of JVM argument, \r\n> e.g. -Dderby.stream.error.extendedDiagSeverityLevel=30000. \r\n\r\nSee above comment, drop how to to set it here altogether, just show \r\nthe value required. \r\n\r\n> The thread dump information is found in the Derby error log, \r\n\r\n\"The thread dump information\" -> \r\n\"The diagnostics and the thread dump information\" \r\n\r\n> typically this is the file \"derby.log\". \r\n\r\n> derby.stream.error.extendedDiagSeverityLevel=30000 \r\n> means turn on TRANSACTION_SEVERITY type of error that the extended \r\n> thread dump information for errors of transaction severity or \r\n> higher. \r\n\r\nSuggest: \r\n\r\n\"derby.stream.error.extendedDiagSeverityLevel=30000 means that extra \r\ndiagnostics and thread dump will be activated for errors with \r\nseverity equal to og higher than transaction severity (30000).\" \r\n>>The change is reflected to the suggestion.  \r\n\r\n> Please consult the Derby documentation for explanation of error \r\n> severity and for other possible settings of \r\n> extenedDiagSeverityLevel. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2011-02-02T21:58:37.991+0000","updated":"2011-02-02T21:58:37.991+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/13000819","id":"13000819","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attaching an updated release note.\r\n\r\nMade the summary a one-liner (\"Improved error diagnostics on system crashes and session errors\") so that it fits nicely into the short list of changes. The extra information contained in the original summary was incorporated into the other sections.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2011-03-01T10:31:25.236+0000","updated":"2011-03-01T10:31:25.236+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12477769/comment/13000926","id":"13000926","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Adjust the release note.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2011-03-01T15:52:24.956+0000","updated":"2011-03-01T15:52:24.956+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4856/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06m3r:"}}