{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12328359","self":"https://issues.apache.org/jira/rest/api/latest/issue/12328359","key":"DERBY-898","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-02-08 13:37:44.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22195","customfield_12310222":"1_*:*_1_*:*_755325000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_36000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-02-09T23:03:45.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-898/watchers","watchCount":0,"isWatching":false},"created":"2006-02-01T05:15:00.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.png","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12310615","id":"12310615","description":"","name":"10.1.2.1","archived":false,"released":true,"releaseDate":"2005-11-18"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-02-09T23:04:21.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11410","id":"11410","name":"Network Server"}],"timeoriginalestimate":null,"description":" Network Server is not honoring local \ntransaction rollback using ClientXADataSource.  Run the following standalone JDBC code.  \nThe output shows that after rolling back the local transaction, \nthe inserted data is still present.\n\n        final org.apache.derby.jdbc.ClientXADataSource ds =\n            new org.apache.derby.jdbc.ClientXADataSource();\n        ds.setServerName(\"localhost\");\n        ds.setPortNumber(1527);\n        \nds.setDatabaseName(\"WOMBAT\");\n        ds.setTraceLevel(-1);\n        \nds.setSecurityMechanism(ds.CLEAR_TEXT_PASSWORD_SECURITY);\n        ds.setUser(\"dbuser1\");\n        ds.setPassword(\"dbpwd1\");\n        //ds.setLogWriter(new \njava.io.PrintWriter(System.out));\n\n        XAConnection xaConn = ds.getXAConnection();\n        Connection conn = xaConn.getConnection();\n\n        \nconn.setTransactionIsolation(Connection.TRANSACTION_REPEATABLE_R\nEAD);\n\n        conn.setAutoCommit(true);\n\n        System.out.println(\"Database product: \" + \nconn.getMetaData().getDatabaseProductName());\n        System.out.println(\"Database version: \" + \nconn.getMetaData().getDatabaseProductVersion());\n        System.out.println(\"Driver name:      \" + \nconn.getMetaData().getDriverName());\n        System.out.println(\"Driver version:   \" + \nconn.getMetaData().getDriverVersion());\n\n        Statement stmt = conn.createStatement();\n\n        try { stmt.execute(\"drop table cmtest\"); }\n        catch (SQLException sqlX) {} // ok, didn't exist\n\n        stmt.execute(\"CREATE TABLE cmtest (id integer not null \nprimary key, name varchar(60))\");\n        stmt.close();\n\n        conn.setAutoCommit(false);\n\n        PreparedStatement pstmt = conn.prepareStatement(\n            \"INSERT INTO cmtest (id, name) VALUES(?,?)\",\n            ResultSet.TYPE_FORWARD_ONLY,\n            ResultSet.CONCUR_READ_ONLY);\n\n        pstmt.setInt(1, 13);\n        pstmt.setString(2, \"blah1\");\n        pstmt.executeUpdate();\n\n        pstmt.setInt(1, 2);\n        pstmt.setString(2, \"blah2\");\n        pstmt.executeUpdate();\n\n        conn.rollback();\n\n        PreparedStatement pstmt2 = conn.prepareStatement(\n            \"SELECT * FROM cmtest WHERE id = ?\",\n            ResultSet.TYPE_FORWARD_ONLY,\n            ResultSet.CONCUR_READ_ONLY);\n\n        pstmt2.setInt(1, 13);\n\n        ResultSet rset = pstmt2.executeQuery();\n\n        if (rset.next())\n        {\n            System.out.println(\"Test fails. First insert was \nnot rolled back.\");\n            System.out.println(\"The data is still present. It \nis: \" + rset.getObject(1) +\n                               \", \" + rset.getObject(2));\n        }\n        else\n            System.out.println(\"Test passes. First insert was \nrolled back.\");\n\nHere's the output,\n\n    Database product: Apache Derby\n    Database version: 10.1.2.2\n    Driver name:      Apache Derby Network Client JDBC Driver\n    Driver version:   10.1.2.2\n    Test fails. First insert was not rolled back.\n    The data is still present. It is: 13, blah1\n\nOn some brief investigation I see that the Network Server embedded connection is  in autocomit mode so is autocommitting the transaction before the rollback.   Network server should always have autocommit false and let the client drive the commit.  \n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40816","summary":"setAutoCommit(false) is not working properly for local transaction with ClientXADataSource","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":6,"total":6,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328359/comment/12365092","id":"12365092","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"DERBY-898 setAutoCommit(false) is not working properly with connections objtained with ClientXADataSource.\r\n\r\nThe problem in this case was that the  server side connection was  set to autocommit true.  Even when the client has autocommit on, the server side connection should be autocommit false and let the client drive the commits.\r\n\r\n-  Changes server side connection for network server XA to autocommit false.  \r\n\r\n- Adds connections obtained from an XADataSource to the savepointJdbc30 test to verify that autocommit is being set properly and also verify that DERBY-899 (a dup of this issue) is fixed.\r\n\r\nI will commit to 10.1 later today.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-02-04T02:26:10.000+0000","updated":"2006-02-04T02:26:10.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328359/comment/12365127","id":"12365127","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Checked in fix to 10.1\r\n\r\nDate: Fri Feb  3 13:00:35 2006\r\nNew Revision: 374742\r\n\r\nURL: http://svn.apache.org/viewcvs?rev=374742&view=rev\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-02-04T06:05:37.000+0000","updated":"2006-02-04T06:05:37.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328359/comment/12365518","id":"12365518","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"OK. So I decided to go with option 1), but wonder what the naming convention should be for this.\r\nRight now I have simpleSavepointJdbc30.java for the base test that runs with all jvms and extendedSavepointJdbc30.java for the one that has the non J2ME/CDC/FP functionality, but would there be a better naming convention? \r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-02-08T13:13:52.000+0000","updated":"2006-02-08T13:13:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328359/comment/12365520","id":"12365520","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I think it would be good to get the names to reflect the reality that  CDC/Foundation/JSR169 is a sub-set of the JDBC 3.0 spec,\r\nnot that JDBC 3.0 is an extended version of  JSR169. \r\n\r\nPossible names\r\n\r\nsavepointJdbc30_JSR169\r\nsavepointJdbc30_XA\r\n\r\nor\r\n\r\nsavepointJdbc30\r\nsavepointJdbc30_XA\r\n\r\nIThe XA iaccurately depicts what is being tested, rather than just saying extended.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-02-08T13:37:44.000+0000","updated":"2006-02-08T13:37:44.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328359/comment/12365735","id":"12365735","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Date: Thu Feb  9 06:02:18 2006\r\nNew Revision: 376296\r\n\r\nURL: http://svn.apache.org/viewcvs?rev=376296&view=rev\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-02-09T23:03:45.000+0000","updated":"2006-02-09T23:03:45.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328359/comment/12365736","id":"12365736","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"fixed in trunk and 10.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-02-09T23:04:21.000+0000","updated":"2006-02-09T23:04:21.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-898/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07cnj:"}}