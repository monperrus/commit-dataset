{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12352146","self":"https://issues.apache.org/jira/rest/api/latest/issue/12352146","key":"DERBY-1910","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-10-02 14:41:32.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22784","customfield_12310222":"1_*:*_1_*:*_279004000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_37576552399","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-10-04T11:09:23.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1910/watchers","watchCount":0,"isWatching":false},"created":"2006-10-01T05:39:19.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-07-25T17:42:21.476+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"}],"timeoriginalestimate":null,"description":"I found this phenomena at my environment.\n\nnaka@rufelza:~/derby/test/20061001_2$ runNetClientTest.sh jdbcapi/_Suite.junit\n/home/naka/derby/dev/trunk/jars/sane/derby.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbytools.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbynet.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyclient.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyrun.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyTesting.jar:\n/home/naka/derby/dev/trunk/tools/java/jakarta-oro-2.0.8.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_de_DE.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_es.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_fr.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_it.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_ja_JP.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_ko_KR.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_pt_BR.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_zh_CN.jar:\n/home/naka/derby/dev/trunk/jars/sane/derbyLocale_zh_TW.jar:\n/home/naka/derby/dev/trunk/tools/java/junit.jar:\n/home/naka/derby/dev/trunk/tools/java/db2jcc.jar:\n/home/naka/derby/dev/trunk/tools/java/db2jcc_license_c.jar:.\nconsole.encoding:null file.encoding:ISO-8859-1 derby.ui.codeset: null\n*** Start: _Suite jdk1.4.2_10 DerbyNetClient 2006-10-01 14:19:52 ***\nInitialize for framework: DerbyNetClient\nstartServer = false. Bypass server startup\njava -Duser.language=en -Duser.country=US -Dderby.system.home=/home/naka/derby/test/20061001_2/DerbyNetClient/_Suite -Dderby.infolog.append=true -Dframework=DerbyNetClient -Djava.security.manager -Djava.security.policy=/home/naka/derby/test/20061001_2/derby_tests.policy -DderbyTesting.clientjar=file:/home/naka/derby/dev/trunk/jars/sane/ -DderbyTesting.codejar=file:/home/naka/derby/dev/trunk/jars/sane/ -DderbyTesting.testjar=file:/home/naka/derby/dev/trunk/jars/sane/ -DderbyTesting.codedir=/home/naka/derby/dev/trunk/jars/sane -DderbyTesting.serverhost=localhost -DderbyTesting.clienthost=localhost junit.textui.TestRunner org.apache.derbyTesting.functionTests.tests.jdbcapi._Suite \nThe test should be running...\nAbout to execute: diff.exec( outName = /home/naka/derby/test/20061001_2/DerbyNetClient/_Suite.out,outDir = /home/naka/derby/test/20061001_2/DerbyNetClient,pwDiff = java.io.PrintWriter@12f0999,testOutName = _Suite,frameworkMaster = DerbyNetClient,jvmName = jdk14,iminor = 4,useprocess = true,systemdiff = false,canondir = null,canonpath = null)\n\n0 add\n> .......................E....\n> There was 1 error:\n> 1) testClobAsciiWrite3Param(org.apache.derbyTesting.functionTests.tests.jdbcapi.LobStreamsTest)java.lang.OutOfMemoryError\n> FAILURES!!!\n> Tests run: 847,  Failures: 0,  Errors: 1\nTest Failed.\n*** End:   _Suite jdk1.4.2_10 DerbyNetClient 2006-10-01 14:22:01 ***\n\n\nThis seems to be same as the error which was recorded in next test result.\nhttp://www.multinet.no/~solberg/public/Apache/DerbyJvm1.4/Limited/testSummary-451360.html\n\nComparing results at http://www.multinet.no/~solberg/public/Apache/index.html, \nthis phenomena seems to happen when test was executed with jvm 1.4.2.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39421","summary":"OutOfMemoryError happens when jdbcapi/_Suite.junit was executed as DerbyNetClient (in jvm1.4.2)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=naka","name":"naka","emailAddress":"tomonaka at basil dot ocn dot ne dot jp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomohito Nakayama","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=naka","name":"naka","emailAddress":"tomonaka at basil dot ocn dot ne dot jp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomohito Nakayama","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"naka@rufelza:~/derby/test/20061001_2$ cat /proc/version \nLinux version 2.6.12-1-386 (horms@tabatha.lab.ultramonkey.org) (gcc version 4.0.2 20050917 (prerelease) (Debian 4.0.1-8)) #1 Tue Sep 27 12:41:08 JST 2005\n\nnaka@rufelza:~/derby/test/20061001_2$ java -version\njava version \"1.4.2_10\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_10-b03)\nJava HotSpot(TM) Client VM (build 1.4.2_10-b03, mixed mode)","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":7,"total":7,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12352146/comment/12438963","id":"12438963","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=naka","name":"naka","emailAddress":"tomonaka at basil dot ocn dot ne dot jp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomohito Nakayama","active":true},"body":"To make it easy to read ...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=naka","name":"naka","emailAddress":"tomonaka at basil dot ocn dot ne dot jp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tomohito Nakayama","active":true},"created":"2006-10-01T05:41:18.000+0000","updated":"2006-10-01T05:41:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12352146/comment/12439177","id":"12439177","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"body":"There seems to be a slight difference in memory usage between Windows/Linux and Solaris platforms, which is most likely why the suite so far does not fail on the Solaris platforms used in Sun's daily/nightly regression tests.\r\n\r\nI ran the jdbcapi suite in the DerbyNetClient framework on both a Solaris 10 x86 machine and a Linux machine using JDK 1.4.2:\r\n\r\n$ java -Dframework=DerbyNetClient org.apache.derbyTesting.functionTests.harness.RunTest jdbcapi/_Suite.junit\r\n\r\nI monitored the memory usage of the junit.textui.TestRunner JVM by using the jstat tool. Both test runs reached a maximum tenured space usage of 60544 kB, but the linux JVM seemed to hit this limit a bit earlier than the Solaris JVM.\r\n\r\nDefault max heap size on 1.4.2 JVMs is 64 MB [1], so 60544 kB is probably the default max for the tenured space (\"Eden\" and the two survivor spaces occupy the rest of the heap, see [2]). On newer JVMs, the default max heap size usually depends on the hardware being used.\r\n\r\nFurther investigations are needed to determine the cause of this failure. It seems to me that there is an issue with JUnit tests all being run in the same JVM, resulting in old objects accumulating over time without being garbage collected, for some reason.\r\n\r\n\r\n[1]: http://java.sun.com/docs/hotspot/gc1.4.2/#3.1.%20Total%20Heap|outline\r\n[2]: http://java.sun.com/docs/hotspot/gc1.4.2/#2.%20Generations|outline\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"created":"2006-10-02T14:41:32.000+0000","updated":"2006-10-02T14:41:32.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12352146/comment/12439460","id":"12439460","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"The problem was being caused by some of the tests that kept a reference to a connection object which prevented this objects from being garbage collected. The attached patch (derby-1910.diff) fixes that problem.\r\n\r\nI monitored the memory usage of the junit.textui.TestRunner JVM by using the jstat with and without this patch. Without the patch the memory usage kept increasing, and with the patch the JVM was able to garbage collect and the memory usage stayed under 17000Kb. I have successfully run jdbcapi, derbynetmats and derbynetclientmats with this patch. Can someone please review it?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-10-03T11:48:29.000+0000","updated":"2006-10-03T11:48:29.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12352146/comment/12439467","id":"12439467","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dyret","name":"dyret","emailAddress":"Dyre dot Tjeldvoll at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dyre Tjeldvoll","active":true},"body":"Patch looks good. \r\n\r\n+1 to commit","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dyret","name":"dyret","emailAddress":"Dyre dot Tjeldvoll at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dyre Tjeldvoll","active":true},"created":"2006-10-03T12:04:22.000+0000","updated":"2006-10-03T12:04:22.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12352146/comment/12439795","id":"12439795","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks, Fernanda. Committed revision 452832.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-10-04T11:09:23.000+0000","updated":"2006-10-04T11:09:23.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12352146/comment/12440845","id":"12440845","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Merged the fix into the 10.2 branch (revision 454325).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-10-09T10:05:20.000+0000","updated":"2006-10-09T10:05:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12352146/comment/12551426","id":"12551426","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"This issue has been resolved for over a year with no further movement. Closing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2007-12-13T09:05:15.384+0000","updated":"2007-12-13T09:05:15.384+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1910/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0741j:"}}