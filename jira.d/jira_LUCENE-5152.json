{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12660667","self":"https://issues.apache.org/jira/rest/api/latest/issue/12660667","key":"LUCENE-5152","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310110","id":"12310110","key":"LUCENE","name":"Lucene - Core","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310110&avatarId=10061","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310110&avatarId=10061","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310110&avatarId=10061","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310110&avatarId=10061"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324742","id":"12324742","description":"Major release after 4.4","name":"4.5","archived":false,"released":true,"releaseDate":"2013-10-05"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321663","id":"12321663","description":"Current trunk","name":"Trunk","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-07-30 14:15:49.358","customfield_12312323":null,"customfield_12310420":"340857","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_3801104404_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-09-12T13:55:45.379+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LUCENE-5152/watchers","watchCount":8,"isWatching":false},"created":"2013-07-30T14:04:00.994+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.png","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324323","id":"12324323","description":"Major release after 4.3","name":"4.4","archived":false,"released":true,"releaseDate":"2013-07-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-10-05T10:18:47.152+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12314362","id":"12314362","name":"core/FSTs","description":"Finite state transducer implementation (lives in org/apache/lucene/util/automaton/fst/*)."}],"timeoriginalestimate":null,"description":"a spinnoff from LUCENE-5120 where the analyzing suggester modified a returned output from and FST (BytesRef) which caused sideffects in later execution. \r\n\r\nI added an assertion into the FST that checks if a cached root arc is modified and in-fact this happens for instance in our MemoryPostingsFormat and I bet we find more places. We need to think about how to make this less trappy since it can cause bugs that are super hard to find.","customfield_10010":null,"timetracking":{},"customfield_12310120":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10121","value":"New","id":"10121"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10120","value":"Patch Available","id":"10120"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"341175","summary":"Lucene FST is not immutable","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":26,"total":26,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13723880","id":"13723880","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"here is a patch with the assert and a nocommit in MemoryPostingsFormat","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-07-30T14:05:04.907+0000","updated":"2013-07-30T14:05:04.907+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13723890","id":"13723890","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"So its really just a BytesRef bug right? Because root arcs cache uses copyFrom, but this does a shallow copy of the output/nextFinalOutput, and in this case they are pointing to the same bytes (which gives someone the chance to muck with them).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2013-07-30T14:15:49.358+0000","updated":"2013-07-30T14:15:49.358+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13723922","id":"13723922","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"body":"bq. So its really just a BytesRef bug right? \r\n+1, so tricky","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"created":"2013-07-30T14:48:20.814+0000","updated":"2013-07-30T14:48:20.814+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13724280","id":"13724280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"bq. So its really just a BytesRef bug right? \r\nwell in theory that is true. Yet, if you have an arc in your hand you can basically change it by passing it to a subsequent call to readNextTargetArc or whatever that would override the values completely. BytesRef is tricky but not the root cause of this issue. I do think that if you call:\r\n\r\n{noformat} \r\npublic Arc<T> findTargetArc(int labelToMatch, Arc<T> follow, Arc<T> arc, BytesReader in) throws IOException\r\n{noformat}\r\n\r\nit should always fill the arc that is provided so everything you do with it is up to you. Aside of this I agree BytesRef is tricky and we should fix if possible.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-07-30T19:12:08.997+0000","updated":"2013-07-30T19:12:08.997+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13726401","id":"13726401","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"here is a patch that adds a #deepCopy method to Outputs that allows me to do a deep copy if the actual arc that is returned is a cached root arc. I think we should never return a pointer into the root arcs though. this is way to dangerous! I haven't run any perf tests will do once I am on my worksstation again.. if somebody beats me go ahead!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-08-01T12:51:53.651+0000","updated":"2013-08-01T12:51:53.651+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13726429","id":"13726429","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jkrupan","name":"jkrupan","emailAddress":"jack dot krupansky at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jkrupan&avatarId=22774","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jkrupan&avatarId=22774","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jkrupan&avatarId=22774","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jkrupan&avatarId=22774"},"displayName":"Jack Krupansky","active":true},"body":"bq. immutale\r\n\r\nIs that the Latin term for \"immutable\"??\r\n\r\n(spelling in summary line)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jkrupan","name":"jkrupan","emailAddress":"jack dot krupansky at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jkrupan&avatarId=22774","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jkrupan&avatarId=22774","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jkrupan&avatarId=22774","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jkrupan&avatarId=22774"},"displayName":"Jack Krupansky","active":true},"created":"2013-08-01T13:45:31.279+0000","updated":"2013-08-01T13:45:31.279+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13726569","id":"13726569","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"I guess one question would be if its FSTs job to defend against bytesref bugs.\r\n\r\nThis issue was driven because there was a bytesref bug for suggester payloads.\r\nThe same kind of bug could happen, e.g. if someone uses DirectPostings and modifies the payload coming back from the postings lists.\r\n\r\nShould we clone payload bytes in the postings lists too? what about term dictionaries?\r\n\r\nAt some point then BytesRef is useless as a reference class because of a few bad apples trying to use it as a ByteBuffer.\r\nIdeally we would remove code that abuses BytesRef as a ByteBuffer instead. \r\n\r\nI don't mean to pick on your issue Simon, and it doesnt mean I object to the patch (though I wonder about performance implications), I just see this as one of many in a larger issue.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2013-08-01T16:22:09.572+0000","updated":"2013-08-01T16:22:09.572+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13726847","id":"13726847","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"bq. Should we clone payload bytes in the postings lists too? what about term dictionaries?\r\nI agree we can be less conservative here and just use the payload and copy it into a new BytesRef or whatever is needed. I will bring up a new patch.\r\n\r\nbq. At some point then BytesRef is useless as a reference class because of a few bad apples trying to use it as a ByteBuffer. Ideally we would remove code that abuses BytesRef as a ByteBuffer instead.\r\n\r\nagreed again. We just need to make sure that we have asserts in place that check for that. \r\n\r\nbq. I don't mean to pick on your issue Simon, and it doesnt mean I object to the patch (though I wonder about performance implications), I just see this as one of many in a larger issue.\r\n\r\nno worries. I am really concerned about this since it took me forever to figure out the problems this caused. I just wanna have an infra in place that catches those problems. I am more concerned about users that get bitten by this. I agree we should figure out the bigger problem eventually but lets make sure that we fix the bad apples first","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-08-01T20:32:30.843+0000","updated":"2013-08-01T20:32:30.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13726928","id":"13726928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"this patch only adds the assert and fixes the problems in MemoryPostings. This could solve the immediate issue and adds some more asserts to make sure we realise if something modifies the arcs outputs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-08-01T21:35:14.471+0000","updated":"2013-08-01T21:35:14.471+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13727927","id":"13727927","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsmiley","name":"dsmiley","emailAddress":"dsmiley at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dsmiley&avatarId=10110","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dsmiley&avatarId=10110","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dsmiley&avatarId=10110","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dsmiley&avatarId=10110"},"displayName":"David Smiley","active":true},"body":"I've been bitten by bugs in my code related to sharing BytesRefs.  It's not clear in the APIs who \"owns\" a BytesRef received from a method call.  In other words, can a recipient know wether it can safely cache it for use later or wether it's not safe because it could change suddenly later.  It's not even just that since there are two levels of ownership, the BytesRef instance and then the underlying char array.  This could be partially addressed with more documentation; I did that in my own code but that didn't stop another bug.  \r\n\r\nI have a rough idea in which a BytesRef has a boolean flag or two to indicate how share-able it is, and then a conditional clone method that either returns the current instance or returns shallow copy, or does a deep copy depending on those flags.  I dunno, just a half-baked idea.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsmiley","name":"dsmiley","emailAddress":"dsmiley at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dsmiley&avatarId=10110","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dsmiley&avatarId=10110","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dsmiley&avatarId=10110","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dsmiley&avatarId=10110"},"displayName":"David Smiley","active":true},"created":"2013-08-02T18:28:35.049+0000","updated":"2013-08-02T18:28:35.049+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13727956","id":"13727956","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1509805 from [~simonw] in branch 'dev/trunk'\r\n[ https://svn.apache.org/r1509805 ]\r\n\r\nLUCENE-5152: Fix MemoryPostingsFormat to not modify borrowed BytesRef from FSTEnum","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-02T18:54:26.309+0000","updated":"2013-08-02T18:54:26.309+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13727958","id":"13727958","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"I committed the latest patch to get the assert in and fix memory postings format. I will keep this issue open for further discussions","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-08-02T18:56:49.878+0000","updated":"2013-08-02T18:56:49.878+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13727963","id":"13727963","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1509812 from [~simonw] in branch 'dev/branches/branch_4x'\r\n[ https://svn.apache.org/r1509812 ]\r\n\r\nLUCENE-5152: Fix MemoryPostingsFormat to not modify borrowed BytesRef from FSTEnum","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-02T19:01:33.155+0000","updated":"2013-08-02T19:01:33.155+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13727986","id":"13727986","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"I know we make no claims about performance when assertions are enabled...\r\n\r\nBut it seems like this commit could substantially slow things down, since we call assertRootArcs, which is O(N) where N = number of root arcs, for every call to findTargetArc = likely called in hotspots.\r\n\r\nMaybe, we could move the call to e.g. FST.getBytesReader?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2013-08-02T19:27:34.159+0000","updated":"2013-08-02T19:27:34.159+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13727993","id":"13727993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"how is getBytesReader related to the root arcs? unless this slows things down when assertions are not enabled I'd vote for not moving it. This is a very trappy thing and we should catch any violation IMO very quickly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-08-02T19:36:05.435+0000","updated":"2013-08-02T19:36:05.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13728317","id":"13728317","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"bq. how is getBytesReader related to the root arcs?\r\n\r\nWell, anything that works with the FST APIs needs to call\r\ngetBytesReader first, e.g. MemoryPF does this every time you pull a\r\nTermsEnum from it.\r\n\r\nbq. This is a very trappy thing and we should catch any violation IMO very quickly.\r\n\r\nI agree it's trappy and it's great to add this check.\r\n\r\nI'm simply proposing moving it to less of a hot-spot, and I don't\r\nthink this will affect how quickly we catch violations but should\r\nreduce the cost of this added assertion.\r\n\r\nIn fact, I think findTargetArc isn't great in this regard; e.g. I\r\nthink MemoryPF only uses this API if the caller calls seekExact?  So I\r\nthink the current location of the assert is both more costly and lower\r\ncoverage than if we moved it to FST.getBytesReader.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2013-08-03T00:31:29.611+0000","updated":"2013-08-03T00:31:29.611+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13732088","id":"13732088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"{quote}In fact, I think findTargetArc isn't great in this regard; e.g. I\r\nthink MemoryPF only uses this API if the caller calls seekExact? So I\r\nthink the current location of the assert is both more costly and lower\r\ncoverage than if we moved it to FST.getBytesReader.{quote}\r\n\r\nI am not sure if that is true actually since findTargetArc is the only place where we actually use this cache? I mean I don't wanna be in the way of moving it but what kind of message are we sending here. We don't guarantee that asserts are fast but they won't slow you down massively? I mean we can call this assert in the getBytesReader as well to increase coverage, can you elaborate what you are concerned about?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-08-07T15:11:16.471+0000","updated":"2013-08-07T15:11:16.471+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13733454","id":"13733454","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"bq. can you elaborate what you are concerned about?\r\n\r\nI'm worried about the O(N^2) cost of the assert: for every arc (single\r\nbyte of each term in a seekExact) we are iterating over all root arcs\r\n(up to 256 arcs) in this assert.\r\n\r\nbq. findTargetArc is the only place where we actually use this cache?\r\n\r\nAhh that's true, I hadn't realized that.\r\n\r\nMaybe, instead, we can move the assert just inside the if that\r\nactually uses the cached arcs?  Ie, put it here:\r\n\r\n{code}\r\n  if (follow.target == startNode && labelToMatch < cachedRootArcs.length) {\r\n    assert assertRootArcs();\r\n    ...\r\n  }\r\n{code}\r\n\r\nThis would address my concern: the cost becomes O(N) not O(N^2).  And\r\nthe coverage is the same?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2013-08-08T12:41:11.593+0000","updated":"2013-08-08T12:41:11.593+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13733474","id":"13733474","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"bq. This would address my concern: the cost becomes O(N) not O(N^2). And the coverage is the same?\r\n\r\nThe problem here is that we really need to check after we returned from the cache and that might be the case only once in a certain test. Yet, I think it's OK to do it there. I still don't get what you are concerned of we only have -ea in tests and the tests don't seem to be any slower? Can you elaborate what you are afraid of?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-08-08T13:18:35.762+0000","updated":"2013-08-08T13:18:35.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13733598","id":"13733598","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"bq. Can you elaborate what you are afraid of?\r\n\r\nIn general I think it's bad if an assert changes too much how the code\r\nwould run without asserts.  E.g., maybe this O(N^2) assert alters how\r\nthreads are scheduled and changes how / whether an issue appears in\r\npractice.\r\n\r\nSimilarly, if a user is having trouble, I'll recommend turning on\r\nasserts to see if one trips, but if this causes a change in how the\r\ncode runs then this can change whether the issue reproduces.\r\n\r\nI also just don't like O(N^2) code, even when it's under an assert :)\r\n\r\nI think asserts should minimize their impact to the real code when\r\npossible, and it certainly seems possible in this case.\r\n\r\nSeparately, we really should run our tests w/o asserts, too, since\r\nthis is how our users typically run (I know some tests fail if\r\nassertions are off ... we'd have to fix them).  What if we accidentally\r\ncommit \"real\" code behind an assert?  Our tests wouldn't catch it ...\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2013-08-08T15:27:53.926+0000","updated":"2013-08-08T15:27:53.926+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13736017","id":"13736017","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"This is what I have in mind ... just moving the assert inside the if that actually uses the cached root arcs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2013-08-10T20:11:32.406+0000","updated":"2013-08-10T20:11:32.406+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13739809","id":"13739809","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"I plan to commit that last patch soon...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2013-08-14T16:03:36.889+0000","updated":"2013-08-14T16:03:36.889+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13739912","id":"13739912","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"sorry for the late reply busy times... +1 to commit","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2013-08-14T17:32:38.157+0000","updated":"2013-08-14T17:32:38.157+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13741604","id":"13741604","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1514520 from [~mikemccand] in branch 'dev/trunk'\r\n[ https://svn.apache.org/r1514520 ]\r\n\r\nLUCENE-5152: make assert less costly","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-15T22:42:55.981+0000","updated":"2013-08-15T22:42:55.981+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13741609","id":"13741609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1514521 from [~mikemccand] in branch 'dev/branches/branch_4x'\r\n[ https://svn.apache.org/r1514521 ]\r\n\r\nLUCENE-5152: make assert less costly","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-15T22:45:59.931+0000","updated":"2013-08-15T22:45:59.931+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12660667/comment/13787022","id":"13787022","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpountz","name":"jpountz","emailAddress":"jpountz at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jpountz&avatarId=16520","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jpountz&avatarId=16520","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jpountz&avatarId=16520","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jpountz&avatarId=16520"},"displayName":"Adrien Grand","active":true},"body":"4.5 release -> bulk close","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpountz","name":"jpountz","emailAddress":"jpountz at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jpountz&avatarId=16520","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jpountz&avatarId=16520","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jpountz&avatarId=16520","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jpountz&avatarId=16520"},"displayName":"Adrien Grand","active":true},"created":"2013-10-05T10:18:47.148+0000","updated":"2013-10-05T10:18:47.148+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LUCENE-5152/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1msdj:"}}