{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12511021","self":"https://issues.apache.org/jira/rest/api/latest/issue/12511021","key":"DERBY-5289","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313478","id":"12313478","description":"Head of 10.1 branch. Maintenance version bump for sps update ","name":"10.1.3.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312251","id":"12312251","description":"Head of 10.2 branch","name":"10.2.2.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313143","id":"12313143","description":"Head of 10.3 branch","name":"10.3.3.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313401","id":"12313401","description":"Head of 10.4 branch","name":"10.4.2.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314182","id":"12314182","description":"Old head of 10.5 branch","name":"10.5.3.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315370","id":"12315370","description":"Old head of 10.6 branch","name":"10.6.2.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315902","id":"12315902","description":"Head of 10.7 branch as of 2010-11-29","name":"10.7.1.4","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12317968","id":"12317968","description":"second release on the 10.8 branch","name":"10.8.2.2","archived":false,"released":true,"releaseDate":"2011-10-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316344","id":"12316344","description":"First release on the 10.9 branch","name":"10.9.1.0","archived":false,"released":true,"releaseDate":"2012-06-25"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2011-06-21 18:35:32.293","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24760","customfield_12310222":"1_*:*_1_*:*_750433209_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-06-29T16:49:10.743+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-5289/watchers","watchCount":2,"isWatching":false},"created":"2011-06-21T00:21:57.576+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313142","id":"12313142","description":"","name":"10.3.3.0","archived":false,"released":true,"releaseDate":"2008-05-12"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313345","id":"12313345","description":"","name":"10.4.2.0","archived":false,"released":true,"releaseDate":"2008-09-05"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314117","id":"12314117","description":"Next release after 10.5.2.0 release candidate #1","name":"10.5.3.0","archived":false,"released":true,"releaseDate":"2009-08-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315343","id":"12315343","description":"Derby 10.6.2.1 Release","name":"10.6.2.1","archived":false,"released":true,"releaseDate":"2010-10-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315564","id":"12315564","description":"First release on the 10.7 branch.","name":"10.7.1.1","archived":false,"released":true,"releaseDate":"2010-12-14"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316362","id":"12316362","description":"First release on the 10.8 branch","name":"10.8.1.2","archived":false,"released":true,"releaseDate":"2011-04-29"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316344","id":"12316344","description":"First release on the 10.9 branch","name":"10.9.1.0","archived":false,"released":true,"releaseDate":"2012-06-25"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-06-17T09:19:43.669+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"I have been unable to get Derby 10.7.1.1 and 10.8.1.2 to boot the attached 10.5.1.1 database. Derby 10.6.1.0 is however able to use the DB.\r\n\r\nI'm not sure if this is a backwards compatibility bug or the result of corruption to the database. Running SYSCS_CHECK_TABLE and SYSCS_COMPRESS_TABLE under 10.6.1.0 found no problems with the database.\r\n\r\nNOTE: I have had to remove all data and non-essential tables/columns/triggers/etc prior to attaching this database.\r\n\r\nOutput when connecting to the DB using ij:\r\nERROR XJ040: Failed to start database 'C:\\Users\\BMASON\\Sandbox\\InternalDB' with class loader sun.misc.Launcher$AppClassLoader@11b86e7, see the next exception for details.\r\nERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\r\nFull exception from our application:\r\njava.sql.SQLException: Failed to start database 'C:\\Users\\BMASON\\Sandbox\\InternalDB' with class loader sun.misc.Launcher$AppClassLoader@93dee9, see the next exception for details.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.seeNextException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(Unknown Source)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.EmbeddedDataSource.getConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.EmbeddedDataSource.getConnection(Unknown Source)\r\n\tat com.ADInstruments.LTS.util.DerbyUtils.exists(DerbyUtils.java:86)\r\n\tat com.ADInstruments.LTS.InternalDB.InternalDbUtilities.cacheInternalDbVersion(InternalDbUtilities.java:117)\r\n\tat com.ADInstruments.LTCS.InternalDB.InternalDbStartup.initialiseDatabase(InternalDbStartup.java:23)\r\n\tat com.ADInstruments.LTCS.StartupTasks$StartupRunnable.initDatabases(StartupTasks.java:35)\r\n\tat com.ADInstruments.LTCS.StartupTasks$StartupRunnable.run(StartupTasks.java:52)\r\n\tat java.lang.Thread.run(Thread.java:662)\r\nCaused by: java.sql.SQLException: Failed to start database 'C:\\Users\\BMASON\\Sandbox\\InternalDB' with class loader sun.misc.Launcher$AppClassLoader@93dee9, see the next exception for details.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n\t... 17 more\r\nCaused by: java.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\r\n\t... 14 more\r\nCaused by: ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.restoreRecordFromSlot(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.data.BasePage.fetchFromSlot(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.conglomerate.GenericScanController.fetchRows(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.heap.HeapScan.fetchNext(Unknown Source)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaHeap(Unknown Source)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getAllSPSDescriptors(Unknown Source)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.dropJDBCMetadataSPSes(Unknown Source)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.updateMetadataSPSes(Unknown Source)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.handleMinorRevisionChange(Unknown Source)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.upgradeIfNeeded(Unknown Source)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.loadDictionaryTables(Unknown Source)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.boot(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(Unknown Source)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Unknown Source)\r\n\tat org.apache.derby.impl.db.BasicDatabase.boot(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootService(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(Unknown Source)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Unknown Source)\r\n\t... 14 more\r\nCaused by: java.io.EOFException\r\n\tat java.io.DataInputStream.readInt(DataInputStream.java:375)\r\n\tat org.apache.derby.iapi.sql.dictionary.TriggerDescriptor.readExternal(Unknown Source)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source)\r\n\tat org.apache.derby.iapi.services.io.ArrayUtil.readArrayItems(Unknown Source)\r\n\tat org.apache.derby.impl.sql.execute.TriggerInfo.readExternal(Unknown Source)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source)\r\n\tat org.apache.derby.impl.sql.execute.WriteCursorConstantAction.readExternal(Unknown Source)\r\n\tat org.apache.derby.impl.sql.execute.UpdateConstantAction.readExternal(Unknown Source)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source)\r\n\tat org.apache.derby.impl.sql.GenericStorablePreparedStatement.readExternal(Unknown Source)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(Unknown Source)\r\n\tat org.apache.derby.iapi.types.UserType.readExternal(Unknown Source)\r\n\t... 39 more","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10420","value":"Regression","id":"10420"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36249","summary":"Unable to boot 10.5.1.1 database - fails during soft/hard upgrade process for a new version number while trying to drop jdbc metadata","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10424","value":"Repro attached","id":"10424"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":">sysinfo\r\n------------------ Java Information ------------------\r\nJava Version:    1.6.0_26\r\nJava Vendor:     Sun Microsystems Inc.\r\nJava home:       C:\\Program Files (x86)\\Java\\jre6\r\nJava classpath:  .;C:\\Program Files (x86)\\Java\\jre6\\lib\\ext\\QTJava.zip;C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\bin\\../lib/derby.jar;C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\bin\\../lib/derbynet.jar;C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\bin\\../lib/derbyclient.jar;C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\bin\\../lib/derbytools.jar\r\nOS name:         Windows 7\r\nOS architecture: x86\r\nOS version:      6.1\r\nJava user name:  bmason\r\nJava user home:  C:\\Users\\BMASON\r\nJava user dir:   C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\bin\r\njava.specification.name: Java Platform API Specification\r\njava.specification.version: 1.6\r\njava.runtime.version: 1.6.0_26-b03\r\n--------- Derby Information --------\r\nJRE - JDBC: Java SE 6 - JDBC 4.0\r\n[C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\lib\\derby.jar] 10.8.1.2 - (1095077)\r\n[C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\lib\\derbytools.jar] 10.8.1.2 - (1095077)\r\n[C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\lib\\derbynet.jar] 10.8.1.2 - (1095077)\r\n[C:\\Users\\BMASON\\Sandbox\\libs\\db-derby-10.8.1.2-bin\\lib\\derbyclient.jar] 10.8.1.2 - (1095077)\r\n------------------------------------------------------\r\n----------------- Locale Information -----------------\r\nCurrent Locale :  [English/New Zealand [en_NZ]]\r\nFound support for locale: [cs]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [de_DE]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [es]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [fr]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [hu]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [it]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [ja_JP]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [ko_KR]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [pl]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [pt_BR]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [ru]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [zh_CN]\r\n         version: 10.8.1.2 - (1095077)\r\nFound support for locale: [zh_TW]\r\n         version: 10.8.1.2 - (1095077)\r\n------------------------------------------------------","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":31,"total":31,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052289","id":"13052289","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"body":"Trimmed down database which exhibits the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"created":"2011-06-21T00:24:50.750+0000","updated":"2011-06-21T00:24:50.750+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052291","id":"13052291","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"body":"The database can be booted with 10.8 if the trigger ADMIN_LIST_UPDATE_MARKERS is dropped.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"created":"2011-06-21T00:28:36.706+0000","updated":"2011-06-21T00:28:36.706+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052335","id":"13052335","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"body":"Just checked and 10.6.2.1 works as expected.\r\n\r\nLet me know if there is any more information I can provide.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"created":"2011-06-21T03:03:20.584+0000","updated":"2011-06-21T03:03:20.584+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052750","id":"13052750","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I tried the attached db with 10.7.1.1 release and ran into same problem as Brett. I tried it with 10.8 codeline(not the released 10.8.1.2) and the database upgraded fine. I will try it with 10.8.1.2 and with the current trunk codeline to see how it behaves there. It looks like the trigger definition for ADMIN_LIST_UPDATE_MARKERS is as follows\r\nUPDATE EXP_RUNS SET MARKER_USERCODE = LOWER(NEW.USER_CODE) WHERE MARKER_USERCODE = LOWER(OLD.USER_CODE)\r\n\r\nBrett, I wondered if you could post a simple repro to create the database which shows the problem, It can be an ij script or java program, whichever is easy for you. In the mean time, I will investigate the db attached by you. Thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-21T18:35:32.293+0000","updated":"2011-06-21T21:13:11.305+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052821","id":"13052821","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"mamta, did you try a sane server on the 10.7 codeline?  Could you post a complete stack from derby.log as the posted stack is incomplete.\r\n\r\nFrom the stack it looks like this is a hard upgrade issue.  Is soft upgrade a problem?\r\n\r\nIs it correct that on upgrade we are reading anything out of the system catlogs for the triggers?  With full stack it probably will be clearer where\r\nthe problem is.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-06-21T20:55:00.770+0000","updated":"2011-06-21T20:55:00.770+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052873","id":"13052873","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Mike write \"From the stack it looks like this is a hard upgrade issue. Is soft upgrade a problem? \"\r\n\r\nYes, the stack trace appears to be for hard upgrade. I tried the soft upgrade on the attached db to 10.7.1.1 and saw the same problem.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-21T21:59:59.433+0000","updated":"2011-06-21T21:59:59.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052876","id":"13052876","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I am attaching derby.log with complete stack trace and also copying it here (it is rather long)\r\njava.sql.SQLException: Failed to start database 'InternalDB' with class loader sun.misc.Launcher$AppClassLoader@5ca65ca6, see the next exception for details.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:95)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:278)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2725)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:384)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:68)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:238)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:119)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:322)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:297)\r\n\tat org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:1503)\r\n\tat org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:1333)\r\n\tat org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1118)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:341)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)\r\n\tat org.apache.derby.impl.tools.ij.Main.go(Main.java:229)\r\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)\r\n\tat org.apache.derby.impl.tools.ij.Main.main(Main.java:75)\r\n\tat org.apache.derby.tools.ij.main(ij.java:59)\r\nCaused by: java.sql.SQLException: Failed to start database 'InternalDB' with class loader sun.misc.Launcher$AppClassLoader@5ca65ca6, see the next exception for details.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:119)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)\r\n\t... 18 more\r\nCaused by: java.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:119)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:256)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2719)\r\n\t... 15 more\r\nCaused by: ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:296)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5753)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.restoreRecordFromSlot(StoredPage.java:1495)\r\n\tat org.apache.derby.impl.store.raw.data.BasePage.fetchFromSlot(BasePage.java:438)\r\n\tat org.apache.derby.impl.store.access.conglomerate.GenericScanController.fetchRows(GenericScanController.java:759)\r\n\tat org.apache.derby.impl.store.access.heap.HeapScan.fetchNext(HeapScan.java:238)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaHeap(DataDictionaryImpl.java:8832)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getAllSPSDescriptors(DataDictionaryImpl.java:4522)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.dropJDBCMetadataSPSes(DataDictionaryImpl.java:12836)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.updateMetadataSPSes(DataDictionaryImpl.java:12860)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.handleMinorRevisionChange(DD_Version.java:520)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.upgradeIfNeeded(DD_Version.java:244)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.loadDictionaryTables(DataDictionaryImpl.java:7124)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.boot(DataDictionaryImpl.java:774)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:531)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)\r\n\tat org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:211)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1816)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1682)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1560)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:979)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:550)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2686)\r\n\t... 15 more\r\nCaused by: java.io.EOFException\r\n\tat java.io.DataInputStream.readInt(DataInputStream.java:386)\r\n\tat org.apache.derby.iapi.sql.dictionary.TriggerDescriptor.readExternal(TriggerDescriptor.java:813)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.services.io.ArrayUtil.readArrayItems(ArrayUtil.java:115)\r\n\tat org.apache.derby.impl.sql.execute.TriggerInfo.readExternal(TriggerInfo.java:235)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.execute.WriteCursorConstantAction.readExternal(WriteCursorConstantAction.java:244)\r\n\tat org.apache.derby.impl.sql.execute.UpdateConstantAction.readExternal(UpdateConstantAction.java:171)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.GenericStorablePreparedStatement.readExternal(GenericStorablePreparedStatement.java:226)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.types.UserType.readExternal(UserType.java:305)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5639)\r\n\t... 40 more\r\n============= begin nested exception, level (1) ===========\r\njava.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:95)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:256)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2719)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:384)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:68)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:238)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:119)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:322)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:297)\r\n\tat org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:1503)\r\n\tat org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:1333)\r\n\tat org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1118)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:341)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)\r\n\tat org.apache.derby.impl.tools.ij.Main.go(Main.java:229)\r\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)\r\n\tat org.apache.derby.impl.tools.ij.Main.main(Main.java:75)\r\n\tat org.apache.derby.tools.ij.main(ij.java:59)\r\nCaused by: java.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:119)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)\r\n\t... 17 more\r\nCaused by: ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:296)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5753)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.restoreRecordFromSlot(StoredPage.java:1495)\r\n\tat org.apache.derby.impl.store.raw.data.BasePage.fetchFromSlot(BasePage.java:438)\r\n\tat org.apache.derby.impl.store.access.conglomerate.GenericScanController.fetchRows(GenericScanController.java:759)\r\n\tat org.apache.derby.impl.store.access.heap.HeapScan.fetchNext(HeapScan.java:238)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaHeap(DataDictionaryImpl.java:8832)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getAllSPSDescriptors(DataDictionaryImpl.java:4522)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.dropJDBCMetadataSPSes(DataDictionaryImpl.java:12836)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.updateMetadataSPSes(DataDictionaryImpl.java:12860)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.handleMinorRevisionChange(DD_Version.java:520)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.upgradeIfNeeded(DD_Version.java:244)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.loadDictionaryTables(DataDictionaryImpl.java:7124)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.boot(DataDictionaryImpl.java:774)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:531)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)\r\n\tat org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:211)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1816)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1682)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1560)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:979)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:550)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2686)\r\n\t... 15 more\r\nCaused by: java.io.EOFException\r\n\tat java.io.DataInputStream.readInt(DataInputStream.java:386)\r\n\tat org.apache.derby.iapi.sql.dictionary.TriggerDescriptor.readExternal(TriggerDescriptor.java:813)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.services.io.ArrayUtil.readArrayItems(ArrayUtil.java:115)\r\n\tat org.apache.derby.impl.sql.execute.TriggerInfo.readExternal(TriggerInfo.java:235)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.execute.WriteCursorConstantAction.readExternal(WriteCursorConstantAction.java:244)\r\n\tat org.apache.derby.impl.sql.execute.UpdateConstantAction.readExternal(UpdateConstantAction.java:171)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.GenericStorablePreparedStatement.readExternal(GenericStorablePreparedStatement.java:226)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.types.UserType.readExternal(UserType.java:305)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5639)\r\n\t... 40 more\r\n============= end nested exception, level (1) ===========\r\n============= begin nested exception, level (2) ===========\r\njava.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:119)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:256)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2719)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:384)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:68)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:238)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:119)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:322)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:297)\r\n\tat org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:1503)\r\n\tat org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:1333)\r\n\tat org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1118)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:341)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)\r\n\tat org.apache.derby.impl.tools.ij.Main.go(Main.java:229)\r\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)\r\n\tat org.apache.derby.impl.tools.ij.Main.main(Main.java:75)\r\n\tat org.apache.derby.tools.ij.main(ij.java:59)\r\nCaused by: ERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:296)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5753)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.restoreRecordFromSlot(StoredPage.java:1495)\r\n\tat org.apache.derby.impl.store.raw.data.BasePage.fetchFromSlot(BasePage.java:438)\r\n\tat org.apache.derby.impl.store.access.conglomerate.GenericScanController.fetchRows(GenericScanController.java:759)\r\n\tat org.apache.derby.impl.store.access.heap.HeapScan.fetchNext(HeapScan.java:238)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaHeap(DataDictionaryImpl.java:8832)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getAllSPSDescriptors(DataDictionaryImpl.java:4522)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.dropJDBCMetadataSPSes(DataDictionaryImpl.java:12836)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.updateMetadataSPSes(DataDictionaryImpl.java:12860)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.handleMinorRevisionChange(DD_Version.java:520)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.upgradeIfNeeded(DD_Version.java:244)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.loadDictionaryTables(DataDictionaryImpl.java:7124)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.boot(DataDictionaryImpl.java:774)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:531)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)\r\n\tat org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:211)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1816)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1682)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1560)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:979)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:550)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2686)\r\n\t... 15 more\r\nCaused by: java.io.EOFException\r\n\tat java.io.DataInputStream.readInt(DataInputStream.java:386)\r\n\tat org.apache.derby.iapi.sql.dictionary.TriggerDescriptor.readExternal(TriggerDescriptor.java:813)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.services.io.ArrayUtil.readArrayItems(ArrayUtil.java:115)\r\n\tat org.apache.derby.impl.sql.execute.TriggerInfo.readExternal(TriggerInfo.java:235)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.execute.WriteCursorConstantAction.readExternal(WriteCursorConstantAction.java:244)\r\n\tat org.apache.derby.impl.sql.execute.UpdateConstantAction.readExternal(UpdateConstantAction.java:171)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.GenericStorablePreparedStatement.readExternal(GenericStorablePreparedStatement.java:226)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.types.UserType.readExternal(UserType.java:305)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5639)\r\n\t... 40 more\r\n============= end nested exception, level (2) ===========\r\n============= begin nested exception, level (3) ===========\r\nERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:296)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5753)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.restoreRecordFromSlot(StoredPage.java:1495)\r\n\tat org.apache.derby.impl.store.raw.data.BasePage.fetchFromSlot(BasePage.java:438)\r\n\tat org.apache.derby.impl.store.access.conglomerate.GenericScanController.fetchRows(GenericScanController.java:759)\r\n\tat org.apache.derby.impl.store.access.heap.HeapScan.fetchNext(HeapScan.java:238)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaHeap(DataDictionaryImpl.java:8832)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getAllSPSDescriptors(DataDictionaryImpl.java:4522)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.dropJDBCMetadataSPSes(DataDictionaryImpl.java:12836)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.updateMetadataSPSes(DataDictionaryImpl.java:12860)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.handleMinorRevisionChange(DD_Version.java:520)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.upgradeIfNeeded(DD_Version.java:244)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.loadDictionaryTables(DataDictionaryImpl.java:7124)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.boot(DataDictionaryImpl.java:774)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:531)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)\r\n\tat org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:211)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1816)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1682)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1560)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:979)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:550)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2686)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:384)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:68)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:238)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:119)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:322)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:297)\r\n\tat org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:1503)\r\n\tat org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:1333)\r\n\tat org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1118)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:341)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)\r\n\tat org.apache.derby.impl.tools.ij.Main.go(Main.java:229)\r\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)\r\n\tat org.apache.derby.impl.tools.ij.Main.main(Main.java:75)\r\n\tat org.apache.derby.tools.ij.main(ij.java:59)\r\nCaused by: java.io.EOFException\r\n\tat java.io.DataInputStream.readInt(DataInputStream.java:386)\r\n\tat org.apache.derby.iapi.sql.dictionary.TriggerDescriptor.readExternal(TriggerDescriptor.java:813)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.services.io.ArrayUtil.readArrayItems(ArrayUtil.java:115)\r\n\tat org.apache.derby.impl.sql.execute.TriggerInfo.readExternal(TriggerInfo.java:235)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.execute.WriteCursorConstantAction.readExternal(WriteCursorConstantAction.java:244)\r\n\tat org.apache.derby.impl.sql.execute.UpdateConstantAction.readExternal(UpdateConstantAction.java:171)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.GenericStorablePreparedStatement.readExternal(GenericStorablePreparedStatement.java:226)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.types.UserType.readExternal(UserType.java:305)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5639)\r\n\t... 40 more\r\n============= end nested exception, level (3) ===========\r\n============= begin nested exception, level (4) ===========\r\njava.io.EOFException\r\n\tat java.io.DataInputStream.readInt(DataInputStream.java:386)\r\n\tat org.apache.derby.iapi.sql.dictionary.TriggerDescriptor.readExternal(TriggerDescriptor.java:813)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.services.io.ArrayUtil.readArrayItems(ArrayUtil.java:115)\r\n\tat org.apache.derby.impl.sql.execute.TriggerInfo.readExternal(TriggerInfo.java:235)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.execute.WriteCursorConstantAction.readExternal(WriteCursorConstantAction.java:244)\r\n\tat org.apache.derby.impl.sql.execute.UpdateConstantAction.readExternal(UpdateConstantAction.java:171)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.impl.sql.GenericStorablePreparedStatement.readExternal(GenericStorablePreparedStatement.java:226)\r\n\tat org.apache.derby.iapi.services.io.FormatIdInputStream.readObject(FormatIdInputStream.java:125)\r\n\tat org.apache.derby.iapi.types.UserType.readExternal(UserType.java:305)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(StoredPage.java:5639)\r\n\tat org.apache.derby.impl.store.raw.data.StoredPage.restoreRecordFromSlot(StoredPage.java:1495)\r\n\tat org.apache.derby.impl.store.raw.data.BasePage.fetchFromSlot(BasePage.java:438)\r\n\tat org.apache.derby.impl.store.access.conglomerate.GenericScanController.fetchRows(GenericScanController.java:759)\r\n\tat org.apache.derby.impl.store.access.heap.HeapScan.fetchNext(HeapScan.java:238)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaHeap(DataDictionaryImpl.java:8832)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getAllSPSDescriptors(DataDictionaryImpl.java:4522)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.dropJDBCMetadataSPSes(DataDictionaryImpl.java:12836)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.updateMetadataSPSes(DataDictionaryImpl.java:12860)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.handleMinorRevisionChange(DD_Version.java:520)\r\n\tat org.apache.derby.impl.sql.catalog.DD_Version.upgradeIfNeeded(DD_Version.java:244)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.loadDictionaryTables(DataDictionaryImpl.java:7124)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.boot(DataDictionaryImpl.java:774)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:531)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)\r\n\tat org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:211)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1979)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:333)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1816)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1682)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1560)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:979)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:550)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2686)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:384)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:68)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:238)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:119)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:322)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:297)\r\n\tat org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:1503)\r\n\tat org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:1333)\r\n\tat org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1118)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:341)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)\r\n\tat org.apache.derby.impl.tools.ij.Main.go(Main.java:229)\r\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)\r\n\tat org.apache.derby.impl.tools.ij.Main.main(Main.java:75)\r\n\tat org.apache.derby.tools.ij.main(ij.java:59)\r\n============= end nested exception, level (4) ===========\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-21T22:02:23.930+0000","updated":"2011-06-21T22:02:23.930+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052889","id":"13052889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"body":"Thanks for taking a look so quickly. I haven't been able to reproduce the issue with a fresh DB so far but I will keep trying. I will also try upgrading a range of other databases we have available to see if any others exhibit the problem.\r\n\r\nThe attached database was a development database I used for load testing so it would have had quite a bit of use, particularly the EXP_RUNS table.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"created":"2011-06-21T22:18:36.596+0000","updated":"2011-06-21T22:18:36.596+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052909","id":"13052909","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I tried dblook on the attached db and got following\r\n$ java org.apache.derby.tools.dblook -d 'jdbc:derby:InternalDB'\r\n-- Timestamp: 2011-06-21 13:26:02.351\r\n-- Source database is: InternalDB\r\n-- Connection URL is: jdbc:derby:InternalDB\r\n-- appendLogs: false\r\n\r\n-- ----------------------------------------------\r\n-- DDL Statements for schemas\r\n-- ----------------------------------------------\r\n\r\nCREATE SCHEMA \"SYNC\";\r\n\r\n-- ----------------------------------------------\r\n-- DDL Statements for functions\r\n-- ----------------------------------------------\r\n\r\nCREATE FUNCTION \"SYNC\".\"XML_ENCODE\" (\"ELEM_NAME\" VARCHAR(100),\"STR\" VARCHAR(32672)) RETURNS VARCHAR(32672) LANGUAGE JAVA PARAMETER STYLE JAVA NO SQL CALLED ON NULL INPUT EXTERNAL NAME 'com.ADInstruments.LTS.InternalDB.dbSync.record.UtilityProcedures.xmlEncode' ;\r\n\r\nCREATE FUNCTION \"SYNC\".\"XML_ENCODE_CHAR\" (\"ELEM_NAME\" VARCHAR(100),\"VAL\" CHAR(1)) RETURNS VARCHAR(32672) LANGUAGE JAVA PARAMETER STYLE JAVA NO SQL CALLED ON NULL INPUT EXTERNAL NAME 'com.ADInstruments.LTS.InternalDB.dbSync.record.UtilityProcedures.xmlEncode' ;\r\n\r\nCREATE FUNCTION \"SYNC\".\"XML_ENCODE_INT\" (\"ELEM_NAME\" VARCHAR(100),\"VAL\" INTEGER) RETURNS VARCHAR(32672) LANGUAGE JAVA PARAMETER STYLE JAVA NO SQL CALLED ON NULL INPUT EXTERNAL NAME 'com.ADInstruments.LTS.InternalDB.dbSync.record.UtilityProcedures.xmlEncode' ;\r\n\r\nCREATE FUNCTION \"SYNC\".\"XML_ENCODE_BIGINT\" (\"ELEM_NAME\" VARCHAR(100),\"VAL\" BIGINT) RETURNS VARCHAR(32672) LANGUAGE JAVA PARAMETER STYLE JAVA NO SQL CALLED ON NULL INPUT EXTERNAL NAME 'com.ADInstruments.LTS.InternalDB.dbSync.record.UtilityProcedures.xmlEncode' ;\r\n\r\nCREATE FUNCTION \"SYNC\".\"XML_ENCODE_DOUBLE\" (\"ELEM_NAME\" VARCHAR(100),\"VAL\" DOUBLE) RETURNS VARCHAR(32672) LANGUAGE JAVA PARAMETER STYLE JAVA NO SQL CALLED ON NULL INPUT EXTERNAL NAME 'com.ADInstruments.LTS.InternalDB.dbSync.record.UtilityProcedures.xmlEncode' ;\r\n\r\nCREATE FUNCTION \"SYNC\".\"XML_ENCODE_TIMESTAMP\" (\"ELEM_NAME\" VARCHAR(100),\"VAL\" TIMESTAMP) RETURNS VARCHAR(32672) LANGUAGE JAVA PARAMETER STYLE JAVA NO SQL CALLED ON NULL INPUT EXTERNAL NAME 'com.ADInstruments.LTS.InternalDB.dbSync.record.UtilityProcedures.xmlEncode' ;\r\n\r\nCREATE FUNCTION \"SYNC\".\"RANDOM_UUID\" () RETURNS VARCHAR(100) LANGUAGE JAVA PARAMETER STYLE JAVA NO SQL RETURNS NULL ON NULL INPUT EXTERNAL NAME 'com.ADInstruments.LTS.InternalDB.dbSync.record.UtilityProcedures.randomUUID' ;\r\n\r\n-- ----------------------------------------------\r\n-- DDL Statements for tables\r\n-- ----------------------------------------------\r\n\r\nCREATE TABLE \"APP\".\"ADMIN_LIST\" (\"ADMIN_ID\" INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1), \"USER_CODE\" VARCHAR(255) NOT NULL);\r\n\r\nCREATE TABLE \"APP\".\"EXP_RUNS\" (\"RUN_ID\" INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1), \"MARKER_USERCODE\" VARCHAR(255));\r\n\r\n-- ----------------------------------------------\r\n-- DDL Statements for keys\r\n-- ----------------------------------------------\r\n\r\n-- primary/unique\r\nALTER TABLE \"APP\".\"EXP_RUNS\" ADD CONSTRAINT \"RUN_PK\" PRIMARY KEY (\"RUN_ID\");\r\n\r\nALTER TABLE \"APP\".\"ADMIN_LIST\" ADD CONSTRAINT \"ADMIN_LIST_USER_CODE_UC\" UNIQUE (\"USER_CODE\");\r\n\r\nALTER TABLE \"APP\".\"ADMIN_LIST\" ADD CONSTRAINT \"ADMIN_PK\" PRIMARY KEY (\"ADMIN_ID\");\r\n\r\n-- ----------------------------------------------\r\n-- DDL Statements for triggers\r\n-- ----------------------------------------------\r\n\r\nCREATE TRIGGER \"APP\".\"ADMIN_LIST_UPDATE_MARKERS\" AFTER UPDATE ON \"APP\".\"ADMIN_LIST\" REFERENCING OLD AS OLD NEW AS NEW FOR EACH ROW UPDATE EXP_RUNS SET MARKER_USERCODE = LOWER(NEW.USER_CODE) WHERE MARKER_USERCODE = LOWER(OLD.USER_CODE);\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-21T22:36:50.131+0000","updated":"2011-06-21T22:36:50.131+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052913","id":"13052913","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"From the above output from dblook, I took out the trigger related stuff as follows to see if I could reproduce the problem and I couldn't. Following is what I tried to repro the bug. I created a db in 10.5 codeline and took the db to 10.7.1.1 codeline and did upgrade on it and it didn't fail. I do not have any data in the tables. I will try to insert some data and make the trigger fire and see if that makes the problem show up\r\n\r\njava -Dij.exceptionTrace=true org.apache.derby.tools.ij\r\nconnect 'jdbc:derby:DB105;create=true';\r\nCREATE TABLE \"APP\".\"ADMIN_LIST\" (\"ADMIN_ID\" INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1), \r\n\t\"USER_CODE\" VARCHAR(255) NOT NULL);\r\n\r\nCREATE TABLE \"APP\".\"EXP_RUNS\" (\"RUN_ID\" INTEGER NOT NULL GENERATED BY DEFAULT AS\r\n IDENTITY (START WITH 1, INCREMENT BY 1), \"MARKER_USERCODE\" VARCHAR(255));\r\n\r\n-- ----------------------------------------------\r\n-- DDL Statements for keys\r\n-- ----------------------------------------------\r\n\r\n-- primary/unique\r\nALTER TABLE \"APP\".\"EXP_RUNS\" ADD CONSTRAINT \"RUN_PK\" PRIMARY KEY (\"RUN_ID\");\r\n\r\nALTER TABLE \"APP\".\"ADMIN_LIST\" ADD CONSTRAINT \"ADMIN_LIST_USER_CODE_UC\" UNIQUE (\"USER_CODE\");\r\n\r\nALTER TABLE \"APP\".\"ADMIN_LIST\" ADD CONSTRAINT \"ADMIN_PK\" PRIMARY KEY (\"ADMIN_ID\");\r\n\r\n-- ----------------------------------------------\r\n-- DDL Statements for triggers\r\n-- ----------------------------------------------\r\n\r\nCREATE TRIGGER \"APP\".\"ADMIN_LIST_UPDATE_MARKERS\" AFTER UPDATE ON \"APP\".\"ADMIN_LIST\"\r\n\tREFERENCING OLD AS OLD NEW AS NEW FOR EACH ROW \r\n\tUPDATE EXP_RUNS SET MARKER_USERCODE = LOWER(NEW.USER_CODE) \r\n\t\tWHERE MARKER_USERCODE = LOWER(OLD.USER_CODE);\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-21T22:39:40.571+0000","updated":"2011-06-21T22:39:40.571+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052920","id":"13052920","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"brett, can you comment on the \"history\" of the database that is having the problem as far as you know.  Do you know what\r\nversion derby created it?  From the db itself we can only tell what version the database is currently at.  So it is possible it\r\ncould have been hard upgraded to the current version it is at.   The best chance to get a fix is to somehow reproduce it.  more\r\ninfo might help.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-06-21T22:52:21.080+0000","updated":"2011-06-21T22:52:21.080+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052934","id":"13052934","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"DERBY-1482 added code to have extra information about triggers collected and saved persistently. These changes went in 10.7 codeline. In DERBY-1482, there was a lot of discussion about how this should be handled to provide upgradability from releases prior to 10.7 to 10.7 and higher releases(The discussion about serialization can be found at DERBY-1482 with the comments starting at date 02/Apr/10 through 28/May/10.). Despite what was agreed on for serialization of the new information, I see that with revision 956763, I have (accidentally) added incorrect serialization code rather than what was discussed and agreed on in the jira. I am pretty certain that is the cause of the problem. I will look into developing a small test case to demonstrate the problem. I think the fix to this would be to change the serialization code to what was agreed upon in DERBY-1482. At this point, I would like to first work on a simple test case which shows the problem and then try the new serialization code to see if that fixes the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-21T23:19:38.341+0000","updated":"2011-06-21T23:19:38.341+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052937","id":"13052937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Brett, I will work on a repro on my own but it will be great help if you happen to have a simple repro script for your db showing the problem. Thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-21T23:28:29.751+0000","updated":"2011-06-21T23:28:29.751+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052957","id":"13052957","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I still think there may be an architectural problem.  I believe we are counting on upgrade getting rid of invalid SPS's during the code that is\r\nexecuting on the stack of this issue.  But it seems that in order to do it, it is reading all the SPS's from disk and possibly using bad read/write\r\ncode to do so.   At least that is what it looks like for the stacks shown, have not debugged this.  \r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-06-22T00:06:25.759+0000","updated":"2011-06-22T00:06:25.759+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052972","id":"13052972","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"body":"Good news, I can reproduce the problem fairly easily from a clean install of our application. I have done a run through with \"derby.language.logStatementText\" turned on so I should be able to supply an ij script to reproduce the problem. Will just take a while to work through the 2.5mb of logs :-).\r\n\r\nMike, the attached DB has only ever been used with 10.5.1.1.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"created":"2011-06-22T00:33:21.978+0000","updated":"2011-06-22T00:33:21.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052987","id":"13052987","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I took Brett's db and tried upgrading it with 10.7 latest codeline and I see the problem there too. Brett's db also failed when I upgraded it to 10.8.1.2\r\n\r\nIn short, following is where the attached db upgrades without problem\r\ntrunk \r\n10.8 codeline\r\n\r\nThe upgrade failled with following\r\n10.7.1.1\r\n10.8.1.2\r\n10.7 codeline","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-22T01:33:12.105+0000","updated":"2011-06-22T01:33:12.105+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13052989","id":"13052989","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I don't think the problem is in the trigger synchonization code that was discussed as part of DERBY-1482.  That discussion was about\r\nhandling upgrade to the SYSTRIGGERS system table, and that code looked right to me.  It is located in ReferencedColumnsDescriptorImpl .\r\n\r\nThe overall architecture for handling upgrade problems in SYSSTATEMENTS stored query plans, is that basically we don't do any upgrade handling.\r\nCoders are free to change all the read and write routines of stuff that goes into a stored query plan and need not write upgrade dependent code.  What\r\nis supposed to happen is that if you do this you make sure the branch gets a version number bump, and then the upgrade code is supposed to \r\nrecognize the version number bump and invalidate all those stored dynamic query plans.  It looks to me like there is a problem in this area where\r\nin order to do this upgrade work we are actually reading in the \"BAD\" plans using code that is not ready to do it.  In the current case it looks like\r\nwe are reading in all SPS's to find the database metadata rows because we don't have a good index.  This code should not be reading the SPS portion\r\nof the row as it is not guaranteed to work.  \r\n\r\nI think best way to understand this bug:\r\n1) get a repro that we can run through the full upgrade suite.\r\n2) figure out what change has happened to fix this and see if we can backport that to 10.7.  I looked around at the first level of upgrade code and\r\n    nothing jumped out at me in DD_VERSION.java between 10.7 and trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-06-22T01:42:20.515+0000","updated":"2011-06-22T01:42:20.515+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13053004","id":"13053004","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I looked through the changes to the 10.8 branch and nothing looked like it would fix this from the description.  Seems like next step is to binary search 10.8 with builds to figure out what change fixed this.  There are not that many changes, only 28.  The release svn number of the 10.8 release is 1095077.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-06-22T02:15:56.423+0000","updated":"2011-06-22T02:15:56.423+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13053009","id":"13053009","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I looked closer after mamta posted the results for 10.8.  I think the fix to DERBY-3870 may have fixed this issue.  Maybe knut can say whether it is appropriate to backport that whole change to 10.7 or not.  But my guess is that we only need the following change in 10.7 (and probably should \r\nbackport it as far as possible as I think it could fix other issues for upgrade), should verify this one change fixes the problem in 10.7:\r\n\r\nIn DataDictionaryImpl.java knut made the change I was saying was a problem with the architecture.  You should not be deserializing the\r\nSPS's during upgrade's attempt to drop/invalidate them:\r\n    public List getAllSPSDescriptors()\r\n        throws StandardException\r\n    {\r\n        TabInfoImpl                 ti = getNonCoreTI(SYSSTATEMENTS_CATALOG_NUM)\r\n;\r\n\r\n        List list = newSList();\r\n\r\n        // DERBY-3870: The compiled plan may not be possible to deserialize\r\n        // during upgrade. Skip the column that contains the compiled plan to\r\n        // prevent deserialization errors when reading the rows. We don't care\r\n        // about the value in that column, since this method is only called\r\n        // when we want to drop or invalidate rows in SYSSTATEMENTS.\r\n        FormatableBitSet cols = new FormatableBitSet(\r\n                ti.getCatalogRowFactory().getHeapColumnCount());\r\n        for (int i = 0; i < cols.size(); i++) {\r\n            if (i + 1 == SYSSTATEMENTSRowFactory.SYSSTATEMENTS_CONSTANTSTATE) {\r\n                cols.clear(i);\r\n            } else {\r\n                cols.set(i);\r\n            }\r\n        }\r\n\r\n        getDescriptorViaHeap(\r\n                        cols,\r\n                        (ScanQualifier[][]) null,\r\n                        ti,\r\n                        (TupleDescriptor) null,\r\n                        list);\r\n\r\n        return list;\r\n\r\n    }","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-06-22T02:41:31.667+0000","updated":"2011-06-22T02:41:31.667+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13053014","id":"13053014","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I made the code change suggested by Mike(along with that, had to make couple other minor changes since the signature of getDescriptorViaHeap has been changed by the code) and the upgrade works fine. I am running the existing upgrade suite to see how it runs. Once it's done, I will fire the regular junit and derbyall tests. Like Mike said, it will be great to have a repro for this problem which we can add to our upgrade suite which will ensure that this test works fine with various upgrades.Also, it seems like it will be good to backport this to older releases as well. Thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-22T03:05:51.165+0000","updated":"2011-06-22T03:05:51.165+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13053119","id":"13053119","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Yes, this sounds similar to the upgrade problem we came across in DERBY-3870. I think it's safe to backport the whole fix to 10.7, as long as we remember to bump the version number on the branch. If the whole fix cannot be backported, the DataDictionaryImpl changes should be sufficient for this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2011-06-22T08:17:41.618+0000","updated":"2011-06-22T08:17:41.618+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13053343","id":"13053343","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I did the partial backport of Knut's changes to my 10,7 codeline and with that backport, the full upgrade, junit suite and derbyall suite ran fine. I will attach this partial backport to jira. We do not have a standalone test case yet which we can be added to upgrade suite to test the problem as part of our regression suites.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2011-06-22T16:59:38.732+0000","updated":"2011-06-22T16:59:38.732+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13053458","id":"13053458","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"body":"Took a while but I've managed to isolate a test case which can be added to the test suite. Appears to come down to triggers which fire other triggers.\r\n\r\nSteps to reproduce:\r\n1) Run the attached repro.sql in ij using Derby 10.5.1.1 or 10.6.2.1. It will create a database called \"test\" in the current directory.\r\n2) Attempt to open the resulting database in Derby 10.7.1.1 or 10.8.1.2. With or without \"upgrade=true\".\r\n3) The error posted above is thrown.\r\n\r\nThe script is fairly short so I'll paste it here too:\r\n\r\nCONNECT 'jdbc:derby:test;create=true';\r\n\r\nCREATE TABLE TABLE1 (COL1 VARCHAR(5));\r\nCREATE TABLE TABLE2 (COL2 VARCHAR(5));\r\nCREATE TABLE TABLE3 (COL3 VARCHAR(5));\r\n\r\nCREATE TRIGGER TABLE1_UPDATED AFTER UPDATE ON TABLE1 REFERENCING OLD AS OLD NEW AS NEW FOR EACH ROW UPDATE TABLE2 SET COL2 = NEW.COL1 WHERE COL2 = OLD.COL1;\r\n\r\nCREATE TRIGGER TABLE2_UPDATED AFTER UPDATE ON TABLE2 REFERENCING NEW AS NEW FOR EACH ROW INSERT INTO TABLE3(COL3) VALUES('ccc');\r\n\r\ninsert into TABLE1(COL1) values ('aaa');\r\nUPDATE TABLE1 SET COL1 = 'bbb';\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=b.mason%40adinstruments.com","name":"b.mason@adinstruments.com","emailAddress":"b dot mason at adinstruments dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Mason","active":true},"created":"2011-06-22T20:35:06.977+0000","updated":"2011-06-22T20:35:06.977+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13053466","id":"13053466","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thank you very much Brett for the reproduction! I verified it in my environment.  I will pick up this issue, add the upgrade  test and look at back porting all or part of DERBY-3870 to the older branches where it may be an issue for other users.  Note: If you build the head of the 10.8 branch it already has the fix because DERBY-3870 is already fixed in that branch.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-06-22T20:55:30.750+0000","updated":"2011-06-22T20:55:30.750+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13054646","id":"13054646","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Attached is a new test case for this issue. I will go ahead and put it in trunk as the issue is fixed with DERBY-3870.  One complication with the test was that it cannot run any phase if the old version is affected by DERBY-4385, because the database won't boot when booting in the post soft upgrade phase and other fixtures are affected.\r\n\r\nFor the older branches I think I will not backport all of DERBY-3870, but just the relevant part based on the patch mamta provided for this.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-06-24T19:53:06.218+0000","updated":"2011-06-24T19:53:06.218+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13055715","id":"13055715","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Here is a full patch for 10.7 with tests.  It combines Mamta's subset patch of DERBY-3870, the test for DERBY-5289 and also needed to include the test fix for DERBY-5105. Running tests now.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-06-27T19:40:36.047+0000","updated":"2011-06-27T19:40:36.047+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13056083","id":"13056083","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I believe there should be a version bump to whatever version this fix is backported to.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-06-27T23:00:15.607+0000","updated":"2011-06-27T23:00:15.607+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13056197","id":"13056197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I am not sure that is required for just this subset of DERBY-3870 as it doesn't actually change the compiled plans. The change to DataDictionaryImpl.getAllSPSDescriptiors()  is described with this comment:\r\n+        // DERBY-5289 uses partial fix from\r\n+        // DERBY-3870: The compiled plan may not be possible to deserialize \r\n+        // during upgrade. Skip the column that contains the compiled plan to \r\n+        // prevent deserialization errors when reading the rows. We don't care \r\n+        // about the value in that column, since this method is only called \r\n+        // when we want to drop or invalidate rows in SYSSTATEMENTS. \r\n\r\nSo, it is just skipping the compiled plan column in a situation where it is already in upgrade. \r\nAs I understand it, if I backported the full DERBY-3870 it would contain some actual generated code change that would require a version bump, but this part just affects what happens when we have a version change already,\r\nPlease let me know if I read this incorrectly.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-06-27T23:31:04.251+0000","updated":"2011-06-27T23:31:04.251+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13056412","id":"13056412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I think your understanding is correct. The backported subset of DERBY-3870 doesn't change the compiled plans, so a version bump shouldn't be required. If an upgrade fails because the fix is missing, booting again with the fix should make the upgrade code run again even if the version number hasn't changed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2011-06-28T09:30:48.368+0000","updated":"2011-06-28T09:30:48.368+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13057341","id":"13057341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Resolving this issue.  Backported the code fix all the way to 10.1 branch. Even though just recently exposed with the upgrade from 10.5 to 10.8 the code attempting to read in the stored plans on upgrade has always been there.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-06-29T16:49:10.754+0000","updated":"2011-06-29T16:49:10.754+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511021/comment/13685338","id":"13685338","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"[bulk update] Close all resolved issues that haven't been updated for more than one year.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-06-17T09:19:43.667+0000","updated":"2013-06-17T09:19:43.667+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-5289/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06kgn:"}}