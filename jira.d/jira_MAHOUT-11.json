{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12390325","self":"https://issues.apache.org/jira/rest/api/latest/issue/12390325","key":"MAHOUT-11","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310751","id":"12310751","key":"MAHOUT","name":"Mahout","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310751&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310751&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310751&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310751&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13060","id":"13060","description":"Apache Mahout","name":"Mahout"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314281","id":"12314281","description":"","name":"0.3","archived":false,"released":true,"releaseDate":"2010-03-17"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-11-18 13:55:09.068","customfield_12312323":null,"customfield_12310420":"10055","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_753414985_*|*_1_*:*_1_*:*_54888495797_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2009-12-10T09:40:59.673+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAHOUT-11/watchers","watchCount":1,"isWatching":false},"created":"2008-03-06T09:35:48.891+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312976","id":"12312976","description":"First Minor Release","name":"0.1","archived":false,"released":true,"releaseDate":"2009-04-07"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-05-21T03:24:17.070+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312151","id":"12312151","name":"Clustering","description":"Bugs related to any of the clustering packages"}],"timeoriginalestimate":null,"description":"I file this as a bug, even though I'm not 100% sure it is one. In the currect code the information is exchanged via static fields (for example, distance measure and thresholds for Canopies are static field). Is it always true in Hadoop that one job runs inside one JVM with exclusive access? I haven't seen it anywhere in Hadoop documentation and my impression was that everything uses JobConf to pass configuration to jobs, but jobs are configured on a per-object basis (a job is an object, a mapper is an object and everything else is basically an object).\r\n\r\nIf it's possible for two jobs to run in parallel inside one JVM then this is a limitation and bug in our code that needs to be addressed.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"23407","summary":"Static fields used throughout clustering code (Canopy, K-Means).","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":17,"total":17,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12779455","id":"12779455","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"I agree with this, this is bad design. I will take on this old issue to try to patch up.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-11-18T13:55:09.068+0000","updated":"2009-11-18T13:55:09.068+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12779893","id":"12779893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"I looked at this in depth and think it is going to happen to work in many cases, but not all. It doesn't attempt to share data via these statics -- I think. This is some global configuration about how the algorithm works that, actually, every Mapper sets and overwrites.\r\n\r\nIf they're all setting the same values, this doesn't fail. *But we don't know that* -- we have no guarantee Hadoop isn't running mappers for several jobs in one JVM. Then this would be a serious bug as two jobs would be overwriting each others' parameters continuously.\r\n\r\nReally there are two separable concerns here:\r\n1) Representing one canopy\r\n2) Implementing the canopy algorithm\r\n\r\nThese are bundled together into one class, with the static stuff representing the algorithm and the non-static stuff representing the canopy. I think these should be explicitly separated so it's clear where this data lives. Having it live in static-land gets confusing to think about in a distributed environment -- and leads to subtle bugs that may not be immediately obvious.\r\n\r\nHaving got halfway through a patch, it's looking like a lot of surgery I'm not qualified to do, so I am not going to proceed on this.\r\n\r\nI think it's a hard to ignore issue -- who wrote this and what do you think?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-11-19T09:21:37.287+0000","updated":"2009-11-19T09:21:37.287+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12780146","id":"12780146","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"body":"Not the original author of the source, but still managed to get the static fields out of the k-means clustering code. All unit-tests are still passing. However I would feel a lot better, if someone else double-checked the changes made.\r\n\r\nLooking at the code, I spotted some more points that could benefit from being revisited (e.g. usage of deprecated MapReduce APIs and introduction of status reports). But this should be done in a separate issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"created":"2009-11-19T17:19:49.040+0000","updated":"2009-11-19T17:19:49.040+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12780402","id":"12780402","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"body":"Isabel, I reviewed the changes and they look great. The refactoring of the code into KMeansClusterer is especially nice. \r\n\r\nWould there be a benefit to passing the output collector into KMeansClusterer.(emitPointToNearestCluster|outputPointWithClusterInfo) methods directly? It would reduce the amount of object creation/garbage collection, which I suspect is worth being concerned with in this case because a Pair<?,?> is created per point per iteration and per point for the clustering. It should not impact testability of these methods because OutputCollector<?,?> is an interface which can either be mocked or stubbed.\r\n\r\nAlso agree that the use of deprecated MapReduce APIs should be handled elsewhere, likely across all usages if possible.\r\n\r\nI'm going to try a run on some real data with your patch applied this evening, if I run into any problems I'll follow up.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"created":"2009-11-20T03:08:18.906+0000","updated":"2009-11-20T03:08:18.906+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12780476","id":"12780476","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"body":"First of all, thanks for the review.\r\n\r\nPassing the output collector directly - Jepp, makes sense. Will change and resubmit the patch.\r\n\r\nTests with real data: Big thanks for that.\r\n\r\nIsabel","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"created":"2009-11-20T07:33:22.986+0000","updated":"2009-11-20T07:33:22.986+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12780510","id":"12780510","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"Yes that's certainly looking good. The \"good\" news is the Canopy jobs need the same treatment, as do a few others!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-11-20T10:54:33.146+0000","updated":"2009-11-20T10:54:33.146+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12780884","id":"12780884","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"body":"FWIW, I'm running into some strangeness of some sort, it seems that emitPointToNearestCluster is only looking at a single cluster although my -k is set to 100 for my input. I'm tracking it down, it could be a problem unrelated to this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"created":"2009-11-21T02:07:31.168+0000","updated":"2009-11-21T02:07:31.168+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12780909","id":"12780909","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"body":"Found the problem, which I believe is isolated to the case where kmeans cluster uses random seed clusters as a basis for clustering.\r\n\r\nIn RandomSeedGenerator, no cluster ids are assigned, so all clusters generated get an id of zero when being written to the sequence file. If all cluster id's are zero, KmeansClusterer.outputPointWithClusterInfo winds up assigning all points to the same cluster. This issue was hidden previously because Cluster id's were assigned in the Cluster(Vector) constructor. \r\n\r\nI've attached a small patch for RandomSeedGenerator. This should probably be accompanied by a unit test, but I haven't had the chance to put one together.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"created":"2009-11-21T04:24:22.523+0000","updated":"2009-11-21T04:24:22.523+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12781762","id":"12781762","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"body":"Attached a patch that takes Isabel's original patch to remove static fields in kmeans clustering, makes the discussed change for the output collectors, cleans up some warnings and unused instance of the convergenceDelta variable. Fixes the RandomSeedGenerator in kmeans clustering and adds a unit test for it. Also, KMeansClusterer no longer extends Cluster -- it wasn't necessary to do so.\r\n\r\nIsabel, are you planning on taking a crack at the rest of the clustering code that uses static fields? I'm finding this issue a great way to become familiar with the code, and if you're not already intending to work on it, I could give it a try.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"created":"2009-11-24T04:09:19.452+0000","updated":"2009-11-24T04:09:19.452+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12782470","id":"12782470","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"body":"Drew, go ahead then.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"created":"2009-11-25T15:57:41.341+0000","updated":"2009-11-25T15:57:41.341+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12783293","id":"12783293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"body":"MAHOUT-11-all-cleanup-20091128.patch eliminates the use of static fields for configuration in the clustering code in all cases where it was present: canopy, kmeans, fuzzykmeans and meanshift. It retains Isabel's original patch to the kmeans package, with the exception of the items discussed previously, and adds similar changes to the other packages. It also includes the fix to and unit test for RandomSeedGenerator previously included.\r\n\r\nApplied against rev 883446, all unit tests are passing, and I've run the kmeans code on real data. It would be really great if someone could double check the changes and comment.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"created":"2009-11-28T21:50:25.606+0000","updated":"2009-11-28T21:50:25.606+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12784280","id":"12784280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"body":"see attached: MAHOUT-11-all-cleanup-20091128.patch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"created":"2009-12-01T16:24:04.646+0000","updated":"2009-12-01T16:24:04.646+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12785985","id":"12785985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"body":"Applies cleanly and builds w/o unit test failures here.\r\n\r\nThe changes look all good to me. Great work, Drew.\r\n\r\nOne question though: In the TestMeanShift test (lines 301 and 304) you removed the canopyId adjustments - could you please explain what was the reason this was necessary?\r\n\r\nI would like to commit this patch next week if noone objects.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"created":"2009-12-04T16:19:17.839+0000","updated":"2009-12-04T16:19:17.839+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12786144","id":"12786144","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"body":"Thanks very much for the review Isabel. \r\n\r\nRegarding the canopyId adjustments in TestMeanShift: Prior to the patch, classes like Canopy and MeanShiftCanopy assigned their ids in their constructors using a static field. I've changed this so that classes that create Canopy/MeanShiftCanopy objects are responsible for assigning cluster ids. As a result, there is no longer a need to offset the canopy id's in TestMeanShift because both the reference set and map/reduce (clusterer) generated canopies start are able to generate canopies starting at an id of 0.\r\n\r\nUsing the static fields in the Classes themselves and then having to work around that in the unit tests felt a little funny to me. It could be limiting in cases where id's must be assigned from some external source, or perhaps to be consistent in a distributed environment. More specifically it seemed to go along with the spirit of the original issue and pushing the responsibility for id management up to the users of the classes seems like a good thing.\r\n\r\nFWIW, While reviewing this, I happened to noticed that the nextCanopyId field could be removed from MeanShiftCanopyClusterer entirely. Can you fix this prior to commit Isabel, or should I submit another patch?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=drew.farris","name":"drew.farris","emailAddress":"drew dot farris at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=drew.farris&avatarId=16822","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=drew.farris&avatarId=16822","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=drew.farris&avatarId=16822","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=drew.farris&avatarId=16822"},"displayName":"Drew Farris","active":true},"created":"2009-12-04T20:36:21.870+0000","updated":"2009-12-04T20:36:21.870+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12788129","id":"12788129","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"body":"I'll make the changes before committing - no need to submit a new patch version.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"created":"2009-12-09T15:45:21.872+0000","updated":"2009-12-09T15:45:21.872+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12788626","id":"12788626","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"body":"Committed. Thanks Drew for your help.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"created":"2009-12-10T09:40:59.577+0000","updated":"2009-12-10T09:40:59.577+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390325/comment/12788672","id":"12788672","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"body":"Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=isabel","name":"isabel","emailAddress":"mainec at isabel-drost dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=isabel&avatarId=16810","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=isabel&avatarId=16810","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=isabel&avatarId=16810","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=isabel&avatarId=16810"},"displayName":"Isabel Drost-Fromm","active":true},"created":"2009-12-10T11:09:10.975+0000","updated":"2009-12-10T11:09:10.975+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAHOUT-11/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i04d7z:"}}