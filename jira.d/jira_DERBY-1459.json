{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12345065","self":"https://issues.apache.org/jira/rest/api/latest/issue/12345065","key":"DERBY-1459","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-06-28 03:24:35.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22519","customfield_12310222":"1_*:*_1_*:*_2051544000_*|*_6_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-07-21T19:14:02.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1459/watchers","watchCount":0,"isWatching":false},"created":"2006-06-28T01:21:38.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.png","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12312718","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12312718","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12344605","key":"DERBY-1429","self":"https://issues.apache.org/jira/rest/api/2/issue/12344605","fields":{"summary":"Additional vulnerability to non-deterministic startup behavior when applications generate derby properties on the fly","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12312719","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12312719","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12328677","key":"DERBY-930","self":"https://issues.apache.org/jira/rest/api/2/issue/12328677","fields":{"summary":"Add support for autoloading of Derby client drivers","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-06-30T15:55:42.067+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"},{"self":"https://issues.apache.org/jira/rest/api/2/component/11415","id":"11415","name":"Services"}],"timeoriginalestimate":null,"description":"The addition of support for autoloading of Derby drivers, DERBY-930, caused two potentially serious regresions for applications.\n\n\n1) Early load of driver can mean that  derby system properties, such as derby.system.home may not be processed by the driver because they are set after the driver is loaded.\n\n2) Early load of the driver can mean boot time operations, such as starting network server with derby.drda.startNetworkServer can happen even when Derby is never used if a connection is made to another database such as Oracle.\n\n\nThe attached file autoloading_scenarios.html  shows scenarios that show these regressions plus another case that will regress if boot time operations are moved to the first Derby embedded connection.   I don't know what solution is available that would handle all three cases.\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10420","value":"Regression","id":"10420"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38833","summary":"Early load of Derby driver with JDBC 4.0 autoloading can lead to derby properties not being processed or derby boot time actions consuming resources when a connection is made with another driver","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"JDK 1.6 ","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":14,"total":14,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418093","id":"12418093","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Document to show autoloading scenarios that need to be handled for 10.2\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-06-28T02:09:28.000+0000","updated":"2006-06-28T02:09:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418107","id":"12418107","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Knut Anders made an excellent suggestion for fixing this bug: Autoload a dummy driver which doesn't boot the engine but which indirects to the appropriate embedded driver. I am attaching a patch which does this: bug1459_v01.diff. Please review this approach and let me know what you think. If this seems like a good approach, I will continue testing it.\r\n\r\nHere is Derby's behavior under this patch:\r\n\r\no Instead of autoloading EmbeddedDriver, we autoload a new driver: AutoloadedDriver.\r\no The DriverManager registers AutoloadedDriver rather than Driver20, Driver30, or Driver40.\r\no The engine does NOT boot at autoload time.\r\no The engine does boot if you do the following:\r\n\r\n1) Ask the DriverManager to connect to an embedded Derby database\r\n\r\nor\r\n\r\n2) Class.forName( \"org.apache.derby.jdbc.EmbeddedDriver\" );\r\n\r\nor\r\n\r\n3) Class.forName( \"org.apache.derby.jdbc.EmbeddedDriver\" ).newInstance();\r\n\r\n-----------------------------------\r\n\r\nThis patch touches the following files:\r\n\r\nM      java\\engine\\org\\apache\\derby\\jdbc\\EmbeddedDataSource.java\r\n\r\nChanged to indirect to the booted driver through AutoloadedDriver.\r\n\r\nM      java\\engine\\org\\apache\\derby\\jdbc\\EmbeddedDriver.java\r\n\r\nNow extends AutoloadedDriver. All that remains in this class are the static initializer and constructor needed to get the right booting behavior out of Class.forName() and Class.forName().newInstance().\r\n\r\nM      java\\engine\\org\\apache\\derby\\jdbc\\Driver20.java\r\n\r\nChanged to forward driver registration to AutoloadedDriver.\r\n\r\nA      java\\engine\\org\\apache\\derby\\jdbc\\AutoloadedDriver.java\r\n\r\nNew, dummy driver which holds the guts of what used to be in EmbeddedDriver. The java.sql.Driver methods in this new class indirect to the appropriate driver module (Driver20, Driver30, or Driver40).\r\n\r\nM      java\\engine\\org\\apache\\derby\\loc\\messages_en.properties\r\nM      java\\shared\\org\\apache\\derby\\shared\\common\\reference\\MessageId.java\r\n\r\nA little tweeking of error messages.\r\n\r\nM      build.xml\r\n\r\nAutoload directive changed to point at AutoloadedDriver rather than EmbeddedDriver.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-06-28T03:24:35.000+0000","updated":"2006-06-28T03:24:35.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418124","id":"12418124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I think the general approach is good, but do we really want AutoloadedDriver to be part of the public api? With EmbeddedDriver extending this class it will become so.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-06-28T03:57:54.000+0000","updated":"2006-06-28T03:57:54.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418278","id":"12418278","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching bug1459_v02.diff, which hopefully addresses Dan's concern. In this version the public EmbeddedDriver has a rather than is an AutoloadeDriver.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-06-29T00:31:05.000+0000","updated":"2006-06-29T00:31:05.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418285","id":"12418285","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The functional description as you have outlined it sounds great and I think would solve all the scenarios outlined.  I haven't looked carefully at the patch though.  With the new patch do the public interfaces not change at all?   \r\n\r\nAlso, it would be great to see test cases added for the scenarios, using the client driver to simulate the unrelated driver.  Also it would be good to double check that the  demo program SimpleNetworkServerSample.java   works ok with the new scheme.\r\n\r\nThanks Rick!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-06-29T01:03:30.000+0000","updated":"2006-06-29T01:03:30.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418294","id":"12418294","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Kathey,\r\n\r\nWith the new patch, the public interfaces should not change. Thanks for recommending those tests. I will add them to the jdbc4 test suite. And I will check out SimpleNetworkServerSample. Let me know what other tests you think are appropriate. I also intend to run derbyall against the jar files on jdks 1.3, 1.4, 1.5, and 1.6. So far, the 1.6 run looks good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-06-29T02:16:19.000+0000","updated":"2006-06-29T02:16:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418299","id":"12418299","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"The functional behaviour of EmbeddedDriver changes with this patch.\r\n\r\nPreviously calls to the java.sql.Driver methods of EmbeddedDriver defered to the currently registered driver in DriverManager. Now they defer to a specific instance of the AutoloadedDriver which may not be registered with the DriverManager. Through the logic I think this means that the calls can throw an exception when they would previously succeed. This would be in the case the Derby driver had been loaded, unloaded and then loaded again. Seems to me that EmbeddedDriver should not change with this patch.\r\nEven without an unload there is a chance (due to concurrent booting) the AutoloadedDriver stored in EmbeddedDriver is not the currently active one (ie. one registered with the DriverManager).\r\n\r\nSecond issue that calling one of the methods of java.sql.Driver methods on EmbeddedDriver will now automatically load the Derby driver, whereas currently an exception will be thrown, driver not registered. Maybe this is intentional, it would be good to call this out. I'm not sure it is a good idea, adds a new non-standard mechanism for autoloading, and we've seen what  issues the standard autoloading has!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-06-29T02:39:12.000+0000","updated":"2006-06-29T02:39:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418327","id":"12418327","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks for continuing to review these patches, Dan. I've attached another rev, bug1459_v03.diff. I hope this is converging on a solution and not just pushing the problem around! In this new rev, EmbeddedDriver defers its work to the booted driver module. Calling methods on an EmbeddedDriver should no longer automatically boot the engine.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-06-29T04:52:05.000+0000","updated":"2006-06-29T04:52:05.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12418730","id":"12418730","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching bug1159_v04.diff. This rev of the patch makes the following changes:\r\n\r\n1) Adds a unit test (AutoloadBooting) to verify Kathey's scenarios.\r\n\r\n2) Makes some changes to AutoloadedDriver.acceptsURL() and AutoloadedDriver.connect() so that the DriverManager will not accidentally boot Derby while trying to connect through another driver. The problem is that when an application requests a Connection, the DriverManager will walk through all loaded drivers, passing the request on to each in turn. Depending on where your autoloaded driver sits in the list, this may trigger an attempt to connect through your driver.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-07-01T06:01:48.000+0000","updated":"2006-07-01T06:01:48.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12420111","id":"12420111","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"I'm beginning to run a battery of derbyalls against this patch using various VMs with and without jar files. So far derbyall runs cleanly (no errors at all) with this patch when run against 1.6 and the derby jar files.\r\n\r\nUnless someone objects to this patch, I plan to commit it if the tests pass.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-07-10T23:47:58.000+0000","updated":"2006-07-10T23:47:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12420134","id":"12420134","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thanks so much Rick for looking this issue and to Olav for bringing it to the attention of the community.  \r\nI just wanted to confirm.  \r\n   1) Will this resolve  DERBY-1399 without changing the test?  \r\n    2)  With this fix, do we expect  users upgrading to to 10.2 /jdk 16 see any impact to  their existing applications due to autoloading?\r\n    \r\n\r\nKathey","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-07-11T00:57:28.000+0000","updated":"2006-07-11T00:57:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12420146","id":"12420146","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Kathey,\r\n\r\nHere are some answers to your questions. And don't forget to thank Knut Anders, who suggested this approach!\r\n\r\n1) This approach should fix DERBY-1399. My clean derbyall run against the jars on 1.6 confirms this.\r\n\r\n2) Under this approach, the 10.2/jdk1.6 engine should boot (and lookup system properties) in the same fashion as the current 10.1.3 engine does. There is a subtle differences though:\r\n\r\nDriverManager.getDriver() will return a different driver in 10.2, viz., AutoloadedDriver. In 10.1.3, this method returns Driver20 or Driver30 depending on the JDBC level. This could affect users who care about the name of the returned driver and who want to call public Derby-specific methods on these classes. Since these classes aren't part of our public API, I don't think we want to encourage or support this practice.\r\n\r\nI do not anticipate any impact for customers who have coded their applications against our published API.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-07-11T01:41:52.000+0000","updated":"2006-07-11T01:41:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12420154","id":"12420154","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Rick said:\r\n>And don't forget to thank Knut Anders, who suggested this approach\r\nYes. Thanks Knut Anders!\r\n\r\n>I do not anticipate any impact for customers who have coded their applications against our published API.\r\nExcellent!\r\n\r\nAlso wanted to clarify that I have not reviewed the code change. but  the functional results of this patch of this patch as you describe them sound great to me.\r\n\r\nKathey\r\n  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-07-11T02:13:40.000+0000","updated":"2006-07-11T02:13:40.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345065/comment/12420955","id":"12420955","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Committed at revision 421717. Derbyall ran cleanly against jar files and against the classtree on jdks 1.6, 1.5, and 1.4. The following issues occurred running against 1.3:\r\n\r\n1) Initially, the encryption tests failed. The encryption tests passed after I installed the Sun JCE jars.\r\n\r\n2) OutBufferedStream hung on 1.3. It also hung even on a clean subversion workspace without this patch.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-07-14T05:25:18.000+0000","updated":"2006-07-14T05:25:18.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1459/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i070ev:"}}