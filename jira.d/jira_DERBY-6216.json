{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12646605","self":"https://issues.apache.org/jira/rest/api/latest/issue/12646605","key":"DERBY-6216","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326659","id":"12326659","description":"candidate for Second release for 10.10 branch","name":"10.10.2.0","archived":false,"released":true,"releaseDate":"2014-04-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324243","id":"12324243","description":"First release on the 10.11 branch","name":"10.11.1.1","archived":false,"released":true,"releaseDate":"2014-08-26"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2013-05-17 17:14:12.865","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"326963","customfield_12310222":"1_*:*_1_*:*_5712575612_*|*_5_*:*_2_*:*_20144353312_*|*_4_*:*_1_*:*_175447361","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2014-03-05T19:28:36.653+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-6216/watchers","watchCount":8,"isWatching":false},"created":"2013-05-08T12:15:40.410+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_triage10_11","features"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315434","id":"12315434","description":"Head of 10.6 branch as of 2014-01-13","name":"10.6.2.4","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315902","id":"12315902","description":"Head of 10.7 branch as of 2010-11-29","name":"10.7.1.4","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323475","id":"12323475","description":"Head of 10.8 branch starting 2014-01-13","name":"10.8.3.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316344","id":"12316344","description":"First release on the 10.9 branch","name":"10.9.1.0","archived":false,"released":true,"releaseDate":"2012-06-25"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12372264","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12372264","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12658485","key":"DERBY-6297","self":"https://issues.apache.org/jira/rest/api/2/issue/12658485","fields":{"summary":"Intermittent failures in XplainStatisticsTest.testSimpleXplainOnly","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12369162","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12369162","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12365794","key":"DERBY-2487","self":"https://issues.apache.org/jira/rest/api/2/issue/12365794","fields":{"summary":"Enhance Derby with EXPLAIN Functionality","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}},{"id":"12383607","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12383607","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12695601","key":"DERBY-6481","self":"https://issues.apache.org/jira/rest/api/2/issue/12695601","fields":{"summary":"Derby 10.10 backport issue (winter/spring 2014)","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-01-21T00:23:33.838+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11414","id":"11414","name":"Tools"}],"timeoriginalestimate":null,"description":"I am running Derby 10.9.1.0 and am trying to figure out a  performance problem with query taking too long.   I donâ€™t actually want to run the query so from the documentation, I try:\r\n\r\ncall syscs_util.syscs_set_runtimestatistics(1);\r\ncall syscs_util.syscs_set_xplain_schema('STATS');\r\ncall syscs_util.syscs_set_xplain_mode(1);\r\n--- my query here\r\ncall syscs_util.syscs_set_runtimestatistics(0);\r\ncall syscs_util.syscs_set_xplain_schema('');\r\ncall syscs_util.syscs_set_xplain_mode(0);\r\n\r\nWhen it runs my query, I get:\r\n\r\nERROR XCL16: ResultSet not open. Operation 'getMetaData' not permitted. Verify that autocommit is OFF.\r\n\r\nI try the following with IJ just to see:\r\n\r\ncall syscs_util.syscs_set_runtimestatistics(1);\r\ncall syscs_util.syscs_set_xplain_schema('STATS');\r\ncall syscs_util.syscs_set_xplain_mode(1);\r\nselect sql_text from syscs_diag.transaction_table where status != 'IDLE';\r\ncall syscs_util.syscs_set_runtimestatistics(0);\r\ncall syscs_util.syscs_set_xplain_schema('');\r\ncall syscs_util.syscs_set_xplain_mode(0);\r\n\r\nNote I have tried this with real tables as apposed to the syscs_diag.transaction_table with the same result.  The only reason that I posted this with this table is that it is a table that is accessible for any database.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10420","value":"Regression","id":"10420"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10421","value":"Seen in production","id":"10421"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"327307","summary":"XPLAIN feature does not work and gives ERROR XCL16: ResultSet not open","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10424","value":"Repro attached","id":"10424"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Solaris 10, MacOS X 10.6, Windows XP","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":47,"total":47,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13660662","id":"13660662","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"body":"I found that if:\r\n\r\n\tcall syscs_util.syscs_set_xplain_mode(1);\r\n\r\nis used.  When this is used, then you get:\r\n\r\n\tERROR XCL16: ResultSet not open. Operation 'getMetaData' not permitted. Verify that autocommit is OFF.\r\n\r\nUsing XPLAIN in NOEXECUTE mode to me is the most important function especially when trying to figure out why a query that might be taking hours to run is doing so.   Without this working you have to wait hours for the query to run to figure out why.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"created":"2013-05-17T12:11:41.941+0000","updated":"2013-05-17T12:11:41.941+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13660870","id":"13660870","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"tried in 10.8 and saw same results.  Also set autocommit off to make sure that was not the issue, but same result.\r\nThere is nothing in derby.log about the error.\r\n\r\nij(C1)> call syscs_util.syscs_set_runtimestatistics(1);\r\n0 rows inserted/updated/deleted\r\nij(C1)> call syscs_util.syscs_set_xplain_schema('STATS');\r\n0 rows inserted/updated/deleted\r\nij(C1)> call syscs_util.syscs_set_xplain_mode(1);\r\n0 rows inserted/updated/deleted\r\nij(C1)> select sql_text from syscs_diag.transaction_table where status != 'IDLE';\r\nERROR XCL16: ResultSet not open. Operation 'getMetaData' not permitted. Verify that autocommit is OFF.\r\nij(C1)> call syscs_util.syscs_set_runtimestatistics(0);\r\n0 rows inserted/updated/deleted\r\nij(C1)> call syscs_util.syscs_set_xplain_schema('');\r\n0 rows inserted/updated/deleted\r\nij(C1)> call syscs_util.syscs_set_xplain_mode(0);\r\n0 rows inserted/updated/deleted\r\nij(C1)> autocommit off;\r\nij(C1)> call syscs_util.syscs_set_runtimestatistics(1);\r\n0 rows inserted/updated/deleted\r\nij(C1)> call syscs_util.syscs_set_xplain_schema('STATS');\r\n0 rows inserted/updated/deleted\r\nij(C1)> call syscs_util.syscs_set_xplain_mode(1);\r\n0 rows inserted/updated/deleted\r\nij(C1)> select sql_text from syscs_diag.transaction_table where status != 'IDLE';\r\nERROR XCL16: ResultSet not open. Operation 'getMetaData' not permitted. Verify that autocommit is OFF.\r\nij(C1)> call syscs_util.syscs_set_runtimestatistics(0);\r\n0 rows inserted/updated/deleted\r\nij(C1)> call syscs_util.syscs_set_xplain_schema('');\r\n0 rows inserted/updated/deleted\r\nij(C1)> call syscs_util.syscs_set_xplain_mode(0);\r\n0 rows inserted/updated/deleted\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2013-05-17T17:14:12.865+0000","updated":"2013-05-17T17:14:12.865+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13660950","id":"13660950","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"also tried in 10.7 and it did not work.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2013-05-17T18:57:05.235+0000","updated":"2013-05-17T18:57:05.235+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13661062","id":"13661062","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"does not work in 10.6, starting to think that this never worked and is not a regression.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2013-05-17T21:30:01.006+0000","updated":"2013-05-17T21:30:01.006+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13661090","id":"13661090","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"it looks like this mode is never tested.  See below todo comments in the XplainStatisticsTest test:\r\n * FIXME -- some general to-do items that I don't want to forget:\r\n * - should resultSetNumber be its own column in sysxplain_resultsets?\r\n * - need tests of xplain-only mode\r\n * - need a test of external sorting/merging\r\n * - need to cross-check the result set types, and verify that they're\r\n *   all tested at least once\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2013-05-17T22:13:54.901+0000","updated":"2013-05-17T22:13:54.901+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13661097","id":"13661097","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"It would be good to determine if the code actually ever supported\r\nthe no execute mode, and if not probably should log a doc bug and to \r\nremove this mode and file a new JIRA if anyone has time/interest to complete\r\nthis feature. It could of been something the original contributer was working\r\non but did not finish and then when it got committed much later was missed\r\nthat it did not work.\r\n\r\n I don't really know anything about this code, but\r\nsome simple searching looked like the only work done was:\r\no support for setting the option\r\no 2 code changes to BasicNoPutResultSetImpl.java, to no opt open of tables and\r\n   get next rows of tables.  Would this really stop execution of all queries that\r\n   can be executed in derby?\r\no no tests written for this mode, with a TODO in the only test file for the feature.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2013-05-17T22:25:30.754+0000","updated":"2013-05-17T22:25:30.754+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13661379","id":"13661379","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Urk. Sorry about that. At least the to-dos give us some idea of the scope of the problem.\r\n\r\nIt will require a fair bit of research to answer the questions you raise.\r\n\r\nInterestingly it looks like, about 18 months ago, somebody else encountered\r\nthis and at the time I off-handedly answered without doing any research then, either:\r\nhttp://apache-database.10148.n7.nabble.com/Statistics-are-not-capturing-in-XPLAIN-only-mode-td104392.html\r\n\r\nThe history of the development of this feature is primarily in DERBY-2487, but\r\nit may be hard to contact the original contributor, as it has been more than 6 years\r\nsince this feature was implemented.\r\n\r\nI do recall thinking at the time about the no-execute mode, but I don't recall\r\nexplicitly testing it in any detail, and I think if I had I would have included those\r\ntests in the regression suite.\r\n\r\nSo perhaps I never really tested that behavior back then.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-05-18T15:43:17.217+0000","updated":"2013-05-18T15:43:17.217+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13661385","id":"13661385","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"I think that the basic idea was: in XPLAIN-only mode, the execution logic would\r\nsimply not open the tables. The \"get\" methods would immediately return \"EOF\";\r\nthe \"update\" methods would immediately return \"SUCCESS\". Nothing would\r\nactually happen to the actual tables, but the execution tree of result set nodes\r\nwould be constructed and executed; it would simply complete instantly.\r\n\r\nHopefully it's actually not much code.\r\n\r\nBut the fact that we get a \"ResultSet Not open\" clearly indicates that at least\r\nsome of the execution ResultSet nodes would need to be changed to plant\r\n\"if XPLAIN-only mode, return EOF\" logic into them.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-05-18T16:23:28.859+0000","updated":"2013-05-18T16:23:28.859+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13686197","id":"13686197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"\r\nIt's clearly been a while since I worked with this part of the system,\r\nand I'm now working on a new machine, so there may be some build/setup\r\nissues in my environment.\r\n\r\nStill, XplainStatisticsTest is exhibiting some very strange behaviors:\r\n\r\n1) When, in an empty test directory, I run:\r\n\r\n     java junit.textui.TestRunner org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest\r\n\r\n   I get:\r\n\r\n     ........................\r\n     Time: 30.222\r\n\r\n     OK (23 tests)\r\n\t\r\n   The test appears to pass successfully, with no errors.\r\n\r\n   But I see errors like the following in my system\\derby.log:\r\n\r\n   Mon Jun 17 16:34:07 PDT 2013 Thread[main,5,main] (XID = 450127), (SESSIONID = 19), (DATABASE = wombat), (DRDAID = null),\r\n            Failed Statement is: insert into \"XPLTEST\".\"SYSXPLAIN_RESULTSETS\"(RS_ID,OP_IDENTIFIER,OP_DETAILS,NO_OPENS,\r\n\t    NO_INDEX_UPDATES,LOCK_MODE,LOCK_GRANULARITY,PARENT_RS_ID,EST_ROW_COUNT,EST_COST,AFFECTED_ROWS,DEFERRED_ROWS,\r\n\t    INPUT_ROWS,SEEN_ROWS,SEEN_ROWS_RIGHT,FILTERED_ROWS,RETURNED_ROWS,EMPTY_RIGHT_ROWS,INDEX_KEY_OPT,SCAN_RS_ID,\r\n\t    SORT_RS_ID,STMT_ID,TIMING_ID) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)\r\n   ERROR 42X14: 'RS_ID' is not a column in table or VTI 'XPLTEST.SYSXPLAIN_RESULTSETS'.\r\n        at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:265)\r\n        at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:260)\r\n        at org.apache.derby.impl.sql.compile.ResultColumn.bindResultColumnByName(ResultColumn.java:832)\r\n        at org.apache.derby.impl.sql.compile.ResultColumnList.bindResultColumnsByName(ResultColumnList.java:908)\r\n        at org.apache.derby.impl.sql.compile.InsertNode.bindStatement(InsertNode.java:297)\r\n        at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:403)\r\n        at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:100)\r\n        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:1107)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.<init>(EmbedPreparedStatement.java:134)\r\n        at org.apache.derby.jdbc.Driver40.newEmbedPreparedStatement(Driver40.java:101)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:1734)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:1562)\r\n        at org.apache.derby.catalog.SystemProcedures.createXplainTable(SystemProcedures.java:2148)\r\n        at org.apache.derby.catalog.SystemProcedures.SYSCS_SET_XPLAIN_SCHEMA(SystemProcedures.java:2082)\r\n        at org.apache.derby.exe.acf8e7c29bx013fx547cxa652x00004fd8b4bd3.g0(Unknown Source)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\r\n        at java.lang.reflect.Method.invoke(Unknown Source)\r\n        at org.apache.derby.impl.services.reflect.ReflectMethod.invoke(ReflectMethod.java:46)\r\n        at org.apache.derby.impl.sql.execute.CallStatementResultSet.open(CallStatementResultSet.java:75)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:453)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:334)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1337)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:704)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:631)\r\n        at org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.enableXplainStyle(XplainStatisticsTest.java:501)\r\n        at org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.testTableNotValid(XplainStatisticsTest.java:2546)\r\n\r\n   Although the stack trace is perfectly reasonable, the presence of\r\n   this exception confuses me:\r\n\r\n   - why is this exception occurring? RS_ID is a perfectly fine column.\r\n\r\n   - why is this exception not causing the test suite to fail? Is something on\r\n     this stack catching and ignoring this exception?\r\n\r\n     Is it perhaps the dynamically-generated bytecode which is calling\r\n     SYSCS_SET_XPLAIN_SCHEMA which is hiding this error?\r\n\r\n   - if something is hiding the prepareStatement() exception, why isn't that\r\n     causing further problems down the road?\r\n\r\n2) I tried to diagnose the first problem by running, in an empty directory:\r\n\r\n     java -Dderby.language.logStatementText=true junit.textui.TestRunner org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest\r\n\r\n   (That is, the same test invocation, but with logStatementText=true)\r\n\r\n   Once again, the test appears to pass fine, with no JUnit-level errors\r\n   in the test report.\r\n\r\n   However, this time, when I look in system/derby.log, all of the above\r\n   exceptions are gone! Again, this confuses me:\r\n\r\n   - why does -Dderby.language.logStatementText=true affect whether or not\r\n     the prepareStatement exception is thrown?\r\n\r\nI'd be much obliged if somebody could repeat these steps and tell me whether\r\nthey can confirm my findings or not.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-17T23:53:18.415+0000","updated":"2013-06-17T23:53:18.415+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13686385","id":"13686385","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"I see the error also when running with  -Dderby.language.logStatementText=true (confirmed by running the debugger to catch the exception throw).\r\n\r\nAfter the exception is thrown, I see the execution flow ending up on line 2518 in XplainStatisticsTest:\r\n        :\r\n        catch (SQLException e)\r\n        {\r\n            assertSQLState(\"Expected 42X14 error for missing column\",\r\n                    \"42X14\", e);\r\n            if (e.getMessage().indexOf(\"RS_ID\") < 0)\r\n                fail(\"Expected message about missing column RS_ID, not \" +\r\n                        e.getMessage());\r\n\r\nso it seems it's expected?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-06-18T04:43:15.920+0000","updated":"2013-06-18T04:43:15.920+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13688854","id":"13688854","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Triaged for 10.11.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-06-20T04:24:11.255+0000","updated":"2013-06-20T04:24:11.255+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13690978","id":"13690978","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks Dag! I knew it had been too long since I worked on this code :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-22T00:57:24.172+0000","updated":"2013-06-22T00:57:24.172+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13690999","id":"13690999","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"So I wonder if there are differences in behavior here between\r\nrunning queries using IJ, and running queries directly to JDBC.\r\n\r\nAttached is 'addTests.diff, which tries to use xplain-only mode\r\nboth in XplainStatisticsTest and in a new xplain.sql test script.\r\n\r\nWhen I use xplain-only mode in XplainStatisticsTest, it seems \r\nto work correctly; I don't get the ResultSet not open.\r\n\r\nBut when I use xplain-only mode in xplain.sql, I get the \r\nResultSet not open message, just as describe in the issue\r\ndescription.\r\n\r\nThis patch is not ready for commit, just shows some of the\r\ntesting work I've been doing to better understand the behavior.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-22T01:25:20.417+0000","updated":"2013-06-22T01:25:20.417+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13691011","id":"13691011","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"So here, I think, is the place where the \"ResultSet not open\" error is thrown:\r\n\r\n        at org.apache.derby.impl.jdbc.EmbedResultSet.checkIfClosed(EmbedResultSet.java:4599)\r\n        at org.apache.derby.impl.jdbc.EmbedResultSet.getMetaData(EmbedResultSet.java:1726)\r\n        at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:357)\r\n        at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:344)\r\n        at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:247)\r\n        at org.apache.derby.tools.JDBCDisplayUtil.DisplayResults(JDBCDisplayUtil.java:235)\r\n        at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:454)\r\n        at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:528)\r\n        at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:369)\r\n        at org.apache.derby.impl.tools.ij.utilMain.goScript(utilMain.java:265)\r\n\r\n\r\nI wonder if it is possible for this generic IJ code to recognize that we are in \"xplain only mode\"\r\nand thus not throw this error?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-22T01:41:25.299+0000","updated":"2013-06-22T01:41:25.299+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13691018","id":"13691018","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"OK, I think it's more complicated than just ignoring the \"not open\" error in IJ code somewhere;\r\nunder the covers we're not actually recording the query plan if we don't execute the query.\r\n\r\nI think that the \r\n\r\n    if( !isOpen)\r\n        return;\r\n\r\nstatements in NoPutResultSetImpl.close() and NoRowsResultSetIml.close() are short-circuiting\r\nthe collection of the query plan information in xplain-only mode.\r\n\r\nMore study still needed, but at least I'm making some progress...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-22T02:21:32.598+0000","updated":"2013-06-22T02:21:32.598+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13691759","id":"13691759","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Maybe it would be easier to get it to work if we moved the short-circuiting from open() to getNextRowCore()? Then executeQuery() would return an empty ResultSet of the correct shape instead of a closed ResultSet, which would make getMetaData() and close() behave more like we want them to (that is, return meta-data and record the query plan).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-06-24T07:50:04.316+0000","updated":"2013-06-24T07:50:04.316+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13691992","id":"13691992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Yes, I like that suggestion. I'll spend a few days pursuing that approach. Thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-24T14:07:50.177+0000","updated":"2013-06-24T14:07:50.177+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13692713","id":"13692713","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"I think that the approach suggested by Knut Anders is promising.\r\n\r\nOne downside is that there are a number of ResultSet types\r\nwhich define getNextRowCore, so the diff touches a number\r\nof classes (in a small way).\r\n\r\nEarly testing has been promising, but I have much more testing\r\nto do. Attaching the diff to track my progress; it is NOT ready\r\nfor commit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-25T03:23:32.362+0000","updated":"2013-06-25T03:23:32.362+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13696156","id":"13696156","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"OK, I think I've finally got a patch worth consideration by the community, and would appreciate any feedback.\r\n\r\nThis patch follows the approach suggested by Knut Anders,\r\nin which we allow the result set(s) to be opened, but then\r\nshort-circuit the \"get next row\" routine if we are in xplain-only mode.\r\n\r\nOne interesting detail is that, for queries such as GROUP BY\r\nand other complex situations where we have internal sort\r\noperations and other intermediate results, to get a true\r\nexplain-only mode of operation we need to check in the\r\nresult set constructor, and not wait until the result set is\r\nopened, since many result sets do substantial work even\r\nin their low-level constructors.\r\n\r\nThe patch includes a complete set of code changes, which\r\ntouch a number of files but are quite small, and a small set\r\nof test changes. Undoubtedly we need more tests, but they\r\ntake a while to write and maintain so suggestions about\r\nparticularly high-value tests to write would be appreciated.\r\n\r\nIn my particular environment, I don't have a large amount\r\nof computing horsepower, so I've only run a subset of the\r\ntests. In particular, I've run o.a.dT.functionTests.tests.lang._Suite with zero errors.\r\n\r\nIf anyone has the time/resources to run other regression\r\ntests with this patch, that would be very nice.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-29T17:09:59.538+0000","updated":"2013-06-29T17:09:59.538+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13696157","id":"13696157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"By the way, it's not obvious to me that this is a \"regression\", strictly speaking, since\r\nit's not clear that the xplain-only mode ever worked (though I didn't go back to the\r\n2006-era code to check that out thoroughly). I think this was broken when I first\r\nchecked it in. It might well have worked in the original research which resulted\r\nin the XPLAIN contribution, but have broken sometime between when the original\r\nresearch was done and when I ported it over to the Derby trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-06-29T17:12:45.269+0000","updated":"2013-06-29T17:12:45.269+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13696675","id":"13696675","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks for the patch, Bryan. I'll start a run with the full regression test suite on it.\r\n\r\nJust a small reminder: remember to run \"svn propset svn:eol-style native\" on the added files before you commit. (Might be worth adding https://www.apache.org/dev/svn-eol-style.txt to your subversion config so that the property is set automatically for many file types at the time they are added with \"svn add\".)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-01T09:39:42.600+0000","updated":"2013-07-01T09:39:42.600+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13696697","id":"13696697","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I like that the patch introduces a local flag so that the result set doesn't have to go through the LCC and check if xplain is enabled for every row it looks at. It might be a problem that the flag is set in the constructor, though. The constructor is only called the first time a PreparedStatement is executed, so it may cause some surprises if the same statement is used both with xplain mode enabled and disabled.\r\n\r\nExample ij session:\r\n\r\nij version 10.11\r\nij> connect 'jdbc:derby:memory:db;create=true';\r\nij> prepare ps1 as 'values ''Compiled before xplain mode was enabled''';\r\nij> execute ps1;\r\n1                                      \r\n---------------------------------------\r\nCompiled before xplain mode was enabled\r\n\r\n1 row selected\r\nij> call syscs_util.syscs_set_runtimestatistics(1);\r\n0 rows inserted/updated/deleted\r\nij> call syscs_util.syscs_set_xplain_schema('STATS');\r\n0 rows inserted/updated/deleted\r\nij> call syscs_util.syscs_set_xplain_mode(1);\r\n0 rows inserted/updated/deleted\r\nij> execute ps1;\r\n1                                      \r\n---------------------------------------\r\n\r\n0 rows selected\r\nij> prepare ps2 as 'values ''Compiled when xplain mode was enabled''';\r\nij> execute ps2;\r\n1                                    \r\n-------------------------------------\r\n\r\n0 rows selected\r\nij> call syscs_util.syscs_set_runtimestatistics(0);\r\n0 rows inserted/updated/deleted\r\nij> call syscs_util.syscs_set_xplain_schema('');\r\n0 rows inserted/updated/deleted\r\nij> call syscs_util.syscs_set_xplain_mode(0);\r\n0 rows inserted/updated/deleted\r\nij> execute ps1;\r\n1                                      \r\n---------------------------------------\r\nCompiled before xplain mode was enabled\r\n\r\n1 row selected\r\nij> execute ps2;\r\n1                                    \r\n-------------------------------------\r\n\r\n0 rows selected\r\nij> \r\n\r\n\r\nThe statement that was compiled before xplain was enabled actually behaved as desired. It returned results if xplain mode was disabled, and returned empty results if it was enabled. I think this statement works because BasicNoPutResultSetImpl.getNextRow() still checks the LCC instead of the local flag. (Note: this was in getNextRow(), not in getNextRowCore().)\r\n\r\nThe statement that was compiled when xplain was enabled, on the other hand, continued returning empty results even after xplain had been disabled. I think it would be more reasonable if it had returned results after disabling xplain mode.\r\n\r\nI think it might work better if the flag is initialized in open() instead of the constructor.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-01T10:20:42.479+0000","updated":"2013-07-01T10:20:42.479+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13696712","id":"13696712","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Derbyall and suites.All ran cleanly with the patch in my environment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-01T10:47:30.460+0000","updated":"2013-07-01T10:47:30.460+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13696828","id":"13696828","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Good catch on the PreparedStatement issue. In practice, I imagine\r\nthat Xplain-Only mode is only likely to be used in special debugging\r\nsituations, not in production applications, so it seems uncommon that\r\nan application would routinely be switching it on and off.\r\n\r\nBut I can see that in many situations it might be easiest for an\r\napplication writer to insert the Xplain-Only requests into an existing\r\napplication in a way that mimics the scenarios you outline, so we\r\nshould try to give these patterns of use reasonable behaviors.\r\n\r\nPerhaps I should set the flag in both locations: in the constructor,\r\nand again in open(). I don't think it's an expensive check to make.\r\n\r\nI'll update the patch with some additional tests using PreparedStatements.\r\n\r\nAnd thanks for the testing, and for the catch on the eol-style; this\r\nis a new machine and I missed that part.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-07-01T14:00:55.314+0000","updated":"2013-07-01T14:00:55.314+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13697506","id":"13697506","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"I added several tests of the behavior with PreparedStatements.\r\n\r\nI'm not sure I understand the behavior completely. But the\r\ncurrent behavior may be acceptable, for now; at least it\r\ndoesn't crash.\r\n\r\nIn addition to the new tests, I also added code to set the\r\nisXplainOnlyMode member variable in BasicNoPutResultSetImpl\r\n\r\nAs Knut Anders observed, it's not completely obvious where\r\nthat variable should be set. Candidate locations include: the\r\nconstructor, the open() method, the reopen() method, and\r\nperhaps other places.\r\n\r\nThe isXplainOnlyMode variable appears to be holding the\r\nexpected value, but the behavior of complex ResultSet\r\ntrees is intricate and indicates I may not have the right\r\nlocation for this code yet.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-07-02T05:03:25.866+0000","updated":"2013-07-02T05:03:25.866+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13697864","id":"13697864","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"It might be that caching the xplain-only flag is premature optimization, and that it would be better in the first increment to check the flag via the lcc on each call to getNextRowCore(). I'd expect that to make it easier to get the correct behaviour and write tests whose results are easier to understand. When we have well-behaved tests for the feature, it may be easier to introduce optimizations later without breaking anything.\r\n\r\nThe patch attempts to reset the flag in the reopenCore() method. It looks like many subclasses override that method without calling super.reopenCore(), so that may not be the most robust place for it.\r\n\r\nIf we are to cache the value in BasicNoPutResultSetImpl/NoPutResultSetImpl, I'm wondering if it might be better if the flag has three possible values: true, false, unknown. The flag is initialized to unknown in the constructor. If getNextRowCore() sees that it is unknown, it initializes by looking up the value in the lcc. The flag could be reset to unknown in close(). (Of course, it still has the weakness that subclasses that override close() must remember to call super.close(), but at least that requirement is called out in NoPutResultSetImpl.close()'s javadoc comment, so it's a bug if a class doesn't already do that.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-02T15:10:05.387+0000","updated":"2013-07-02T15:10:05.387+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13701483","id":"13701483","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Attached 'noMemberField.diff' patch proposal follows the\r\nsuggestion made by Knut Anders: this patch does not attempt\r\nto remember the xplainOnly mode in a local variable.\r\n\r\nWith this patch, prepared statements behave in a reasonable\r\nmanner, obeying the xplainOnly mode even when it is switched\r\non and off without re-preparing the statement.\r\n\r\nExisting tests are all passing with this patch, as well as the\r\nnew tests added by the patch, so I think I'm starting to get close.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-07-07T02:46:57.880+0000","updated":"2013-07-07T02:46:57.880+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13703068","id":"13703068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Tests passed in my environment too. The patch looks fine to me. +1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-09T08:52:52.536+0000","updated":"2013-07-09T08:52:52.536+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13707754","id":"13707754","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1502795 from [~bryanpendleton]\r\n[ https://svn.apache.org/r1502795 ]\r\n\r\nDERBY-6216: XPLAIN feature does not work, gives XCL16: ResultSet not open\r\n\r\nThis change adjusts the implementation of the explain-only mode feature,\r\nwhich is enabled via syscs_util.syscs_set_xplain_mode(1).\r\n\r\nPrior to this change, the implementation short-circuited the open() method\r\nof the ResultSet classes, causing the execution engine to terminate\r\nimmediately because the result sets were not open.\r\n\r\nThis change takes an alternate approach, suggested by Knut Anders: the open()\r\nis allowed to proceed normally, but we short-circuit the getNextRow()\r\nmethod of the ResultSet classes. This way, the result sets all appear to be\r\nnormal result sets, open and ready for business, but they do no work and\r\nalways produce an empty result.\r\n\r\nThen, at the end of the execution, the statistics are gathered. They show\r\nthat no work was done, but they contain information about the overall \"shape\"\r\nof the query plan (which result sets were constructed, and what the overall\r\nresult set tree looks like).\r\n\r\nWe also discovered that we were completely missing regression tests for the\r\nexplain-only feature, so this change adds a handful of regression tests,\r\nincluding an IJ-based test, a simple embedded query, and a test that verifies\r\nthat explain-only mode can be turned on and off between executions of a\r\nprepared query.\r\n\r\nMore testing would clearly be beneficial, but this should at least give us\r\na feature that basically works.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-07-13T15:02:43.790+0000","updated":"2013-07-13T15:02:43.790+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13707755","id":"13707755","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks all for the help, suggestions, and feedback.\r\n\r\nI think this patch is good enough to share with the community,\r\nand we can continue to improve the feature with additional\r\npatches subsequently.\r\n\r\nCommitted to the trunk as revision 1502795.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-07-13T15:05:16.012+0000","updated":"2013-07-13T15:05:16.012+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13708312","id":"13708312","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"It looks like there is an instability in one of the new test cases:\r\n\r\nhttp://download.java.net/javadesktop/derby/javadb-5579342-report/javadb-task-3689858.html\r\n\r\n    junit.framework.AssertionFailedError: Column value mismatch @ column '1', row 1:\r\n    Expected: >1<\r\n    Found:    >2<\r\n\tat org.apache.derbyTesting.junit.JDBC.assertRowInResultSet(JDBC.java:1278)\r\n\tat org.apache.derbyTesting.junit.JDBC.assertRowInResultSet(JDBC.java:1190)\r\n\tat org.apache.derbyTesting.junit.JDBC.assertFullResultSetMinion(JDBC.java:1077)\r\n\tat org.apache.derbyTesting.junit.JDBC.assertFullResultSet(JDBC.java:1000)\r\n\tat org.apache.derbyTesting.junit.JDBC.assertFullResultSet(JDBC.java:957)\r\n\tat org.apache.derbyTesting.junit.JDBC.assertFullResultSet(JDBC.java:915)\r\n\tat org.apache.derbyTesting.junit.JDBC.assertSingleValueResultSet(JDBC.java:900)\r\n\tat org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.testSimpleXplainOnly(XplainStatisticsTest.java:1148)\r\n\tat org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:117)\r\n\tat org.apache.derbyTesting.junit.BaseJDBCTestCase.runBareOverridable(BaseJDBCTestCase.java:439)\r\n\tat org.apache.derbyTesting.junit.BaseJDBCTestCase.runBare(BaseJDBCTestCase.java:456)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:21)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:25)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:21)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:25)\r\n\tat org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-15T08:37:49.572+0000","updated":"2013-07-15T08:37:49.572+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13708474","id":"13708474","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks for catching this. What do you think is the simplest way to reproduce this failure?\r\n\r\nI expect that the code in enableXplainStyle which clears out all the statistics from the\r\nprevious test case is somehow failing to clear out the old values:\r\n\r\n        for (int i = 0; i < tableNames.length; i++)\r\n            if (hasTable(s, \"XPLTEST\", tableNames[i]))\r\n                s.execute(\"delete from XPLTEST.\" + tableNames[i]);\r\n\r\nBut beyond that, I'm not sure what's wrong.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-07-15T14:00:24.302+0000","updated":"2013-07-15T14:00:24.302+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13708550","id":"13708550","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I managed to reproduce it in my environment.\r\n\r\nI changed the suite method so that it only ran the testSimpleXplainOnly test case. That is, I replaced\r\n\r\n            TestSuite allTests = new TestSuite(XplainStatisticsTest.class,\r\n                                    \"XplainStatisticsTest\");\r\n\r\nwith\r\n\r\n            Test allTests = new XplainStatisticsTest(\"testSimpleXplainOnly\");\r\n\r\nThen I ran the test 20 times, and it failed 17 times. So it looks like it can be reproduced, but not 100% reliably. This was with Java 7u25, 64-bit, on Linux.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-15T15:36:06.190+0000","updated":"2013-07-15T15:36:06.190+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13708578","id":"13708578","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I added a call to dumpStatements() right before the failing assert. This is what it printed (the getSchemas statement is unexpected):\r\n\r\nc9d6825c-013f-e304-f57a-000058ee2be7,null,   ,EXECUTE STATEMENT SYS.\"getSchemas\",8,Linux,F,2013-07-15 17:48:43.56,Thread[main,5,main],13846,3,wombat,null,null\r\nc70a4272-013f-e304-f57a-000058ee2be7,2,S  ,select sql_text from syscs_diag.transaction_table where status != 'IDLE',8,Linux,O,2013-07-15 17:48:43.583,Thread[main,5,main],13846,3,wombat,null,null","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-15T16:02:14.572+0000","updated":"2013-07-15T16:02:14.572+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13709386","id":"13709386","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"I don't seem to have your touch, unfortunately; I ran the test 100 times on my\r\nenvironment without a single failure. This is with Java 7, 64 bit, on Windows 8,\r\nwhich is the only environment I have access to right now for running Derby.\r\n\r\nThere don't seem to be any direct calls to getSchemas in XplainStatisticsTest,\r\nso the call must be made from some other code.\r\n\r\nI found one call in CleanDatabaseTestSetup.removeObjects(), which seems\r\nlike a possibility since XplainStatisticsTest uses a CleanDatabaseTestSetup\r\ndecorator in its suite.\r\n\r\nSince it reproduces for you with some regularity, can you try putting\r\n\r\n    new Exception(\"How did I get here\").printStackTrace();\r\n\r\ninto EmbedDatabaseMetaData.getSchemas(String catalog, String schemaPattern)\r\nand paste in the stack trace that shows how we are getting to that getSchemas call?\r\n\r\nthanks,\r\n\r\nbryan\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-07-16T02:24:38.572+0000","updated":"2013-07-16T02:24:38.572+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13709787","id":"13709787","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Dag reported on derby-dev that a similar, but not identical, failure occurred last night:\r\n\r\n-------- Original Message --------\r\nSubject: Re: [Java DB - testing] Failure nightly trunk (rev 1503157)\r\nDate: Tue, 16 Jul 2013 14:45:41 +1000\r\nFrom: Dag Wanvik <dag.wanvik@oracle.com>\r\n\r\nIntermittent, it seems (last night:\r\nhttp://download.java.net/javadesktop/derby/javadb-5579365-report/)\r\n\r\nThanks,\r\nDag\r\n\r\norg.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.testSimpleXplainOnly    \r\n2.437 s\r\n\r\n junit.framework.AssertionFailedError: Column value mismatch @ column\r\n'1', row 1:\r\n Expected: >4<\r\n Found:    >7<\r\n    at\r\norg.apache.derbyTesting.junit.JDBC.assertRowInResultSet(JDBC.java:1278)\r\n    at\r\norg.apache.derbyTesting.junit.JDBC.assertRowInResultSet(JDBC.java:1190)\r\n    at\r\norg.apache.derbyTesting.junit.JDBC.assertFullResultSetMinion(JDBC.java:1077)\r\n    at\r\norg.apache.derbyTesting.junit.JDBC.assertFullResultSet(JDBC.java:1000)\r\n    at org.apache.derbyTesting.junit.JDBC.assertFullResultSet(JDBC.java:957)\r\n    at org.apache.derbyTesting.junit.JDBC.assertFullResultSet(JDBC.java:915)\r\n    at\r\norg.apache.derbyTesting.junit.JDBC.assertSingleValueResultSet(JDBC.java:900)\r\n    at\r\norg.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.testSimpleXplainOnly(XplainStatisticsTest.java:1183)\r\n    at\r\norg.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:117)\r\n    at\r\norg.apache.derbyTesting.junit.BaseJDBCTestCase.runBareOverridable(BaseJDBCTestCase.java:439)\r\n    at\r\norg.apache.derbyTesting.junit.BaseJDBCTestCase.runBare(BaseJDBCTestCase.java:456)\r\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\r\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:21)\r\n    at junit.extensions.TestSetup.run(TestSetup.java:25)\r\n    at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\r\n    at junit.extensions.TestSetup$1.protect(TestSetup.java:21)\r\n    at junit.extensions.TestSetup.run(TestSetup.java:25)\r\n    at\r\norg.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\r\n\r\n\r\nOn 16.07.2013 10:53, ingemar.aberg@oracle.com wrote:\r\n> Java DB testing and reporting infrastructure.\r\n>\r\n> Failure nightly trunk (rev 1503157)\r\n>\r\n> There were 1 failures.\r\n>\r\n> Test report: \r\nhttp://download.java.net/javadesktop/derby/javadb-5579365-report/\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-07-16T13:52:51.178+0000","updated":"2013-07-16T13:52:51.178+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13711077","id":"13711077","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"The SYSCS_SET_XPLAIN_SCHEMA system procedure contains a getSchemas() call.\r\n\r\nAnd XplainStatisticsTest calls that system procedure regularly.\r\n\r\nSo there must be some reason why the new test cases, intermittently, cause that\r\ngetSchemas() call to capture its runtime statistics into the XPLAIN tables.\r\n\r\nI'll have to keep thinking about this...\r\n\r\nPerhaps we should open a new JIRA to track the intermittent test failure.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2013-07-17T13:33:08.990+0000","updated":"2013-07-17T13:33:08.990+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13712198","id":"13712198","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I've filed DERBY-6297 for the intermittent test failure.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-07-18T10:27:30.423+0000","updated":"2013-07-18T10:27:30.423+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13736906","id":"13736906","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Should this be backported to 10.10? It would be good to have the feature work, but it does look like a significant change and comes with an intermittent test failure.  I appreciate opinions on whether it makes sense to try to backport.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2013-08-12T14:33:51.569+0000","updated":"2013-08-12T14:33:51.569+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13913296","id":"13913296","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"consider for 10.10 backport","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2014-02-26T18:43:46.726+0000","updated":"2014-02-26T18:43:46.726+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13914910","id":"13914910","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"Since the last comment by kathey it looks like the intermittent failures have been fixed and backported\r\nto 10.10.  Anyone have opinions if we should put this change into the upcoming 10.10 point release.\r\nI lean toward not backporting as the amount of changes are more of the level of a feature than a fix, but \r\nnow that there do not seem to be test issues if someone felt strongly that this should be put into 10.10 I \r\nwould not stand in the way.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2014-02-27T19:13:32.583+0000","updated":"2014-02-27T19:13:32.583+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13914933","id":"13914933","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"body":"It really is a bug fix and not a feature.  The documentation said the feature was there in the earlier releases but they did not work and produced an error.   So no we have a fix with an intermittent test failure.  I really don't think it is any worse than it was before (not working at all) and as long as the other tests run seem to be unaffected by this (other than the intermittent test failure), I don't think the risk is too great.\r\n\r\nThe feature is extremely useful when trying to analyze performance of queries where the is a very large amount of data to be processed.  Without the feature, I had to wait many hours (the query was running a bad plan) just to see that it was choosing a bad plan.  \r\n\r\nOf course this is just my opinion :)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"created":"2014-02-27T19:22:26.849+0000","updated":"2014-02-27T19:22:26.849+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13915135","id":"13915135","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I think it would be good to have this working in the next release of 10.10. I don't much care backporting it further. The XPLAIN functionality was actually added in 10.6.\r\nIf we do backport this, we should make sure the tests get backported too - looks like that part of DERBY-6297 was *not* backported to the 10.10 branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2014-02-27T22:37:39.575+0000","updated":"2014-02-27T22:37:39.575+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13918404","id":"13918404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I will take a look at backporting this to 10.10. Reopening and assigning to myself for now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2014-03-03T18:44:29.328+0000","updated":"2014-03-03T18:44:29.328+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13918742","id":"13918742","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1573813 from [~myrna] in branch 'code/branches/10.10'\r\n[ https://svn.apache.org/r1573813 ]\r\n\r\nDERBY-6216; XPLAIN feature does not work and gives ERROR XCL16: ResultSet not open\r\n   backport of revision 1502795 from trunk; \r\n   clean merge, but added modifications to XplainStatisticsTest from revision 1518111 (DERBY-6297) not previously backported.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2014-03-03T23:43:48.526+0000","updated":"2014-03-03T23:43:48.526+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/13921272","id":"13921272","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Backport to 10.10 branch complete. Resolving again, resetting assignee.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2014-03-05T19:28:36.684+0000","updated":"2014-03-05T19:28:36.684+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12646605/comment/14284820","id":"14284820","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"bulk change to close all issues resolved but not closed and not changed since June 1, 2014.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2015-01-21T00:23:33.828+0000","updated":"2015-01-21T00:23:33.828+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-6216/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1kenj:"}}