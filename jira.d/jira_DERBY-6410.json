{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12678190","self":"https://issues.apache.org/jira/rest/api/latest/issue/12678190","key":"DERBY-6410","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326753","id":"12326753","description":"head of 10.10 branch","name":"10.10.2.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324243","id":"12324243","description":"First release on the 10.11 branch","name":"10.11.1.1","archived":false,"released":true,"releaseDate":"2014-08-26"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2013-11-08 14:05:12.357","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"357565","customfield_12310222":"3_*:*_1_*:*_2679170182_*|*_1_*:*_1_*:*_12705730091_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2014-05-05T11:37:18.465+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-6410/watchers","watchCount":6,"isWatching":false},"created":"2013-11-08T10:02:18.261+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316344","id":"12316344","description":"First release on the 10.9 branch","name":"10.9.1.0","archived":false,"released":true,"releaseDate":"2012-06-25"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12384385","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12384385","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12699440","key":"DERBY-6503","self":"https://issues.apache.org/jira/rest/api/2/issue/12699440","fields":{"summary":"Starting network server on a network drive fails with JDK 7 on Windows","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12385051","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12385051","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12702580","key":"DERBY-6521","self":"https://issues.apache.org/jira/rest/api/2/issue/12702580","fields":{"summary":"Improve error handling when restricting file permissions","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-01-21T00:23:22.356+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11415","id":"11415","name":"Services"}],"timeoriginalestimate":null,"description":"When launching derby bundled with glassfish4 on a substed drive derby fails to startup and logs the following into the derby.log:\r\n\r\n{code}\r\nFri Nov 08 10:30:34 CET 2013 : Sicherheitsmanager mit einfacher Server-Sicherheitsrichtlinie installiert.\r\njava.lang.reflect.InvocationTargetException\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\r\n\tat java.lang.reflect.Method.invoke(Unknown Source)\r\n\tat com.sun.enterprise.admin.cli.optional.DerbyControl.invokeNetworkServerControl(DerbyControl.java:158)\r\n\tat com.sun.enterprise.admin.cli.optional.DerbyControl.main(DerbyControl.java:245)\r\nCaused by: java.lang.ExceptionInInitializerError\r\n\tat java.lang.Class.forName0(Native Method)\r\n\tat java.lang.Class.forName(Unknown Source)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.startNetworkServer(Unknown Source)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.blockingStart(Unknown Source)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.executeWork(Unknown Source)\r\n\tat org.apache.derby.drda.NetworkServerControl.main(Unknown Source)\r\n\t... 6 more\r\nCaused by: java.lang.ClassCastException: java.nio.file.FileSystemException cannot be cast to java.lang.RuntimeException\r\n\tat org.apache.derby.iapi.services.io.FileUtil.limitAccessToOwnerViaACLs(Unknown Source)\r\n\tat org.apache.derby.iapi.services.io.FileUtil.limitAccessToOwner(Unknown Source)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.PBmakeFileHPW(Unknown Source)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.run(Unknown Source)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.makeFileHPW(Unknown Source)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.createDefaultStream(Unknown Source)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.makeStream(Unknown Source)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.boot(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(Unknown Source)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startSystemModule(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.runWithState(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.FileMonitor.<init>(Unknown Source)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startMonitor(Unknown Source)\r\n\tat org.apache.derby.iapi.jdbc.JDBCBoot.boot(Unknown Source)\r\n\tat org.apache.derby.jdbc.EmbeddedDriver.boot(Unknown Source)\r\n\tat org.apache.derby.jdbc.EmbeddedDriver.<clinit>(Unknown Source)\r\n\t... 12 more\r\n{code}\r\n\r\nDerby was started via the glassfish command:\r\n{code}\r\n$ asadmin start-database\r\n{code}\r\n\r\nThe asadmin command only fails if it is launched from a substed windows drive. The substed drive was created with the following command:\r\n{code}\r\n$ subst d: c:\\d\r\n{code}\r\n\r\nWhen derby is started from drive 'C' everything is fine.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10365","value":"Crash","id":"10365"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"357855","summary":"ClassCastException when launching derby from windows subst drive","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ma300k","name":"ma300k","emailAddress":"markus dot peroebner at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Markus Peröbner","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10427","value":"Workaround attached","id":"10427"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ma300k","name":"ma300k","emailAddress":"markus dot peroebner at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Markus Peröbner","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Windows 7","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10053","value":"Low","id":"10053"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":9,"total":9,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/13817293","id":"13817293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I tried to start the network server on a substituted drive and saw the same ClassCastException. The original exception seems to be the following:\r\n\r\n{noformat}\r\njava.nio.file.FileSystemException: F:\\derby.log: The parameter is incorrect.\r\n\r\n\tat sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:86)\r\n\tat sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:97)\r\n\tat sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:102)\r\n\tat sun.nio.fs.WindowsFileStore.create(WindowsFileStore.java:92)\r\n\tat sun.nio.fs.WindowsFileSystemProvider.getFileStore(WindowsFileSystemProvider.java:498)\r\n\tat java.nio.file.Files.getFileStore(Files.java:1411)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:601)\r\n\tat org.apache.derby.iapi.services.io.FileUtil.limitAccessToOwnerViaACLs(FileUtil.java:824)\r\n\tat org.apache.derby.iapi.services.io.FileUtil.limitAccessToOwner(FileUtil.java:747)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.PBmakeFileHPW(SingleStream.java:205)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.run(SingleStream.java:401)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.run(SingleStream.java:72)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.makeFileHPW(SingleStream.java:394)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.createDefaultStream(SingleStream.java:356)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.makeStream(SingleStream.java:132)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.boot(SingleStream.java:92)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1991)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:334)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:541)\r\n\tat org.apache.derby.impl.services.monitor.FileMonitor.startModule(FileMonitor.java:44)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startSystemModule(Monitor.java:362)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.runWithState(BaseMonitor.java:343)\r\n\tat org.apache.derby.impl.services.monitor.FileMonitor.<init>(FileMonitor.java:58)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startMonitor(Monitor.java:285)\r\n\tat org.apache.derby.iapi.jdbc.JDBCBoot.boot(JDBCBoot.java:67)\r\n\tat org.apache.derby.jdbc.EmbeddedDriver.boot(EmbeddedDriver.java:199)\r\n\tat org.apache.derby.jdbc.EmbeddedDriver.<clinit>(EmbeddedDriver.java:95)\r\n\tat java.lang.Class.forName0(Native Method)\r\n\tat java.lang.Class.forName(Class.java:188)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.startNetworkServer(NetworkServerControlImpl.java:1032)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.blockingStart(NetworkServerControlImpl.java:732)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.executeWork(NetworkServerControlImpl.java:2277)\r\n\tat org.apache.derby.drda.NetworkServerControl.main(NetworkServerControl.java:353)\r\n{noformat}\r\n\r\nI also tried to start the network server from a network drive. That failed with a ClassCastException too, but the original exception was a different one:\r\n\r\n{noformat}\r\njava.nio.file.AccessDeniedException: \\\\clustra\\cluwin\\khatlen\\derby.log\r\n\tat sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:83)\r\n\tat sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:97)\r\n\tat sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:102)\r\n\tat sun.nio.fs.WindowsAclFileAttributeView.setAcl(WindowsAclFileAttributeView.java:221)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:601)\r\n\tat org.apache.derby.iapi.services.io.FileUtil.limitAccessToOwnerViaACLs(FileUtil.java:897)\r\n\tat org.apache.derby.iapi.services.io.FileUtil.limitAccessToOwner(FileUtil.java:747)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.PBmakeFileHPW(SingleStream.java:205)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.run(SingleStream.java:401)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.run(SingleStream.java:72)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.makeFileHPW(SingleStream.java:394)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.createDefaultStream(SingleStream.java:356)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.makeStream(SingleStream.java:132)\r\n\tat org.apache.derby.impl.services.stream.SingleStream.boot(SingleStream.java:92)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:1991)\r\n\tat org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:334)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:541)\r\n\tat org.apache.derby.impl.services.monitor.FileMonitor.startModule(FileMonitor.java:44)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startSystemModule(Monitor.java:362)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.runWithState(BaseMonitor.java:343)\r\n\tat org.apache.derby.impl.services.monitor.FileMonitor.<init>(FileMonitor.java:58)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startMonitor(Monitor.java:285)\r\n\tat org.apache.derby.iapi.jdbc.JDBCBoot.boot(JDBCBoot.java:67)\r\n\tat org.apache.derby.jdbc.EmbeddedDriver.boot(EmbeddedDriver.java:199)\r\n\tat org.apache.derby.jdbc.EmbeddedDriver.<clinit>(EmbeddedDriver.java:95)\r\n\tat java.lang.Class.forName0(Native Method)\r\n\tat java.lang.Class.forName(Class.java:188)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.startNetworkServer(NetworkServerControlImpl.java:1032)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.blockingStart(NetworkServerControlImpl.java:732)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.executeWork(NetworkServerControlImpl.java:2277)\r\n\tat org.apache.derby.drda.NetworkServerControl.main(NetworkServerControl.java:353)\r\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-11-08T14:05:12.357+0000","updated":"2013-11-08T14:05:12.357+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/13865986","id":"13865986","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"not sure what component is failing here, setting system.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2014-01-08T22:29:41.512+0000","updated":"2014-01-08T22:29:41.512+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/13923953","id":"13923953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The problem with subst drives is probably this JDK bug: https://bugs.openjdk.java.net/browse/JDK-8034057\r\n\r\nThe problem with network drives seems to be something different. It might make sense to track the two problems separately. I've filed DERBY-6503 for the network drive issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2014-03-07T15:27:58.285+0000","updated":"2014-03-07T15:27:58.285+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/13937711","id":"13937711","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"The workaround for this issue is to turn off the extra file access controls for Windows platforms which are available on Java SE 7 and higher. To do that, set...\r\n\r\nderby.storage.useDefaultFilePermissions=true\r\n\r\n...as described here: http://db.apache.org/derby/docs/10.10/ref/rrefproperdefaultfileperms.html","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2014-03-17T11:57:00.002+0000","updated":"2014-03-17T11:57:00.002+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/13959882","id":"13959882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Even though the root cause of this bug is a JVM bug, I think it is possible to fix it in Derby.\r\n\r\nThe failing call is to Files.getFileStore(Path). We only need the FileStore instance in order to check if the specific FileAttributeView is supported on the file system (by calling FileStore.supportsFileAttributeView()). But this information can also be found by checking if Files.getAttributeFileView() returns null. Since we already call getAttributeFileView() to get the view, the calls to Files.getFileStore() and FileStore.supportsFileAttributeView() are redundant and can be removed.\r\n\r\nThe attached patch, d6410-1a.diff, removes the redundant calls. With the patch, I'm able to start the network server on a subst drive without getting an error, and the files created by the server instance have restricted file permissions. I've also successfully run RestrictiveFilePermissionsTest on a subst drive with the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2014-04-04T11:24:13.504+0000","updated":"2014-04-04T11:24:13.504+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/13961668","id":"13961668","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1585407 from kahatlen@apache.org in branch 'code/trunk'\r\n[ https://svn.apache.org/r1585407 ]\r\n\r\nDERBY-6410: ClassCastException when launching derby from windows subst drive\r\n\r\nAvoid calling Files.getFileStore() since it fails when called on a\r\nfile that lives on a subst drive. (Because of a bug in the JVM:\r\nJDK-8034057.)\r\n\r\nIt is used for checking if a specific FileAttributeView is supported\r\non the file system. The same information can be found by checking if\r\nFiles.getFileAttributeView() returns null, which we already do, so\r\nskip the failing call.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2014-04-07T06:59:10.582+0000","updated":"2014-04-07T06:59:10.582+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/13989411","id":"13989411","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The fix doesn't merge cleanly to 10.10, since 10.10 still uses reflection to access the java.nio.file API. The attached patch, d6410-backport.diff, is a manual backport of the fix. RestrictiveFilePermissionsTest runs cleanly on a subst drive with the patch. I'm running the full regression test suite now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2014-05-05T10:44:49.193+0000","updated":"2014-05-05T10:44:49.193+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/13989431","id":"13989431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1592486 from [~knutanders] in branch 'code/branches/10.10'\r\n[ https://svn.apache.org/r1592486 ]\r\n\r\nDERBY-6410: ClassCastException when launching derby from windows subst drive\r\n\r\nMerged revision 1585407 from trunk and manually resolved conflicts.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2014-05-05T11:37:02.468+0000","updated":"2014-05-05T11:37:02.468+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12678190/comment/14284789","id":"14284789","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"bulk change to close all issues resolved but not closed and not changed since June 1, 2014.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2015-01-21T00:23:22.346+0000","updated":"2015-01-21T00:23:22.346+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-6410/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1pn2n:"}}