{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"27486","self":"https://issues.apache.org/jira/rest/api/latest/issue/27486","key":"DERBY-7","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2004-12-21 09:20:11.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21710","customfield_12310222":"1_*:*_1_*:*_26867166000_*|*_6_*:*_4_*:*_8462862000_*|*_5_*:*_1_*:*_15180743000_*|*_4_*:*_3_*:*_15470000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-05-05T19:48:02.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-7/watchers","watchCount":5,"isWatching":false},"created":"2004-09-28T00:44:01.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10920","id":"10920","description":"initial source drop","name":"10.0.2.0","archived":false,"released":true,"releaseDate":"2004-08-30"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12313840","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12313840","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12353388","key":"DERBY-1967","self":"https://issues.apache.org/jira/rest/api/2/issue/12353388","fields":{"summary":"UNION (ALL) contraint violation problem","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-10-17T17:44:39.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"Reporting for Christian d'Heureuse, filed on derby-dev list.\n\nThe NULLIF built-in function of Cloudscape 10.0.1.0 beta seems to accept\nonly string values.\n\nExamples:\n\n values nullif('a','b');\n --> OK\n\n values nullif(1,2);\n --> Error message: \"ERROR 42X89: Types 'CHAR' and\n     'INTEGER' are not type compatible. (Neither type\n     is assignable to the other type.)\"\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40322","summary":"Bug in NULLIF Function","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tulika","name":"tulika","emailAddress":"tulika dot agrawal at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tulika Agrawal","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tulika","name":"tulika","emailAddress":"tulika dot agrawal at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tulika Agrawal","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":33,"total":33,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/56929","id":"56929","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"body":"\r\nThe following needs to be commented out in ConditionalNode.bindExpression() as a solution for NULLIF to accept INT\r\nIn trunk/java/engine/org/pacahe/derby/impl/sql/compile/ConditionalNode.java\r\n\r\n\r\n\r\n\t/* ALL COMMENTED OUT BELOW, NO NEED FOR FOLLOWING VALIDATION BETWEEN \r\n         * thenExpression and elseExpression\r\n\r\n\t\r\n        if (! thenExpression.getTypeCompiler().\r\n\t\t\t comparable(elseExpression.getTypeId(), false, getClassFactory()) &&\r\n\t\t\t! cu.assignableTo(thenExpression.getTypeId().getCorrespondingJavaTypeName(),\r\n\t\t\t\t\t\t\t  elseExpression.getTypeId().getCorrespondingJavaTypeName()) &&\r\n\t\t\t! cu.assignableTo(elseExpression.getTypeId().getCorrespondingJavaTypeName(),\r\n\t\t\t\t\t\t\t  thenExpression.getTypeId().getCorrespondingJavaTypeName()))\r\n\t\t{\r\n\t\t\tthrow StandardException.newException(SQLState.LANG_NOT_TYPE_COMPATIBLE, \r\n\t\t\t\t\t\tthenExpression.getTypeId().getSQLTypeName(),\r\n\t\t\t\t\t\telseExpression.getTypeId().getSQLTypeName()\r\n\t\t\t\t\t\t);\r\n\t\t\r\n}\r\n        * ALL COMMENTED OUT ABOVE\r\n        */\r\n\r\n\r\nAlso I have checked various cases where the following code if it is removed may cause problems.\r\nThe cases are:-\r\n\r\n1. An int and a char e.g. NULLIF(1,'pqr'); where pqr is a generic string and not a name of column.\r\nIt returns the message ERROR 42818: Comparisons between 'INTEGER' and 'CHAR' are not supported.\r\n\r\n2. An int and a column_name passed. If column_type and other expression are of same type, it works. If type of column_name passed and the other expression are of differrent types it fails with a proper message ERROR 42818: Comparisons between 'INTEGER' and 'CHAR' are not supported.\r\ni.e it works between type compatible expressions.\r\n\r\nI will submit a patch soon.\r\n\r\nKindly verify and post any comments to this proposed solution.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"created":"2004-12-21T09:20:11.000+0000","updated":"2004-12-21T09:20:11.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/56932","id":"56932","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"body":"After commenting out these lines in ConditionalNode.bindExpression(), what data types are returned from the following expressions?\r\n\r\n nullif(1,2)\r\n nullif(cast(null as int),2)\r\n\r\nThese expressions should return INTEGER and not CHAR!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"created":"2004-12-21T10:56:56.000+0000","updated":"2004-12-21T10:56:56.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/56962","id":"56962","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"body":"It returns for \r\n\r\nnullif(1,2) --> returns 1\r\n\r\nnullif(cast(null as int),2) --> returns 0\r\n\r\nAlso it returns an int and not as a char. I took nullif() as one column of \r\nselect statement and it ResultSetMetaData returns java.sql.Types.INTEGER.\r\n\r\nFurther Oracle works in same way.\r\n\r\n\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"created":"2004-12-22T10:12:42.000+0000","updated":"2004-12-22T10:12:42.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/56969","id":"56969","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"body":"> nullif(cast(null as int),2) --> returns 0\r\n\r\nShould return 2?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"created":"2004-12-22T13:49:33.000+0000","updated":"2004-12-22T13:49:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/56977","id":"56977","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"body":"Sorry, ignore my previous comment. I had mistaken nullif() with isnull/coalesce().\r\n\r\nThe expression\r\n values nullif(1,1)\r\nshould return the value\r\n cast(null as int)\r\n\r\nIn sqlgrammar.jj there is the following comment:\r\n// \"NULLIF(L, R)\" is the same as \"L=R ? CAST(NULL AS CHAR(1)) : L\"\r\n\r\nI think the problem is:\r\n thenExpression = CAST(NULL AS CHAR(1)) = type CHAR\r\n elseExpression = L = type INT\r\n==> CHAR and INT are not compatible.\r\n\r\nTo solve this problem, the data type of L (leftExpression) could be used to build the NULL constant node, instead of CHAR(1).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"created":"2004-12-22T15:23:18.000+0000","updated":"2004-12-22T15:23:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/56992","id":"56992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"Good observations... The defect has been around for sometime, but I think suggested fix by commenting out code in ConditionalNode is incorrect. If I remember right, that caused other issues.\r\n\r\nSince there has been some interest in fixing this defect, I can volunteer to look at possible fix. Christian suggestion seems to be in the right direction, but I need to do more research.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2004-12-22T19:14:37.000+0000","updated":"2004-12-22T19:14:37.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57001","id":"57001","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"body":"I don't think so I have seen anything on issues with Nullif on the mailing lists.\r\nCan you elaborate more on what are the issues ?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"created":"2004-12-23T02:05:43.000+0000","updated":"2004-12-23T02:05:43.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57068","id":"57068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"body":"Before I comment on Christian's note, we need to read what nullif definition says at link below :- \r\nhttp://incubator.apache.org/derby/manuals/reference/sqlj66.html#IDX910\r\n\r\nQuoting from the above link is the next one line \r\n\r\nFor built-in types, this means that the types must be the same or a built-in broadening conversion must exist between the types.\r\n\r\nSo if we have say a CHAR and an INT to compare in NULLIF, the CHAR('1') will have a built in broadening and Hence get converted to INT(1)\r\n\r\n\r\n> The expression\r\n> values nullif(1,1)\r\n> should return the value\r\n> cast(null as int)\r\n\r\nI agree with Christian here.  \r\n\r\n> In sqlgrammar.jj there is the following comment:\r\n> // \"NULLIF(L, R)\" is the same as \"L=R ? CAST(NULL AS CHAR(1)) : L\"\r\n\r\nAlso to note was the next line after that in the same file, which says\r\n\r\n// An impl assumption here is that Cloudscape can promote CHAR to any comparable datatypes such as numeric\r\n\r\n\r\n> I think the problem is:\r\n> thenExpression = CAST(NULL AS CHAR(1)) = type CHAR\r\n> elseExpression = L = type INT\r\n> ==> CHAR and INT are not compatible.\r\n\r\nI disagree here. Rather it is this way\r\n\r\nthenExpression = CAST(NULL AS CHAR(1)) = type CHAR\r\n elseExpression = L = type INT\r\ncheck type of INT and CHAR, Since not compatible, \r\npromote CHAR to INT(built in broadening), \r\ncompare INT and INT and do the comparison\r\n==> return INT\r\n\r\nNote that \r\nCAST(NULL as Char(1)) WIll return CHAR\r\n\r\nBUT in below\r\nNULLIF(CAST(NULL as CHAR(1),1)\r\n\r\nthe CAST(NULL as CHAR(1) still returns 1 as CHAR \r\nbut gets converted to INT \r\nas soon as it has to be compared to an INT.\r\n\r\n\r\n\r\n>To solve this problem, the data type of L (leftExpression) could be used to build the NULL >constant node, instead of CHAR(1).\r\n\r\nThat is what is happenning, I hope the above helps in clarifying that\r\nelse I can explain that using code from ConditionalNode.bindExpression()\r\n\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"created":"2004-12-27T10:14:21.000+0000","updated":"2004-12-27T10:14:21.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57072","id":"57072","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"body":"I agree with the comments of Amit.\r\n\r\nThe following code in ConditionalNode.bindExpression() determines the result type of NULLIF():\r\n\r\n/*\r\n** Set the result type of this conditional to be the dominant type\r\n** of the result expressions.\r\n*/\r\nsetType(thenElseList.getDominantTypeServices());\r\n\r\nDataTypeDescriptor.getDominantType() returns the type with the higher typePrecedence value.\r\nThe typePrecedence values for CHAR and INT are defined in TypeId.java:\r\n CHAR_PRECEDENCE = 0\r\n INT_PRECEDENCE = 50\r\n\r\nSo the \"dominant\" type between CHAR(1) and INT is INT.\r\nThe result type of NULLIF() is set to INT.\r\nAt the end of bindExpression(), a CAST node is inserted into thenExpression, to convert the NULL constant from CHAR to INT.\r\n\r\n---\r\n\r\nIn ConditionalNode.bindExpression() there is the following comment:\r\n\r\n/*\r\n** If it is comparable, then we are ok.  Note that we\r\n** could in fact allow any expressions that are convertible()\r\n** since we are going to generate a cast node, but that might\r\n** be confusing to users...\r\n*/\r\n\r\nMaybe this explains the reason, why the type compatibility check (the one that Amit suggests to comment out) was added to bindExpression(): It \"might be confusing to users...\"?\r\n\r\nTo prevent this \"user confusion\", the term \"built-in broadening conversion\" should be clarified.\r\nWhat is a \"broadening conversion\"? Is the return value type of NULLIF() the \"broadened type\"?\r\nBut then, why is a conversion from CHAR to INT a \"broadening conversion\"? CHAR would be the \"broader\" type than INT. (All INT values can be converted to CHAR, but not all CHAR values can be converted to INT.)\r\nOr is the return type the \"narrower\" type?\r\n\r\nAn better solution would be to define that the result type of NULLIF() is the \"dominant\" type, which is the one that comes first in the following list:\r\nUSER-defined, BLOB, LONGVARBIT, VARBIT, BIT, BOOLEAN, TIME, TIMESTAMP, DATE, DOUBLE, REAL, DECIMAL, NUMERIC, LONGINT, INT, SMALLINT, TINYINT, REF, NATIONAL_LONGVARCHAR, NATIONAL_VARCHAR, NATIONAL_CHAR, CLOB, NCLOB, LONGVARCHAR, VARCHAR, CHAR.\r\nFor DECIMAL/NUMERIC types, scale and precision are broadened to matche both input types.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"created":"2004-12-27T15:00:22.000+0000","updated":"2004-12-27T15:00:22.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57076","id":"57076","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"There was a related bug that Derby tried to address before going OPEN SOURCE. \r\n\r\nij> values (case when 1.0=1.0 then null else 10 end);\r\nERROR 42X89: Types 'CHAR' and 'INTEGER' are not type compatible. (Neither type i\r\ns assignable to the other type.)\r\n\r\nThe above statement should have returned NULL instead. Don't remember who worked on that bug, but I might have mistaken this NULLIF issue with that one. I think issues here may be slightly different...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2004-12-27T21:55:39.000+0000","updated":"2004-12-27T21:55:39.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57077","id":"57077","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"body":"I think this is the same problem, because NULLIF() and CASE (whenThenExpression) both are implemented using CONDITIONAL_NODE.\r\n\r\nBut for CASE, the error can be avoided by using \"CAST(NULL as INT)\" instead of an untyped NULL:\r\n\r\n  values (case when 1.0=1.0 then cast(null as int) else 10 end);\r\n\r\nFor NULLIF() this is not possible.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"created":"2004-12-27T22:45:38.000+0000","updated":"2004-12-27T22:45:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57079","id":"57079","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jboynes","name":"jboynes","emailAddress":"jboynes at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Boynes","active":true},"body":"According to the SQL spec (ISO/IEC 9075-2:2003)\r\n\r\nNULLIF (V1, V2) is equivalent to the following <case specification>:\r\nCASE WHEN V1=V2 THEN NULL ELSE V1 END\r\n\r\nand \r\n\r\nThe declared type of a <case specification> is determined by applying Subclause 9.3, \"Data types of results of aggregations\", to the declared types of all <result expression>s in the <case specification>.\r\n\r\n9.3 is long but basically says that the type of the result will be the type of V1 as the type of NULL is undefined.\r\n\r\nAs part of this V1 and V2 must be comparable. Therefore, as I read it, NULLIF('a', 1) should raise an exception as 'a' cannot be converted to a numeric but NULLIF('1', 1) should return NULL with type CHAR(1) and NULLIF(1, '1') should return NULL with type INTEGER. Of course the type of NULL is fairly meaningless but it would have an impact if we were referencing columns instead.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jboynes","name":"jboynes","emailAddress":"jboynes at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Boynes","active":true},"created":"2004-12-28T01:05:14.000+0000","updated":"2004-12-28T01:05:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57082","id":"57082","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"body":"I think we agree on one thing for nullif(l,r),\r\nthe datatype of what is returned will be of type l.\r\n\r\nAlso\r\n\r\n The expression\r\n values nullif(1,1)\r\n should return the value\r\n cast(null as int) \r\n\r\ngives the same result as output.\r\n\r\nSome other things to note  \r\n\r\n1. nullif('a','b');\r\n2. nullif(1,2);\r\n\r\n3. nullif('a', 1);\r\n4. nullif(1, 'a');\r\n5. nullif(CAST(NULL as Char(1)), 1)\r\n6. nullif(1, CAST(NULL as Char(1)))\r\n\r\nOnly 1 and 2 work with the fix, rest all fail.\r\n\r\nSo kindly let me know if you guys approve the fix. \r\nIf not, kindly update what is missing which needs to be fixed or is not being fixed with the patch proposed.\r\n\r\nPlease do vote in favour or against with some justification.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"created":"2004-12-28T08:46:48.000+0000","updated":"2004-12-28T08:46:48.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57093","id":"57093","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"body":"I approve the fix and I agree that NULLIF(L,R) should return the data type of L (and does so with the fix).\r\n\r\nBut the proposed fix also affects the CASE expression.\r\n\r\n CASE WHEN BooleanExpression THEN thenExpression ELSE elseExpression END\r\n\r\nThe effect of the fix is that CASE accepts values that are not \"type compatible\" (for thenExpression and elseExpression), e.g. CHAR and INT.\r\nCASE returns the \"dominant\" type of thenExpression and elseExpression (see DataTypeDescriptor.getDominantType()). The \"dominant\" type is the one that comes first in the list {USER-defined, BLOB, LONGVARBIT, ... CHAR} (according to the typePrecedence constants in TypeId.java). For DECIMAL/NUMERIC types, scale and precision are broadened to matche both input types.\r\n\r\nThe documentation of NULLIF and CASE in the reference manual should be complemented.\r\nsee http://incubator.apache.org/derby/manuals/reference/sqlj66.html\r\nNULLIF is currently not explained at all.\r\nFor CASE, the formulation \"a built-in broadening conversion must exist\" should be extended and the data type of the result should be documented.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"created":"2004-12-28T17:00:34.000+0000","updated":"2004-12-28T17:00:34.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57096","id":"57096","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jboynes","name":"jboynes","emailAddress":"jboynes at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Boynes","active":true},"body":"The fix seems address the issue with non-CHAR types being used.\r\n\r\nHowever, it exposes a problem with binary comparisons where it is not possible to compare CHAR and INTEGER types:\r\n\r\nij> values(nullif('1', 1));\r\nERROR 42818: Comparisons between 'CHAR' and 'INTEGER' are not supported.\r\nij> values (case when '1' = 1 THEN 2 ELSE 3 END);\r\nERROR 42818: Comparisons between 'CHAR' and 'INTEGER' are not supported.\r\n\r\nI believe though that this is a separate issue affecting all comparisons.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jboynes","name":"jboynes","emailAddress":"jboynes at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Boynes","active":true},"created":"2004-12-28T18:09:32.000+0000","updated":"2004-12-28T18:09:32.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57450","id":"57450","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"body":"Submitting Patch as per discussion.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"created":"2005-01-10T16:57:39.000+0000","updated":"2005-01-10T16:57:39.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57487","id":"57487","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"Is anyone concerned that the proposed patch also accepts this:\r\n\r\nij> values (case when 1=2 then 5 else '6' end);\r\n1\r\n-----------\r\n6\r\n\r\nI think it shouldn't. I have a feeling we are not confirming to SQL standard (ISO/IEC 9075-2:2003) 9.3 section, 'Data types of results of aggregations' here.\r\n\r\nSatheesh\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2005-01-11T07:31:48.000+0000","updated":"2005-01-11T07:31:48.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57488","id":"57488","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"body":"> I have a feeling we are not confirming to SQL standard\r\n\r\nAre you referring to the syntax rule that states that all arguments \"shall\" be character strings, if any argument is character string?\r\n\r\n\"9075-2 9.3 Data types of results of aggregations\r\n...\r\nSyntax Rules\r\n3. a) If any of the data types in DTS is character string, then all data types in DTS shall be character string, ...\"\r\n\r\nThe term \"shall\" is defined as:\r\n\r\n\"9075-1 6.2.3.3 Terms denoting rule requirements\r\nIn the Syntax Rules, the term shall defines conditions that are required to be true of syntactically conforming SQL language. ...\r\nThe treatment of language that does not conform to the SQL Formats and Syntax Rules is implementation-dependent. ...\"\r\n\r\nThe conclusion is that the expression\r\n CASE WHEN ... THEN intValue ELSE charValue END\r\nis non-conforming SQL and may be processed in an implementation-dependent manner.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chdh%40inventec.ch","name":"chdh@inventec.ch","emailAddress":"chdh at inventec dot ch","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Christian d'Heureuse","active":true},"created":"2005-01-11T08:26:32.000+0000","updated":"2005-01-11T08:26:32.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/57721","id":"57721","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jboynes","name":"jboynes","emailAddress":"jboynes at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Boynes","active":true},"body":"A larger patch that also deals with the use of untyped NULLs in CASE statements. This allows NULLIF to be implemented as (CASE WHEN L=R THEN NULL ELSE L END). Adds a new testcase for various CASE statements and has been tested with the derbylang suite on WinXP/Sun JVM 1.4.2.\r\n\r\nThis patch also checks that the values returned by the different branches are compatible using the same check as the COALESCE function. Not sure if this is right, but at least it will be consistent. It might be worth exploring if COALESCE can be implemented as a large CASE statement.\r\n\r\nIt also reuses the SQLState codes for a couple of errors as I am not sure of the policy for changing the associated text or adding new ones.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jboynes","name":"jboynes","emailAddress":"jboynes at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Boynes","active":true},"created":"2005-01-19T00:57:51.000+0000","updated":"2005-01-19T00:57:51.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12313328","id":"12313328","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I have been working on this bug for a little while and have a patch which I think resolves issues with NULLIF. Please find the patch Derby7NullIf061005svndiff.txt attached to this bug. \r\n\r\nFollowing is a brief description of what the proposed fix involves.\r\nFor NULLIF(L,R), parser will generate CASE L=R then untyped NULL else L. Notice that the NULL does not have any type associated with it during parsing. This change went into sqlgrammar.jj\r\nThe existing code in ConditionalNode.bindExpression first binds the condition L=R. At the end of L=R condition binding, we will have determined the type of operand L. I have added cod into ConditionalNode to CAST untyped NULL to the type of L. The exisiting code for L=R binding enforces the Reference Guide Table 1. Comparisons allowed by Derby on page 111 and 112. So answers for what datatypes can be combined in NULLIF can be explained by that table.\r\nI have added some tests to see what the return type of NULLIF would be for various combinations of :L and R datatypes. I have also added test cases where the first operand to NULLIF is a parameter.\r\n\r\nAll the tests pass except one failure below which I don't think is related to my changes\r\n*** Start: miscerrors jdk1.4.2_07 derbyall:derbylang 2005-06-10 01:43:31 ***\r\n35 del\r\n< xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |92             |0              | wombat                                                                                                                         | null                                             |Cleanup action starting                                                                                                         \r\n36 del\r\n< xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |92             |0              | wombat                                                                                                                         | null                                             |Failed Statement is: --                                                                                                         \r\n37 del\r\n< xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |97             |0              | wombat                                                                                                                         | null                                             |Cleanup action starting                                                                                                         \r\n38 del\r\n< xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |97             |0              | wombat                                                                                                                         | null                                             |Failed Statement is: create table a (one int, two int)                                                                          \r\n39 del\r\n< xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |100            |0              | wombat                                                                                                                         | null                                             |Cleanup action starting                                                                                                         \r\n40 del\r\n< xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |100            |0              | wombat                                                                                                                         | null                                             |Failed Statement is: create table a (one int)                                                                                   \r\n40a35,40\r\n> xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |91             |0              | wombat                                                                                                                         | null                                             |Cleanup action starting                                                                                                         \r\n> xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |91             |0              | wombat                                                                                                                         | null                                             |Failed Statement is: --                                                                                                         \r\n> xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |96             |0              | wombat                                                                                                                         | null                                             |Cleanup action starting                                                                                                         \r\n> xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |96             |0              | wombat                                                                                                                         | null                                             |Failed Statement is: create table a (one int, two int)                                                                          \r\n> xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |99             |0              | wombat                                                                                                                         | null                                             |Cleanup action starting                                                                                                         \r\n> xxxxxxFILTERED-TIMESTAMPxxxxx|main,5,main                             |99             |0              | wombat                                                                                                                         | null                                             |Failed Statement is: create table a (one int)                                                                                   \r\nTest Failed.\r\n*** End:   miscerrors jdk1.4.2_07 derbyall:derbylang 2005-06-10 01:43:48 ***\r\n\r\n\r\nOutput of svn stat\r\nM      java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\ConditionalNode.java\r\nM      java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\sqlgrammar.jj\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\lang\\coalesceTests.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\jdbcapi\\resultset.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\DerbyNet\\resultset.out\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\DerbyNetClient\\resultset.out\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\resultset.out\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2005-06-11T05:57:14.000+0000","updated":"2005-06-11T05:57:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12317454","id":"12317454","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Adding a new patch to the bug named derby7Nullif080205svndiff.txt since the old patch has gotten out of sync.\r\n\r\nsvn stat has remain unchanged since the last patch and the changes are also the same as the last patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2005-08-03T06:47:13.000+0000","updated":"2005-08-03T06:47:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12317554","id":"12317554","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"I submitted this patch to trunk. I noticed a build.xml file was changed under iapi/types directory that didn't look related to this bug, so I didn't submit that change. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2005-08-04T09:44:18.000+0000","updated":"2005-08-04T09:44:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12317633","id":"12317633","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"The build.xml change didn't belong to this patch as Satheesh guessed. Thanks for catching it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2005-08-04T23:50:07.000+0000","updated":"2005-08-04T23:50:07.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12363673","id":"12363673","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"I verified that the initial reported error no longer occurs, but the discussion for this issue is somewhat volumnious and several other (potential) problems are mentioned.\r\nCould someone with more knowledge about this field confirm that this issue is fixed and that no more work is to be done on it?\r\nIf true, please close the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2006-01-23T23:03:09.000+0000","updated":"2006-01-23T23:03:09.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12364192","id":"12364192","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Prior to submitting a patch for this issue, I had gone through all the activities on this issue in JIRA and on Derby mailing list. I don't think any outstanding issues are left on it, so I am marking this as closed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2006-01-27T16:42:30.000+0000","updated":"2006-01-27T16:42:30.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12377766","id":"12377766","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"body":"Merge to 10.1 branch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"created":"2006-05-04T17:55:14.000+0000","updated":"2006-05-04T17:55:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12377768","id":"12377768","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"body":"Committed revision 399657 on 10.1 branch\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"created":"2006-05-04T17:56:18.000+0000","updated":"2006-05-04T17:56:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12377769","id":"12377769","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"body":"Ooops.... lost the fixed 10.2....","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"created":"2006-05-04T17:57:30.000+0000","updated":"2006-05-04T17:57:30.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12377852","id":"12377852","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Hi Berndt,\r\n\r\nI happened to spot the following in your check-in for revision 399657 for the test jdbcapi/resultset.java:\r\n\r\n+                               } catch(SQLException ex){\r\n+                                       if (ex.getSQLState().equals(\"22005\")) {\r\n+                                               if (s.getBytes (i) != null)\r\n+                row.append(new String(s.getBytes(i)));\r\n+                                               else\r\n+                row.append(s.getBytes(i));\r\n+                                       } else throw ex; \r\n+                               }\r\n\r\nI think what has happened here is that you applied original patch of DERBY-7 to 10.1. \r\n\r\nHowever, the test resultset.java has since had some work done on it, and I'm specifically concerned that you may have missed the changes I worked on for DERBY-903, which were committed with revision 378337 and 379643. \r\n\r\nThis eliminates the use of the constructor 'new String(bytes[]), which is non-portable...It constructs a string by decoding the bytes using the default platform charset. This can lead to encoding related problems.  For this case, you should probably use the constructor that takes in the encoding. ie new String(byte[], String charsetname). \r\n\r\nCan you please rework this section of resultset.java to not use an encoding-safe mechanism? \r\nJust compare with the current 10.2 resultset.java...\r\n\r\nThx,\r\nMyrna","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-05-05T00:46:39.000+0000","updated":"2006-05-05T00:46:39.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12377889","id":"12377889","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Oops, at least one line in my previous comment is suffering from bad editing...I meant:\r\n\r\n\"Can you please rework this section of resultset.java to use an encoding-safe mechanism? \"\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-05-05T04:20:41.000+0000","updated":"2006-05-05T04:20:41.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12377982","id":"12377982","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"body":"Need to apply changes from DERBY-903 in 10.1 branch","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"created":"2006-05-05T15:31:55.000+0000","updated":"2006-05-05T15:31:55.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12378021","id":"12378021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"body":"Changes to java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultset.java as a result of DERBY-7 and DERBY-903 was applied in the oposite order on 10.1 compared to trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"created":"2006-05-05T19:45:47.000+0000","updated":"2006-05-05T19:45:47.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27486/comment/12378022","id":"12378022","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"body":"Committed revision 400066.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"created":"2006-05-05T19:48:30.000+0000","updated":"2006-05-05T19:48:30.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-7/votes","votes":6,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i079lr:"}}