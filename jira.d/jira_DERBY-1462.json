{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12345168","self":"https://issues.apache.org/jira/rest/api/latest/issue/12345168","key":"DERBY-1462","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-07-14 04:48:04.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22521","customfield_12310222":"1_*:*_1_*:*_2812701000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_24789181035","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-07-31T19:57:34.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1462/watchers","watchCount":0,"isWatching":false},"created":"2006-06-29T06:39:13.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12310615","id":"12310615","description":"","name":"10.1.2.1","archived":false,"released":true,"releaseDate":"2005-11-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-01T00:10:10.816+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"}],"timeoriginalestimate":null,"description":"The following store tests from derbyall do not shutdown cleanly so leave the db.lck file on disk.  This is OK! It is done by design to test recovery.  THE PROBLEM, when run on Linux using IBM JRE 1.3.1 sp 10 the test harness 'sees' the warnings and lists the tests as having failed.  The harness should ignore this warnings as the tests proceed and complete cleanly.\r\n\r\nTests INCORRECLTY reported as failed:\r\n\r\nderbyall/derbynetclientmats/derbynetmats.fail:stress/stress.multi\r\nderbyall/derbynetmats/derbynetmats.fail:stress/stress.multi\r\nderbyall/storeall/storeall.fail:storetests/st_1.sql\r\nderbyall/storeall/storeall.fail:unit/recoveryTest.unit\r\n erbyall/storeall/storeall.fail:store/LogChecksumRecovery.java\r\nderbyall/storeall/storeall.fail:store/LogChecksumRecovery1.java\r\n erbyall/storeall/storeall.fail:store/MaxLogNumberRecovery.java\r\nderbyall/storeall/storeall.fail:store/oc_rec1.java\r\nderbyall/storeall/storeall.fail:store/oc_rec2.java\r\nderbyall/storeall/storeall.fail:store/oc_rec3.java\r\nderbyall/storeall/storeall.fail:store/oc_rec4.java\r\nderbyall/storeall/storeall.fail:store/dropcrash.java\r\nderbyall/storeall/storeall.fail:store/dropcrash2.java\r\n\r\nExample Error message:\r\n\r\nWARNING: Derby (instance xxxxFILTERED-UUIDxxxx) is attempting to boot the database csf:/local1/131TST/Store1/storeall/storerecovery/storerecovery/wombat even though Derby (instance xxxxFILTERED-UUIDxxxx) may still be active.  Only one instance of Derby should boot a database at a time. Severe and non-recoverable corruption can result and may have already occurred.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38573","summary":"Test harness incorrectly catches db.lck WARNINGS generated during STORE tests and lists the tests as failed in *_fail.txt.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"IBM 1.3.1 JRE for LINUX (and possibly other JRE 1.3.1 environments)","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":5,"total":5,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345168/comment/12420945","id":"12420945","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I do not believe this is a test harness issue.\r\n\r\nIf I run these steps with another jvm, these warnings do not appear.\r\n\r\nI experimented, and I can make the warning appear with this ibm 1.3.1 SR10 with only ij, but not with another jvm by doing the following:\r\n- start ij:\r\n   java org.apache.derby.tools.ij\r\n   ij>connect 'jdbc:derby:tstdb;create=true';\r\n   ij> create table t1 (c1 int);\r\n   ij> disconnect;\r\n   ij> exit;\r\n- ls tstdb and observe there is no db.lck file\r\n-  start ij again, select from t, and ctrl-c out:\r\n   java org.apache.derby.tools.ij\r\n   ij> connect 'jdbc:derby:tstdb';\r\n   ij> select * from t1;\r\n   CTRL-C\r\n- ls tstdb and observe there is a db.lck file now\r\n- start ij again, and connect again, and see that only with ibm 1.3.1 do you see the warning.\r\n\r\nI have no jdk131 installed on the machine I was doing this on. Maybe someone else can verify this behavior for that.\r\n\r\nI worked on making _sed.properties files for all the affected tests (for 10.2, we have one extra tests failing - st_derby715.java) but this does not work for the stress tests, and possibly this is not the right thing to do in the first place.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-07-14T04:48:04.000+0000","updated":"2006-07-14T04:48:04.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345168/comment/12420977","id":"12420977","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"cut-and-paste comment on the list by Mike Matrigali:\r\n--------------- agree, I think this a problem with these particular tests on pre 1.4\r\njvms, on non windows platforms - their output is different - it would\r\nnot be right to somehow get\r\nthe harness to supress every connect warning printed.  Fixing with test\r\nspecific seds is fine.\r\n\r\nI checked all the tests below except for the stress ones, they all are\r\nsetup to run on an existing db and are coded to crash with no cleanup so\r\nthat subsequent test will run recovery.  A side effect of that crash on\r\npre-1.4 jvms on non windows platforms is that it leaves a lock file\r\naround which derby can't tell\r\nif it is an active lock file and thus the reconnect correctly prints a\r\nwarning in those cases.\r\n\r\nThe stress ones are a little puzzling, I didn't think we reconnected to\r\nthe same db - I have not really looked at how we run those tests in\r\nthe network server framework.  Is it likely we are trying to run those\r\ntests on an existing db?\r\n------------------------------------\r\n\r\nI think with the stress test & networkserver the last tester gets interrupted because of the timeout (10 minutes), so that process leaves the db.lck behind, which will cause the final.sql to hit the WARNING, so that's to be expected too.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-07-14T08:57:35.000+0000","updated":"2006-07-14T08:57:35.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345168/comment/12420980","id":"12420980","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attached patch for 10.2 - DERBY-1462_102_20060713.* - adds _sed.properties files for all the tests that are listed as failing, plus for st_derby715.java which also fails.\r\n\r\nIn addition, I had to modify RunTest.java to pick up the stress_sed.properties file (which was not happening because the multi test sits in a different location from the rest of the tests).\r\n\r\nFinally I modified 2 build.xmls to no longer need the copyfiles.ant - which is how other test dirs have their build.xml now. (eliminating the maintenance pain of coyfiles.ant).\r\n\r\nI ran the troublesome test suites with ibm131 and ibm142 on Linux with only failures in stress multi which appeared to be the known intermittent problem (I reran that until it passed once...) and is at least not related to this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-07-14T09:07:47.000+0000","updated":"2006-07-14T09:07:47.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345168/comment/12424390","id":"12424390","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Fixing a problem in the previous patch with this one - DERBY-1462_20060730.diff. The test store/streamingColumn.java would fail because shortbanner was not found - fixed up the build.xml.\r\nLesson to self...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-07-30T14:06:22.000+0000","updated":"2006-07-30T14:06:22.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345168/comment/12424632","id":"12424632","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Committed to trunk with revision 427237. It would be nice if there was a way that we could tag this for cleanup when it comes time to remove support with jdk1.3, like e.g. including [JDK13CLEANUP] in the comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-07-31T19:57:34.000+0000","updated":"2006-07-31T19:57:34.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1462/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06yt3:"}}