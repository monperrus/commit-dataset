{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12597568","self":"https://issues.apache.org/jira/rest/api/latest/issue/12597568","key":"ARIES-870","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310981","id":"12310981","key":"ARIES","name":"Aries","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310981&avatarId=10065","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310981&avatarId=10065","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310981&avatarId=10065","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310981&avatarId=10065"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10520","id":"10520","description":"Apache Aries","name":"Aries"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321544","id":"12321544","name":"1.0","archived":false,"released":true}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-10-17 15:27:51.129","customfield_12312323":null,"customfield_12310420":"249322","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_27334630616_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-05-17T20:29:40.105+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-870/watchers","watchCount":3,"isWatching":false},"created":"2012-07-05T11:32:29.542+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-09-26T13:38:38.881+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313494","id":"12313494","name":"Subsystem"}],"timeoriginalestimate":null,"description":"When working with the Resolver in order to compute dependencies and resolve subsystems, the ResolveContext will need to handle requests for osgi.ee capabilities. Currently, these capabilities need to be provided by resources packaged with the subsystems.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"57387","summary":"How to handle osgi.ee requirements.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":6,"total":6,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12597568/comment/13477955","id":"13477955","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=glyn.normington","name":"glyn.normington","emailAddress":"gnormington at vmware dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Glyn Normington","active":true},"body":"I've noticed an issue when running the Aries subsystems implementation in the Virgo user region (!) which may be relevant. Here's a portion of a stack trace:\r\n\r\nCaused by: org.osgi.service.subsystem.SubsystemException: org.osgi.service.resolver.ResolutionException: Unable to resolve file:/Users/glynnormington/aries-subsystems/virgo-kernel-3.6.0.CI-2012-10-15_20-52-58/hello.esa/hello.jar: missing requirement org.apache.aries.subsystem.core.archive.ImportPackageRequirement: namespace=osgi.wiring.package, attributes={}, directives={filter=(&(osgi.wiring.package=org.osgi.framework)(version>=0.0.0))}, resource=file:/Users/glynnormington/aries-subsystems/virgo-kernel-3.6.0.CI-2012-10-15_20-52-58/hello.esa/hello.jar [caused by: Unable to resolve org.eclipse.osgi_3.8.1.v20120830-144521: missing requirement osgi.ee; filter:=\"(|(&(osgi.ee=JavaSE)(version=1.5))(&(osgi.ee=OSGi/Minimum)(version=1.2)))\"]\r\n\tat org.apache.aries.subsystem.core.internal.SubsystemResource.computeDependencies(SubsystemResource.java:417)\r\n\tat org.apache.aries.subsystem.core.internal.SubsystemResource.computeDependencies(SubsystemResource.java:394)\r\n\tat org.apache.aries.subsystem.core.internal.SubsystemResource.<init>(SubsystemResource.java:102)\r\n\tat org.apache.aries.subsystem.core.internal.SubsystemResource.<init>(SubsystemResource.java:92)\r\n\tat org.apache.aries.subsystem.core.internal.InstallAction.createSubsystemResource(InstallAction.java:128)\r\n\tat org.apache.aries.subsystem.core.internal.InstallAction.run(InstallAction.java:62)\r\n\tat org.apache.aries.subsystem.core.internal.InstallAction.run(InstallAction.java:31)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.apache.aries.subsystem.core.internal.AriesSubsystem.install(AriesSubsystem.java:252)\r\n\tat org.apache.aries.subsystem.core.internal.AriesSubsystem.install(AriesSubsystem.java:246)\r\n\tat demo.driver.HelloDriver.start(HelloDriver.java:19)\r\n\tat org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run(BundleContextImpl.java:711)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:702)\r\n\t... 61 common frames omitted\r\nCaused by: org.osgi.service.resolver.ResolutionException: Unable to resolve file:/Users/glynnormington/aries-subsystems/virgo-kernel-3.6.0.CI-2012-10-15_20-52-58/hello.esa/hello.jar: missing requirement org.apache.aries.subsystem.core.archive.ImportPackageRequirement: namespace=osgi.wiring.package, attributes={}, directives={filter=(&(osgi.wiring.package=org.osgi.framework)(version>=0.0.0))}, resource=file:/Users/glynnormington/aries-subsystems/virgo-kernel-3.6.0.CI-2012-10-15_20-52-58/hello.esa/hello.jar [caused by: Unable to resolve org.eclipse.osgi_3.8.1.v20120830-144521: missing requirement osgi.ee; filter:=\"(|(&(osgi.ee=JavaSE)(version=1.5))(&(osgi.ee=OSGi/Minimum)(version=1.2)))\"]\r\n\tat org.apache.felix.resolver.Candidates.populateResource(Candidates.java:285)\r\n\tat org.apache.felix.resolver.Candidates.populate(Candidates.java:153)\r\n\tat org.apache.felix.resolver.ResolverImpl.resolve(ResolverImpl.java:96)\r\n\tat org.apache.aries.subsystem.core.internal.SubsystemResource.computeDependencies(SubsystemResource.java:411)\r\n\t... 74 common frames omitted\r\n\r\nThe strange thing is that hello.jar doesn't need the osgi.ee capability (nor does it use BREE). Also, the system bundle is, of course, already resolved and there's only one system bundle in my system, so it's strange that the Felix resolver can't resolve it.\r\n\r\nI'm not complaining about this stack trace - running inside the Virgo user region is likely to be the problem (as the user region doesn't allow any generic capabilities of the system bundle to be visible) - but it *may* help to inform the current issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=glyn.normington","name":"glyn.normington","emailAddress":"gnormington at vmware dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Glyn Normington","active":true},"created":"2012-10-17T15:27:51.129+0000","updated":"2012-10-17T15:27:51.129+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12597568/comment/13477968","id":"13477968","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"body":"First, I'm surprised the resolver thinks it needs to resolve the system bundle as part of installing the subsystem. The subsystem's ResolveContext should be returning the system bundle as part of the current wiring which means the resolver should not attempt to resolve it. There might be a bug in the ResolveContext.\r\n\r\nSecond, the workaround to any resolution failures due to a missing osgi.ee capability is to have one of the subsystem's content bundles provide it. For example, in this case, adding\r\n\r\nProvide-Capability: osgi.ee;osgi.ee=JavaSE;version=1.5\r\n\r\nto the manifest of one of the content bundles should get around this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"created":"2012-10-17T15:46:52.625+0000","updated":"2012-10-17T15:46:52.625+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12597568/comment/13478411","id":"13478411","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tjwatson","name":"tjwatson","emailAddress":"tjwatson at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Watson","active":true},"body":"I suspect that the user region is somehow hiding the system bundle from the subsystems implementation which ultimately causes the subsystems implementation to think it needs to provision a resource that provides the capabilities of the system bundle (stuff like the org.osgi.framework package).  The subsystems implementation knows there is this system bundle resource (somehow, not sure how) and it tries to setup a resolve operation against the resources of the subsystem along with the subsystem dependencies which will include this system bundle (org.eclipse.osgi).  That resolve operation appears to be failing which ultimately prevents any of the bundles from installing for the subsystem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tjwatson","name":"tjwatson","emailAddress":"tjwatson at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Watson","active":true},"created":"2012-10-17T21:33:54.787+0000","updated":"2012-10-17T21:33:54.787+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12597568/comment/13479054","id":"13479054","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=glyn.normington","name":"glyn.normington","emailAddress":"gnormington at vmware dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Glyn Normington","active":true},"body":"I have since run the above scenario successfully from the command line. It was failing when Virgo was running under Eclipse. I have also successfully run the scenario from Eclipse on another machine. So I think the symptoms should be treated as unreproducible unless/until it reproduces predictably across more than one machine.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=glyn.normington","name":"glyn.normington","emailAddress":"gnormington at vmware dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Glyn Normington","active":true},"created":"2012-10-18T14:57:37.976+0000","updated":"2012-10-18T14:57:37.976+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12597568/comment/13479113","id":"13479113","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"body":"Although it might not have been the cause, there was a bug in how the current wiring was being returned from the resolve context. See http://svn.apache.org/viewvc?view=revision&revision=1399722.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"created":"2012-10-18T16:23:10.587+0000","updated":"2012-10-18T16:23:10.587+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12597568/comment/13661027","id":"13661027","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"body":"The fix referenced in the previous comment resolved this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwross%40us.ibm.com","name":"jwross@us.ibm.com","emailAddress":"jwross at us dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Ross","active":true},"created":"2013-05-17T20:29:40.149+0000","updated":"2013-05-17T20:29:40.149+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-870/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0a6vj:"}}