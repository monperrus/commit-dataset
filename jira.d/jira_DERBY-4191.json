{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12423890","self":"https://issues.apache.org/jira/rest/api/latest/issue/12423890","key":"DERBY-4191","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313143","id":"12313143","description":"Head of 10.3 branch","name":"10.3.3.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313401","id":"12313401","description":"Head of 10.4 branch","name":"10.4.2.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314182","id":"12314182","description":"Old head of 10.5 branch","name":"10.5.3.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313727","id":"12313727","description":"Feature release","name":"10.6.1.0","archived":false,"released":true,"releaseDate":"2010-05-18"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2009-07-02 18:46:45.864","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24090","customfield_12310222":"1_*:*_1_*:*_28610132783_*|*_6_*:*_1_*:*_5394443102_*|*_5_*:*_2_*:*_3176402681_*|*_4_*:*_1_*:*_406966224","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-07-06T15:15:18.884+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4191/watchers","watchCount":0,"isWatching":false},"created":"2009-04-27T14:09:34.094+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"15.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313345","id":"12313345","description":"","name":"10.4.2.0","archived":false,"released":true,"releaseDate":"2008-09-05"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313771","id":"12313771","description":"build: 764942, 14/Apr/09. Voted release: 28/Apr/09. Announced: 1/May/09","name":"10.5.1.1","archived":false,"released":true,"releaseDate":"2009-04-28"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12378170","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12378170","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12678217","key":"DERBY-6411","self":"https://issues.apache.org/jira/rest/api/2/issue/12678217","fields":{"summary":"Minimal select privilege should be checked in subqueries","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12332796","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12332796","type":{"id":"12310040","name":"Required","inward":"is required by","outward":"requires","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310040"},"inwardIssue":{"id":"12468384","key":"DERBY-4728","self":"https://issues.apache.org/jira/rest/api/2/issue/12468384","fields":{"summary":"10.5 backport effort tracking issue ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}},{"id":"12328988","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12328988","type":{"id":"10001","name":"dependent","inward":"is depended upon by","outward":"depends upon","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"},"inwardIssue":{"id":"12446346","key":"DERBY-4522","self":"https://issues.apache.org/jira/rest/api/2/issue/12446346","fields":{"summary":"Document SELECT statement requirements resulting from fix to DERBY-4191","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-11-08T13:35:06.131+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"A user that does not have SELECT privilege on a table can still perform a SELECT COUNT(*) on that table. Counting a specific column (e.g., SELECT COUNT(X)) is prevented.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10361","value":"Security","id":"10361"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10366","value":"Wrong query result","id":"10366"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"37671","summary":"Lack of SELECT privilege does not prevent SELECT COUNT(*)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10101","value":"Release Note Needed","id":"10101"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":36,"total":36,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12703136","id":"12703136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attached is a repro script showing that count(x) is disallowed and count(*) is allowed for a non-privileged user.\r\n\r\n$ java -Dderby.database.sqlAuthorization=true -jar lib/derbyrun.jar ij repro.sql\r\nij version 10.5\r\nij> connect 'jdbc:derby:db;user=root;create=true';\r\nWARNING 01J14: SQL authorization is being used without first enabling authentication.\r\nij> create table t (x int);\r\n0 rows inserted/updated/deleted\r\nij> insert into t values 1,2,3;\r\n3 rows inserted/updated/deleted\r\nij> connect 'jdbc:derby:db;user=kah';\r\nWARNING 01J14: SQL authorization is being used without first enabling authentication.\r\nij(CONNECTION1)> select count(x) from root.t;\r\nERROR 42502: User 'KAH' does not have SELECT permission on column 'X' of table 'ROOT'.'T'.\r\nij(CONNECTION1)> select count(*) from root.t;\r\n1          \r\n-----------\r\n3          \r\n\r\n1 row selected\r\nij(CONNECTION1)>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2009-04-27T14:11:55.697+0000","updated":"2009-04-27T14:11:55.697+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12726621","id":"12726621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Triaged July 2, 2009: Checked Security and WrongQueryResult boxes. Assiged normal urgency.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-07-02T18:46:45.864+0000","updated":"2009-07-02T18:46:45.864+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12779460","id":"12779460","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Before fixing this bug, we need to decide what privileges are needed to execute the following statement:\r\n\r\n  select count(*) from t\r\n\r\nI believe that all you need is SELECT privilege on some column of the table. That at least is the minimum set of privileges required by the SQL Standard, part 2, section 7.6 <table reference>, access rule 1.ii.1.B. I asked the SQL committee for its opinion and got one response, which concurred:\r\n\r\n\"There are no access rules for count(*) (in either 6.9 <set function specification> or\r\n10.9 <aggregate function>), nor in 7.12 <query specification> or\r\n7.13 <query expression>, so that leaves just the access rules for t in\r\n7.6 <table reference>.  I think you are right.\"\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-11-18T14:10:52.417+0000","updated":"2009-11-18T14:10:52.417+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12779521","id":"12779521","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"The solution to this bug should also insist on the same privileges for the following query:\r\n\r\n  select count(1) from t;\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-11-18T16:52:32.997+0000","updated":"2009-11-18T16:52:32.997+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12779525","id":"12779525","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Thanks for your comment on this jira, Rick. I was starting to look at the jira and was thinking about what privileges would be required. \r\n\r\nIt seems like Derby has a SELECT level privilege for the table (I think that gets used for instance when somebody attempts to lock the table) and I thought that is what would be required for count(*) or count(1). But it seems like SQL-spec is saying that SELECT privilege on any column of the table is enough. I think that does make sense because a user can easily get count(*) equivalent by going count(columnwithselectprivilege) and hence it should be fine to have select privilege on any column to do count(*) or count(1) equivalent.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-11-18T16:58:52.224+0000","updated":"2009-11-18T16:58:52.224+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12779597","id":"12779597","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Mamta,\r\n\r\nThanks for volunteering to look at this issue. Off the top of my head, I think that the tricky bit may be that privilege checks are currently modelled as an ANDed list of required permissions. What is needed here seems to be an ORed list of permissions. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-11-18T19:04:12.667+0000","updated":"2009-11-18T19:04:12.667+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12780188","id":"12780188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Currently, we have a method called getRequiredPermissionsList() in CompilerContext. I am thinking of adding another method called getRequiredPermissionsListForCountStar() (let me know if some other name suggestion people may have). This list will just include the TableDescriptors of tables involved in count(*) or count(1) kind of variations. And for these TableDescriptors, we will check if there is SELECT privilege available on table level OR at any column level. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-11-19T18:28:48.556+0000","updated":"2009-11-19T18:28:48.556+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12780202","id":"12780202","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Mamta,\r\n\r\nWithout seeing how the method is used it is hard to comment. However, I think you are trying to capture the sense of \"The absolutely minimal set of permissions needed to SELECT from a table.\" That is my sense of what is meant by part 2, section 7.6 <table reference>, access rule 1.ii.1.B. So a better name for your proposed method may be getMinimalSelectPermissionsList().\r\n\r\nAnother way to tackle this might be to invent a new kind of permission which can't be granted but which can be used internally: a MINIMAL_SELECT_PRIVILEGE for tables. This solution would look something like the following:\r\n\r\no At bind time, you would add a MINIMAL_SELECT_PRIVILEGE( T ) to the list of required table privileges for every table T that is selected from.\r\n\r\no For extra credit, this privilege could be removed from the list for any table which has other required SELECT privileges. That removal might happen during bind() or maybe during code generation. Alternatively, you could wait till execution time to short-circuit the check for this privilege.\r\n\r\no At execution time, you would then do what I think you're planning on: If you see a MINIMAL_SELECT_PRIVILEGE required for a table, you would check whether the user/currentRole enjoys a table-wide SELECT privilege or SELECT privilege on at least one column.\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-11-19T18:59:24.764+0000","updated":"2009-11-19T18:59:24.764+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12780295","id":"12780295","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Rick, I really appreciate you taking the time on thinking about this jira. As a start, I am thinking I will go ahead and work on getMinimalSelectPermissionsList/getRequiredPermissionsListForCountStar() approach. I think the actual implementation of that method will be required even by the alternative approach you suggested. So, for now, I will work on implementing the new method and have it used for count(*) case. Once I have that working, we can see if we should add a new internal privilege type MINIMAL_SELECT_PRIVILEGE and use that privilege type rather than internal method calls to implement the final solution. Once I have some kind of code ready, I will post it to this jira so we are more clear on what I am proposing to do. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-11-19T22:02:25.606+0000","updated":"2009-11-19T22:02:25.606+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12780309","id":"12780309","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Just to add to Rick's point, this problem is not limited to COUNT, or to aggregate functions. Same problem can be seen with for instance this statement that just selects a constant expression from table ROOT.T (executed as user KAH in the original repro):\r\n\r\nij(CONNECTION1)> select x from root.t;\r\nERROR 42502: User 'KAH' does not have SELECT permission on column 'X' of table 'ROOT'.'T'.\r\nij(CONNECTION1)> select 1 from root.t;\r\n1          \r\n-----------\r\n1          \r\n1          \r\n1          \r\n\r\n3 rows selected","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2009-11-19T22:32:35.081+0000","updated":"2009-11-19T22:32:35.081+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12785457","id":"12785457","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I am attaching a patch(DERBY4191_ColumnLevelCheckInStatmentTablePerm_diff_patch1.txt)  which resolves this jira's issue(the patch is not ready for commit yet). \r\n\r\nI have piggybacked on first and third bullet items of Rick's suggestion. At this point, I am not planning on optimizing the code by checking if there is already a SELECT privilege requirement on table or a column in the table, and if yes, then drop the MINIMAL_SELECT_PRIVILEGE requirement on that same table. \r\n\r\nThe logic is as follows. At the bind time, The compile time changes went into SelectNode and AggregateNode to see if we need to add MINIMAL_SELECT_PRIVILEGE requirement. \r\na)I check in the SelectNode if all the columns in the select list are constants. If yes, then I add MINIMAL_SELECT_PRIVILEGE requirement for all the tables involved in the select. A new method was added for doing the column constant check. That method went in ResultColumnList.java \r\nb)In the AggregateNode, I check if the aggregate is of the kind count(*) or count(constant), then we should require MINIMAL_SELECT_PRIVILEGE for all the tables involved in the select. \r\nc)Then at execute time, in StatementTablePermission, if I don't find a table level select privilege, then I check if there is atleast one column level select privilege if we are working with MINIMAL_SELECT_PRIVILEGE requirement. For this, I had to add a new method, called checkForAtleastOneSelectColumnPrivilege. The majority of this code is copied from StatementColumnPermission and this the reason I don't want this patch to be committed yet. I want to see if I can change the MINIMAL_SELECT_PRIVILEGE requirement to be at the column level rather than table level. That way, I might be able to use the existing code in StatementColumnPermission rather than copying majority of it in StatementTablePermission as a new method. \r\nd)I have added new tests to RolesConferredPrivilegesTest and GrantRevokeDDLTest. \r\ne)As a next step, I want to focus on utilizing most of existing code in StatementColumnPermission. Once I have that ready, I will post another patch. I will appreciate though if someone can review the patch and the logic to see if I may have missed anything.\r\n\r\nThe files impacted by the change are as follows\r\nsvn stat -q\r\nM       java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\SelectNode.java\r\nM       java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\AggregateNode.java\r\nM       java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\ResultColumnList.java\r\nM       java\\engine\\org\\apache\\derby\\impl\\sql\\catalog\\DataDictionaryImpl.java\r\nM       java\\engine\\org\\apache\\derby\\iapi\\sql\\conn\\Authorizer.java\r\nM       java\\engine\\org\\apache\\derby\\iapi\\sql\\dictionary\\StatementTablePermission.java\r\nM       java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\lang\\RolesConferredPrivilegesTest.java\r\nM       java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\lang\\GrantRevokeDDLTest.java\r\n\r\nI ran all the tests and ran into following failure. I do not think it is related to my changes but not sure why this error is showing up. I can consistently reproduce this eror. There was reference to this kind of failure once on derby-dev list with thread titled \"[jira] Issue Comment Edited: (DERBY-3451) Remove dependency between StandardException class and org.apache.derby.impl.jdbc classes\". I do not think there was any resolution to that failure.\r\nThere were 2 failures:\r\n1) CheckToursDBTest:embeddedjunit.framework.AssertionFailedError: org/apache/derbyTesting/functionTests/tests/demo/cupisle.gif\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup.copyFiles(SupportFilesSetup.java:174)\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup.access$000(SupportFilesSetup.java:64)\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup$1.run(SupportFilesSetup.java:139)\r\n        at java.security.AccessController.doPrivileged(AccessController.java:251)\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup.privCopyFiles(SupportFilesSetup.java:135)\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup.setUp(SupportFilesSetup.java:120)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:18)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:23)\r\n2) CheckToursDBTest:clientjunit.framework.AssertionFailedError: org/apache/derbyTesting/functionTests/tests/demo/cupisle.gif\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup.copyFiles(SupportFilesSetup.java:174)\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup.access$000(SupportFilesSetup.java:64)\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup$1.run(SupportFilesSetup.java:139)\r\n        at java.security.AccessController.doPrivileged(AccessController.java:251)\r\n        at rg.apache.derbyTesting.junit.SupportFilesSetup.privCopyFiles (SupportFilesSetup.java:135)\r\n        at org.apache.derbyTesting.junit.SupportFilesSetup.setUp(SupportFilesSetup.java:120)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:18)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:23)\r\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:23)\r\n        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\r\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:23)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-12-03T19:13:55.262+0000","updated":"2009-12-03T19:13:55.262+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12785501","id":"12785501","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks for the patch, Mamta. I think that this would be good, incremental improvement. My chief misgiving about this patch is that it attempts to enumerate the cases which could go wrong. I don't think that I am smart enough to list the problem cases even with the limited grammar that we have now. As we extend the language, more problem cases may creep in. Here for instance is a query which should fail but which still succeeds with this patch:\r\n\r\n   select myTable.a from myTable, admin.privateTable;  -- here admin.privateTable is a table that I don't have any SELECT privileges on\r\n\r\nI continue to think that it would be best to always add the MIN_SELECT_PRIV and then weed it out later if you can prove that it isn't needed. I think the downside of this alternative approach is that some cases may slip through where we needlessly look for column permissions. On the whole, I think that is a better problem to have than ignoring permissions checks when they are required.\r\n\r\nAnother small comment: The code which adds the MIN_SELECT_PRIV seems to be duplicated in a couple files. I would recommend abstracting this code into a shared subroutine.\r\n\r\nThanks!\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-12-03T20:34:59.890+0000","updated":"2009-12-03T20:34:59.890+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12786086","id":"12786086","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I am attaching a patch (DERBY4191_ColumnLevelCheckInStatmentColumnPerm_diff_patch2.txt)  is same as the previous patch EXCEPT that the minimum select privilege requirement is enforced in StatementColumnPermission rather than StatementTablePermission thus eliminating the need to duplicate the code. \r\n\r\nI ran derbyall and junit tests and even with this patch, I continue to get the failure CheckToursDBTest:embeddedjunit.framework.AssertionFailedError: org/apache/derbyTesting/functionTests/tests/demo/cupisle.gif\r\nIn addition, I got one more failure, testReplication_Encrypted_1_miniLoad_negative(org.apache.derbyTesting.functio\r\nnTests.tests.replicationTests.ReplicationRun_Local_Encrypted_1)junit.framework.ComparisonFailure: Unexpected SQL state. expected:<...0> but was:<...1>\r\n\r\nI reran the replication suite and didn't get the above failure when running this way.\r\n$ java  -Dderby.tests.trace=true  -Xmx256M -XX:MaxPermSize=128M junit.textui.TestRunner org.apache.derbyTesting.functionTests.tests.replicationTests.Replication.Suite\r\n\r\nIf anyone has cycles at all, if they can run the junit suite with the patch I am attaching, I will appreciate it. I want to be sure that nothing in my changes has broken the 2 failures I am seeing(may be they are specific to my computer).  \r\n\r\nRick, thanks for reviwing my earlier patch. I agree with your comments about not trying to selective handle specific select queries. As a next step, I will work on your suggestion of requiring minimum select privilege on all the tables in the select query rather than trying to handpick the ones based on select constant or select count(*) or select count(constant) because this approach does not cover a query like select t1.c1 from anotheruser.t1, anotheruser.t2\r\n\r\nI will post that patch once it is ready. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-12-04T19:15:36.909+0000","updated":"2009-12-04T19:15:36.909+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12789156","id":"12789156","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I am attaching a new patch (DERBY4191_miniumSelectPrivOnAllTables_diff_patch3.txt) which now adds a minimum select privilege requirement for all the tables in a SELECT query and if such a requirement is already getting satisfied with already existing select privilege requirement on the table(s), then we will not add the redundant minimum select privilege requirement. eg\r\nselect c1 from t1\r\nFor the query above, we do not require a minimum select privilege on t1 because we have already select privilege requirement on t1.c1 \r\nNow consider the following query\r\nselect 1 from t1\r\nFor the query above, we DO want to add a minumum select privilege on t1 because there is no other select privilege requirement on table t1 or any of it's columns.\r\n\r\nThe code had to be intelligent enough to not require minimum select privilege for following query\r\nupdate t1 set c1=1\r\nfor this query, we have a SelectNode which provides the resultset for update. But for this SelectNode, we do not want any minimum select privileges on t1. Code for recognizing such a query is added into SelectNode.\r\n\r\nI have run all the junit and derbyall tests and only ran into known jira issue DERBY-4463. Prior run of junit with the patch gave me some upgrade test failures which I occassionally run into on my machine and I do not think those upgrade test failures are related to my patch. I will greatly appreciate if someone can run the junit tests for me with the patch to make sure they run fine.\r\n\r\nPlease let me know if anyone has any feedback on the patch. I will plan on committing it early next week. Thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-12-11T07:33:28.804+0000","updated":"2009-12-11T07:33:28.804+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12789368","id":"12789368","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks for the new patch, Mamta. I think this is moving in the right direction. I have a couple comments:\r\n\r\n1) It's hard to tell whether the new tests cover the cases where permissions come from roles rather than from direct grants. It would be good to write some tests for those cases.\r\n\r\n2) After applying this patch, the following query succeeds if the user has update privilege on the table but not select privilege. I believe that this query should fail because the user does not have select privilege:\r\n\r\n    update admin.t set a = ( select max(a) + 2 from admin.t );\r\n\r\nHere is a full script which shows this problem:\r\n\r\nconnect 'jdbc:derby:memory:dummy;create=true;user=admin;password=adminpassword';\r\n\r\ncreate table t( a int, b int );\r\n\r\ninsert into t( a, b ) values ( 1, 1 );\r\ncall syscs_util.syscs_set_database_property( 'derby.database.sqlAuthorization', 'true' );\r\n\r\nconnect 'jdbc:derby:memory:dummy;shutdown=true;user=admin;password=adminpassword';\r\n\r\nconnect 'jdbc:derby:memory:dummy;user=admin;password=adminpassword';\r\n\r\ngrant update on t to public;\r\n\r\nconnect 'jdbc:derby:memory:dummy;user=ruth;password=ruthpassword';\r\n\r\n-- fails\r\nselect * from admin.t;\r\n\r\nupdate admin.t set a = 2;\r\n\r\n-- succeeds but should not\r\nupdate admin.t set a = ( select max(a) + 2 from admin.t );\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-12-11T16:21:49.305+0000","updated":"2009-12-11T16:21:49.305+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12789412","id":"12789412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Rick, thanks for reviewing the patch. It appears that my logic of determining whether we are inside UPDATE/DELETE etc statement is not as full-proof as I thought. I will look further into it. \r\n\r\nAs for the permission available through role rather than direct direct tests, I will attempt to add a standalong test fixture in RolesConferredPrivilegesTest.java The existing test fixtures are very sophisticated for what I need to test. If anyone has ideas on how I can use the existing test fixture in RolesConferredPrivilegesTest.java to add a test case like\r\nselect t1.c1 from user1.t1, user1.t2\r\nOtherwise, I will just add a new test fixture to test above.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-12-11T17:34:38.060+0000","updated":"2009-12-11T17:34:38.060+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12789491","id":"12789491","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I have added another patch DERBY4191_miniumSelectPrivOnAllTables_diff_patch4.txt which is same as the previous one except that SubqueryNode during it's bind phase now requires minimum select privilege on all it's table. It fixes the test case you provided Rick. I have fired the derbyall and will run junit suite after that. In the mean time, I will work on adding a test case for this subquery scenario and will add test case for roles (as Rick pointed out in his last review).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-12-11T19:48:46.640+0000","updated":"2009-12-11T19:48:46.640+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12789577","id":"12789577","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"While trying so more test cases, I found another test case for update that does not collect select privilege requirement. \r\n\r\njava -Dderby.database.sqlAuthorization=true -Dij.exceptionTrace=true org.apache.derby.tools.ij\r\nconnect 'jdbc:derby:c:/dellater/db1;user=dbo;create=true' as dbo;\r\ncreate table t( a int, b int ); \r\ngrant update on t to public; \r\nconnect 'jdbc:derby:c:/dellater/db1;user=user2' as user2; \r\n-- with my last patch(DERBY4191_miniumSelectPrivOnAllTables_diff_patch4.txt), following now will give an error\r\nupdate dbo.t set a = ( select max(a) + 2 from dbo.t ); \r\n--grant select privilege on dbo.t(a) to user2\r\nset connection dbo;\r\ngrant select(a) on t to user2;\r\nset connection user2;\r\n-- now the following will succeed\r\nupdate dbo.t set a = ( select max(a) + 2 from dbo.t ); \r\n--BUT FOLLOWING SHOULD NOT SUCCEED because there is no select privilege on column b\r\nupdate dbo.t set a = ( select max(b) + 2 from dbo.t ); \r\n\r\nSo, it appears that we are not collecting individual select privilege for a subquery hidden inside update. I will look further into it. Wonder if there are other cases where we are missing on collecting the select privileges. I tried the test case about without my changes on a different trunk client(that client has some other changes but they are not related to privilege collection) and the buggy behavior can be seen there, too. I just wanted to be sure that my changes for this jira didn't cause any regression.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-12-11T22:20:13.169+0000","updated":"2009-12-11T22:20:13.169+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12791451","id":"12791451","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I have another patch, DERBY4191_miniumSelectPrivOnAllTables_And_Subquery_diff_patch5.txt. The difference in this patch compared to earlier patches is it now collects the select privilege requirement for a subquery involved in a DML. eg of subquery are as follows\r\nupdate dbo.t set a = ( select max(a1) + 2 from dbo.t1 )\r\nupdate dbo.t set a = ( select max(b1) + 2 from dbo.t2 )\r\nFor the queries above, we were not collecting any select privileges for the subquery. Instead we were requiring update privileges on columns inside the subquery. I have made changes in SubqueryNode to require the select privileges for the query it is working with. I have added tests for this subquery change in this patch. \r\n\r\nIn addition to the above changes, I have added tests for testing privileges available through roles. These tests were missing from earlier patch for a query like \r\nselect c1 from user1.t1, user1.t2\r\n\r\nPlease review the patch and let me know of any issues you may see with it.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-12-16T17:16:52.292+0000","updated":"2009-12-16T17:16:52.292+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12792070","id":"12792070","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"BTW, I forgot to mention that derbyall ran fine with my patch and as for the junit tests, only saw the known failure in StressMultiTest which is DERBY-3916(which appears to be duplicate of DERBY-3757","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-12-17T18:56:58.802+0000","updated":"2009-12-17T18:56:58.802+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12792528","id":"12792528","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks for the new patch, Mamta. I am seeing some odd behavior around views and deletes. Here's a script which shows this odd behavior:\r\n\r\nconnect 'jdbc:derby:memory:dummy;create=true;user=ruth;password=ruthpassword' as ruth_conn;\r\n\r\ncreate table t_ruth( a int, b int );\r\ncreate view v_ruth( c, d ) as select a, b from t_ruth;\r\n\r\ngrant update on t_ruth to public;\r\ngrant insert on t_ruth to public;\r\ngrant delete on t_ruth to public;\r\n\r\nconnect 'jdbc:derby:memory:dummy;user=alice;password=alicepassword' as alice_conn;\r\n\r\n-- misleading error message on these queries\r\n-- complains that User 'ALICE' does not have UPDATE permission on column 'C' of table 'RUTH'.'V_RUTH'.\r\nupdate ruth.t_ruth set a = ( select max(c) from ruth.v_ruth );\r\nupdate ruth.t_ruth set a = ( select count(*) from ruth.v_ruth );\r\nupdate ruth.t_ruth set a = ( select 1 from ruth.v_ruth );\r\n\r\n-- fails but should succeed\r\n-- complains that User 'ALICE' does not have SELECT permission on table 'RUTH'.'T_RUTH'.\r\ndelete from ruth.t_ruth;\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-12-18T16:50:14.480+0000","updated":"2009-12-18T16:50:14.480+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12797419","id":"12797419","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Attaching another patch, DERBY4191_miniumSelectPriv_CursorNode_And_Subquery_diff_patch6.txt. I have made couple changes in this patch compared to the previous Both the patches require that user had minimum select privileges on all the tables in the select list. But the earlier patch made that check in SelectNode whereas this patch makes that check in CursorNode. The reason for this is for a simple DMLlike following, delete from ruth.t_ruth, a SelectNode is generated. But that SelectNode is to generate the resultset needed for delete. From my research, I believe CursorNode is the correct node where the minimum select privilege requirement should go. I have added test cases mentioned by Rick for the earlier patch and those test cases along with all the existing tests run with no problem with this patch. Another change in this patch compared to earlier one is the select privilege requirement for subquery now happens around the entire bind time code in SubqueryNode rather than just aroiund resultSet.bindExpressions. Would appreciate if someone can review this patch for me to see if they see any problems with it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-01-07T00:56:47.456+0000","updated":"2010-01-07T00:56:47.456+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12798695","id":"12798695","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks for this new patch, Mamta. I have verified that the previously identified problem cases now behave properly. I have run out of problem queries to test against this patch. This looks like a very good improvement to me. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2010-01-11T15:36:44.901+0000","updated":"2010-01-11T15:36:44.901+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12799556","id":"12799556","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Thanks again for all your time, Rick. I have committed the patch(revision 898635) with following commit comments\r\n\r\nDERBY-4191\r\n\r\nRequire minimum select privilege from the tables in the SELECT sql if no column is selected from the table by the user eg\r\nselect count(*) from root.t; \r\nselect 1 from root.t; \r\nFor the query above, Derby was letting the user execute the select even if the user had no select privilege available on root.t With this fix, Derby will check if there is atleast one column on which the user has select privilege available to it or if the user select privilege at the table level. If yes, only then the user will be able to select from another user's table.\r\n\r\nselect myTable.a from myTable, admin.privateTable\r\nfor the query above, since no column is selected specifically from admin.privateTable, Derby will now see if there is table level select privilege or atleast one column level select privilege available on admin.privatTable\r\n\r\nOne other problem scenario was\r\nupdate ruth.t_ruth set a = ( select max(c) from ruth.v_ruth ); \r\nFor the query above, prior to fix for DERBY-4191, we were not looking for select privilege for the subquery. That has also been fixed with fix for DERBY-4191\r\n\r\nAll the existing tests passed with no regression. Added few tests for the fixes involved in this jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-01-13T03:25:04.842+0000","updated":"2010-01-13T03:25:04.842+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12799738","id":"12799738","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Should this issue have a releaseNote (the change can break existing apps)?b","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2010-01-13T13:26:12.013+0000","updated":"2010-01-13T13:26:12.013+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12799880","id":"12799880","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Dag, you are right about the release notes. I will work on creating one. I think there is a tool to generate one. I will look into it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-01-13T19:14:29.759+0000","updated":"2010-01-13T19:14:29.759+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12802118","id":"12802118","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Attaching release notes since this jira is going to change the Derby behavior by catching privilege violation which were incorrectly allowed earlier.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-01-19T06:54:40.587+0000","updated":"2010-01-19T06:54:40.587+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12802438","id":"12802438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I am wondering if we should put anything in our docs about minimum select requirement when the query is not referencing any specific column from the tables in the FROM list. Already attached a release note for it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-01-19T19:49:33.260+0000","updated":"2010-01-19T19:49:33.260+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12803689","id":"12803689","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"+1 to a note in the docs about this requirement; it's not necessarily obvious..","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2010-01-22T13:06:51.081+0000","updated":"2010-01-22T13:06:51.081+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12803719","id":"12803719","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaase3","name":"chaase3","emailAddress":"camilla dot haase at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kim Haase","active":true},"body":"I can document this along with the changes to the SELECT statement topic that I am making for DERBY-4518, if that would be okay.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaase3","name":"chaase3","emailAddress":"camilla dot haase at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kim Haase","active":true},"created":"2010-01-22T15:11:10.423+0000","updated":"2010-01-22T15:11:10.423+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12803784","id":"12803784","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaase3","name":"chaase3","emailAddress":"camilla dot haase at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kim Haase","active":true},"body":"Since DERBY-4518 doesn't actually require any changes to the SELECT statement topic (I think), I've created a separate documentation issue for this (DERBY-4522). ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaase3","name":"chaase3","emailAddress":"camilla dot haase at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kim Haase","active":true},"created":"2010-01-22T17:55:28.622+0000","updated":"2010-01-22T17:55:28.622+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12849176","id":"12849176","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Mamta,\r\n\r\nCan this issue be resolved now? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2010-03-24T13:16:48.015+0000","updated":"2010-03-24T13:16:48.015+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12849294","id":"12849294","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Yes, it can be resolved. Thanks for pointing it out Rick. The changes at this point are only in 10.6 codeline.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-03-24T17:25:06.811+0000","updated":"2010-03-24T17:25:06.811+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12858937","id":"12858937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching a new version of the release note. This version:\r\n\r\n1) Simplifies the summary so that the 10.6 release notes are more readable.\r\n\r\n2) Moves explanatory material out of html comments into the relevant release note subsections.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2010-04-20T15:24:07.856+0000","updated":"2010-04-20T15:24:07.856+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12884459","id":"12884459","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Reopen to 10.5 back port","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-07-01T22:12:32.647+0000","updated":"2010-07-01T22:12:32.647+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12423890/comment/12885559","id":"12885559","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"This issue has already been backported to 10.5, and should not have been reopened for the 10.5 backport effort.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2010-07-06T15:15:18.861+0000","updated":"2010-07-06T15:15:18.861+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4191/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06t8n:"}}