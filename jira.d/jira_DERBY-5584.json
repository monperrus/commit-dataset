{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12539467","self":"https://issues.apache.org/jira/rest/api/latest/issue/12539467","key":"DERBY-5584","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323456","id":"12323456","description":"Third release on the 10.8 branch","name":"10.8.3.0","archived":false,"released":true,"releaseDate":"2012-11-16"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316344","id":"12316344","description":"First release on the 10.9 branch","name":"10.9.1.0","archived":false,"released":true,"releaseDate":"2012-06-25"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2012-01-23 15:03:30.076","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"224969","customfield_12310222":"1_*:*_1_*:*_2564600737_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2012-02-22T06:07:30.498+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-5584/watchers","watchCount":1,"isWatching":false},"created":"2012-01-23T13:44:10.061+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_backport_reject_10_5","derby_triage10_9"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315434","id":"12315434","description":"Head of 10.6 branch as of 2014-01-13","name":"10.6.2.4","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315564","id":"12315564","description":"First release on the 10.7 branch.","name":"10.7.1.1","archived":false,"released":true,"releaseDate":"2010-12-14"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12347276","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12347276","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12375845","key":"DERBY-3002","self":"https://issues.apache.org/jira/rest/api/2/issue/12375845","fields":{"summary":"Add support for GROUP BY ROLLUP","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-11-15T08:15:11.722+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"Steps to reproduce:\r\n\r\n1. Create database, connect to database with any JDBC client\r\n\r\n2. create two tables:\r\n\r\nCREATE TABLE TEST_5 (\r\n       profile_id INTEGER NOT NULL,\r\n       group_ref INTEGER NOT NULL,\r\n       matched_count INTEGER NOT NULL\r\n   );\r\n\r\n\r\n   CREATE TABLE TEST_6 (\r\n       profile_id INTEGER NOT NULL,\r\n       group_ref INTEGER NOT NULL,\r\n       matched_count INTEGER NOT NULL\r\n   );\r\n\r\n3. Insert two records for each table:\r\n\r\ninsert into test_5 values (1, 10000,1);\r\ninsert into test_5 values (2, 10000, 2);\r\n\r\ninsert into test_6 values (1, 10000,1);\r\ninsert into test_6 values (2, 10000, 2);\r\n\r\n4. Run following statement\r\n\r\nSELECT *\r\nFROM\r\n (SELECT ps1.group_ref,\r\n   COUNT(DISTINCT ps1.matched_count) AS matched_count\r\n FROM test_5 ps1\r\n GROUP BY ps1.group_ref,\r\n   ps1.profile_id\r\n ) a,\r\n (SELECT ps2.group_ref,\r\n   COUNT( DISTINCT ps2.matched_count) AS matched_count\r\n FROM test_6 ps2\r\n GROUP BY ps2.group_ref,\r\n   ps2.profile_id\r\n ) b\r\n\r\n\r\nAs a result I've got 3 records instead of 4 - at least Oracle 10g\r\nreturns 4 records for this statement. Maybe i'm doing something wrong.\r\nDo you have any suggestions / possible workarounds for this problem","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10367","value":"Deviation from standard","id":"10367"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10420","value":"Regression","id":"10420"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10366","value":"Wrong query result","id":"10366"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"35876","summary":"Select statement with subqueries with group by and count distinct statements returns wrong number of results","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pzgadzaj","name":"pzgadzaj","emailAddress":"pzgadzaj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Piotr Zgadzaj","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10422","value":"High Value Fix","id":"10422"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10424","value":"Repro attached","id":"10424"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pzgadzaj","name":"pzgadzaj","emailAddress":"pzgadzaj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Piotr Zgadzaj","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Output from sysinfo\r\njava.specification.name: Java Platform API Specification\r\njava.specification.version: 1.6\r\njava.runtime.version: 1.6.0_20-b02\r\n--------- Derby Information --------\r\nJRE - JDBC: Java SE 6 - JDBC 4.0\r\n[/home/piotrz/Desktop/db-derby-10.7.1.1-bin/lib/derby.jar] 10.7.1.1 - (1040133)\r\n[/home/piotrz/Desktop/db-derby-10.7.1.1-bin/lib/derbytools.jar] 10.7.1.1 - (1040133)\r\n[/home/piotrz/Desktop/db-derby-10.7.1.1-bin/lib/derbynet.jar] 10.7.1.1 - (1040133)\r\n[/home/piotrz/Desktop/db-derby-10.7.1.1-bin/lib/derbyclient.jar] 10.7.1.1 - (1040133)\r\n------------------------------------------------------\r\n----------------- Locale Information -----------------\r\nCurrent Locale :  [English/United States [en_US]]\r\nFound support for locale: [cs]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [de_DE]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [es]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [fr]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [hu]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [it]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [ja_JP]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [ko_KR]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [pl]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [pt_BR]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [ru]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [zh_CN]\r\n\t version: 10.7.1.1 - (1040133)\r\nFound support for locale: [zh_TW]\r\n\t version: 10.7.1.1 - (1040133)\r\n\r\n","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10051","value":"Urgent","id":"10051"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":30,"total":30,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13191190","id":"13191190","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"It looks like Derby returned 4 rows for the query up to version 10.5. From 10.6, it started returning 3 rows.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2012-01-23T15:03:30.076+0000","updated":"2012-01-23T15:03:30.076+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13191221","id":"13191221","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The query result changed from 4 rows to 3 rows at revision 824966, which was when DERBY-3002 (Add support for GROUP BY ROLLUP) went in.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2012-01-23T15:55:34.819+0000","updated":"2012-01-23T15:55:34.819+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13191846","id":"13191846","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks for narrowing this down. Unfortunately nothing immediately jumps to mind and it's been rather a while since I worked on that code ... :(\r\n\r\nPerhaps we might get some clues by comparing the query plans and statistics from the 10.5 execution against the query plans and statistics from the 10.6 execution.\r\n\r\nAs I recall when working with that part of the system, there were often problems where the optimizer's manipulation of the query nodes got confused about the internal table number and column number references. For example, if at some crucial point we thought we were working with table test_5 but we were actually working with table test_6...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-24T03:22:33.822+0000","updated":"2012-01-24T03:22:33.822+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13191908","id":"13191908","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Not only are there 3 rows instead of 4, but the 3rd row has strange values. When I run the query I see:\r\n\r\nGROUP_REF  |MATCHED_CO&|GROUP_REF  |MATCHED_CO&\r\n-----------------------------------------------\r\n10000      |1          |10000      |1          \r\n10000      |1          |10000      |1          \r\n10000      |1          |10000      |2          \r\n\r\nGiven that the two subqueries, separately, each return\r\n\r\nGROUP_REF  |MATCHED_CO&\r\n-----------------------\r\n10000      |1          \r\n10000      |1          \r\n\r\nI think that the resulting cartesian product 4-row answer should have been:\r\n\r\nGROUP_REF  |MATCHED_CO&|GROUP_REF  |MATCHED_CO&\r\n-----------------------------------------------\r\n10000      |1          |10000      |1          \r\n10000      |1          |10000      |1          \r\n10000      |1          |10000      |1          \r\n10000      |1          |10000      |1          \r\n\r\nThat is, it doesn't seem like we're losing a row; rather, it seems like we're combining two rows into one.\r\n\r\nSo perhaps the problem has something to do with temporary data management; that is, perhaps during the execution of the cartesian produce we are closing and re-opening the inner table-expression, and when we do that, instead of re-computing and returning two rows (10000,1), (10000,1), we are instead returning a single row (10000,2)\r\n\r\nI tried running a slight variation of the problematic query:\r\n\r\nSELECT *\r\nFROM\r\n (SELECT ps1.group_ref, ps1.profile_id,\r\n   COUNT(DISTINCT ps1.matched_count) AS matched_count\r\n FROM test_5 ps1\r\n GROUP BY ps1.group_ref,\r\n   ps1.profile_id\r\n ) a,\r\n (SELECT ps2.group_ref, ps2.profile_id,\r\n   COUNT( DISTINCT ps2.matched_count) AS matched_count\r\n FROM test_6 ps2\r\n GROUP BY ps2.group_ref,\r\n   ps2.profile_id\r\n ) b \r\n\r\n(note that I included 'profile_id' explicitly in the select list of each sub-query), and the results were:\r\n\r\nGROUP_REF  |PROFILE_ID |MATCHED_CO&|GROUP_REF  |PROFILE_ID |MATCHED_CO&\r\n-----------------------------------------------------------------------\r\n10000      |1          |1          |10000      |1          |1          \r\n10000      |1          |1          |10000      |2          |1          \r\n10000      |2          |1          |10000      |1          |2          \r\n\r\nI also extended the test case a bit by additionally doing:\r\n\r\ninsert into test_6 values (3, 10000, 3 );\r\n\r\nafter which the query produced:\r\n\r\nGROUP_REF  |PROFILE_ID |MATCHED_CO&|GROUP_REF  |PROFILE_ID |MATCHED_CO&\r\n-----------------------------------------------------------------------\r\n10000      |1          |1          |10000      |1          |1          \r\n10000      |1          |1          |10000      |2          |1          \r\n10000      |1          |1          |10000      |3          |1          \r\n10000      |2          |1          |10000      |1          |3          \r\n\r\nand then\r\n\r\ninsert into test_6 values (4, 10000, 4 );\r\n\r\nafter which the query produced:\r\n\r\nGROUP_REF  |PROFILE_ID |MATCHED_CO&|GROUP_REF  |PROFILE_ID |MATCHED_CO&\r\n-----------------------------------------------------------------------\r\n10000      |1          |1          |10000      |1          |1          \r\n10000      |1          |1          |10000      |2          |1          \r\n10000      |1          |1          |10000      |3          |1          \r\n10000      |1          |1          |10000      |4          |1          \r\n10000      |2          |1          |10000      |1          |4          \r\n\r\nAnd, lastly,\r\n\r\ninsert into test_5 values (3, 10000, 3);\r\n\r\nand got \r\n\r\nGROUP_REF  |PROFILE_ID |MATCHED_CO&|GROUP_REF  |PROFILE_ID |MATCHED_CO&\r\n-----------------------------------------------------------------------\r\n10000      |1          |1          |10000      |1          |1          \r\n10000      |1          |1          |10000      |2          |1          \r\n10000      |1          |1          |10000      |3          |1          \r\n10000      |1          |1          |10000      |4          |1          \r\n10000      |2          |1          |10000      |1          |4          \r\n10000      |3          |1          |10000      |4          |4          \r\n\r\nBy this point it becomes quite clear that the problem is that, on the first pass through the inner table,\r\nthe cartesian product observes all the rows of the inner table, but on all subsequent passes, the\r\ninner table's rows are collapsed into a single row (perhaps because we are losing track of\r\nthe 'profile_id' column in that inner table somehow?)\r\n\r\nI'm not sure how much more time I'll have to play with this right away, but wanted to record these findings.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-24T05:56:44.638+0000","updated":"2012-01-24T05:56:44.638+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13192174","id":"13192174","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Attaching a dump of Brian's last query with a dump of\r\n\r\na) parse tree\r\nb) bind tree\r\nc) optimized tree\r\nd) query plan\r\n\r\nwith object hashes renumbered from 1 upwards and redundant node printing truncated.\r\n\r\nI have not analyzed it.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-01-24T14:21:07.210+0000","updated":"2012-01-24T14:21:07.210+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13192830","id":"13192830","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks Dag for gathering the output!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-25T03:04:33.797+0000","updated":"2012-01-25T03:04:33.797+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13192835","id":"13192835","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"If you remove DISTINCT from the COUNT() aggregates, the problem disappears (from what I can tell).\r\n\r\nI think it's possible that the problem involves this section of GroupedAggregateResultSet:\r\n\r\n                        /*\r\n                        ** If there was a distinct aggregate, then that column\r\n                        ** was automatically included as the last column in\r\n                        ** the sort ordering. But we don't want it to be part\r\n                        ** of the ordering anymore, because we aren't grouping\r\n                        ** by that column, we just sorted it so that distinct\r\n                        ** aggregation would see the values in order.\r\n                        */\r\n\r\nThis part was quite tricky, and I remember struggling with it for a long time.\r\n\r\nI think that the solution that is currently implemented in GroupedAggregateResultSet\r\nmay be assuming that the result set is only opened and read once.\r\n\r\nHowever, during a query plan such as this cartesian product, the GROUP BY\r\nsubquery is created, then opened/read/closed, opened/read/closed, etc.,\r\nonce per row of the other side of the cartesian product.\r\n\r\nPerhaps what we need to do  is have a better way of handling that extra\r\ninvisible column, so that we can consider it sometimes, and ignore it other times,\r\nwithout doing something as destructive as physically removing it from the\r\nordering array, which is what we do now.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-25T03:11:24.646+0000","updated":"2012-01-25T03:11:24.646+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13193074","id":"13193074","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Attached 'try1.txt' contains a patch which alters the behavior\r\nof this particular test case.\r\n\r\nI haven't run any of the existing tests, nor have I written any\r\nnew tests; I just attached this patch to record the progress I've\r\nmade so far.\r\n\r\nI'm not sure where to find more examples of DISTINCT\r\naggregates. I recall looking for such examples years ago, when\r\nI was first working on GROUP BY, and didn't find many. Does\r\nanybody have any good ideas about where to find more\r\nDISTINCT aggregate queries that we could include in our\r\ntest suites?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-25T14:55:47.053+0000","updated":"2012-01-25T14:55:47.053+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13193900","id":"13193900","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"The existing GroupByTest and the other GroupBy-related\r\ntests in the lang suite appear to be passing with the patch\r\napplied. So I'm encouraged, and planning to move ahead.\r\n\r\nAttached (in tests.sql, tests.out) are the new tests I'm\r\nintending to add to GroupByTest.java, and the results\r\nI'm currently getting (with try1.txt applied).\r\n\r\nDoes anybody have the time to look through tests.sql\r\nand tests.out and offer an opinion about whether the\r\nresults as shown are correct or not?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-26T15:25:30.533+0000","updated":"2012-01-26T15:25:30.533+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13194421","id":"13194421","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Attached 'patch1' is the code change + the tests,\r\npackaged into a patch file.\r\n\r\nStill haven't run the whole regression suite, just GroupByTest.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-27T03:56:48.386+0000","updated":"2012-01-27T03:56:48.386+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13194963","id":"13194963","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"I looked through the sample test.{sql,out} and the result seems to implement the correct SQL semantics to me.\r\nThe last two queries show the expected (1,2,1) vs (2,3,1) I would expect from the COUNT DISTINCT vs plain COUNT in the cartesian product.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-01-27T18:06:51.612+0000","updated":"2012-01-27T18:06:51.612+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13195071","id":"13195071","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thanks for tackling this Bryan! Looked at the patch and what you do seems reasonable to me. I am puzzled by the comment:\r\n\r\n// Although it seems like N aggs could have been\r\n// added at the end, in fact only one has been\r\n// FIXME -- need to get GroupByNode to handle this\r\n// correctly, but that requires understanding\r\n// scalar distinct aggregates.\r\n\r\nCan you throw some light on this? Is this a implementation limitation. If so, what kind of query would be affected by it?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-01-27T20:23:31.071+0000","updated":"2012-01-27T20:23:31.071+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13195073","id":"13195073","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"For the record, I also verified that the new text fixture fails without the code part of the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-01-27T20:28:55.816+0000","updated":"2012-01-27T20:28:55.816+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13195570","id":"13195570","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks for the review, Dag. I'm cautiously optimistic about the patch and will continue testing it.\r\n\r\nRegarding the distinct limitation, Derby has had a limitation that there be at most one DISTINCT\r\naggregate in a query for a long time, probably ever since it was written. See, for example, this\r\nlink from the 10.2 docs: http://db.apache.org/derby/docs/10.2/ref/rrefsqlj32693.html\r\n\r\n        Only one DISTINCT aggregate expression per SelectExpression is allowed. \r\n        For example, the following query is not valid:\r\n\r\n            SELECT AVG (DISTINCT flying_time), SUM (DISTINCT miles) FROM Flights\r\n\r\nI'm guessing here, but I suspect that the plan for implementing such queries would involve\r\noptimizer work *above* the GroupedAggregateResultSet. In particular, the optimizer could\r\n(perhaps) implement the above query by doing:\r\n\r\n1) Fetch all of Flights, and pass it through a GroupedAggregateResultSet which (a) sorts\r\nby flying_time, (b) eliminates duplicate values, and (c) computes the average of the\r\nunique flying_time values\r\n2)  Fetch all of Flights, and pass it through a GroupedAggregateResultSet which (a) sorts\r\nby miles, (b) eliminates duplicate values, and (c) computes the sum of the unique miles values.\r\n3) Combine the two scalar values into the final result\r\n\r\nTrying to do *all* of this in a single pass through the Flights data is complex, because you\r\ncan't simultaneously sort the data on flying_time AND on miles, so you'd have to have some\r\nother way of eliminating duplicates, other than sorting.\r\n\r\nFor example, we could have some sort of low-level HashMap collection to record the\r\nunique values, and have a hybrid algorithm which sorted one one distinct aggregate and\r\nkept hash collections of the other distinct aggregates (assuming all those hashes fit in memory).\r\n\r\nI think that, in practice, those databases which implement multiple DISTINCT aggregates\r\ndo so by having higher-level query plans which take multiple passes over the data.\r\n\r\nIn all my time with Derby, I can't recall anyone ever complaining about the DISTINCT\r\naggregate limitation. Moreover, in my use of databases I haven't found occasion to regularly\r\nuse DISTINCT aggregates. For whatever that's worth.\r\n\r\nThanks again for the review and feedback; I'll continue testing and working on the patch\r\n(I'm out of town for a week so it may be a little while).\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-28T15:56:02.780+0000","updated":"2012-01-28T15:56:02.780+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13195611","id":"13195611","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thanks for that info and your continued work on this, Bryan!\r\n\r\nAs for the implementation strategy of such an improvement, hash lookup\r\nis interesting. Would BackingStoreHashTable be useful here perhaps?\r\nThe optimizer could then use the hash approach when it thinks the\r\ndistinct values will fit in memory but still work, albeit slowly, if\r\nit got the estimate wrong. The multiple sort/pass strategy would used\r\nif the values would be deemed not to fit. An optimizer override could\r\nbe used if the optimizer gets it all wrong, as a last resort. \r\n\r\nIn any case, it may not be worth the effort if nobody needs this. :)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-01-28T19:40:52.751+0000","updated":"2012-01-28T19:40:52.751+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13198351","id":"13198351","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Hi Bryan, thanks for your work on this jira. \r\n\r\nI haven't worked in code related to DISTINCT and GROUP BY but your solution looks like the correct appraoch. Looks like Derby has made an incorrect assumption about the extra column when there are multiple passes through the inner table. \r\n\r\nI am working on DERBY-4631 and noticed that an extra column gets pulled in (which might not be part of the SELECT list) for ORDER BY columns which sounds similar to the extra column for this jira.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2012-02-02T00:08:44.357+0000","updated":"2012-02-02T00:08:44.357+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13198879","id":"13198879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks for looking at the patch, Mamta. I agree, the extra column that may be\r\nadded by ORDER BY is very similar to the GROUP BY case. I think I had that\r\nORDER BY behavior in mind when I was working on the GROUP BY code in 2009.\r\n\r\nOne difference is that, I think, ORDER BY can only occur at the top level of a\r\nquery, not in a nested sub-query, whereas GROUP BY can occur deeply nested.\r\n\r\nSo I don't think that ORDER BY result sets will get re-opened and re-read\r\nin the same way that this GROUP BY query runs.\r\n\r\nI will take a look at DERBY-4631 and let you know if I have any interesting observations.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-02-02T15:34:09.102+0000","updated":"2012-02-02T15:34:09.102+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13199753","id":"13199753","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"No longer, ORDER BY can now happen in subqueries too, after DERBY-4397. So,\r\ncould we have a similar issue there, I wonder?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-02-03T15:11:39.449+0000","updated":"2012-02-03T15:11:39.449+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13199769","id":"13199769","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"I tested it on this data set with a similar nested query and it seems to work ok:\r\n\r\nSELECT * FROM (SELECT ps1.group_ref, ps1.profile_id FROM test_5 ps1 ORDER BY profile_id) a, (SELECT ps2.group_ref, ps2.profile_id FROM test_6 ps2 ORDER BY PROFILE_ID) b ;\r\n\r\nGROUP_REF  |PROFILE_ID |GROUP_REF  |PROFILE_ID \r\n-----------------------------------------------\r\n10000      |1          |10000      |1          \r\n10000      |1          |10000      |1          \r\n10000      |1          |10000      |2          \r\n10000      |1          |10000      |2          \r\n10000      |1          |10000      |2          \r\n10000      |1          |10000      |3 \r\netc.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-02-03T15:27:16.999+0000","updated":"2012-02-03T15:27:16.999+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13210488","id":"13210488","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Triage for 10.9. Moved component to SQL and checked appropriate boxes.\r\nI wonder. Is this a regression?\r\n\r\n Thanks Bryan for working on this issue.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-02-17T19:58:55.923+0000","updated":"2012-02-17T19:58:55.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13211180","id":"13211180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Hi Kathey! Yes, I believe this is a regression. This query, and similar ones, worked correctly\r\nprior to my work on ROLLUP. I checked the \"regression\" box.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-02-19T01:34:32.504+0000","updated":"2012-02-19T01:34:32.504+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13211493","id":"13211493","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I ran full set of tests with the patch and it passed on windows, xp, ibm16 with no errors.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2012-02-19T19:21:35.059+0000","updated":"2012-02-19T19:21:35.059+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13211956","id":"13211956","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks for running the full test suite, Mike; it's very helpful to know\r\nthat the patch hasn't introduced any other regressions.\r\n\r\nThe last thing I'm intending to do prior to commit is to add the extra\r\nORDER BY subquery test that Dag mentioned in an earlier comment.\r\n\r\nI intend to commit this patch this week.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-02-20T16:24:28.813+0000","updated":"2012-02-20T16:24:28.813+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13212076","id":"13212076","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Note that the nested \"order by\" like in my example is rather meaningless, since there is no guarantee the final result will be sorted in any particular way without an ORDER BY on the outer select. It would only make sense if combined with FETCH FIRST n rows, which would limit the table rows going into the join. So perhaps it would be good to add that in the test case.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-02-20T21:07:40.763+0000","updated":"2012-02-20T21:07:40.763+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13212662","id":"13212662","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Updated the patch with an additional ORDER BY subquery test.\r\n\r\nAlso cleaned up the whitespace in the diff and added\r\na simple comment for the new helper method.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-02-21T15:32:58.567+0000","updated":"2012-02-21T15:32:58.567+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13213234","id":"13213234","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thanks, Bryan! Looks like good improvement, and the changes are small and systematic, and make sense to me. +1 ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-02-22T03:13:17.915+0000","updated":"2012-02-22T03:13:17.915+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13213378","id":"13213378","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks all for the reviews and suggestions and assistance running tests\r\nand preparing the patch. It's been very helpful, especially as I don't have\r\nso much time available to work on Derby nowadays.\r\n\r\nCommitted the patch to the trunk as revision 1292134.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-02-22T06:07:30.613+0000","updated":"2012-02-22T06:07:30.613+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13229314","id":"13229314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"merged to 10.8 with revision 1300625","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-03-14T16:34:14.734+0000","updated":"2012-03-14T16:34:14.734+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13229445","id":"13229445","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"This issue probably affects 10.6 and 10.7 as the ROLLUP work went into 10.6,  It would be a good candidate to backport to those releases, but does not affect 10.5 so labeling derby_backport_reject_10_5\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-03-14T18:05:17.506+0000","updated":"2012-03-14T18:05:17.506+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12539467/comment/13823414","id":"13823414","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"[bulk update: close all resolved issues that haven't had any activity the last year]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-11-15T08:15:11.718+0000","updated":"2013-11-15T08:15:11.718+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-5584/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06i5r:"}}