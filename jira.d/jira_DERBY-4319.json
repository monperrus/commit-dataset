{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12430960","self":"https://issues.apache.org/jira/rest/api/latest/issue/12430960","key":"DERBY-4319","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316362","id":"12316362","description":"First release on the 10.8 branch","name":"10.8.1.2","archived":false,"released":true,"releaseDate":"2011-04-29"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2009-07-23 15:53:32.239","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24181","customfield_12310222":"1_*:*_1_*:*_8474230728_*|*_6_*:*_1_*:*_27206151322_*|*_5_*:*_2_*:*_29008893847_*|*_4_*:*_2_*:*_18243809097","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2012-03-06T18:04:50.179+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4319/watchers","watchCount":1,"isWatching":false},"created":"2009-07-20T21:06:45.249+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_backport_reject_10_5"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"10.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314116","id":"12314116","description":"10.5.2 Release July 30 2009 (794445) Now deprecated","name":"10.5.2.0","archived":false,"released":true,"releaseDate":"2009-07-30"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12326133","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12326133","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12423430","key":"DERBY-4176","self":"https://issues.apache.org/jira/rest/api/2/issue/12423430","fields":{"summary":"java.net.SocketException: Connection reset with ibm 1.5. running ServerPropertiesTest in suites.All","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12338079","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12338079","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12501033","key":"DERBY-5122","self":"https://issues.apache.org/jira/rest/api/2/issue/12501033","fields":{"summary":"Placeholder for marking disabled tests.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}},{"id":"12338590","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12338590","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12504344","key":"DERBY-5192","self":"https://issues.apache.org/jira/rest/api/2/issue/12504344","fields":{"summary":"Setting up network server for management tests hangs intermittently","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-06-17T09:19:12.387+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"The test run for 10.5.2.0 hung in suites.All. The console output (the run was with -Dderby.tests.trace=true) showed ttestDefaultProperties had successfully completed but the run was halted.\r\nps -eaf | grep java showed the process that kicked off suites.All, and a networkserver process with the following flags:\r\n- classpath <classpath including derby.jar, derbytools.jar, derbyclient.jar, derbynet.jar, derbyTesting.jar, derbyrun.jar, derbyTesting.jar and junit.jar> -Dderby.drda.logConnections= -Dderby.drda.traceAll= -Dderby.drda.traceDirectory= -Dderby.drda.keepAlive= -Dderby.drda.timeSlice= -Dderby.drda.host= -Dderby.drda.portNumber= -derby.drda.minThreads= -Dderby.drda.maxThreads= -Dderby.drda.startNetworkServer= -Dderby.drda.debug= org.apache.derby.drda.NetworkServerControl start -h localhost -p 1527\r\nThis process had been sitting for 2 days.\r\nAfter killing the NetworkServerControl process, the test continued successfully (except for DERBY-4186, fixed in trunk), but the following was put out to the console:\r\n START-SPAWNED:SpawnedNetworkServer STANDARD OUTPUT: exit code=137\r\n2009-07-18 03:16:07.157 GMT : Security manager installed using the Basic server\r\nsecurity policy.\r\n2009-07-18 03:16:09.169 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nstarted and ready to accept connections on port 1527\r\nEND-SPAWNED  :SpawnedNetworkServer STANDARD OUTPUT:\r\n\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10369","value":"Regression Test Failure","id":"10369"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"35884","summary":"hang in suites.all with ibm 1.5 on AIX after ttestDefaultProperties","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10422","value":"High Value Fix","id":"10422"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"ibm jvm 1.5 SR9-0 on IBM AIX 3.5","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10051","value":"Urgent","id":"10051"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":28,"total":28,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12733357","id":"12733357","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"system/derby.log  at the time of the hang had 1 start ( on port 1531) and 3 shutdowns.\r\n2009-07-18 03:15:51.865 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nstarted and ready to accept connections on port 1531\r\n2009-07-18 03:15:58.988 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nshutdown\r\n2009-07-18 03:15:59.101 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nshutdown\r\n2009-07-18 03:15:59.257 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nshutdown\r\n\r\nlogs/serverConsoleOutput.log had this: \r\n2009-07-18 03:15:03.669 GMT : Could not connect to Derby Network Server on host\r\n127.0.0.1, port 1528: A remote host refused an attempted connect operation.\r\n2009-07-18 03:15:04.177 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nstarted and ready to accept connections on port 1528\r\n2009-07-18 03:15:04.259 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nshutdown\r\n2009-07-18 03:15:04.361 GMT : Could not connect to Derby Network Server on host \r\n127.0.0.1, port 1528: A remote host refused an attempted connect operation.\r\n2009-07-18 03:15:04.445 GMT : Could not connect to Derby Network Server on host\r\n127.0.0.1, port 1527: A remote host refused an attempted connect operation.\r\n2009-07-18 03:15:04.548 GMT : Could not connect to Derby Network Server on host\r\n127.0.0.1, port 1527: A remote host refused an attempted connect operation.\r\n2009-07-18 03:15:04.658 GMT : Could not connect to Derby Network Server on host\r\n127.0.0.1, port 1527: A remote host refused an attempted connect operation.\r\n2009-07-18 03:15:04.768 GMT : Could not connect to Derby Network Server on host\r\n127.0.0.1, port 1527: A remote host refused an attempted connect operation.\r\n2009-07-18 03:15:04.848 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nstarted and ready to accept connections on port 1527\r\n2009-07-18 03:15:40.465 GMT : Apache Derby Network Server - 10.5.2.0 - (794445)\r\nshutdown\r\n\r\nI don't find any further helpful info.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-07-20T21:15:16.113+0000","updated":"2009-07-20T21:15:16.113+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12734620","id":"12734620","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"This reproduces when I just run ServerPropertiesTest.\r\nThe log/serverConsoleOutput.log must be from a different test - when I just run the ServerPropertiesTest it doesn't get created.\r\nI'll do some more experiments (newer jvm, redo 10.5.1.1, insane, latest 10.5 build) and report.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-07-23T15:39:36.755+0000","updated":"2009-07-23T15:39:36.755+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12734625","id":"12734625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"It would be useful to see the thread dump to see if this might be another shutdown issue or something different.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-07-23T15:53:32.239+0000","updated":"2009-07-23T15:53:32.239+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12734636","id":"12734636","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I went back over my 10.5.1 testing notes, and I *have* seen this before - with 10.5.1.0 with  IBM 1.6 SR4 (and I thought it was a jvm issue as I didn't see it that time with IBM 1.5); then with 10.5.1.1 I saw it with IBM 1.5 and IBM 1.6 SR3, but I couldn't reproduce anymore after I rebooted  the machine...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-07-23T16:28:45.379+0000","updated":"2009-07-23T16:28:45.379+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12734640","id":"12734640","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching the javacore files obtained with kill -QUIT of the test hung (with just running the 1 test).\r\n25380 was the pid of the NetworkServerControl start process; \r\n24726 was the pid of the junit.textui.TestRunner ...ServerPropertiesTest process.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-07-23T16:54:45.270+0000","updated":"2009-07-23T16:54:45.270+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12735742","id":"12735742","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I ran the test with 10.4.2.0 and IBM 1.5, and it hung too!\r\nThen I couldn't log on anymore, and booted the machine, and now there is no more hang.\r\n\r\nI'd blame it on the machine but it's odd that it's only in this particular test...\r\nNo one else works on this machine, there are no long-running processes...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-07-27T19:51:44.581+0000","updated":"2009-07-27T19:51:44.581+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12746935","id":"12746935","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I did not see this during the 10.5.3.0 test run.\r\n(doesn't mean it's gone, I don't think there was a related change between 10.5.2.0 and 10.5.3.0).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-08-24T16:03:34.405+0000","updated":"2009-08-24T16:03:34.405+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12770248","id":"12770248","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I've tried to get this error, but it's not reproducing for me.\r\nIf I see it again, I can reopen and attempt further research.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-10-26T23:03:55.958+0000","updated":"2009-10-26T23:03:55.958+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12915361","id":"12915361","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I saw this while testing 10.6.2.1, insane jars, once with ibm15 (SR12, FP1) (passed second run) and once with ibm16 (SR8, FP1), running suites.All with -Xmx512M -Xms512M (and -Dderby.tests.trace=true).\r\n\r\nI'lll try to gather more info.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2010-09-27T17:05:29.784+0000","updated":"2010-09-27T17:05:29.784+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/12994478","id":"12994478","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Triage for 10.8. Marking urgent as it is generally not good to have hanging tests that prevent the rest of the test run from completing.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-02-14T20:41:40.587+0000","updated":"2011-02-14T20:41:40.587+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13000595","id":"13000595","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I ran the test and saw it hang on AIX.\r\nWhen I think tried to ping the server manually once hung I saw a connection reset error:\r\n\r\n$ java org.apache.derby.drda.NetworkServerControl ping\r\nMon Feb 28 14:52:49 PST 2011 : Error on client socket:\r\n Connection reset\r\nMon Feb 28 14:52:49 PST 2011 : Connection reset\r\njava.net.SocketException: Connection reset\r\n        at java.net.SocketInputStream.read(SocketInputStream.java:197)\r\n        at java.net.SocketInputStream.read(SocketInputStream.java:116)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.fillReplyBuffer(N\r\networkServerControlImpl.java:2873)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.readResult(Networ\r\nkServerControlImpl.java:2817)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.pingWithNoOpen(Ne\r\ntworkServerControlImpl.java:1253)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.ping(NetworkServe\r\nrControlImpl.java:1228)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.executeWork(Netwo\r\nrkServerControlImpl.java:2260)\r\n        at org.apache.derby.drda.NetworkServerControl.main(NetworkServerControl.\r\njava:320)\r\n\r\nAfter that occurred, any attempt to ping or shutdown the server hung and looking at the javacore, the ClientThread was no longer running\r\n\r\nSince in the original trace from the hang was in SpawnedProcess.complete() called from NetworkServerTestSetup.teardown() this is what I think has happened:\r\n\r\nIn NetworkServerTestSetup.tearDown we have\r\n  if (networkServerController != null) {\r\n            boolean running = false;\r\n            try {\r\n                networkServerController.ping();\r\n                running = true;\r\n            } catch (Exception e) {\r\n            }\r\n\r\nAssuming the ping returned the connection reset, even though the process was still running it made teardown think that the server was actually down. It did not attempt to shutdown, but  called spawnedServer.complete(failedShutdown != null); with false as its argument so did not try to destroy the process either, so remains hung waiting for the process to enter.\r\n\r\nThere seem to be a few issues here.\r\n1)  How does the server get into this state for this particular test?\r\n2) How can we ensure that the server is brought down or destroyed no matter what?\r\n\r\nI think I will focus on the second aspect first, so we don't have the risk of full runs getting held up and then try to understand the root cause for the network server state after that.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-02-28T23:10:12.391+0000","updated":"2011-02-28T23:10:12.391+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13001161","id":"13001161","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The attached patch changes NetworkServerControl.tearDown() to print the stack trace and destroy the server process if the test ping fails to some error other than the standard Cannot Connect error that happens if the server is not up. Before the patch if the ping failed for any reason the assumption was that the server was down.\r\n\r\nThis doesn't eliminate the possibility for a hang entirely as if the test ping itself were to hang, then we would still have the problem.  \r\n\r\nNote this patch does not get at the root cause of the Connection reset error on aix, but will hopefully get the tests to finish their run. Currently if the the process destruction is required, it won't result in the failure of a test, just the print of the stacktrace to system.out.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-01T22:42:39.574+0000","updated":"2011-03-01T22:42:39.574+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13001171","id":"13001171","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Well this patch isn't quite right yet  for the german tests, but I'll fix that up.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-01T23:08:01.120+0000","updated":"2011-03-01T23:08:01.120+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13003245","id":"13003245","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Well I want to try to get something checked in to get the tests to complete on aix before we cut the release candidate. I believe the attached patch which adds a timeout to the SpawnedProcess.complete() method should do that and should do no harm.  I am still not totally happy with it and unfortunately the aix machine does not feel like hanging right now.  I am running suites.All on Windows and AIX now and will checkin before tomorrow mornings rc if all goes well.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-07T03:13:26.321+0000","updated":"2011-03-07T03:13:26.321+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13003262","id":"13003262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I got an out of memory error on the aix run. I don't know that it is related to this change but won't chance it. I am sorry it won't make it by tomorrow morning.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-07T04:56:17.044+0000","updated":"2011-03-07T04:56:17.044+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13004220","id":"13004220","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"It ended up that aix has always required -Xmx512M which I added and got through the run. I did two runs on AIX and two on windows getting different known intermittent failures each time, but none I think related to this change. Committed revision 1079548.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-08T21:20:43.350+0000","updated":"2011-03-08T21:20:43.350+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13004827","id":"13004827","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"There was some network maintenance that seems to be what got the aix machine out of its problematic  state.   Myrna said in the past after reboot (this time it wasn't reboot but reboot of the router) it will work for a while and then start to consistently fail.  I kicked of fifty runs of the derbynet suite to see if I can get the machine back into the problematic state.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-09T22:10:50.656+0000","updated":"2011-03-09T22:10:50.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13005332","id":"13005332","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I have the machine back in the state where this reproduces and am sorry to say that there is still a hang in a different method, even with my prior attempt to get past it, but since I can reproduce now, I should be able to make some progress on this issue.    I'll record some info here in case it becomes hard to reproduce again.\r\n\r\n\r\nThe current state of hang is that the launched network server process which seems to specify all the drda parameters without values:\r\ncloudtst 6488248 4390978   0 14:41:38      -  0:20 /local1/IBM_JDK/15sr13/sdk/jr\r\ne/bin/java -classpath /local1/kmarsden/repro/derby-4319/jars//derby.jar:/local1/\r\nkmarsden/repro/derby-4319/jars//derbyrun.jar:/local1/kmarsden/repro/derby-4319/j\r\nars//derbyTesting.jar:/local1/kmarsden/repro/derby-4319/jars//junit.jar -Dderby.\r\ndrda.logConnections= -Dderby.drda.traceAll= -Dderby.drda.traceDirectory= -Dderby\r\n.drda.keepAlive= -Dderby.drda.timeSlice= -Dderby.drda.host= -Dderby.drda.portNum\r\nber= -Dderby.drda.minThreads= -Dderby.drda.maxThreads= -Dderby.drda.startNetwork\r\nServer= -Dderby.drda.debug= org.apache.derby.drda.NetworkServerControl start -h\r\nlocalhost -p 1527\r\n\r\nI will attach the javacore with thread dump as LaunchedNetworkServer.javacore.20110309.160148.6488248.0001.txt\r\n\r\nThe server threads look pretty normal with a ClientThread running waiting to accept requests.\r\n\r\nThe test process is hung in NetworkServerTestSetup.complete(). I am not sure if it is later or if the change I made just did not work.  I will attach the test process file as:\r\nTestProcess.javacore.20110310.123703.4390978.0001.txt\r\n\r\nIf I try to ping the server from the command line I get a ConnectionReset error:\r\n$ java org.apache.derby.drda.NetworkServerControl ping\r\nThu Mar 10 12:47:39 PST 2011 : Error on client socket:\r\n Connection reset\r\nThu Mar 10 12:47:39 PST 2011 : Connection reset\r\njava.net.SocketException: Connection reset\r\n        at java.net.SocketInputStream.read(SocketInputStream.java:197)\r\n        at java.net.SocketInputStream.read(SocketInputStream.java:116)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.fillReplyBuffer(N\r\networkServerControlImpl.java:2873)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.readResult(Networ\r\nkServerControlImpl.java:2817)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.pingWithNoOpen(Ne\r\ntworkServerControlImpl.java:1253)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.ping(NetworkServe\r\nrControlImpl.java:1228)\r\n        at org.apache.derby.impl.drda.NetworkServerControlImpl.executeWork(Netwo\r\nrkServerControlImpl.java:2260)\r\n        at org.apache.derby.drda.NetworkServerControl.main(NetworkServerControl.\r\njava:320)\r\n\r\n\r\nThen after that subsequent ping attempts hang and a new thread dump on the Network Server process shows that the ClientThread is no longer there.   I think this should never happen. I think a lot of work has been put into making sure that the ClientThread always survives any type of error in order host more connections. see attachment  LaunchedNetworkServerAfterPing.javacore.20110310.124948.6488248.0002.txt\r\n\r\n\r\nAnother thing to note is that prior to the defaultProperties test there was actually a stack trace in the setPortPriorty test with a Connection reset  which did not cause failure. see TestOutput2011-03-09.txt .out\r\n\r\n\r\nThis issue actually has many facets that are worth working on:\r\n\r\n1) How do we make sure a spawned network server process is destroyed if it  hangs the whole suite?\r\n\r\n2)  Under  what circumstances can the Network Server ClientThread that loops accepting new connections be destroyed?\r\n\r\n3) What sort of problem is being caused on AIX by starting network server with these odd options?  I am thinking maybe it is related to soTimeout or keepalive getting set to an unexpected option but am not sure.\r\n\r\nI have been holding off on working on 3, because it provides a good reproduction for issue one and two but think that at this point, the best thing to do would be to disable the problematic fixture on AIX whether it is testSetpPortPriority or testDefaultProperties.    Then I can work on all three issues in a logical order and pace without release concerns.  I'll look into doing that.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-10T21:03:21.709+0000","updated":"2011-03-10T21:03:21.709+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13005334","id":"13005334","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Attaching files per previous comment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-10T21:08:02.775+0000","updated":"2011-03-10T21:08:02.775+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13005855","id":"13005855","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I am looking at disabling this test and see that currently we have methods like isSunJVM() isIBMJVM()  etc are in BaseTestCase.  I will be adding isAIXPlatform() isJava5() and  with other issues for disabling tests there will probably be isMacPlatform() etc.  Is BaseTestCase() the right place for these kind of methods?\r\n\r\nFor the platforms, one option might be to have new class  OsName.java that has String constants for  all the os.name values and then just have an isPlatform(String) method in BaseTestCase.  (sorry accidentally put this in DERBY-5096 at first.)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-11T21:37:14.309+0000","updated":"2011-03-11T21:53:21.991+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13005965","id":"13005965","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The Attached patch derby-4319_disable_SetPortPriorty_diff.txt disables the ttestsetPortPriorityTest  on AIX JDK 1.5 which seems to be the test that get us into a state where we might hang although the actual hang happens in the subsequent test ttestDefaultProperties.\r\n\r\nI added the OsName class with the os.name values that I know.  Still missing are Solaris,  HP, and I am not sure on Windows if Windows 7, 2008 etc have different variations, but this is a start.  \r\n\r\nI am looping derbynet on AIX now and doing a suites.All run on Windows.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-12T01:36:08.647+0000","updated":"2011-03-12T01:36:08.647+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13006425","id":"13006425","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I ended up having to disable both ttestSetPortPriority and ttestDefaultProperties.  With this patch I got through 35 runs of derbynet on AIX.  I'll check this in today.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-03-14T14:25:16.191+0000","updated":"2011-03-14T14:25:16.191+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13021354","id":"13021354","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I now saw the hang with ibm 1.6 SR9 FP1 (during the 10.8.1.1 platform tests).\r\nI guess we should stop them from running with ibm 1.6 also.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2011-04-19T00:23:12.174+0000","updated":"2011-04-19T00:23:12.174+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13021457","id":"13021457","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I'm wondering if this could have the same root cause as DERBY-5192 (fixed after 10.8.1.1). That could prevent server shutdown from terminating the server, which would leave the server process running forever. Since NetworkServerTestSetup waits until the external process terminates, the test will just hang there. What Kathey observed when she pinged the hanging server on AIX is also consistent with what I saw when I pinged a server that hung because of DERBY-5192 (see comment https://issues.apache.org/jira/browse/DERBY-5192?focusedCommentId=13020264&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13020264 ).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2011-04-19T07:57:55.889+0000","updated":"2011-04-19T07:58:25.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13021598","id":"13021598","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Thanks for that comment; I saw the link, but hadn't noticed there was a fix. I was contemplating skipping running the 10.8.1.2 RC on this OS, but now I'll at least run the 1.6 with it, and uncomment the skipped tests and run with ibm 1.5. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2011-04-19T14:10:34.856+0000","updated":"2011-04-19T14:10:34.856+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13025419","id":"13025419","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I got the hang again with 10.7.1.1 and then tested same with 10.8.1.2 (with modified derbyTesting.jar) and indeed,  this appears now fixed. I reinstated the testing with revision 1096875 on trunk, and with revision 1096895 on 10.8.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2011-04-26T20:36:43.711+0000","updated":"2011-04-26T20:36:43.711+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13223480","id":"13223480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I marked this derby_backport_reject_10_5, not because of any risk but this issue  has  just test changes made during the diagnosis of this issue. The real fix it seems  came under DERBY-5192, so there is no real value to backporting to 10.5\r\n\r\nIf someone ever wants these changes in older releases for some reason it should be fine to do so.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-03-06T18:04:50.212+0000","updated":"2012-03-06T18:04:50.212+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12430960/comment/13685159","id":"13685159","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"[bulk update] Close all resolved issues that haven't been updated for more than one year.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-06-17T09:19:12.379+0000","updated":"2013-06-17T09:19:12.379+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4319/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06i7j:"}}