{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12456578","self":"https://issues.apache.org/jira/rest/api/latest/issue/12456578","key":"ARIES-178","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310981","id":"12310981","key":"ARIES","name":"Aries","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310981&avatarId=10065","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310981&avatarId=10065","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310981&avatarId=10065","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310981&avatarId=10065"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10520","id":"10520","description":"Apache Aries","name":"Aries"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-02-17 21:16:30.018","customfield_12312323":null,"customfield_12310420":"93792","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_795048400_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-02-27T00:19:00.228+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-178/watchers","watchCount":0,"isWatching":false},"created":"2010-02-17T19:28:11.828+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adamwojtuniak","name":"adamwojtuniak","emailAddress":"adamwojtuniak at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adam Wojtuniak","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-02-17T20:21:07.009+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313100","id":"12313100","name":"JMX"}],"timeoriginalestimate":null,"description":"Using PackageStateMBean.listPackages() gives the following exception on Felix 2.0.3 for certain bundles (here: spring-ws-core-1.5.9.jar)\r\n\r\nCaused by: javax.management.openmbean.KeyAlreadyExistsException: Argument value's index, calculated according to this TabularData instance's tabularType, already refers to a value in this table.\r\n        at javax.management.openmbean.TabularDataSupport.checkValueAndIndex(TabularDataSupport.java:871)\r\n        at javax.management.openmbean.TabularDataSupport.internalPut(TabularDataSupport.java:331)\r\n        at javax.management.openmbean.TabularDataSupport.put(TabularDataSupport.java:323)\r\n        at org.apache.aries.jmx.codec.PackageData.tableFrom(PackageData.java:142)\r\n        at org.apache.aries.jmx.framework.PackageState.listPackages(PackageState.java:130)\r\n        ...\r\n\r\nThe original reason for this is that Felix returns multiple identical ExportedPackage when calling\r\n\r\nExportedPackage[]  PackageAdmin.getExportedPackages(bundle)\r\n\r\n(in this example, org.springframework.ws.soap.addressing.server; version=1.5.9 is given twice)\r\nI don't know whether this is allowed by the Spec (or is in fact a bug in Felix), but Aries could be smarter here anyway.\r\nSince each ExportedPackage is wrapped in a PackageData for JMX-Export and then added to a Set<PackageData> all\r\nwhat is needed to add appropriate equals() and hashCode() to PackageData to make the set contain only PackageData\r\nwith a unique index (NAME, VERSION, EXPORTING_BUNDLE) for the TabularData to build up for the JMX return value.\r\n\r\nPlease find attachted a patch to add equals() and hashCode() to PackageData.\r\n\r\nMy question though is, whether this an allowed behaviour of Felix to return same ExportedPackage objects multiple times \r\nin getExportedPackages() (so that in case I could rise an issue for Felix as well).  ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"167479","summary":"PackageMBean.listPackages() raises an exception for certain bundles in Felix 2.0.3","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12456578/comment/12834964","id":"12834964","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"body":"BTW, the reason that org.springframework.ws.soap.addressing.server is contained twice is connected to\r\nthe fragment spring-ws-core-tiger-1.5.9.jar (also installed) which overwrites certain packages in spring-ws-core.1.5.9.jar:\r\n\r\n[osgi] : ls *ws.core*\r\n  Id   State       Lev Name\r\n---------------------------------------------------------------------------------------\r\n  41   Active        5 Spring WS Core (1.5.9)\r\n 277   Installed     1 Spring WS Core - Java 5 (1.5.9)\r\n[osgi] : ls 277\r\nName:          277 Spring WS Core - Java 5\r\n               org.springframework.bundle.ws.core-tiger [Installed]\r\nLocation:      file:///Users/roland/.m2/repository/org/springframework/ws/spring-ws-core-tiger/1.5.9/spring-ws-core-tiger-1.5.9.jar\r\n\r\nImports:       javax.xml.namespace \r\n               javax.xml.transform \r\n               javax.xml.transform.dom \r\n               javax.xml.xpath  * \r\n               org.apache.commons.logging \r\n               org.springframework.aop.support [2.0,4.0)\r\n               org.springframework.beans [2.0,4.0)\r\n               org.springframework.beans.factory [2.0,4.0)\r\n               org.springframework.beans.factory.config [2.0,4.0)\r\n               org.springframework.context [2.0,4.0)\r\n               org.springframework.core.annotation [2.0,4.0)\r\n               org.springframework.oxm [1.5.9,1.5.9]\r\n               org.springframework.stereotype [2.0,4.0)\r\n               org.springframework.util [2.0,4.0)\r\n               org.springframework.ws [1.5.9,1.5.9]\r\n               org.springframework.ws.context [1.5.9,1.5.9]\r\n               org.springframework.ws.server [1.5.9,1.5.9]\r\n               org.springframework.ws.server.endpoint [1.5.9,1.5.9]\r\n               org.springframework.ws.server.endpoint.adapter [1.5.9,1.5.9]\r\n               org.springframework.ws.server.endpoint.annotation [1.5.9,1.5.9]\r\n               org.springframework.ws.server.endpoint.mapping [1.5.9,1.5.9]\r\n               org.springframework.ws.server.endpoint.support [1.5.9,1.5.9]\r\n               org.springframework.ws.soap [1.5.9,1.5.9]\r\n               org.springframework.ws.soap.addressing.core [1.5.9,1.5.9]\r\n               org.springframework.ws.soap.addressing.server [1.5.9,1.5.9]\r\n               org.springframework.ws.soap.addressing.server.annotation [1.5.9,1.5.9]\r\n               org.springframework.ws.soap.server [1.5.9,1.5.9]\r\n               org.springframework.ws.soap.server.endpoint [1.5.9,1.5.9]\r\n               org.springframework.ws.soap.server.endpoint.annotation [1.5.9,1.5.9]\r\n               org.springframework.ws.soap.server.endpoint.mapping [1.5.9,1.5.9]\r\n               org.springframework.xml.namespace [1.5.9,1.5.9]\r\n               org.w3c.dom \r\n[osgi] : ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"created":"2010-02-17T19:56:09.098+0000","updated":"2010-02-17T19:56:09.098+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12456578/comment/12834995","id":"12834995","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adamwojtuniak","name":"adamwojtuniak","emailAddress":"adamwojtuniak at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adam Wojtuniak","active":true},"body":"Hi Roland\r\n\r\nAll the values in CompositeData need to be uinque so it's no harm to override equals and hashcode in PackageData.\r\nIam going to apply your patch in a couple minutes. I checked docs of PackageAdmin but there is nothing mentioned about\r\nuniqeness of ExportedPackages. So probably there is no bug in Felix but you can check that on Felix mailing list.\r\n\r\nThanks for the patch.\r\nRegards,\r\nAdam \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adamwojtuniak","name":"adamwojtuniak","emailAddress":"adamwojtuniak at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adam Wojtuniak","active":true},"created":"2010-02-17T21:16:30.018+0000","updated":"2010-02-17T21:16:30.018+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12456578/comment/12835326","id":"12835326","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=not","name":"not","emailAddress":"not at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=not&avatarId=10384","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=not&avatarId=10384","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=not&avatarId=10384","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=not&avatarId=10384"},"displayName":"Alasdair Nottingham","active":true},"body":"The OSGi spec allows you to export the same package multiple times. \r\n\r\nI believe ARIES-146 is a dupe of this and it was found on equinox, so this isn't felix specific if they really are dupes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=not","name":"not","emailAddress":"not at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=not&avatarId=10384","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=not&avatarId=10384","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=not&avatarId=10384","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=not&avatarId=10384"},"displayName":"Alasdair Nottingham","active":true},"created":"2010-02-18T18:37:22.950+0000","updated":"2010-02-18T18:37:22.950+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12456578/comment/12839092","id":"12839092","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adamwojtuniak","name":"adamwojtuniak","emailAddress":"adamwojtuniak at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adam Wojtuniak","active":true},"body":"Fixed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=adamwojtuniak","name":"adamwojtuniak","emailAddress":"adamwojtuniak at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Adam Wojtuniak","active":true},"created":"2010-02-27T00:19:00.224+0000","updated":"2010-02-27T00:19:00.224+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-178/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0t11r:"}}