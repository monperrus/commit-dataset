{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12465288","self":"https://issues.apache.org/jira/rest/api/latest/issue/12465288","key":"DERBY-4676","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314182","id":"12314182","description":"Old head of 10.5 branch","name":"10.5.3.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315343","id":"12315343","description":"Derby 10.6.2.1 Release","name":"10.6.2.1","archived":false,"released":true,"releaseDate":"2010-10-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315564","id":"12315564","description":"First release on the 10.7 branch.","name":"10.7.1.1","archived":false,"released":true,"releaseDate":"2010-12-14"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-05-24 22:11:59.303","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24404","customfield_12310222":"3_*:*_1_*:*_524263366_*|*_1_*:*_1_*:*_743640307_*|*_6_*:*_1_*:*_1902751717_*|*_5_*:*_2_*:*_128419669_*|*_4_*:*_1_*:*_676086188","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-07-09T17:39:57.727+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4676/watchers","watchCount":2,"isWatching":false},"created":"2010-05-24T17:27:16.480+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["nullpointerexception"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"10.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314117","id":"12314117","description":"Next release after 10.5.2.0 release candidate #1","name":"10.5.3.0","archived":false,"released":true,"releaseDate":"2009-08-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313727","id":"12313727","description":"Feature release","name":"10.6.1.0","archived":false,"released":true,"releaseDate":"2010-05-18"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12332184","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12332184","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12465446","key":"DERBY-4678","self":"https://issues.apache.org/jira/rest/api/2/issue/12465446","fields":{"summary":"Avoid code duplication in GenericConglomerateController.fetch()","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}},{"id":"12332778","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12332778","type":{"id":"12310040","name":"Required","inward":"is required by","outward":"requires","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310040"},"inwardIssue":{"id":"12468384","key":"DERBY-4728","self":"https://issues.apache.org/jira/rest/api/2/issue/12468384","fields":{"summary":"10.5 backport effort tracking issue ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-06-17T09:19:26.432+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11412","id":"11412","name":"Store"}],"timeoriginalestimate":null,"description":"Running into a NullPointerException error in the Apache Derby database over multiple versions of the derby jars.  From testing, this issue intermittently occurs during moderate load test scenarios, but has never occurred in production.   This is using Derby as embedded and always occurs on the same statement as shown below and in the attachment.   Following the error, hibernate throws an exception which results in the code attempting to rollback the transaction.  The rollback fails as the NullPointerException appears to kill the connection.\r\n\r\n*** derby.log \r\n\r\n2010-04-27 16:05:22.429 GMT Thread[SNMPDelayedStoreRunnable2Thread,5,main] (XID = 244546), (SESSIONID = 17), (DATABASE = db), (DRDAID = null), Cleanup action starting\r\n2010-04-27 16:05:22.429 GMT Thread[SNMPDelayedStoreRunnable2Thread,5,main] (XID = 244546), (SESSIONID = 17), (DATABASE = db), (DRDAID = null), Failed Statement is: select nonprimary0_.componentid as componen1_1_, nonprimary0_.deviceid as deviceid1_, device1_.deviceid as deviceid0_, device1_.name as name3_0_, device1_.description as descript3_3_0_, device1_.device_type as device4_3_0_, device1_.managed_address as managed5_3_0_, device1_.csid as csid3_0_, device1_.url as url3_0_, device1_.date_written_to_db as date8_3_0_, device1_.valid as valid3_0_, device1_.invalid_reason as invalid10_3_0_, device1_.version as version3_0_ from subsystem_callserver_map nonprimary0_ inner join device_data device1_ on nonprimary0_.deviceid=device1_.deviceid where nonprimary0_.componentid=? with 1 parameters begin parameter #1: 86b5b069-ca5c-4c38-9643-d9308c246100 :end parameter \r\njava.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.access.conglomerate.GenericConglomerateController.fetch(Unknown Source)\r\n\tat org.apache.derby.impl.sql.execute.IndexRowToBaseRowResultSet.getNextRowCore(Unknown Source)\r\n\tat org.apache.derby.impl.sql.execute.NestedLoopJoinResultSet.getNextRowCore(Unknown Source)\r\n\tat org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedResultSet.next(Unknown Source)\r\n\tat com.mchange.v2.c3p0.impl.NewProxyResultSet.next(NewProxyResultSet.java:2859)\r\n\tat org.hibernate.loader.Loader.doQuery(Loader.java:408)\r\n\tat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:218)\r\n\tat org.hibernate.loader.Loader.loadCollection(Loader.java:1434)\r\n\tat org.hibernate.loader.collection.CollectionLoader.initialize(CollectionLoader.java:99)\r\n\tat org.hibernate.persister.collection.AbstractCollectionPersister.initialize(AbstractCollectionPersister.java:488)\r\n\tat org.hibernate.event.def.DefaultInitializeCollectionEventListener.onInitializeCollection(DefaultInitializeCollectionEventListener.java:60)\r\n\tat org.hibernate.impl.SessionImpl.initializeCollection(SessionImpl.java:1430)\r\n\tat org.hibernate.collection.AbstractPersistentCollection.forceInitialization(AbstractPersistentCollection.java:280)\r\n\tat org.hibernate.engine.PersistenceContext.initializeNonLazyCollections(PersistenceContext.java:796)\r\n\tat org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:223)\r\n\tat org.hibernate.loader.Loader.doList(Loader.java:1593)\r\n\tat org.hibernate.loader.Loader.list(Loader.java:1577)\r\n\tat org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:395)\r\n\tat org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:271)\r\n\tat org.hibernate.impl.SessionImpl.list(SessionImpl.java:844)\r\n\tat org.hibernate.impl.QueryImpl.list(QueryImpl.java:74)\r\n\tat ooad.p.ga(p.java:288)\r\n\tat ooad.p.ga(p.java:117)\r\n\tat oo.c.gdc(c.java:119)\r\n\tat oo.d.c(d.java:805)\r\n\tat oo.d.c(d.java:785)\r\n\tat oo.d.c(d.java:766)\r\n\tat oodb.s.run(s.java:82)\r\n\tat java.lang.Thread.run(Thread.java:595)\r\n\r\n*** application log\r\n\r\nApr 27 2010 12:05:22.476 -0400: %_JDBCExceptionReporter-3-org.hibernate.util.JDBCExceptionReporter:  Java exception: ': java.lang.NullPointerException'.  \r\nApr 27 2010 12:05:22.492 -0400: %_JDBCTransaction-3-org.hibernate.transaction.JDBCTransaction:  JDBC rollback failed  \r\njava.sql.SQLException: No current connection.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.noCurrentConnection(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkIfClosed(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.setupContextStack(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.rollback(Unknown Source)\r\n\tat com.mchange.v2.c3p0.impl.NewProxyConnection.rollback(NewProxyConnection.java:755)\r\n\tat org.hibernate.transaction.JDBCTransaction.rollbackAndResetAutoCommit(JDBCTransaction.java:163)\r\n\tat org.hibernate.transaction.JDBCTransaction.rollback(JDBCTransaction.java:142)\r\n\tat ooad.p.r(p.java:888)\r\n\tat ooad.p.ga(p.java:310)\r\n\tat ooad.p.ga(p.java:117)\r\n\tat oa.c.gdc(c.java:119)\r\n\tat oa.d.c(d.java:805)\r\n\tat oa.d.c(d.java:785)\r\n\tat oa.d.c(d.java:766)\r\n\tat ooad.s.run(s.java:82)\r\n\tat java.lang.Thread.run(Thread.java:595)","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"37677","summary":"NullPointerException on SELECT on INNER JOIN","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Windows XP, same problem occurred using Apache Derby 10.5.3.0 and still with the newly release 10.6.1.0 version.   \r\n\r\nFor completeness, also noting using c3p0 0.9.1-pre10 and hibernate 3.0.5.   Attempted trying later versions of both (c3p0 and hibernate) to see if this resulted in a workaround, but had no success.","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":25,"total":25,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12870726","id":"12870726","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"body":"Apache Derby log stacktrace and application error stacktrace.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"created":"2010-05-24T17:31:42.852+0000","updated":"2010-05-24T17:31:42.852+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12870874","id":"12870874","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Hi Seth,\r\n\r\nIf you have the chance, it would be great if you could try to run with a debug version of Derby (available from the download page, look for the lib-debug tarball) so that we get line numbers in the stack trace and perhaps an assert failure with more information.\r\n\r\nAnother thing that came to mind: What's the transaction isolation level for the connection? I was wondering if this could be caused by another thread deleting a row right after it was found in the index and before it was read from the heap, which I think may happen if the isolation level is read uncommitted.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-05-24T22:11:59.303+0000","updated":"2010-05-24T22:11:59.303+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12871136","id":"12871136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"body":"Hi Knut,\r\n\r\nThanks for the quick reply.  I'll grab the debug jars and attempt to recreate the exception condition.  I'll add further comments/enclosures as I find out more (connection transaction isolation and debug logs).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"created":"2010-05-25T13:21:46.570+0000","updated":"2010-05-25T13:21:46.570+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12871166","id":"12871166","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"body":"derby.log and application error log attachment using Derby 10.6.1.0 debug jars.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"created":"2010-05-25T14:34:08.469+0000","updated":"2010-05-25T14:34:08.469+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12871169","id":"12871169","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"body":"I have attached the new logs (derby and application) using the 10.6.1.0 debug jars.  The derby log file shows the initial NullPointerException with source line numbers.  The application log file shows the debug dump of thread states with an assert failure.\r\n\r\nI also double checked the transaction isolation level of the connection being used.   The transaction isolation level is always returning 2 which looks to be TRANSACTION_READ_COMMITTED.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"created":"2010-05-25T14:37:13.362+0000","updated":"2010-05-25T14:37:13.362+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12871264","id":"12871264","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks, Seth.\r\n\r\nI am able to reproduce the bug with the attached java class. The repro has two threads running. One of them repeatedly inserts and deletes a record in a table. The other thread repeatedly reads rows from the same table, using an index on one of the columns.\r\n\r\nHere's the exception I see on trunk:\r\n\r\n$ java D4676\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:95)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:403)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2269)\r\n\tat org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81)\r\n\tat org.apache.derby.impl.jdbc.EmbedResultSet.closeOnTransactionError(EmbedResultSet.java:4321)\r\n\tat org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:469)\r\n\tat org.apache.derby.impl.jdbc.EmbedResultSet.next(EmbedResultSet.java:373)\r\n\tat D4676$Reader.run(D4676.java:53)\r\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:119)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)\r\n\t... 10 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.access.conglomerate.GenericConglomerateController.fetch(GenericConglomerateController.java:291)\r\n\tat org.apache.derby.impl.sql.execute.IndexRowToBaseRowResultSet.getNextRowCore(IndexRowToBaseRowResultSet.java:389)\r\n\tat org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(BasicNoPutResultSetImpl.java:477)\r\n\tat org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:429)\r\n\t... 2 more","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-05-25T17:44:05.273+0000","updated":"2010-05-25T17:44:05.273+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12871740","id":"12871740","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I looked at this in a debugger, and it seems like it's pos.current_page that's null in this code in GenericConglomerateController.fetch():\r\n\r\n        boolean ret_val = \r\n            (pos.current_page.fetchFromSlot(\r\n                pos.current_rh, pos.current_slot, \r\n                row, \r\n                new FetchDescriptor(\r\n                    row.length, validColumns, (Qualifier[][]) null), \r\n                false) != null);\r\n\r\nIt is set to null by OpenConglomerate.latchPage() (called from fetch() via OpenConglomerate.lockPositionForRead()) when it discovers that the record was deleted by another transaction before the row was locked.\r\n\r\nOne thing to note is that lockPositionForRead()'s javadoc says:\r\n\r\n     * @param moveForwardIfRowDisappears\r\n     *                  If true, then this routine must handle the case where\r\n     *                  the row id we are waiting on disappears when the latch\r\n     *                  is released.  If false an exception will be thrown if\r\n     *                  the row disappears.\r\n\r\nHowever, there is no exception thrown by this method when the row has disappeared, even though fetch() calls it with moveForwardIfRowDisappears=false.\r\n\r\nI think one possible fix is to make lockPositionForRead() raise an exception in this situation (can be detected by checking the return value from latchPage(), which is currently not checked). The javadoc for fetch() says that it should return false if the row has disappeared, so it could catch that exception and return false.\r\n\r\nfetch() is the only method that calls lockPositionForRead() with moveForwardIfRowDisappears=false, so such a change should only affect the case where we currently see a NullPointerException.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-05-26T13:28:14.656+0000","updated":"2010-05-26T13:28:14.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12872042","id":"12872042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Doesn't GenericConglomerateController.fetch latch the page just before\r\nit calls lockPositionForRead? Is the patch latch being given up inside the\r\nlock call, and then re-acquired? Is that why this only shows up under very\r\nhigh concurrency and lock contention scenarios?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2010-05-27T00:50:04.871+0000","updated":"2010-05-27T00:50:04.871+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12872208","id":"12872208","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Hi Bryan,\r\n\r\n'Yes' is the answer to all you questions above.\r\n\r\nfetch() first latches the heap page on which the indexed row is supposed to be found. Then it attempts to lock the row.\r\n\r\nIf the row cannot be locked immediately, the latch is released before the thread is suspended while it waits for the lock to be obtained. Once it wakes up again, it will re-obtain the latch on the heap page. OpenConglomerate.latchPage() additionally checks if the row is still present on the page, and if it isn't, it will release the latch again and return false. OpenConglomerate.lockPositionForRead/Write however doesn't check the return value from latchPage() and doesn't distinguish between the case where the latch was successfully re-obtained and the case where it was not.\r\n\r\nAnother simpler fix than what I suggested above, would be to check if pos.current_page is null after the attempt to lock the row, and assume that this means the row (or the entire page) is gone. In that case we should update the javadoc comment for lockPositionForRead() to state that this is how it behaves, and remove the sentence that incorrectly states that it raises an exception.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-05-27T13:02:59.067+0000","updated":"2010-05-27T13:02:59.067+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12872752","id":"12872752","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Given a choice between changing the code, or changing the comments,\r\nI usually choose to change the comments.\r\n\r\nI think you have isolated and explained the problem clearly; either of\r\nyour proposed fixes seems reasonable to me.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2010-05-28T01:24:52.248+0000","updated":"2010-05-28T01:24:52.248+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12872887","id":"12872887","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks Bryan. I'll go ahead with adding the null check and updating the comment, as well as adding a store test that exposes the problem. I'll wait for DERBY-4678 to go in first, so that we only have one fetch() method to fix in GenericConglomerateController.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-05-28T07:35:29.420+0000","updated":"2010-05-28T07:35:29.420+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12873953","id":"12873953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I'm attaching a JUnit regression test case for the bug. It doesn't always fail, since the bug is highly dependent on the timing, but it triggers the NPE in about every other run in my environment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-06-01T11:19:35.753+0000","updated":"2010-06-01T11:19:35.753+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12874501","id":"12874501","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Uploading a patch for this issue (derby-4676-1a.diff) with the following changes:\r\n\r\nM       java/engine/org/apache/derby/impl/store/access/conglomerate/OpenConglomerate.java\r\n\r\nUpdated javadoc for latchPage(), lockPositionForRead() and lockPositionForWrite() with info about the expected state upon return if the row has been removed.\r\n\r\nM       java/engine/org/apache/derby/impl/store/access/conglomerate/GenericConglomerateController.java\r\n\r\nAdded a check to see if the row had been removed after calling lockPositionForRead/Write. If so, return false from fetch(), as specified by the ConglomerateController#fetch javadoc.\r\n\r\nM       java/testing/org/apache/derbyTesting/functionTests/tests/store/_Suite.java\r\nA       java/testing/org/apache/derbyTesting/functionTests/tests/store/Derby4676Test.java\r\n\r\nAdded a regression test that fails (intermittently) if the bug is present.\r\n\r\nDerbyall and suites.All ran cleanly with the patch. I've also run the new regression test 500 times without seeing any errors.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-06-02T08:38:52.206+0000","updated":"2010-06-02T08:38:52.206+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12876166","id":"12876166","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Committed revision 952138.\r\n\r\nI'll look into back-porting the fix to 10.6 before I resolve the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-06-07T08:23:08.683+0000","updated":"2010-06-07T08:23:08.683+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12876615","id":"12876615","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Merged fix to 10.6 and committed revision 952585.\r\nMarking the issue as resolved.\r\n\r\nSeth, if you want to verify the fix in your environment, you can either check out the 10.6 branch and build your own jars, or you can wait until the fix has been picked up by the nightly build of the 10.6 branch at http://dbtg.foundry.sun.com/derby/bits/10.6/ (download one with SVN revision number at or above 952585 when available). Please let us know how the testing goes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-06-08T09:39:00.099+0000","updated":"2010-06-08T09:39:00.099+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12876671","id":"12876671","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"body":"Hi Knut,\r\n\r\nI'll test the revised jar and get back to you with the results this coming week.   Thanks again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"created":"2010-06-08T13:17:56.090+0000","updated":"2010-06-08T13:17:56.090+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12877114","id":"12877114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"body":"I ran several hours of load against the 952726 nightly build jars with no errors.  Previously, I was hitting this issue within 5-10 minutes on every run, so this appears to be a good fix.  Looks good.  Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skatzman","name":"skatzman","emailAddress":"skatzman at cisco dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Seth Katzman","active":true},"created":"2010-06-09T15:59:41.126+0000","updated":"2010-06-09T15:59:41.126+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12877213","id":"12877213","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks for testing the fix, Seth! I'm closing the issue based on your feedback.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-06-09T21:19:19.644+0000","updated":"2010-06-09T21:19:19.644+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12884439","id":"12884439","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"reopen for 10.5 back port","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-07-01T21:51:51.479+0000","updated":"2010-07-01T21:51:51.479+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12885685","id":"12885685","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I will backport this to 10.5","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-07-06T21:07:12.724+0000","updated":"2010-07-06T21:07:12.724+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12885759","id":"12885759","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"When I ran derbyall after the merge on 10.5 codeline, I saw a NPE for\r\nderbyall/derbynetclientmats/derbynetmats.fail:derbynet/dblook_test_net.java\r\n\r\nNot sure if it is indeed that test ran into NPE because I don't see one under that actual test directory. The derbyall.sum file has following\r\n*** End:   dblook_test_net jdk1.6.0 DerbyNetClient derbynetmats:derbynetmats 2010-07-06 16:34:52 ***\r\nServer Process did not complete in time. Destroying...\r\njava.lang.NullPointerException\r\n\tat org.apache.derbyTesting.functionTests.harness.RunTest.execTestProcess(RunTest.java:2609)\r\n\tat org.apache.derbyTesting.functionTests.harness.RunTest.testRun(RunTest.java:504)\r\n\tat org.apache.derbyTesting.functionTests.harness.RunTest.main(RunTest.java:372)\r\nderby.infolog.append=true\r\nderby.database.sqlAuthorization=true\r\nderby.connection.requireAuthentication=true\r\nderby.user.app=apppw\r\n*** Start: dblook_test_net_territory jdk1.6.0 DerbyNetClient derbynetmats:derbynetmats 2010-07-06 16:34:53 ***\r\nInitialize for framework: DerbyNetClient\r\njava -Duser.language=en -Duser.country=US -Dderby.system.home=C:\\p4clients\\svn10.5\\client1\\10.5\\systest\\out142\\derbyall\\derbynetclientmats\\DerbyNetClient\\derbynetmats\\derbynetmats\\dblook_test_net_territory -Djava.security.manager -Djava.security.policy=C:\\p4clients\\svn10.5\\client1\\10.5\\systest\\out142\\derby_tests.policy -DderbyTesting.codeclasses=file:/C:/p4clients/svn10.5/client1/10.5/classes/ -DderbyTesting.junit=file:/C:/p4clients/svn10.5/client1/10.5/tools/java/junit.jar -DderbyTesting.codedir=C:\\p4clients\\svn10.5\\client1\\10.5\\classes -DderbyTesting.serverhost=localhost -DderbyTesting.clienthost=localhost org.apache.derby.drda.NetworkServerControl start \r\n-- SecurityManager not installed --\r\nAttempt to shutdown framework: DerbyNetClient\r\n*** End:   dblook_test_net_territory jdk1.6.0 DerbyNetClient derbynetmats:derbynetmats 2010-07-06 16:35:55 ***\r\nWarning: Cleanup failed on baseDir: C:\\p4clients\\svn10.5\\client1\\10.5\\systest\\out142\\derbyall\\derbynetclientmats\\DerbyNetClient\\derbynetmats\\derbynetmats\\dblook_test_net_territory\r\n\r\n\r\nWhen I look directly under C:\\p4clients\\svn10.5\\client1\\10.5\\systest\\out142\\derbyall\\derbynetclientmats\\DerbyNetClient\\derbynetmats\\derbynetmats, I don't see NPE in the files created for dblook_test_net\r\n\r\nI have attached the top level derbyall suite report files for reference.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-07-07T00:42:32.901+0000","updated":"2010-07-07T00:42:32.901+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12885823","id":"12885823","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"A rerun of derbyall didn't show any NPE. Running the junit suite now","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-07-07T04:30:43.720+0000","updated":"2010-07-07T04:31:08.130+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12885966","id":"12885966","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"junit suite ran fine too on 10.5 after the merge. Will go ahead and checkin the changes into 10.5 this morning","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-07-07T15:53:32.082+0000","updated":"2010-07-07T15:53:32.082+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/12886787","id":"12886787","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Backport to 10.5 done","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-07-09T17:39:57.686+0000","updated":"2010-07-09T17:39:57.686+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465288/comment/13685240","id":"13685240","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"[bulk update] Close all resolved issues that haven't been updated for more than one year.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-06-17T09:19:26.424+0000","updated":"2013-06-17T09:19:26.424+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4676/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06t9z:"}}