{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12348098","self":"https://issues.apache.org/jira/rest/api/latest/issue/12348098","key":"DERBY-1706","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-09-14 19:04:16.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22652","customfield_12310222":"1_*:*_1_*:*_3190117000_*|*_6_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-09-22T19:06:31.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1706/watchers","watchCount":1,"isWatching":false},"created":"2006-08-16T20:57:54.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-09-22T19:06:31.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"NPE occurs when attempting to create a table in schema session:\n\nij version 10.2\nij> connect 'jdbc:derby:wombat;create=true' user 'user1';\nWARNING 01J14: SQL authorization is being used without first enabling authentica\ntion.\nij> set schema session;\n0 rows inserted/updated/deleted\nij> create table t1 (i int);\nERROR XJ001: Java exception: ': java.lang.NullPointerException'.\n\nderby.log:\n----------------------------------------------------------------\n2006-08-16 20:49:02.765 GMT:\n Booting Derby version The Apache Software Foundation - Apache Derby - 10.2.1.0 beta - (430903): instance c013800d-010d-18be-88cf-00000013f010\non database directory C:\\work3\\derby\\tests\\derby-10.2.1.0\\lib\\wombat  \n\nDatabase Class Loader started - derby.database.classpath=''\n2006-08-16 20:49:17.312 GMT Thread[main,5,main] (XID = 122), (SESSIONID = 0), (DATABASE = wombat), (DRDAID = null), Cleanup action starting\n2006-08-16 20:49:17.312 GMT Thread[main,5,main] (XID = 122), (SESSIONID = 0), (DATABASE = wombat), (DRDAID = null), Failed Statement is: create table t1 (i int)\njava.lang.NullPointerException\n\tat org.apache.derby.impl.sql.compile.QueryTreeNode.getSchemaDescriptor(Unknown Source)\n\tat org.apache.derby.impl.sql.compile.DDLStatementNode.getSchemaDescriptor(Unknown Source)\n\tat org.apache.derby.impl.sql.compile.DDLStatementNode.getSchemaDescriptor(Unknown Source)\n\tat org.apache.derby.impl.sql.compile.CreateTableNode.referencesSessionSchema(Unknown Source)\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.referencesSessionSchema(Unknown Source)\n\tat org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source)\n\tat org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source)\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\n\tat org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source)\n\tat org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source)\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source)\n\tat org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)\n\tat org.apache.derby.impl.tools.ij.Main.go(Unknown Source)\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)\n\tat org.apache.derby.impl.tools.ij.Main14.main(Unknown Source)\n\tat org.apache.derby.tools.ij.main(Unknown Source)\nCleanup action completed\n\n2006-08-16 20:49:55.312 GMT:\nShutting down instance c013800d-010d-18be-88cf-00000013f010\n----------------------------------------------------------------\n\nsysinfo:\n\n------------------ Java Information ------------------\nJava Version:    1.4.2_12\nJava Vendor:     Sun Microsystems Inc.\nJava home:       C:\\Program Files\\Java\\j2re1.4.2_12\nJava classpath:  derby.jar;derbytools.jar;.\nOS name:         Windows XP\nOS architecture: x86\nOS version:      5.1\nJava user name:  Yip\nJava user home:  C:\\Documents and Settings\\Yip\nJava user dir:   C:\\work3\\derby\\tests\\derby-10.2.1.0\\lib\njava.specification.name: Java Platform API Specification\njava.specification.version: 1.4\n--------- Derby Information --------\nJRE - JDBC: J2SE 1.4.2 - JDBC 3.0\n[C:\\work3\\derby\\tests\\derby-10.2.1.0\\lib\\derby.jar] 10.2.1.0 beta - (430903)\n[C:\\work3\\derby\\tests\\derby-10.2.1.0\\lib\\derbytools.jar] 10.2.1.0 beta - (430903\n)\n------------------------------------------------------\n----------------- Locale Information -----------------\nCurrent Locale :  [English/United States [en_US]]\nFound support for locale: [de_DE]\n         version: 10.2.1.0 - (430903)\nFound support for locale: [es]\n         version: 10.2.1.0 - (430903)\nFound support for locale: [fr]\n         version: 10.2.1.0 - (430903)\nFound support for locale: [it]\n         version: 10.2.1.0 - (430903)\nFound support for locale: [ja_JP]\n         version: 10.2.1.0 - (430903)\nFound support for locale: [ko_KR]\n         version: 10.2.1.0 - (430903)\nFound support for locale: [pt_BR]\n         version: 10.2.1.0 - (430903)\nFound support for locale: [zh_CN]\n         version: 10.2.1.0 - (430903)\nFound support for locale: [zh_TW]\n         version: 10.2.1.0 - (430903)\n------------------------------------------------------","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40381","summary":"NullPointerException occurs when trying to create a table in schema SESSION","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Sun JDK 1.4.2","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":9,"total":9,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12434775","id":"12434775","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I have attached a patch(DERBY1706NPEwithSessionSchemaV1diff.txt) to this Jira entry to fix the null pointer exception problem. But before going into the details of the patch, I want to provide some background information about SESSION schema and global temporary tables.\r\n\r\nSESSION schema is a special schema which is used for global temporary tables. In order to handle global temporary table, Derby creates a in-memory SESSION schema descriptor which does not have any uuid associated with it. A physical SESSION schema(with it's uuid set properly) will be created *only* if there is a persistent object created in it by a user. Global temporary tables can only reside in SESSION schema and Derby documentation recommends that SESSION schema should not be used for other persistent objects. This is because the same object name could be referencing different objects within SESSION schema depending on in what order they got created.\r\nFor instance\r\ncreate table session.t1(c11 int);\r\n-- the following select will get data from the persistent table t1 in SESSION schema\r\nselect * from session.t1;\r\ndeclare global temporary table session.t1(c11 int, c12 int) on commit delete rows not logged;\r\n-- the following select this time will return data from the temporary table t1 rather than persistent table t1\r\n-- This is because, at any time, if there is a global temporary table by the table referenced by a statement,\r\n-- then Derby will always pick up the global temporary table. If no global temporary table by that name is\r\n-- found, then Derby will look for persistent table in SESSION schema. If none found, then error will be thrown\r\nselect * from session.t1;\r\n-- following will drop the temporary table t1 and not the persistent table t1\r\ndrop table session.t1;\r\n-- the following select will get data from the persistent table t1 in SESSION schema because temporary table\r\n-- doesn't exist anymore\r\nselect * from session.t1;\r\n\r\nSo, as can be seen from the example above, the statements referencing SESSION schema objects could have different meanings depending on what kind of objects exist in SESSION schema. Because of this, the compiled plans of statements referencing SESSION schema are not saved in the statement cache, rather they get compiled everytime they are executed. In order to enforce this, in the compilation phase, Derby checks if the statement at hand is referencing a SESSION schema object by calling referencesSessionSchema method. If this method returns true, the statement's compiled plan will not be saved in the statement cache. \r\n\r\nNow, taking the script provided by Yip which results in NPE\r\nset schema session; \r\ncreate table t1 (i int); \r\n\r\nDerby calls referencesSessionSchema while compiling \"create table t1 (i int); \" to see if it references SESSION schema object. Since, there is no schema associated with the table t1, Derby will check for the compilation schema which in this case is SESSION schema because we used \"set schema session; \". (This happens in QueryTreeNode.getSchemaDescriptor(String schemaName, boolean raiseError) line 1486). The method\r\nthen tries to call an equal method on the UUID associated with the SESSION schema descriptor but since it is null(because no physical SESSION schema has been created yet), we end up with a null pointer exception. This will happen only if no physical SESSION schema has been created yet and user tries to create a first persistent object inside SESSION schema after doing a set schema session.\r\n\r\nFollowing will not give a NPE because user hand created SESSION schema before doing set schema SESSION and creating an object inside it.\r\ncreate schema session;\r\nset schema session; \r\ncreate table t1 (i int); \r\nThe hand creation of SESSION schema causes Derby to have a schema descriptor for SESSION schema with it's uuid set correctly.\r\n\r\nThe fix for the NPE is simple and that is to check if the UUID is null. I have added test to existing lang/declareGlobalTempTableJava and ran derbyall on Windows XP with Sun jdk 1.4 and everything ran fine.\r\n\r\nThe svn stat -q o/p is as follows\r\nM      java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\QueryTreeNode.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\lang\\declareGlobalTempTableJava.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\declareGlobalTempTableJava.out\r\n\r\nPlease let me know if anyone has any comments.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2006-09-14T19:04:16.000+0000","updated":"2006-09-14T19:04:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12434802","id":"12434802","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I realized that I didn't change some of the println in the test case that I added and hence attaching a new patch DERBY1706NPEwithSessionSchemaV2diff.txt. Please diregard the earlier patch DERBY1706NPEwithSessionSchemaV1diff.txt. \r\n\r\nThe engine changes are exactly the same in the 2 patches. The only thing that changed is comment and a println in lang/declareGlobalTempTableJava.java test ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2006-09-14T20:46:16.000+0000","updated":"2006-09-14T20:46:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12434833","id":"12434833","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Thanks for the additonal background information, Mamta.  I have tried the second patch DERBY1706NPEwithSessionSchemaV2diff.txt and the NPE no longer exists.  \r\n\r\nPerhaps a comment is useful here for explaining why sdCatalog's UUID can be null in certain cases.\r\n\r\nif (sdCatalog != null && sdCatalog.getUUID() != null)\r\n...\r\n\r\n\r\nOtherwise, the patch looks good to me.  +1 ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-09-14T22:13:31.000+0000","updated":"2006-09-14T22:13:31.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12434974","id":"12434974","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Yip, thanks for doing the code review. Here is the patch DERBY1706NPEwithSessionSchemaV3diff.txt with comments in the code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2006-09-15T13:25:47.000+0000","updated":"2006-09-15T13:25:47.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12435075","id":"12435075","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"body":"Hi Mamta, \r\n\r\njust a general question:\r\n\r\nWhy is it necessary to allow users to create a non-temporary tables in the \"session\" schema , when the schema is not created explicitly ?\r\n\r\n\r\nThanks\r\n-suresh\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"created":"2006-09-15T18:25:17.000+0000","updated":"2006-09-15T18:25:17.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12435381","id":"12435381","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"ran full set of successful tests against ibm 1.4.2 except for \"expected/intermittent\" unrelated test failures.  Thank you Yip for review of changes.  Committed to trunk and change should be put into 10.2.\r\n\r\nm3_ibm142:36>svn commit\r\n\r\nSending        java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\QueryTreeNode.java\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\declareGlobalTempTableJava.out\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\lang\\declareGlobalTempTableJava.java\r\nTransmitting file data ...\r\nCommitted revision 447212.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2006-09-18T03:24:14.000+0000","updated":"2006-09-18T03:24:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12435704","id":"12435704","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Suresh, to answer your question \"Why is it necessary to allow users to create a non-temporary tables in the \"session\" schema , when the schema is not created explicitly ? \"\r\n\r\nI think it may have to do with the usability.\r\n\r\nLet me take the following generic eg \r\nconnect 'jdbc:derby:c:/dellater/dbmaintest2;create=true' user 'mamta1' as mamta1;\r\nselect * from sys.syschemas; -- this will not show *mamta1* as one of the schemas\r\ncreate table t1(c11 int); -- the creation of first user-defined object will implicitly create the schema *mamta1*\r\nselect * from sys.syschemas; -- this will *now* show *mamta1* as one of the schemas\r\n\r\nI think to avoid the confusion with the usability in case of temporary table and non-temporary tables, Derby chose to provide the same behavior for the 2 table types in \"session\" schema ie you can create either of the table types in \"session\" schema w/o first having to manually create the \"session\" schema. This behavior also matches the generic eg given above\r\nSo, extending the eg above for session schema to show Derby's current behavior\r\nconnect 'jdbc:derby:c:/dellater/dbmaintest2;create=true' user 'mamta1' as mamta1;\r\nselect * from sys.syschemas; -- this will not show *session* schema as one of the schemas\r\nset schema session;\r\nselect * from sys.syschemas; -- still will not show *session* schema as one of the schemas\r\ncreate table t1(c11 int); -- the creation of first user-defined table will implicitly create the schema *session*\r\nselect * from sys.syschemas; -- this will *now* show *session* as one of the schemas\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2006-09-19T06:52:45.000+0000","updated":"2006-09-19T06:52:45.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12435863","id":"12435863","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Moving to 10.2.2.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-09-19T15:16:03.000+0000","updated":"2006-09-19T15:16:03.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12348098/comment/12436978","id":"12436978","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"The fix also got merged into 10.2 with revision 448961.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2006-09-22T19:06:30.000+0000","updated":"2006-09-22T19:06:30.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1706/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i079yv:"}}