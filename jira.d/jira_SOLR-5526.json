{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12682345","self":"https://issues.apache.org/jira/rest/api/latest/issue/12682345","key":"SOLR-5526","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12325573","id":"12325573","description":"Major release after 4.6","name":"4.7","archived":false,"released":true,"releaseDate":"2014-02-26"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321664","id":"12321664","description":"Current trunk","name":"Trunk","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-12-03 17:42:35.792","customfield_12312323":null,"customfield_12310420":"361602","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_5500205639_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2014-02-05T01:43:34.984+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-5526/watchers","watchCount":8,"isWatching":false},"created":"2013-12-03T09:53:29.385+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.png","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"9.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12325264","id":"12325264","description":"Bugfix release after 4.5","name":"4.5.1","archived":false,"released":true,"releaseDate":"2013-10-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12325000","id":"12325000","description":"Major release after 4.5","name":"4.6","archived":false,"released":true,"releaseDate":"2013-11-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321664","id":"12321664","description":"Current trunk","name":"Trunk","archived":false,"released":false}],"issuelinks":[{"id":"12382942","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12382942","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"inwardIssue":{"id":"12693373","key":"SOLR-5697","self":"https://issues.apache.org/jira/rest/api/2/issue/12693373","fields":{"summary":"Delete by query does not work properly with customly configured query parser","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-03-16T13:03:56.668+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12317802","id":"12317802","name":"query parsers","description":"Various query parser plugins, like dismax, edismax, lucene etc"}],"timeoriginalestimate":null,"description":"Adding any custom query parser extending standard one with non-final field {{NAME}} lead to messy {{NullPointerException}} during Solr startup.\r\n\r\nDefinition of standard parsers is located in  {{QParserPlugin.standardPlugins}} static array. The array contains names from static {{NAME}} fields and classes for each plugin.                       \r\n\r\nBut all of listed parsers are derived from {{QParserPlugin}}, so we have circular dependency of static fields.\r\n\r\nNormally, class loader start initializing {{QParserPlugin}} before all listed plugins in {{SolrCore.initQParsers}}, and array elements referenced to {{NAME}} plugins' fields are filled properly.\r\n\r\nCustom parsers are instantiated before standard parsers. And when we subclass plugin with non-final {{NAME}} field and add it to Solr via {{solrconfig.xml}}, class loader start loading our class before {{QParserPlugin}}. Because {{QParserPlugin}} is a superclass for plugin, it must be initialized before subclasses, and static dereferencing cause null elements in {{standardPlugins}} array because it filled before {{NAME}} field of loading plugin's superclass.\r\n\r\nHow to reproduce:\r\n# Checkout Solr (trunk or stable)\r\n# Add the following line to solr/example/solr/collection1/conf/solrconfig.xml\r\n  {{<queryParser name=\"fail\" class=\"solr.search.LuceneQParserPlugin\"/>}}\r\n# Call ant run-example in solr folder\r\n\r\nPossible workarounds:\r\n* dev-workaround: add {{int workaround = QParserPlugin.standardPlugins.length;}} as a first line to\r\n  {{SolrCore.initQParsers}}\r\n* user-workaround: add plugin with final {{NAME}} field (edismax) to solrconfig.xml  before subclasses of standard plugins. \r\n  {{<queryParser name=\"workaround\" class=\"solr.search.ExtendedDismaxQParserPlugin\"/>}}\r\n  \r\nPossible fix:\r\nMove {{standardPlugins}} to new final class to break circular dependency.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"361900","summary":"Query parser extends standard cause NPE on Solr startup","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khitrin","name":"khitrin","emailAddress":"khitrin at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nikolay Khitrin","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khitrin","name":"khitrin","emailAddress":"khitrin at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nikolay Khitrin","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Linux, Java 1.7.0_45","customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":16,"total":16,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13837641","id":"13837641","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khitrin","name":"khitrin","emailAddress":"khitrin at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nikolay Khitrin","active":true},"body":"I've attached patch where all static variables from {{QParserPlugin}} were moved to inner static final class {{QParserPlugin.Defaults}}.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khitrin","name":"khitrin","emailAddress":"khitrin at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nikolay Khitrin","active":true},"created":"2013-12-03T12:43:01.344+0000","updated":"2013-12-03T12:43:01.344+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13837937","id":"13837937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"Ouch!\r\n\r\nNikolay: Nice diagnoses! thanks for digging into this.\r\n\r\nMaybe i'm missing something, but isn't the root level bug really that the standard parsers should all be declaring the static NAME as final? ... even with your proposed change, it seems dangerous to me that those NAME variables are mutable.\r\n\r\nIf we fix them all to be \"final\" then the problem goes away w/o needing the rest of your patch, correct?\r\n\r\nWe should also be able to whip up a simple test using reflection to fail the build if anyone ever adds a class to QParserPlugin.standardPlugins w/o static final NAME.\r\n\r\nYou mentioned discovering this problem because you have custom query parsers extending some standard one where NAME isn't final -- \r\nIs there an aspect of this bug that you're seeing with your custom parser that wouldn't be fixed with the solution i'm suggesting?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-12-03T17:42:35.792+0000","updated":"2013-12-03T17:42:35.792+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13838764","id":"13838764","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khitrin","name":"khitrin","emailAddress":"khitrin at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nikolay Khitrin","active":true},"body":"I think making all NAMEs final will fix the issue.\r\n\r\nThere is extremely artificial case with non compile time constant final NAME field... \r\n(How to reproduce: \r\non edismax parser: public static final String NAME = QParserPlugin.DEFAULT_QTYPE + \"edismax\"; \r\nsolrconfig.xml: <queryParser name=\"fail\" class=\"solr.search.ExtendedDismaxQParserPlugin\"/> )\r\nBut I absolutely cannot imagine this in real life. \r\n\r\nSo I propose to apply your suggestion as a hotfix and do calmly think about plugins list structure and location. \r\nWill it be located in abstract supeclass field? Is it good?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khitrin","name":"khitrin","emailAddress":"khitrin at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nikolay Khitrin","active":true},"created":"2013-12-04T09:27:22.867+0000","updated":"2013-12-04T09:27:22.867+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13839979","id":"13839979","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khitrin","name":"khitrin","emailAddress":"khitrin at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nikolay Khitrin","active":true},"body":"Attached patch adding final modifiers to all names for standard parsers, as mentioned in your suggestion.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=khitrin","name":"khitrin","emailAddress":"khitrin at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Nikolay Khitrin","active":true},"created":"2013-12-05T09:43:53.531+0000","updated":"2013-12-05T09:43:53.531+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13875868","id":"13875868","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"body":"NPE stacktrace during solr load","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"created":"2014-01-19T14:02:25.696+0000","updated":"2014-01-19T14:02:25.696+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13877426","id":"13877426","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"body":"Missed final NAME field in org.apache.solr.search.SimpleQParserPlugin. Fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"created":"2014-01-21T12:33:41.011+0000","updated":"2014-01-21T12:33:41.011+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13877427","id":"13877427","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"body":"Test reproducing NPE on Solr start-up\r\nTest checking final and static NAME field for all standard parsers","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"created":"2014-01-21T12:34:23.681+0000","updated":"2014-01-21T12:34:23.681+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13877476","id":"13877476","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shalinmangar","name":"shalinmangar","emailAddress":"shalin dot mangar at lucidworks dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=shalinmangar&avatarId=19501","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=shalinmangar&avatarId=19501","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=shalinmangar&avatarId=19501","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=shalinmangar&avatarId=19501"},"displayName":"Shalin Shekhar Mangar","active":true},"body":"Thanks Vitaliy. Can you please combine the two patches i.e. the test and making the NAME fields final?\r\n\r\nJust a tip for the future: Just have the same names for each iteration of the patch. Jira will automatically grey out old patches and keep the latest one highlighted. It also helps reviewers in figuring out which is the the latest patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shalinmangar","name":"shalinmangar","emailAddress":"shalin dot mangar at lucidworks dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=shalinmangar&avatarId=19501","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=shalinmangar&avatarId=19501","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=shalinmangar&avatarId=19501","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=shalinmangar&avatarId=19501"},"displayName":"Shalin Shekhar Mangar","active":true},"created":"2014-01-21T13:56:14.656+0000","updated":"2014-01-21T13:56:14.656+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13877842","id":"13877842","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"body":"Combined:\r\nMissed final NAME field fixes. \r\nTest reproducing NPE on Solr start-up\r\nTest checking final and static NAME field for all standard parsers","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"created":"2014-01-21T20:51:45.079+0000","updated":"2014-01-21T20:51:45.079+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13877902","id":"13877902","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"Hey Vitaliy,\r\n\r\nFor the most part, these tests look great -- just a few minor things i think we should try to clean up...\r\n\r\n* QParserPlugin.standardPlugins's javadoc needs to point out the importance of these names being static & final so people aren't surprised by these  tests when new parsers are added in the future.\r\n* TestStandardQParsers is doing something sufficiently odd that it really needs some javadocs explaining why it exists (ie: mention the class loading problems associated if there is a standardPlugin that has a non-static, non-final name, with an {{@see}} this issue, {{@see QParserPlugin.standardPlugins}}, etc...)\r\n* we should probably make TestStandardQParsers assert that the static & final name it finds in each class matches the name associated in QParserPlugin.standardPlugins.\r\n* solrconfig-query-parser-init.xml has a cut & paste comment referring to an unrelated test.\r\n* TestInitQParser should have a javadoc comment explaining what the point of the test is\r\n* TestInitQParser should actaully do a query using the \"fail\" parser registered in the config, to help future-proof us against someone unwittingly changing the test config in a way that defeats the point of the test.\r\n\r\n...if you want to take a crack at this that would be great, if not i'll try to make some time later this week.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2014-01-21T21:58:40.799+0000","updated":"2014-01-21T21:58:40.799+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13878953","id":"13878953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"body":"minor fixes:\r\n{quote} QParserPlugin.standardPlugins's javadoc needs to point out the importance of these names being static & final so people aren't surprised by these  tests when new parsers are added in the future.{quote}\r\nAdded relevant javadocs.\r\n{quote}\r\nTestStandardQParsers is doing something sufficiently odd that it really needs some javadocs explaining why it exists (ie: mention the class loading problems associated if there is a standardPlugin that has a non-static, non-final name, with an {{@see}} this issue, {{@see QParserPlugin.standardPlugins}}, etc...){quote}\r\nAdded javadocs\r\n{quote} we should probably make TestStandardQParsers assert that the static & final name it finds in each class matches the name associated in QParserPlugin.standardPlugins.{quote}\r\nThats actually what TestStandardQParsers does. Unit test takes classes registered in QParserPlugin.standardPlugins and ensure that each class has final and static NAME field.\r\nAdded relevant javadocs to TestStandardQParsers.\r\n{quote} solrconfig-query-parser-init.xml has a cut & paste comment referring to an unrelated test.{quote}\r\nFixed, added relevant comments.\r\n\r\n{quote} TestInitQParser should have a javadoc comment explaining what the point of the test is{quote}\r\nFixed, added relevant comments.\r\n\r\n{quote}TestInitQParser should actaully do a query using the \"fail\" parser registered in the config, to help future-proof us against someone unwittingly changing the test config in a way that defeats the point of the test.{quote}\r\nThis test alerady does query using defType=fail, so i expect this registered QParser used and return result.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vzhovtiuk","name":"vzhovtiuk","emailAddress":"vzhovtiuk at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vitaliy Zhovtyuk","active":true},"created":"2014-01-22T18:21:02.204+0000","updated":"2014-01-22T18:21:02.204+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13891443","id":"13891443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"bq. This test alerady does query using defType=fail, so i expect this registered QParser used and return result.\r\n\r\nYep yep ... i must have misread that, sorry.\r\n\r\nbq. Thats actually what TestStandardQParsers does. Unit test takes classes registered in QParserPlugin.standardPlugins and ensure that each class has final and static NAME field.\r\n\r\nCorrect, but that's not the point i was making in that bullet point -- what i said was as long as we were doing that, we should also make sure the NAME field _matches_ the registered name in QParserPlugin.standardPlugins.\r\n\r\nI'm attaching a patch that eliminates some existing duplication in your TestStandardQParsers and adds the type of check i was refering to ... running full tests & precommit now, and unless something weird pops up i'll commit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2014-02-04T23:44:05.889+0000","updated":"2014-02-04T23:44:05.889+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13891529","id":"13891529","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"fixed a javadoc mistake caught by \"ant precommit\"\r\n\r\nGoing to commit & backport now","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2014-02-05T00:39:12.608+0000","updated":"2014-02-05T00:39:12.608+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13891533","id":"13891533","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1564588 from hossman@apache.org in branch 'dev/trunk'\r\n[ https://svn.apache.org/r1564588 ]\r\n\r\nSOLR-5526: Fixed NPE that could arrise when explicitly configuring some built in QParserPlugins","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2014-02-05T00:41:26.424+0000","updated":"2014-02-05T00:41:26.424+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13891588","id":"13891588","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1564606 from hossman@apache.org in branch 'dev/branches/branch_4x'\r\n[ https://svn.apache.org/r1564606 ]\r\n\r\nSOLR-5526: Fixed NPE that could arrise when explicitly configuring some built in QParserPlugins (merge r1564588)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2014-02-05T01:43:32.014+0000","updated":"2014-02-05T01:43:32.014+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12682345/comment/13891589","id":"13891589","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"Thanks Nikolay & Vitaliy!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2014-02-05T01:43:35.011+0000","updated":"2014-02-05T01:43:35.011+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-5526/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1qc07:"}}