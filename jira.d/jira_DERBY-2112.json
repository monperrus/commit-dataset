{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12356489","self":"https://issues.apache.org/jira/rest/api/latest/issue/12356489","key":"DERBY-2112","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-11-24 09:21:20.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22892","customfield_12310222":"1_*:*_1_*:*_6834287406_*|*_6_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-02-10T14:49:38.406+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2112/watchers","watchCount":1,"isWatching":false},"created":"2006-11-23T12:24:51.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-02-10T14:49:38.290+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"there is a problem when using batch statements without bind parameters (?), with ClientDriver (derbyclient.jar):\n\njava.lang.NullPointerException\n\tat org.apache.derby.client.am.PreparedStatement.executeBatchRequestX(Unknown Source)\n\tat org.apache.derby.client.am.PreparedStatement.executeBatchX(Unknown Source)\n\tat org.apache.derby.client.am.PreparedStatement.executeBatch(Unknown Source)\n\tat teste.Teste9.main(Teste9.java:29)\n\ntest process to reproduce the bug:\n\ncreate a database called mydbtest under $DERBY_HOME/data\n\ncreate and populate a new table called teste1:\n\ncreate table teste1 ( valor numeric );\ninsert into teste1 values (1);\ninsert into teste1 values (2);\ninsert into teste1 values (3);\n\nstart derby network server.\n\nrun the following code:\n\n\tpublic static void main(String[] args) throws SQLException {\n\t\t\n\t    try {\n\t        Class.forName(\"org.apache.derby.jdbc.ClientDriver\" );\n\t    } catch (Exception e) {\n\t        e.printStackTrace();\n\t        return;\n\t    }\n\n\t    Connection c = DriverManager.getConnection(\"jdbc:derby://localhost:1527/d:/derby_10/data/mydbtest\", \"app\", \"app\");\n\t    \n\t    PreparedStatement ps = c.prepareStatement(\"update teste1 set valor = 8\");\n\t    ps2.addBatch();\n\t    \n\t    int j[] = ps.executeBatch();\n\t    System.out.println(j[0]);\n\t    ps.close();\n\t    \n\t    c.close();\n\t}\n\nthis exception is thrown:\n\njava.lang.NullPointerException\n\tat org.apache.derby.client.am.PreparedStatement.executeBatchRequestX(Unknown Source)\n\tat org.apache.derby.client.am.PreparedStatement.executeBatchX(Unknown Source)\n\tat org.apache.derby.client.am.PreparedStatement.executeBatch(Unknown Source)\n\tat teste.Teste9.main(Teste9.java:29)\n\n------\n\ni've studied the source and got the bug on class org.apache.derby.client.am.PreparedStatement line 2043.\n\nthen, i've changed that line from this:\n\n\t\t\tparameterMetaData_.clientParamtertype_ = (int[]) parameterTypeList.get(i);\n\nto this:\n\n\t\t\tif (parameterMetaData_ != null) {\n\t\t\t\tparameterMetaData_.clientParamtertype_ = (int[]) parameterTypeList.get(i);\n\t\t\t}\n\nafter running the build and updating the derbyclient.jar, my application worked fine, so this seems to solve the problem.\n\ni didn't run the automatic build tests to check for other impacts / collateral effects.\n\n\nfollows org.apache.derby.tools.sysinfo output:\n\n------------------ Informacoes sobre Java ------------------\nVers?o do Java:                     1.4.2_08\nFornecedor do Java:                 Sun Microsystems Inc.\nDiret?rio base do Java:             C:\\j2sdk1.4.2_08\\jre\nCaminho de classes do Java:         .;.;C:\\PROGRA~1\\JMF21~1.1E\\lib\\sound.jar;C:\\PROGRA~1\\JMF21~1.1E\\lib\\jmf.jar;C:\\PROGRA~1\\J\nMF21~1.1E\\lib;%systemroot%\\java\\classes;.;D:\\DERBY_10/lib/derby.jar;D:\\DERBY_10/lib/derbynet.jar;D:\\DERBY_10/lib/derbyclient.\njar;D:\\DERBY_10/lib/derbytools.jar\nNome do Sistema Operacional:        Windows XP\nArquitetura do Sistema Operacional: x86\nVers?o do Sistema Operacional:      5.1\nNome do usußrio Java:               acd025\nDiret?rio base do usußrio Java:     D:\\Profiles\\acd025\nDiret?rio do usußrio Java:          D:\\derby_10\njava.specification.name: Java Platform API Specification\njava.specification.version: 1.4\n---------------- Informa??es sobre o Derby -----------------\nJRE - JDBC: J2SE 1.4.2 - JDBC 3.0\n[D:\\derby_10\\lib\\derby.jar] 10.2.1.6 - (452058)\n[D:\\derby_10\\lib\\derbytools.jar] 10.2.1.6 - (452058)\n[D:\\derby_10\\lib\\derbynet.jar] 10.2.1.6 - (452058)\n[D:\\derby_10\\lib\\derbyclient.jar] 10.2.1.6 - (452058)\n------------------------------------------------------\n---------------- Informa??es sobre o Idioma ----------------\nIdioma atual :  [portugu?s/Brasil [pt_BR]]\nEncontrado suporte para o idioma: [de_DE]\n         vers?o: 10.2.1.6 - (452058)\nEncontrado suporte para o idioma: [es]\n         vers?o: 10.2.1.6 - (452058)\nEncontrado suporte para o idioma: [fr]\n         vers?o: 10.2.1.6 - (452058)\nEncontrado suporte para o idioma: [it]\n         vers?o: 10.2.1.6 - (452058)\nEncontrado suporte para o idioma: [ja_JP]\n         vers?o: 10.2.1.6 - (452058)\nEncontrado suporte para o idioma: [ko_KR]\n         vers?o: 10.2.1.6 - (452058)\nEncontrado suporte para o idioma: [pt_BR]\n         vers?o: 10.2.1.6 - (452058)\nEncontrado suporte para o idioma: [zh_CN]\n         vers?o: 10.2.1.6 - (452058)\nEncontrado suporte para o idioma: [zh_TW]\n         vers?o: 10.2.1.6 - (452058)\n------------------------------------------------------\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40201","summary":"Nullpointer on executeBatchRequestX when preparedStatement has no parameters","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cesardevera","name":"cesardevera","emailAddress":"cesardevera at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cesar Devera","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cesardevera","name":"cesardevera","emailAddress":"cesardevera at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cesar Devera","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Using java version 1.5.0_05 (sun). ","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12356489/comment/12452399","id":"12452399","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"'Derby2112ReproNPE.java' demonstrates the reported bug (basically took code from the reporter of this issue).\r\n\r\nI also ran derbyall/suites.All with the proposed fix, and it ran without failures. I think a patch including a test case for this bug should be created.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2006-11-24T09:21:20.000+0000","updated":"2006-11-24T09:21:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12356489/comment/12470367","id":"12470367","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Updated stack trace (with trunk at revision 502319), from running an attempt to convert test batchUpdate.java to junit. So, a test already exists, it's just not getting executed with network server currently.\r\n---------------------------------\r\njava.lang.NullPointerException\r\n\tat org.apache.derby.client.am.PreparedStatement.executeBatchRequestX(PreparedStatement.java:2264)\r\n\tat org.apache.derby.client.am.PreparedStatement.executeBatchX(PreparedStatement.java:2193)\r\n\tat org.apache.derby.client.am.PreparedStatement.executeBatch(PreparedStatement.java:1629)\r\n\tat org.apache.derbyTesting.functionTests.tests.jdbcapi.BatchUpdateTest.runNoParametersPreparedBatch(BatchUpdateTest.java:1000)\r\n\tat org.apache.derbyTesting.functionTests.tests.jdbcapi.BatchUpdateTest.testPreparedStatementBatchUpdatePositive(BatchUpdateTest.java:190)\r\n---------------------------------","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-02-05T21:53:03.427+0000","updated":"2007-02-05T21:53:03.427+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12356489/comment/12471719","id":"12471719","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching a patch with the fix suggested by Cesar & which activates the test in jdbcapi/BatchUpdateTest.java for network server.\r\nsuites.All and derbyall ran cleanly for me too, but as I know nothing about this code, another check is probably good. \r\n\r\nReview please?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-02-09T15:10:00.741+0000","updated":"2007-02-09T15:10:00.741+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12356489/comment/12471987","id":"12471987","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I looked at the code again, and I believe this is really ok. So, I updated the BatchUpdateTest.java & committed with revision 505700. See: http://svn.apache.org/viewvc?view=rev&revision=505700.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-02-10T14:49:38.207+0000","updated":"2007-02-10T14:49:38.207+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2112/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i078uv:"}}