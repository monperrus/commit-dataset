{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12439251","self":"https://issues.apache.org/jira/rest/api/latest/issue/12439251","key":"MAHOUT-191","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310751","id":"12310751","key":"MAHOUT","name":"Mahout","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310751&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310751&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310751&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310751&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13060","id":"13060","description":"Apache Mahout","name":"Mahout"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314281","id":"12314281","description":"","name":"0.3","archived":false,"released":true,"releaseDate":"2010-03-17"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-10-29 12:43:17.584","customfield_12312323":null,"customfield_12310420":"9874","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_3453517304_*|*_1_*:*_1_*:*_75617_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2009-12-07T07:34:47.321+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAHOUT-191/watchers","watchCount":0,"isWatching":false},"created":"2009-10-28T08:14:54.400+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314281","id":"12314281","description":"","name":"0.3","archived":false,"released":true,"releaseDate":"2010-03-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-05-21T03:24:11.654+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[],"timeoriginalestimate":null,"description":"(based on the message from here: http://www.nabble.com/Creating-Vectors-from-Text-tt24298643.html#a26090263)\r\n\r\nI checked out mahout from trunk and tried to create term frequency vector from a lucene index and ran into this..\r\n\r\n09/10/27 17:36:10 INFO lucene.Driver: Output File: /Users/shoeseal/DATA/luc2tvec.out\r\n09/10/27 17:36:11 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\r\n09/10/27 17:36:11 INFO compress.CodecPool: Got brand-new compressor\r\nException in thread \"main\" java.lang.NullPointerException\r\n        at org.apache.mahout.utils.vectors.lucene.LuceneIterable$TDIterator.next(LuceneIterable.java:109)\r\n        at org.apache.mahout.utils.vectors.lucene.LuceneIterable$TDIterator.next(LuceneIterable.java:1)\r\n        at org.apache.mahout.utils.vectors.io.SequenceFileVectorWriter.write(SequenceFileVectorWriter.java:40)\r\n        at org.apache.mahout.utils.vectors.lucene.Driver.main(Driver.java:200)\r\n\r\nI am running this from Eclipse (snow leopard with JDK 6), on an index that has field with stored term vectors..\r\n\r\nmy input parameters for Driver are:\r\n--dir <path>/smallidx/ --output <path>/luc2tvec.out --idField id_field\r\n --field field_with_TV --dictOut <path>/luc2tvec.dict --max 50  --weight tf\r\n\r\nLuke shows the following info on the fields I am using:\r\n id_field is indexed, stored, omit norms\r\n field_with_TV is indexed, tokenized, stored, term vector ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"23227","summary":"NPE while creating term vectors with an index on a field that does not exist in all the documents","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushil_kb","name":"sushil_kb","emailAddress":"bajracharya at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sushil Bajracharya","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushil_kb","name":"sushil_kb","emailAddress":"bajracharya at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sushil Bajracharya","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"mac, snow leopard, eclipse galileo, jdk 6","customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":5,"total":5,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12439251/comment/12770825","id":"12770825","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushil_kb","name":"sushil_kb","emailAddress":"bajracharya at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sushil Bajracharya","active":true},"body":"It seems that the problem is because that not all the documents in my index has the field that I am using to get term vectors from. I made the following changes to make this work, but I am not sure if thats the right way. I wanted to get this work to run the LDA topic modeling using the output from the Driver.\r\n\r\nIndex: utils/src/main/java/org/apache/mahout/utils/vectors/io/SequenceFileVectorWriter.java\r\n===================================================================\r\n--- utils/src/main/java/org/apache/mahout/utils/vectors/io/SequenceFileVectorWriter.java (revision 830343)\r\n+++ utils/src/main/java/org/apache/mahout/utils/vectors/io/SequenceFileVectorWriter.java (working copy)\r\n@@ -42,7 +42,7 @@\r\n         break;\r\n       }\r\n       //point.write(dataOut);\r\n-      writer.append(new LongWritable(recNum++), point);\r\n+      if(point!=null) writer.append(new LongWritable(recNum++), point);\r\n \r\n     }\r\n     return recNum;\r\nIndex: utils/src/main/java/org/apache/mahout/utils/vectors/lucene/LuceneIterable.java\r\n===================================================================\r\n--- utils/src/main/java/org/apache/mahout/utils/vectors/lucene/LuceneIterable.java (revision 830343)\r\n+++ utils/src/main/java/org/apache/mahout/utils/vectors/lucene/LuceneIterable.java (working copy)\r\n@@ -104,6 +104,10 @@\r\n       try {\r\n         indexReader.getTermFreqVector(doc, field, mapper);\r\n         result = mapper.getVector();\r\n+        \r\n+        if (result == null)\r\n+         return null;\r\n+        \r\n         if (idField != null) {\r\n           String id = indexReader.document(doc, idFieldSelector).get(idField);\r\n           result.setName(id);","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sushil_kb","name":"sushil_kb","emailAddress":"bajracharya at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sushil Bajracharya","active":true},"created":"2009-10-28T08:16:10.013+0000","updated":"2009-10-28T08:16:10.013+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12439251/comment/12771408","id":"12771408","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kshashi","name":"kshashi","emailAddress":"shashikant at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shashikant Kore","active":true},"body":"I noticed a different problem for empty field. TFDFMapper returned vector for previous non-empty document.  This happens because  setExpectations() is not getting called on empty documents. \r\n\r\nI have attached a patch to addres the same.  Couldn't find a better way. If you know, please update accordingly. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kshashi","name":"kshashi","emailAddress":"shashikant at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shashikant Kore","active":true},"created":"2009-10-29T12:43:17.584+0000","updated":"2009-10-29T12:43:17.584+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12439251/comment/12786657","id":"12786657","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"So, may I submit these on y'all's behalf? Not clear on the status here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-12-06T17:31:37.045+0000","updated":"2009-12-06T17:31:37.045+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12439251/comment/12786782","id":"12786782","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kshashi","name":"kshashi","emailAddress":"shashikant at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shashikant Kore","active":true},"body":"Yeah, this can be committed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kshashi","name":"kshashi","emailAddress":"shashikant at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shashikant Kore","active":true},"created":"2009-12-07T05:06:13.333+0000","updated":"2009-12-07T05:06:13.333+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12439251/comment/12786807","id":"12786807","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"Committed variant on patches on behalf of submitters. Did not override the standard setDocumentNumber() method since this seems to be available in Lucene now and undesirable to cut off calls to super.setDocumentNumber()?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-12-07T07:34:47.229+0000","updated":"2009-12-07T07:34:47.229+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAHOUT-191/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i04c3z:"}}