{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12491720","self":"https://issues.apache.org/jira/rest/api/latest/issue/12491720","key":"DERBY-4923","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323475","id":"12323475","description":"Head of 10.8 branch starting 2014-01-13","name":"10.8.3.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323562","id":"12323562","description":"Head of 10.9 branch after releasing 10.9.1.0","name":"10.9.2.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326659","id":"12326659","description":"candidate for Second release for 10.10 branch","name":"10.10.2.0","archived":false,"released":true,"releaseDate":"2014-04-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324243","id":"12324243","description":"First release on the 10.11 branch","name":"10.11.1.1","archived":false,"released":true,"releaseDate":"2014-08-26"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2011-03-23 13:22:37.825","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24536","customfield_12310222":"1_*:*_1_*:*_92435500639_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-11-04T21:33:06.197+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4923/watchers","watchCount":6,"isWatching":false},"created":"2010-12-01T01:01:25.585+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_triage10_11"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314117","id":"12314117","description":"Next release after 10.5.2.0 release candidate #1","name":"10.5.3.0","archived":false,"released":true,"releaseDate":"2009-08-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313727","id":"12313727","description":"Feature release","name":"10.6.1.0","archived":false,"released":true,"releaseDate":"2010-05-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315343","id":"12315343","description":"Derby 10.6.2.1 Release","name":"10.6.2.1","archived":false,"released":true,"releaseDate":"2010-10-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321550","id":"12321550","description":"First release on the 10.10 branch","name":"10.10.1.1","archived":false,"released":true,"releaseDate":"2013-04-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324243","id":"12324243","description":"First release on the 10.11 branch","name":"10.11.1.1","archived":false,"released":true,"releaseDate":"2014-08-26"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12383240","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12383240","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12665995","key":"DERBY-6319","self":"https://issues.apache.org/jira/rest/api/2/issue/12665995","fields":{"summary":"Intermittent ERROR nospc: nospc.U at org.apache.derby.impl.store.raw.data.StoredPage.logRow","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12347269","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12347269","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12539208","key":"DERBY-5581","self":"https://issues.apache.org/jira/rest/api/2/issue/12539208","fields":{"summary":"store.LongColumnTest fails with testThreeColumnsShortAndLongAndShort(org.apache.derbyTesting.functionTests.tests.store.LongColumnTest: Unexpected SQL state. expected:<[XSCB6]> but was:<[nospc]>","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12355333","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12355333","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12598679","key":"DERBY-5858","self":"https://issues.apache.org/jira/rest/api/2/issue/12598679","fields":{"summary":"java.sql.SQLException: nospc.U trying to update a row","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12348305","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12348305","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12526300","key":"DERBY-5450","self":"https://issues.apache.org/jira/rest/api/2/issue/12526300","fields":{"summary":"in nstest: XSLA6: Cannot recover from database & and 40XT4 errors in nstest (sane jars) after ASSERT FAILED   org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED  inconsistency in space management during insert","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12355413","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12355413","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12599854","key":"DERBY-5876","self":"https://issues.apache.org/jira/rest/api/2/issue/12599854","fields":{"summary":"Overhaul table compression code","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-01-21T00:23:28.580+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11412","id":"11412","name":"Store"}],"timeoriginalestimate":null,"description":"An update of a row fails with a nospc.U exception.  If there is space on the disk then an update should never fail for a space \r\nissue.  The code is meant to always reserve enough space on a page such that if an expanding update happens that does not\r\nfit, it should in the worst case change the row to an overflow row pointer and put the rest in a linked overflow chain.\r\n\r\nThe following set of circumstances will cause this bug (not sure which are exactly needed - just what i did to\r\ncause the repro), I will be attaching a test case:\r\nThe row being updated has the following characteristics:\r\n    o located on 4k page\r\n    o 2 colum row with 2nd column a blob column\r\n    o the row is a long row with first piece having 1st column on main page, and the 2nd piece having just blob column on overflow page.\r\n    o before the update there is 0 free space on the overflow page.\r\n    o the update causes the blob column to expand past 4k \r\n\r\nCaused by: java.sql.SQLException: nospc.U\r\n    at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n    at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:119)\r\n    at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)\r\n    ... 39 more\r\nCaused by: ERROR nospc: nospc.U\r\n    at org.apache.derby.impl.store.raw.data.StoredPage.logRow(StoredPage.java:4155)\r\n    at org.apache.derby.impl.store.raw.data.UpdateOperation.writeOptionalDataToBuffer(UpdateOperation.java:255)\r\n    at org.apache.derby.impl.store.raw.data.UpdateOperation.<init>(UpdateOperation.java:106)\r\n    at org.apache.derby.impl.store.raw.data.LoggableActions.actionUpdate(LoggableActions.java:80)\r\n    at org.apache.derby.impl.store.raw.data.StoredPage.doUpdateAtSlot(StoredPage.java:8625)\r\n    at org.apache.derby.impl.store.raw.data.BasePage.updateAtSlot(BasePage.java:1062)\r\n    at org.apache.derby.impl.store.access.conglomerate.GenericConglomerateController.replace(GenericConglomerateController.java:486)\r\n    at org.apache.derby.impl.sql.execute.RowChangerImpl.updateRow(RowChangerImpl.java:523)\r\n    at org.apache.derby.impl.sql.execute.UpdateResultSet.collectAffectedRows(UpdateResultSet.java:569)\r\n    at org.apache.derby.impl.sql.execute.UpdateResultSet.open(UpdateResultSet.java:264)\r\n    at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:436)\r\n    at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:317)\r\n    at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1241)\r\n    ... 33 more","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10364","value":"Data corruption","id":"10364"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"35356","summary":"update of a long row can fail with ERROR nospc: nospc.U exception.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10422","value":"High Value Fix","id":"10422"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10102","value":"Patch Available","id":"10102"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10424","value":"Repro attached","id":"10424"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10051","value":"Urgent","id":"10051"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":21,"total":21,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/12965520","id":"12965520","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"derby4923repro.diff is a repro of the bug in the form of a junit test to be run from the codeline.  The attached derby.log shows the result from running it against a sane build.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2010-12-01T01:20:14.856+0000","updated":"2010-12-01T01:20:14.856+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/12994413","id":"12994413","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"reproducible serious bug setting urgency to urgent.  Once hit the row can't be updated any more.\r\n\r\ntriaged for 10.8.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-02-14T18:42:29.210+0000","updated":"2011-02-14T18:42:29.210+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13010111","id":"13010111","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Turning off the \"Wrong query result\" box. It seems to me that this bug does not return the wrong rows to the user. It raises an exception and fails.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2011-03-23T13:22:37.825+0000","updated":"2011-03-23T13:22:37.825+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13419118","id":"13419118","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Mike,\r\n\r\nThis bug is assigned to you. Are you still working on it? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-07-20T13:25:13.170+0000","updated":"2012-07-20T13:25:13.170+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13419325","id":"13419325","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"i had plans to look at this, but not top of my list.  unassiging it for now and will change if I am actively working on it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2012-07-20T16:32:21.669+0000","updated":"2012-07-20T16:32:21.669+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13419389","id":"13419389","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching DERBY_4923.java. This reworks Mike's test case to be a standalone program rather than a JUnit test. If you run this with an insane engine, you get the stack trace indicated in this bug report. If you run this with a sane engine, you get an assertion.\r\n\r\nI don't know if it's significant that the test case compresses the table. However, table compression certainly takes us through code which has given rise to a lot of bugs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-07-20T17:54:27.795+0000","updated":"2012-07-20T17:54:27.795+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13419498","id":"13419498","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Comments on DERBY-4577 and DERBY-4923 suggest that NoSpaceOnPage is a transient signal passed between methods inside StoredPage. If you grep the codeline, you see that StoredPage is the only class which mentions this exception. Low level logging methods throw NoSpaceOnPage to tell their callers that there isn't enough room on the page for the operation. The callers (in StoredPage) are supposed to allocate more space and then retry the operation. It seems that NoSpaceOnPage should never leak out of StoredPage. It should never escape to methods higher on the call stack. Does that sound correct?\r\n\r\nI am attaching derby-4923-tt-aa-NoSpaceOnPageExtendsException.diff. This patch changes NoSpaceOnPage, making it directly extend Exception so that it is no longer a StandardException. With this change you can see that it may be possible for NoSpaceOnPage to escape outside StoredPage to methods in the following classes:\r\n\r\nUpdateOperation\r\nCopyRowsOperation\r\nDirectActions\r\nUpdateFieldOperation\r\nInsertOperation\r\n\r\nThere may be reasons why some of these callers can be confident that they won't ever see a NoSpaceOnPage exception. However, I don't understand how we can prove that assertion for any of these classes. It's clear that NoSpaceOnPage can leak up to at least one of these classes (UpdateOperation), perhaps in several ways given the number of bugs we have seen with this stack trace.\r\n\r\nIs there some way that we can prove that NoSpaceOnPage won't escape to any of the other calling classes?\r\n\r\nThanks,\r\n-Rick\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-07-20T19:49:19.247+0000","updated":"2012-07-20T19:49:19.247+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13419620","id":"13419620","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I do believe it is always a bug if a NoSpaceOnPage leaks out to a user.  There is a normal case where we can't insert and/or update keys in indexes over a certain size, but I think that\r\ngets wrapped in a different exception.\r\n\r\nIf the code were acting correctly then it would have reserved enough space such that the operation is not leaking the exception.  So at least in the cases that I have debugged in the\r\npast the bug is not in the operation that is failing, it is in  a previous operation that lead to the page getting to state with not enough reserved space to do the operation.  There are \r\n2 things to handle.  First is that the head of a row in a base table (heap) can never move off its page, so you must reserve enough space in the head row/page so that in the worst\r\ncase you can change the row to one that just has the head of row pointing to a linked list of all the other columns on another page.  The second case is handling the \"middle\" of the\r\nrow on another page.  Again similarly the design is to reserve enough space for the row such that if you need to expand it there is always enough space in worst case to just make\r\nit a pointer yet another chunk somewhere.  It gets tricky in that a row might be smaller than what is necessary in the worst case to be one of these pointers.  \r\n\r\nThe mostly likely place for this bug to happen would be in UpdateOperation and UpdateFieldOperation as these result in expanding the length of the row in place. \r\n\r\nCopyRowsOperation prechecks that the destination of the rows has space and maintains a latch so that it is guaranteed.  I remember a NoSpaceOnPage bug in the past in this one\r\nwhere the bug was in the check not accounting for the correct change in compressed size of the page field, so in this case the bug was in the operation and not in the previous operaition.\r\n\r\nInsertOperation is the normal path for NoSpaceOnPage exceptions, I expect that somehow the code is set to catch these as it is the normal way to tell to insert a row somewhere else\r\nrather than where it does not fit.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2012-07-20T22:07:59.527+0000","updated":"2012-07-20T22:07:59.527+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13420694","id":"13420694","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks for that explanation, Mike. This observation particularly struck me:\r\n\r\n\"So at least in the cases that I have debugged in the past the bug is not in the operation that is failing, it is in a previous operation that lead to the page getting to state with not enough reserved space to do the operation.\"\r\n\r\nThis increases my suspicion that the attached repro may turn out to be another bug in table compression.\r\n\r\nOn the related issue DERBY-5858, table compression was not used. So there is at least another code path, not involving table compression, which sets up this NoSpaceOnPage condition.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-07-23T14:59:38.618+0000","updated":"2012-07-23T14:59:38.618+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13464083","id":"13464083","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Verified the repro attached still reproduces the error  against trunk and . The reproduction connects with an in-memory database so I didn't verify but presumably the original Data corruption flag is correct as well.  This would be great to get this one fixed for the next release. Do we have an idea of the scope of the work?\r\n\r\n \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-09-26T19:22:40.899+0000","updated":"2012-09-26T19:22:40.899+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13803009","id":"13803009","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"This patch fixes the problem repro'd by the included new test.  The problem was an off by 1 in checking for enough space to update a row on an overflow page to just an overflow pointer.  The intent of the code is to always reserve enough space in every overflow row to allow for this update.  In this case there was exactly enough space, but the code mistaken thought it needed 1 more byte.\r\n\r\nThis patch also has been run full tests and passed against trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2013-10-23T16:44:06.885+0000","updated":"2013-10-23T16:44:06.885+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13803023","id":"13803023","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1535075 from mikem@apache.org in branch 'code/trunk'\r\n[ https://svn.apache.org/r1535075 ]\r\n\r\nDERBY-6320 Log a page dump to derby.log if ERROR nospc: nospc.U is returned to the user\r\nThis patch adds the ability to dump a page in an insane build, and adds 2 calls to do so in 2 outstanding nospc error cases. In those two cases a new user\r\nlevel error is thrown and nests the nospc.U error so that we still know the\r\noriginal stack trace where the lowest error was thrown.  \r\nThe patch passes all tests and the specific errors were hand tested, one of \r\nthem using the test case filed in DERBY-4923 and in the other case just by hand forcing the codepath.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-23T17:07:40.671+0000","updated":"2013-10-23T17:07:40.671+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13803524","id":"13803524","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1535206 from mikem@apache.org in branch 'code/branches/10.10'\r\n[ https://svn.apache.org/r1535206 ]\r\n\r\nDERBY-6320 Log a page dump to derby.log if ERROR nospc: nospc.U is returned to the user\r\n\r\nbackported change #1535075 from trunk to 10.10 branch, muliple manual changes\r\nwere necessary for the backport.\r\n\r\nThe backport of this change from trunk to 10.10 did not go cleanly at all due\r\nto usage of new java language features in messages in trunk. Here is the patch\r\nfor 10.10 which I assume will backport cleanly to previous releases.\r\nThe 2 problems were a new 15 param message and that trunk did not require\r\nObjects in newException() anymore. Also had to hand resolve a merge issue in\r\nStoredPage.java\r\n\r\nThis patch adds the ability to dump a page in an insane build, and adds 2 calls\r\nto do so in 2 outstanding nospc error cases. In those two cases a new user\r\nlevel error is thrown and nests the nospc.U error so that we still know the\r\noriginal stack trace where the lowest error was thrown.\r\nThe patch passes all tests and the specific errors were hand tested, one of\r\nthem using the test case filed in DERBY-4923 and in the other case just by hand\r\nforcing the codepath.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-23T23:10:02.820+0000","updated":"2013-10-23T23:10:02.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13803712","id":"13803712","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1535273 from mikem@apache.org in branch 'code/branches/10.9'\r\n[ https://svn.apache.org/r1535273 ]\r\n\r\nDERBY-6320 Log a page dump to derby.log if ERROR nospc: nospc.U is returned to the user\r\n\r\nbackported change #1535206 from 10.10 to 10.9 branch, merge was clean.\r\n\r\nThis patch adds the ability to dump a page in an insane build, and adds 2 calls\r\nto do so in 2 outstanding nospc error cases. In those two cases a new user\r\nlevel error is thrown and nests the nospc.U error so that we still know the\r\noriginal stack trace where the lowest error was thrown.\r\nThe patch passes all tests and the specific errors were hand tested, one of\r\nthem using the test case filed in DERBY-4923 and in the other case just by hand\r\nforcing the codepath.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-24T03:34:52.428+0000","updated":"2013-10-24T03:34:52.428+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13804306","id":"13804306","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1535408 from mikem@apache.org in branch 'code/branches/10.8'\r\n[ https://svn.apache.org/r1535408 ]\r\n\r\nDERBY-6320 Log a page dump to derby.log if ERROR nospc: nospc.U is returned to the user\r\n\r\nbackported change #1535206 from 10.10 to 10.8 branch, merge was clean.\r\n\r\nThis patch adds the ability to dump a page in an insane build, and adds 2 calls\r\nto do so in 2 outstanding nospc error cases. In those two cases a new user\r\nlevel error is thrown and nests the nospc.U error so that we still know the\r\noriginal stack trace where the lowest error was thrown.\r\nThe patch passes all tests and the specific errors were hand tested, one of\r\nthem using the test case filed in DERBY-4923 and in the other case just by hand\r\nforcing the codepath.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-24T15:16:48.548+0000","updated":"2013-10-24T15:16:48.548+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13804316","id":"13804316","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1535413 from mikem@apache.org in branch 'code/trunk'\r\n[ https://svn.apache.org/r1535413 ]\r\n\r\nDERBY-4923 update of a long row can fail with ERROR nospc: nospc.U exception.\r\n\r\nThis checkin fixes the problem repro'd by the included new test, which shows\r\nan update of an existing row in db failing with a nosp.U exception. \r\nThe problem was an off by 1 error in checking for enough space to update a row\r\non an overflow page to just an overflow pointer. The intent of the code is to \r\nalways reserve enough space in every overflow row to allow for this update. \r\nIn this case there was exactly enough space, but the code mistaken thought it \r\nneeded 1 more byte.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-24T15:27:16.260+0000","updated":"2013-10-24T15:27:16.260+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13804638","id":"13804638","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1535523 from mikem@apache.org in branch 'code/branches/10.10'\r\n[ https://svn.apache.org/r1535523 ]\r\n\r\nDERBY-4923 update of a long row can fail with ERROR nospc: nospc.U exception.\r\n\r\nbackport change #1535413 from trunk to 10.10 branch.\r\n\r\nThis checkin fixes the problem repro'd by the included new test, which shows\r\nan update of an existing row in db failing with a nosp.U exception.\r\nThe problem was an off by 1 error in checking for enough space to update a row\r\non an overflow page to just an overflow pointer. The intent of the code is to\r\nalways reserve enough space in every overflow row to allow for this update.\r\nIn this case there was exactly enough space, but the code mistaken thought it\r\nneeded 1 more byte.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-24T20:22:54.620+0000","updated":"2013-10-24T20:22:54.620+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13804751","id":"13804751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1535576 from mikem@apache.org in branch 'code/branches/10.8'\r\n[ https://svn.apache.org/r1535576 ]\r\n\r\nDERBY-4923 update of a long row can fail with ERROR nospc: nospc.U exception.\r\n\r\nbackport change #1535413 from trunk to 10.8 branch.\r\n\r\nThis checkin fixes the problem repro'd by the included new test, which shows\r\nan update of an existing row in db failing with a nosp.U exception.\r\nThe problem was an off by 1 error in checking for enough space to update a row\r\non an overflow page to just an overflow pointer. The intent of the code is to\r\nalways reserve enough space in every overflow row to allow for this update.\r\nIn this case there was exactly enough space, but the code mistaken thought it\r\nneeded 1 more byte.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-24T22:21:02.905+0000","updated":"2013-10-24T22:21:02.905+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13804753","id":"13804753","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1535577 from mikem@apache.org in branch 'code/branches/10.9'\r\n[ https://svn.apache.org/r1535577 ]\r\n\r\nDERBY-4923 update of a long row can fail with ERROR nospc: nospc.U exception.\r\n\r\nbackport change #1535413 from trunk to 10.9 branch.\r\n\r\nThis checkin fixes the problem repro'd by the included new test, which shows\r\nan update of an existing row in db failing with a nosp.U exception.\r\nThe problem was an off by 1 error in checking for enough space to update a row\r\non an overflow page to just an overflow pointer. The intent of the code is to\r\nalways reserve enough space in every overflow row to allow for this update.\r\nIn this case there was exactly enough space, but the code mistaken thought it\r\nneeded 1 more byte.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-24T22:22:01.688+0000","updated":"2013-10-24T22:22:01.688+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/13804755","id":"13804755","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"fixed in trunk and backported to 10.10, 10.9, and 10.8.  I don't plan on backporting farther at this time, but it would be fine if someone else is interested.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2013-10-24T22:23:51.547+0000","updated":"2013-10-24T22:23:51.547+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12491720/comment/14284808","id":"14284808","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"bulk change to close all issues resolved but not closed and not changed since June 1, 2014.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2015-01-21T00:23:28.550+0000","updated":"2015-01-21T00:23:28.550+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4923/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06ey7:"}}