{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12633654","self":"https://issues.apache.org/jira/rest/api/latest/issue/12633654","key":"SOLR-4489","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324743","id":"12324743","description":"Major release after 4.4","name":"4.5","archived":false,"released":true,"releaseDate":"2013-10-05"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-03-18 10:04:59.929","customfield_12312323":null,"customfield_12310420":"314149","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_13214947057_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-07-25T16:19:26.120+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-4489/watchers","watchCount":6,"isWatching":false},"created":"2013-02-22T17:30:19.086+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324395","id":"12324395","description":"Bugfix release after 4.3","name":"4.3.1","archived":false,"released":true,"releaseDate":"2013-06-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324324","id":"12324324","description":"Major release after 4.3","name":"4.4","archived":false,"released":true,"releaseDate":"2013-07-23"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-10-05T10:18:49.045+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312015","id":"12312015","name":"spellchecker","description":"Returning spelling suggestions"}],"timeoriginalestimate":null,"description":"My SOLR request params are as shown below.\r\n\r\nspellcheck=true&enableElevation=true&facet=true&spellcheck.q=minecraft&spellcheck.extendedResults=true&spellcheck.maxCollations=10&spellcheck.collate=true&wt=javabin&defType=edismax&spellcheck.onlyMorePopular=true  etc.\r\n\r\nNote: this work fine many use cases, however it fails for some query terms.\r\n\r\n\r\nFeb 22, 2013 11:06:04 AM org.apache.solr.common.SolrException log\r\nSEVERE: null:java.lang.StringIndexOutOfBoundsException: String index out of range: -5\r\n\tat java.lang.AbstractStringBuilder.replace(AbstractStringBuilder.java:797)\r\n\tat java.lang.StringBuilder.replace(StringBuilder.java:271)\r\n\tat org.apache.solr.spelling.SpellCheckCollator.getCollation(SpellCheckCollator.java:190)\r\n\tat org.apache.solr.spelling.SpellCheckCollator.collate(SpellCheckCollator.java:75)\r\n\tat org.apache.solr.handler.component.SpellCheckComponent.addCollationsToResponse(SpellCheckComponent.java:203)\r\n\tat org.apache.solr.handler.component.SpellCheckComponent.process(SpellCheckComponent.java:180)\r\n\tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:206)\r\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)\r\n\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1699)\r\n\tat org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:455)\r\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:276)\r\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)\r\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:484)\r\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)\r\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524)\r\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)\r\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1065)\r\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:413)\r\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)\r\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:999)\r\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)\r\n\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)\r\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)\r\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111)\r\n\tat org.eclipse.jetty.server.Server.handle(Server.java:351)\r\n\tat org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:454)\r\n\tat org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:47)\r\n\tat org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:890)\r\n\tat org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:944)\r\n\tat org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:634)\r\n\tat org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:230)\r\n\tat org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:66)\r\n\tat org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:254)\r\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:599)\r\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:534)\r\n\tat java.lang.Thread.run(Thread.java:680)\r\n\r\n\r\n\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"314494","summary":"StringIndexOutOfBoundsException in SpellCheckComponent ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vmarrapu","name":"vmarrapu","emailAddress":"vmarrapu at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"venkata marrapu","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vmarrapu","name":"vmarrapu","emailAddress":"vmarrapu at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"venkata marrapu","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"all","customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":8,"total":8,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12633654/comment/13584957","id":"13584957","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vmarrapu","name":"vmarrapu","emailAddress":"vmarrapu at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"venkata marrapu","active":true},"body":"Tested in Solr 4.1 release & noticed same issue.\r\nI am using DirectSolrSpellChecker. \r\n\r\nfrom my solrconfig.xml\r\n\r\n\r\n<searchComponent name=\"spellcheck\" class=\"solr.SpellCheckComponent\">\r\n\r\n    <str name=\"queryAnalyzerFieldType\">textSpell</str>\r\n       <lst name=\"spellchecker\">\r\n          <str name=\"name\">default</str>\r\n          <str name=\"field\">textSpell</str>\r\n          <str name=\"classname\">solr.DirectSolrSpellChecker</str>\r\n          <str name=\"distanceMeasure\">internal</str>\r\n         <float name=\"accuracy\">0.5</float>\r\n         <int name=\"maxEdits\">2</int>\r\n         <int name=\"minPrefix\">1</int>\r\n         <int name=\"maxInspections\">5</int>\r\n         <int name=\"minQueryLength\">4</int>\r\n         <float name=\"maxQueryFrequency\">0.01</float>\r\n      </lst>\r\n\r\n      <lst name=\"spellchecker\">\r\n          <str name=\"name\">wordbreak</str>\r\n          <str name=\"classname\">solr.WordBreakSolrSpellChecker</str>\r\n          <str name=\"field\">textSpell</str>\r\n          <str name=\"combineWords\">true</str>\r\n          <str name=\"breakWords\">true</str>\r\n          <int name=\"maxChanges\">10</int>\r\n      </lst>\r\n   </searchComponent>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vmarrapu","name":"vmarrapu","emailAddress":"vmarrapu at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"venkata marrapu","active":true},"created":"2013-02-23T02:14:42.383+0000","updated":"2013-02-23T02:14:42.383+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12633654/comment/13604973","id":"13604973","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alukanin","name":"alukanin","emailAddress":"ice_lc at mail dot ru","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Artem Lukanin","active":true},"body":"The same issue with wordbreak in Solr 4.1:\r\n\r\n{code}params={spellcheck=true&indent=true&q=calvin\\+harris\\+feat\\+ne\\+yo&spellcheck.q=calvin\\+harris\\+feat\\+ne\\+yo&wt=xml}\r\n\r\nSEVERE: null:java.lang.StringIndexOutOfBoundsException: String index out of range: 25\r\n\tat java.lang.AbstractStringBuilder.charAt(AbstractStringBuilder.java:174)\r\n\tat java.lang.StringBuilder.charAt(StringBuilder.java:55)\r\n\tat org.apache.solr.spelling.SpellCheckCollator.getCollation(SpellCheckCollator.java:164)\r\n\tat org.apache.solr.spelling.SpellCheckCollator.collate(SpellCheckCollator.java:75)\r\n\tat org.apache.solr.handler.component.SpellCheckComponent.addCollationsToResponse(SpellCheckComponent.java:203)\r\n\tat org.apache.solr.handler.component.SpellCheckComponent.process(SpellCheckComponent.java:180)\r\n\tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:208)\r\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)\r\n\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1816)\r\n\tat org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:448)\r\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:269)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\r\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\r\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\r\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\r\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\r\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\r\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\r\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\r\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)\r\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\r\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\r\n\tat java.lang.Thread.run(Thread.java:662)\r\n{code}\r\n\r\nIf I set\r\n{code}\r\n\t<str name=\"combineWords\">false</str>\r\n{code}\r\nthe exception disappears.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alukanin","name":"alukanin","emailAddress":"ice_lc at mail dot ru","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Artem Lukanin","active":true},"created":"2013-03-18T10:04:59.929+0000","updated":"2013-03-18T10:24:59.096+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12633654/comment/13604986","id":"13604986","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alukanin","name":"alukanin","emailAddress":"ice_lc at mail dot ru","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Artem Lukanin","active":true},"body":"with combineWords=false I have another exception for the query \r\n{code}рики\\-тики\\-тави{code}\r\n:\r\n\r\n{code}\r\norg.apache.solr.spelling.SpellCheckCollator collate\r\nWARNING: Exception trying to re-query to check if a spell check possibility would return any hits.\r\norg.apache.solr.common.SolrException: org.apache.solr.search.SyntaxError: Cannot parse 'рики\\-таки\\(-т -а -ви)': Encountered \" \")\" \") \"\" at line 1, column 21.\r\nWas expecting one of:\r\n    <EOF> \r\n    <AND> ...\r\n    <OR> ...\r\n    <NOT> ...\r\n    \"+\" ...\r\n    \"-\" ...\r\n    <BAREOPER> ...\r\n    \"(\" ...\r\n    \"*\" ...\r\n    \"^\" ...\r\n    <QUOTED> ...\r\n    <TERM> ...\r\n    <FUZZY_SLOP> ...\r\n    <PREFIXTERM> ...\r\n    <WILDTERM> ...\r\n    <REGEXPTERM> ...\r\n    \"[\" ...\r\n    \"{\" ...\r\n    <LPARAMS> ...\r\n    <NUMBER> ...\r\n    \r\n\tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:147)\r\n\tat org.apache.solr.spelling.SpellCheckCollator.collate(SpellCheckCollator.java:111)\r\n\tat org.apache.solr.handler.component.SpellCheckComponent.addCollationsToResponse(SpellCheckComponent.java:203)\r\n\tat org.apache.solr.handler.component.SpellCheckComponent.process(SpellCheckComponent.java:180)\r\n\tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:208)\r\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)\r\n\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:1816)\r\n\tat org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:448)\r\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:269)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\r\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\r\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\r\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\r\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\r\n\tat org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)\r\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\r\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\r\n\tat org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)\r\n\tat org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\r\n\tat org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\r\n\tat java.lang.Thread.run(Thread.java:662)\r\nCaused by: org.apache.solr.search.SyntaxError: Cannot parse 'рики\\-таки\\(-т -а -ви)': Encountered \" \")\" \") \"\" at line 1, column 21.\r\nWas expecting one of:\r\n    <EOF> \r\n    <AND> ...\r\n    <OR> ...\r\n    <NOT> ...\r\n    \"+\" ...\r\n    \"-\" ...\r\n    <BAREOPER> ...\r\n    \"(\" ...\r\n    \"*\" ...\r\n    \"^\" ...\r\n    <QUOTED> ...\r\n    <TERM> ...\r\n    <FUZZY_SLOP> ...\r\n    <PREFIXTERM> ...\r\n    <WILDTERM> ...\r\n    <REGEXPTERM> ...\r\n    \"[\" ...\r\n    \"{\" ...\r\n    <LPARAMS> ...\r\n    <NUMBER> ...\r\n    \r\n\tat org.apache.solr.parser.SolrQueryParserBase.parse(SolrQueryParserBase.java:164)\r\n\tat org.apache.solr.search.LuceneQParser.parse(LuceneQParserPlugin.java:72)\r\n\tat org.apache.solr.search.QParser.getQuery(QParser.java:142)\r\n\tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:117)\r\n\t... 23 more\r\nCaused by: org.apache.solr.parser.ParseException: Encountered \" \")\" \") \"\" at line 1, column 21.\r\nWas expecting one of:\r\n    <EOF> \r\n    <AND> ...\r\n    <OR> ...\r\n    <NOT> ...\r\n    \"+\" ...\r\n    \"-\" ...\r\n    <BAREOPER> ...\r\n    \"(\" ...\r\n    \"*\" ...\r\n    \"^\" ...\r\n    <QUOTED> ...\r\n    <TERM> ...\r\n    <FUZZY_SLOP> ...\r\n    <PREFIXTERM> ...\r\n    <WILDTERM> ...\r\n    <REGEXPTERM> ...\r\n    \"[\" ...\r\n    \"{\" ...\r\n    <LPARAMS> ...\r\n    <NUMBER> ...\r\n    \r\n\tat org.apache.solr.parser.QueryParser.generateParseException(QueryParser.java:651)\r\n\tat org.apache.solr.parser.QueryParser.jj_consume_token(QueryParser.java:533)\r\n\tat org.apache.solr.parser.QueryParser.TopLevelQuery(QueryParser.java:98)\r\n\tat org.apache.solr.parser.SolrQueryParserBase.parse(SolrQueryParserBase.java:160)\r\n\t... 26 more\r\n{code}\r\n\r\nSo, SpellCheckCollator generates a corrupted query for the original escaped query.\r\nI have\r\n{code}\r\n<solrQueryParser defaultOperator=\"AND\"/>\r\n{code}\r\nin the schema, as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=alukanin","name":"alukanin","emailAddress":"ice_lc at mail dot ru","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Artem Lukanin","active":true},"created":"2013-03-18T10:21:16.065+0000","updated":"2013-03-18T10:24:11.350+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12633654/comment/13718563","id":"13718563","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"Here is a failing unit test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2013-07-24T16:53:21.806+0000","updated":"2013-07-24T16:53:21.806+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12633654/comment/13718724","id":"13718724","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"Here is a patch with a fix & test.  All tests pass.  I will commit this shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2013-07-24T19:12:35.120+0000","updated":"2013-07-24T19:12:35.120+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12633654/comment/13719735","id":"13719735","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1507042 from [~jdyer] in branch 'dev/trunk'\r\n[ https://svn.apache.org/r1507042 ]\r\n\r\nSOLR-4489: fix StringIndexOutOfBoundsException in SpellCheckComponent","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-07-25T16:04:04.643+0000","updated":"2013-07-25T16:04:04.643+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12633654/comment/13719741","id":"13719741","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1507049 from [~jdyer] in branch 'dev/branches/branch_4x'\r\n[ https://svn.apache.org/r1507049 ]\r\n\r\nSOLR-4489: fix StringIndexOutOfBoundsException in SpellCheckComponent","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-07-25T16:17:04.351+0000","updated":"2013-07-25T16:17:04.351+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12633654/comment/13787028","id":"13787028","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpountz","name":"jpountz","emailAddress":"jpountz at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jpountz&avatarId=16520","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jpountz&avatarId=16520","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jpountz&avatarId=16520","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jpountz&avatarId=16520"},"displayName":"Adrien Grand","active":true},"body":"4.5 release -> bulk close","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpountz","name":"jpountz","emailAddress":"jpountz at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jpountz&avatarId=16520","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jpountz&avatarId=16520","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jpountz&avatarId=16520","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jpountz&avatarId=16520"},"displayName":"Adrien Grand","active":true},"created":"2013-10-05T10:18:49.026+0000","updated":"2013-10-05T10:18:49.026+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-4489/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1i7mf:"}}