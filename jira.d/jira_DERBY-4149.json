{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12422162","self":"https://issues.apache.org/jira/rest/api/latest/issue/12422162","key":"DERBY-4149","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/6","id":"6","description":"The problem isn't valid and it can't be fixed.","name":"Invalid"},"customfield_12310220":"2009-09-30 23:09:10.037","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24062","customfield_12310222":"1_*:*_1_*:*_54693645761_*|*_6_*:*_2_*:*_1125680987_*|*_4_*:*_1_*:*_73046091","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-01-13T18:57:23.357+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4149/watchers","watchCount":0,"isWatching":false},"created":"2009-04-06T21:17:50.518+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12337980","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12337980","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12500641","key":"DERBY-5096","self":"https://issues.apache.org/jira/rest/api/2/issue/12500641","fields":{"summary":"DisconnectException: \"Connection was refused because the database DB was not found\" when creating db for first time","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-03-09T23:47:34.837+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"}],"timeoriginalestimate":null,"description":"This is the test failure's stack trace:\r\n testSimpleDSConnect(org.apache.derbyTesting.functionTests.tests.jdbcapi.InternationalConnectSimpleDSTest)java.sql.SQLException: Database '?' not found.\r\n\tat java.lang.Throwable.<init>(Throwable.java:196)\r\n\tat java.lang.Exception.<init>(Exception.java:41)\r\n\tat java.sql.SQLException.<init>(SQLException.java:40)\r\n\tat org.apache.derby.impl.jdbc.EmbedSQLException.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleDBNotFound(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(Unknown Source)\r\n\tat org.apache.derby.jdbc.Driver30.getNewEmbedConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.EmbeddedDataSource.getConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.EmbeddedDataSource.getConnection(Unknown Source)\r\n\tat org.apache.derbyTesting.functionTests.tests.jdbcapi.InternationalConnectSimpleDSTest.testSimpleDSConnect(InternationalConnectSimpleDSTest.java:61)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\r\n\tat org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:84)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10369","value":"Regression Test Failure","id":"10369"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36644","summary":"test failure in jdbcapi.InternationalConnectSimpleDSTest fixture  testSimpleDSConnect on IBM iseries - Database '?' not found.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"IBM iseries, OS: AS/400; OS version: !V5R4M0, jvm: IBM 1.5 (build 1.5.0_13-b05)","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":9,"total":9,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12696408","id":"12696408","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"same error for InternationalConnectTest testDriverManagerConnect and testCPDSConnect.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-04-07T05:17:50.828+0000","updated":"2009-04-07T05:17:50.828+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12696413","id":"12696413","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Additional oddness: after the test has failed, qsh (q shell on AS400) rm -rf * no longer works on the 'system' directory:\r\nrm: 001-2136 Error found removing link to object system. Directory not empty.\r\n(but ls -al shows the directory is empty)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-04-07T05:40:24.026+0000","updated":"2009-04-07T05:40:24.026+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12718589","id":"12718589","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I tried to make this class to see if it could remove the not-really-there database, but it hangs.\r\nSo I *do* end up with unremovable directories on the system.\r\nThis isn't really acceptable, I think.\r\n\r\nBut perhaps I made a mistake somewhere in the class file.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-06-11T19:04:33.570+0000","updated":"2009-06-11T19:04:33.570+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12761041","id":"12761041","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The attached program RemveDir.java can be used to remove the \r\nproblem directories.  You cd to the test directory and run\r\njava RemoveDir <dirtoremove>, e.g java RemoveDir system.  \r\nThe directory system and all its contents will  be removed.  \r\nI tried this only with jdk16. Your program did not remove \r\ndirectory entries, only files. I did not see it hang but it did not remove\r\nthe offending directory.\r\n\r\nI am also attaching ReproDerby4149 which shows the problem connecting to \r\nan international database on iseries.  The program fails creating the \r\ndatabase with:\r\n   conn = DriverManager.getConnection(\"jdbc:derby:\" + dbDir + \";create=true\");\r\nwhere dbDir is \"test/\\u4e10\";\r\n\r\nThe connect fails with Database not found but does actually create a the\r\ndirectory.  This is the exception:\r\n\r\n\r\njava.sql.SQLException: Database 'test/?' not found.\r\n\tat java.lang.Throwable.<init>(Throwable.java:218)\r\n\tat java.sql.SQLException.<init>(SQLException.java:218)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleDBNotFound(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(Unknown Source)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:582)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:207)\r\n\tat ReproDerby4149.main(ReproDerby4149.java:13)\r\nCaused by: java.sql.SQLException: Database 'test/?' not found.\r\n\tat java.lang.Throwable.<init>(Throwable.java:196)\r\n\tat java.sql.SQLException.<init>(SQLException.java:52)\r\n\tat org.apache.derby.impl.jdbc.EmbedSQLException.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n\t... 15 more\r\n============= begin nested exception, level (1) ===========\r\njava.sql.SQLException: Database 'test/?' not found.\r\n\tat java.lang.Throwable.<init>(Throwable.java:196)\r\n\tat java.sql.SQLException.<init>(SQLException.java:52)\r\n\tat org.apache.derby.impl.jdbc.EmbedSQLException.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleDBNotFound(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(Unknown Source)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:582)\r\n\tat java.sql.DriverManager.getConnection(DriverManager.java:207)\r\n\tat ReproDerby4149.main(ReproDerby4149.java:13)\r\n============= end nested exception, level (1) ===========\r\nCleanup action completed\r\n\r\n2009-09-30 16:20:50.841 GMT:\r\nShutting down instance a816c00e-0124-0bc0-d16d-00000010a8cb\r\n----------------------------------------------------------------\r\n\r\n\r\nI suspect a JVM bug here and am trying to narrow this down \r\nto a java only repro.\r\n\r\nIn the test there is a teardown method that tries to remove the \r\ndirectory but the problem is that it first tries to shutdown the \r\ndatabase which fails with the exception above.  I suggest we \r\nchange the test to shutdown the engine instead of just the \r\ndatabase so the teardown can complete and clean up the \r\ndirectory properly.  I will submit a patch for that shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-09-30T23:09:10.037+0000","updated":"2009-09-30T23:09:10.037+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12762338","id":"12762338","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The attached patch changes the test to shutdown the engine instead of the database with the teardown method, before removing the direcstory. This allows the directory to be properly removed on iseries.  The test still fails on iseries but will not leave the hard to remove directory behind.\r\n\r\nI will commit this patch this afternoon unless anyone has comments.  I am still working to isolate the iseries java problem.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-10-05T20:06:48.881+0000","updated":"2009-10-05T20:06:48.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12933608","id":"12933608","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"This is still occurring. With 10.7.1.0 testing, there are now additional test failures.\r\n\r\nWith 10.6.2.1 we had 3 Errors \r\n  (indicating Database ? not found) in the embedded runs of\r\n    - testSimpleDSConnect\r\n    - testDriverManagerConnect\r\n    - testCPDSConnect\r\n\r\nWith 10.7.1.0 I see 9 Errors and 1 Failure:\r\n- The 'database ? not found' \r\n   in embedded run of testSimpleDSConnect, testDriverManagerConnect.\r\n- 'connection refused because the database ??????(etc) was not found' in testBoundaries (i.e. networkserver/client)\r\n- 'cannot create database because it already exists' in \r\n   - testXADSConnect (embedded & client/server)\r\n   - testCPDSConnect (embedded & client/server)\r\n   - testDriverManagerConnect (client/server)\r\n\r\nAlso, testSimpleDSConnect (network server/client) fails with a assertion comparison failure:\r\n1) testSimpleDSConnect(org.apache.derbyTesting.functionTests.tests.jdbcapi.InternationalConnectSimpleDSTest)junit.framework.ComparisonFailure: Unexpected SQL state. expected:<22005> but was:<08004>.\r\n...(stack)...\r\nCaused by: org.apache.derby.client.am.DisconnectException: The connection was refused because the database ?;create=true was not found.\r\n...(more stack)...\r\nI think this is either just more of the same, or a result of earlier errors\r\n\r\nIn addition, there is a NullPointer in a seemingly unrelated test, which passes when run by itself. Note that this same test showed NPEs after the trouble on windows of DERBY-4836, so I think it too is related. This is the stack trace for that one:\r\n9) testSettingBootAllPropertyWithHomePropertySet(org.apache.derbyTesting.functionTests.tests.store.BootAllTest)java.lang.NullPointerException\r\n\tat java.lang.Throwable.<init>(Throwable.java:181)\r\n\tat java.lang.RuntimeException.<init>(RuntimeException.java:32)\r\n\tat java.lang.NullPointerException.<init>(NullPointerException.java:36)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootProviderServices(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.bootPersistentServices(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.BaseMonitor.runWithState(Unknown Source)\r\n\tat org.apache.derby.impl.services.monitor.FileMonitor.<init>(Unknown Source)\r\n\tat org.apache.derby.iapi.services.monitor.Monitor.startMonitor(Unknown Source)\r\n\tat org.apache.derby.iapi.jdbc.JDBCBoot.boot(Unknown Source)\r\n\tat org.apache.derby.jdbc.EmbeddedDriver.boot(Unknown Source)\r\n\tat org.apache.derby.jdbc.EmbeddedDriver.<init>(Unknown Source)\r\n\tat sun.reflect.GeneratedConstructorAccessor1287095131.newInstance(Unknown Source)\r\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)\r\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:494)\r\n\tat java.lang.Class.newInstance0(Class.java:375)\r\n\tat java.lang.Class.newInstance(Class.java:328)\r\n\tat org.apache.derbyTesting.functionTests.tests.store.BootAllTest.testSettingBootAllPropertyWithHomePropertySet(BootAllTest.java:147)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\r\n\tat org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2010-11-18T23:30:35.549+0000","updated":"2010-11-18T23:30:35.549+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12976120","id":"12976120","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Closing as invalid as this is not a problem in derby code.\r\n\r\nI spent some time debugging this (which was tricky because I don't have access to a debugger on the system where the test was failing).\r\n\r\nThe problem occurs on calling getCanonicalPath after a call to mkDirs when the u4e10 character is used in the (full-path) filename. After mkDirs, getCanonicalPath returns a different value then before.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2010-12-30T21:58:36.190+0000","updated":"2010-12-30T21:58:36.190+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12980980","id":"12980980","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"reopening to skip the test fixtures on the offending os.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2011-01-12T22:39:57.217+0000","updated":"2011-01-12T22:39:57.217+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12422162/comment/12981417","id":"12981417","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Adding skipping on os400 with revision 1058707","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2011-01-13T18:57:09.567+0000","updated":"2011-01-13T18:57:09.567+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4149/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06mwf:"}}