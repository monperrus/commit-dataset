{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12311901","self":"https://issues.apache.org/jira/rest/api/latest/issue/12311901","key":"DERBY-438","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-08-22 08:49:20.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21953","customfield_12310222":"1_*:*_1_*:*_28912176000_*|*_6_*:*_2_*:*_43689929799_*|*_5_*:*_1_*:*_3461859000_*|*_4_*:*_1_*:*_719161548","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-12-08T00:49:36.347+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-438/watchers","watchCount":0,"isWatching":false},"created":"2005-07-02T08:10:50.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10992","id":"10992","name":"10.0.2.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-12-08T00:49:36.332+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"Suppose I have 1) a table \"t1\" with blob data in it, and 2) an UPDATE trigger \"tr1\" defined on that table, where the triggered-SQL-action for \"tr1\" references the blob column from the updated (\"new\") row. Ex:\n\ncreate table t1 (id int, updated smallint, bl blob(32000));\ncreate trigger tr1 after update on t1 referencing new as n_row for each row mode db2sql values length(n_row.bl);\n\nAssuming that t1 has been populated with some data, then attempts to update t1 will fire the trigger, but the result will be one of the two following errors:\n\n1) If blob data is < 32K...\n\nIf the actual data in the table is less than 32K in length, the result will be:\n\nERROR XCL12: An attempt was made to put a data value of type 'org.apache.derby.impl.jdbc.EmbedBlob' into a data value of type 'BLOB'.\n\n2) If blob data is > 32K...\n\nIf at least one row in the table has blob data that is longer than 32K (which means that Derby will stream it, so far as I can tell), then the error will be:\n\nERROR XCL30: An IOException was thrown when reading a 'BLOB' from an InputStream.\nERROR XJ001: Java exception: ': java.io.EOFException'.\n\nNote that for data larger than 32K, this error will occur regardless of whether or not the triggered-SQL-statement\nreferences the blob column.\n\nSurprisingly, it doesn't (appear to) matter what the trigger statement is actually doing--so long as it references the blob column at least once, one of these two errors will occur, depending on the length of the data.  And if the data is greater than 32k, then the error will happen regardless of what the trigger does or whether or not it references the blob column.\n\nI looked at the documentation for UPDATE statements and TRIGGER statements, but nowhere did I see anything saying that either of these will not work with blobs.  So as far as I can tell, both of the above scenarios should succeed...","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39748","summary":"Update triggers on tables with BLOB and CLOB columns fail at execution time if the triggered-SQL-statement references the LOB column(s).","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"subtasks":[{"id":"12312010","key":"DERBY-442","self":"https://issues.apache.org/jira/rest/api/2/issue/12312010","fields":{"summary":"Update triggers on tables with blob columns stream blobs into memory even when the blobs are not referenced/accessed.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}},{"id":"12326834","key":"DERBY-770","self":"https://issues.apache.org/jira/rest/api/2/issue/12326834","fields":{"summary":"Document restrictions mentioned in DERBY-438","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}},{"id":"12326835","key":"DERBY-771","self":"https://issues.apache.org/jira/rest/api/2/issue/12326835","fields":{"summary":"Return better error messages for the scenarios in DERBY-438","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}},{"id":"12326900","key":"DERBY-776","self":"https://issues.apache.org/jira/rest/api/2/issue/12326900","fields":{"summary":"Clean up code relating to Object handling in DataValueDescriptor.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}},{"id":"12383539","key":"DERBY-3236","self":"https://issues.apache.org/jira/rest/api/2/issue/12383539","fields":{"summary":"backport DERBY-438 changes to 10.1","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}}],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":10,"total":10,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12314928","id":"12314928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching a repro for the problem.  To run, just do \"java go\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-07-02T08:12:01.000+0000","updated":"2005-07-02T08:12:01.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12318008","id":"12318008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"There was some discussion on this issue on the derby-dev list; I'm including the results of that discussion here for ease-of-tracking:\r\n\r\nIt was noted that Derby as it currently stands does not support \"accessing LOB columns of the modified table by the action statement\" within a triggered-SQL-action, \"because within the database engine, there is no mechanism to create a java.sql.Blob object (or Clob) from a SQL BLOB (CLOB) datatype\" (quoting from the derby-dev thread).  That said, there are really four 'to-do's with this issue:\r\n\r\n1  - document the current restrictions\r\n2  - with the current restriction produce a better error message\r\n3  - implement LOB support in the referenced tables.\r\n4  - Fix triggers so that they work in cases where the triggered-SQL-statement does _not_ reference a blob column (currently, a trigger will fail with an IOException if the target table has blob data larger than 32K, even if that column isn't actually referenced by the trigger action).\r\n\r\nFor the full thread, see:\r\n\r\nhttp://article.gmane.org/gmane.comp.apache.db.derby.devel/6272\r\n\r\nI should have posted this comment at the time the derby-dev discussion was concluded; apologies for any inconvenience...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-08-08T23:59:41.000+0000","updated":"2005-08-08T23:59:41.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12319533","id":"12319533","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mkhettry","name":"mkhettry","emailAddress":"manish_khettry at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manish Khettry","active":true},"body":"Even if the blob column is not referenced,  an io exception is thrown. The Exception is caused by the SQL layer trying to read the same Stream twice. The test case is pretty much the same as the attached go.java, reproduced here for convenience)\r\n\r\ncreate table t1 (id int, updated smallint, bl blob(64k));\r\ncreate trigger tr1 after update on t1 referencing \r\n                  new as n_row for each row mode db2sql values length(n_row.updated);\r\nupdate t1 set updated = 1 where id = ?;\r\n\r\n\r\nThe first call to load the stream is in NormalizeResultSet; i.e.\r\n\r\n        at org.apache.derby.iapi.types.SQLBlob.normalize(SQLBlob.java:110)\r\n        at org.apache.derby.iapi.types.DataTypeDescriptor.normalize(DataTypeDescriptor.java:432)\r\n        at org.apache.derby.impl.sql.execute.NormalizeResultSet.normalizeRow(NormalizeResultSet.java:351)\r\n        at org.apache.derby.impl.sql.execute.NormalizeResultSet.getNextRowCore(NormalizeResultSet.java:207)\r\n        at org.apache.derby.impl.sql.execute.DMLWriteResultSet.getNextRowCore(DMLWriteResultSet.java:124)\r\n\r\nThe second call is\r\n\r\n        at org.apache.derby.iapi.types.SQLBinary.getValue(SQLBinary.java:198)\r\n        at org.apache.derby.iapi.types.SQLBinary.loadStream(SQLBinary.java:542)\r\n        at org.apache.derby.impl.sql.execute.DMLWriteResultSet.objectifyStreams(DMLWriteResultSet.java:151)\r\n        at org.apache.derby.impl.sql.execute.DMLWriteResultSet.getNextRowCore(DMLWriteResultSet.java:132)\r\n        at org.apache.derby.impl.sql.execute.UpdateResultSet.collectAffectedRows(UpdateResultSet.java:453)\r\n\r\nIf Derby does not support accessing LOB columns in triggers, there does seem to becode that seems to think otherwise! In particular look at the constructor for DMLWriteResultStream (the comments at the end, the variable 'needToObjectifyStream'). It looks to me, that for any DML on a table which has triggers defined, we'll end up materializing stream columns even if the DML and the trigger do not reference any stream storable columns.\r\n\r\nSo apart from the 4  \"todo's\" in the previous comment, I have a couple of questions for those more familiar with this code.\r\n\r\n1. If we don't support referencing blob columns in triggers, do we need the logic for objectifyStream in DMLWriteResultSet? The comment in the constructor refers to several bug numbers which predate Jira-- 2432, 3383, 4896. Is it possible to get information about these?\r\n\r\n2. Does NormalizeResultSet need to normalize a column that is not referred to in the update? \r\n\r\n\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mkhettry","name":"mkhettry","emailAddress":"manish_khettry at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Manish Khettry","active":true},"created":"2005-08-22T08:49:20.000+0000","updated":"2005-08-22T08:49:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12377483","id":"12377483","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Several fixes have been made (seen the Subversion commits) that support blob/clob in row triggers including the case when the LOB value is streamed from the store.\r\nWriting a test for statement triggers showed an issue where the implementation of the statement trigger depended on a VTI (ResultSet implementation) that was still at JDBC 1.2 level, thus not supporting BLOB/CLOB. Some description of how triggers are executed has been documented on the wiki at:\r\n\r\nhttp://wiki.apache.org/db-derby/TriggerImplementation\r\n\r\nThe proposed change to fix this is to change the VTIs used in triggers from implementations of java.sql.ResultSet that wrap a embedded java.sql.ResultSet  that wraps a Derby language ResultSet, to implementations of java.sql.PreparedStatement  that simply return the embedded java.sql.ResultSet  that wraps a Derby language ResultSet. \r\n\r\nPreparedStatement VTIs are more flexible that ResultSet  VTIs in that they can be updatable (not required in this case) and (for this case) the implementation of the ResultSet can be hidden by the class, allowing different implementations in different situations.\r\n\r\nThis fixes the situation for statement triggers as the ResultSet now returned to the re-written  trigger action statement  will support BLOB/CLOB as it will be JDBC ResultSet as returned from the embedded driver. Since the api of the VTI does not change this fix should work on soft upgrade for old triggers from 10.1/10.0 and triggers created in 10.2 soft upgrade that will then run in 10.1/10.0","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-05-03T05:40:24.000+0000","updated":"2006-05-03T05:40:24.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12377485","id":"12377485","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Draft patch that shows the change from ResultSet to PreparedStatement for the trigger VTIs.\r\n\r\nM      java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\FromVTI.java\r\nM      java\\engine\\org\\apache\\derby\\vti\\UpdatableVTITemplate.java\r\nM      java\\engine\\org\\apache\\derby\\catalog\\TriggerNewTransitionRows.java\r\nM      java\\engine\\org\\apache\\derby\\catalog\\TriggerOldTransitionRows.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\jdbcapi\\blobclob4BLOB.java\r\n\r\nMajority of change is removing the ResultSet methods from the transition VTIs.\r\nOnly includes the test changes, not the modified output. Patch is draft.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-05-03T05:46:21.000+0000","updated":"2006-05-03T05:46:21.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12414253","id":"12414253","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Number of commits marked with DERBY-438 have been applied. Tests are in triggerGeneral.sql and blobclob4BLOB.java for both BLOB and CLOB. Includes row & statement, with small and large LOBs.\r\n\r\nI do not believe DERBY-442 is a sub-task of this bug description. DERBY-442 is a separate (but related) issue. I don't see a way in Juru to move it though.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-06-01T23:20:26.000+0000","updated":"2006-06-01T23:20:26.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12420381","id":"12420381","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Many patches contributed and committed by Dan, the last of which has been in the codeline for over a month now.  So I'm closing this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2006-07-12T00:58:05.000+0000","updated":"2006-07-12T00:58:05.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12546784","id":"12546784","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Kathey Mardsen (in DERBY-1482) has indicated a need to fix this issue in 10.1, possibly by backporting these changes.\r\n\r\nOne possible concern to backporting is the changes made in revision 409422 which modifed the altered form of the trigger's action statement.\r\nIt might work ok in a branch (ie. 10.1) as long as the commit that includes that specific change also changes the last digit of the version number.\r\nThis will trigger automatic re-compile for all stored plans which will include the trigger's action statement. This would need to be confirmed though.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-11-29T16:24:48.273+0000","updated":"2007-11-29T16:24:48.273+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12546791","id":"12546791","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"In back-porting this (which I think is the best approach to fixing this in 10.1) back-porting DERBY-1258 might be required.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-11-29T16:43:14.895+0000","updated":"2007-11-29T16:43:14.895+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12311901/comment/12546799","id":"12546799","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"reopen to attempt  backport to 10.1\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-11-29T17:03:34.793+0000","updated":"2007-11-29T17:03:34.793+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-438/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07627:"}}