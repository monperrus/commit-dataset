{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12426193","self":"https://issues.apache.org/jira/rest/api/latest/issue/12426193","key":"DERBY-4244","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314182","id":"12314182","description":"Old head of 10.5 branch","name":"10.5.3.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313727","id":"12313727","description":"Feature release","name":"10.6.1.0","archived":false,"released":true,"releaseDate":"2010-05-18"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2009-05-23 15:41:43.477","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24128","customfield_12310222":"1_*:*_1_*:*_4877406451_*|*_6_*:*_1_*:*_29994730611_*|*_5_*:*_2_*:*_60602220_*|*_4_*:*_1_*:*_144808753","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-07-03T14:27:39.552+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4244/watchers","watchCount":1,"isWatching":false},"created":"2009-05-23T14:41:51.517+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312876","id":"12312876","description":"","name":"10.3.2.1","archived":false,"released":true,"releaseDate":"2007-12-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313142","id":"12313142","description":"","name":"10.3.3.0","archived":false,"released":true,"releaseDate":"2008-05-12"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313345","id":"12313345","description":"","name":"10.4.2.0","archived":false,"released":true,"releaseDate":"2008-09-05"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313771","id":"12313771","description":"build: 764942, 14/Apr/09. Voted release: 28/Apr/09. Announced: 1/May/09","name":"10.5.1.1","archived":false,"released":true,"releaseDate":"2009-04-28"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313727","id":"12313727","description":"Feature release","name":"10.6.1.0","archived":false,"released":true,"releaseDate":"2010-05-18"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12332795","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12332795","type":{"id":"12310040","name":"Required","inward":"is required by","outward":"requires","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310040"},"inwardIssue":{"id":"12468384","key":"DERBY-4728","self":"https://issues.apache.org/jira/rest/api/2/issue/12468384","fields":{"summary":"10.5 backport effort tracking issue ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-06-17T09:19:29.082+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"While working with Eranda on DERBY-4187, I stumbled across an apparent ALTER TABLE bug.\r\n\r\nHere's a script which reproduces the problem for me:\r\n\r\nautocommit off;\r\ncreate table t0(c1 int not null constraint p1 primary key);\r\nalter table t0 add column c1 int;\r\nalter table t0 add column c2 int not null default 0 primary key;\r\nalter table t0 add column c2 int not null default 0;\r\n\r\nThe \"autocommit off\" is crucial; otherwise the problem does not reproduce.\r\n\r\nHere's the detailed assertion failure:\r\n\r\n2009-05-23 15:01:17.436 GMT Thread[main,5,main] (XID = 146), (SESSIONID = 1), (DATABASE = brydb), (DRDAID = null), Failed Statement is: alter table t0 add column c2 int not null default 0\r\norg.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED column_id = 1format_ids.length = 2format_ids = [I@1321f5\r\n        at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162)\r\n        at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147)\r\n        at org.apache.derby.impl.store.access.heap.Heap.addColumn(Heap.java:418)\r\n        at org.apache.derby.impl.store.access.RAMTransaction.addColumnToConglomerate(RAMTransaction.java:618)\r\n        at org.apache.derby.impl.sql.execute.AlterTableConstantAction.addNewColumnToTable(AlterTableConstantAction.java:1325)\r\n        at org.apache.derby.impl.sql.execute.AlterTableConstantAction.executeConstantAction(AlterTableConstantAction.java:449)\r\n\r\nHere's the relevant section of Heap.java:\r\n\r\n            if (column_id != format_ids.length)\r\n            {\r\n                if (SanityManager.DEBUG)\r\n                    SanityManager.THROWASSERT(\r\n                        \"column_id = \" + column_id +\r\n                        \"format_ids.length = \" + format_ids.length +\r\n                        \"format_ids = \" + format_ids);\r\n\r\n                throw(StandardException.newException(\r\n                        SQLState.HEAP_TEMPLATE_MISMATCH,\r\n                        new Long(column_id),\r\n                        new Long(this.format_ids.length)));\r\n            }\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38030","summary":"ALTER TABLE Sanity ASSERT in add column with autocommit off","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10424","value":"Repro attached","id":"10424"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":19,"total":19,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12712434","id":"12712434","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Does the THROWASSERT add any value in this code? It seems like all useful information is included in the message of the StandardException that will be thrown otherwise (I don't regard the identity hash code of the int array useful, and that's the only missing piece, as far as I can see). Not that removing the THROWASSERT will fix the bug...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2009-05-23T15:41:43.477+0000","updated":"2009-05-23T15:41:43.477+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12725280","id":"12725280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"body":"Hi,\r\nI remove,\r\n SanityManager.THROWASSERT(\r\n                        \"column_id = \" + column_id +\r\n                        \"format_ids.length = \" + format_ids.length +\r\n                        \"format_ids = \" + format_ids);\r\n\r\nand I get the new error as,\r\nCaused by: ERROR XSCH5: In a base table there was a mismatch between\r\nthe requested column number 1 and the maximum numbe\r\nr of columns 2.\r\n        at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:303)\r\n        at org.apache.derby.impl.store.access.heap.Heap.addColumn(Heap.java:423)\r\n        at org.apache.derby.impl.store.access.RAMTransaction.addColumnToConglomerate(RAMTransaction.java:618)\r\n        at org.apache.derby.impl.sql.execute.AlterTableConstantAction.addNewColumnToTable(AlterTableConstantAction.java:\r\n1325)\r\n        at org.apache.derby.impl.sql.execute.AlterTableConstantAction.executeConstantAction(AlterTableConstantAction.java:449)\r\n        at org.apache.derby.impl.sql.execute.MiscResultSet.open(MiscResultSet.java:64)\r\n\r\nThanks\r\nEranda\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"created":"2009-06-29T17:55:47.965+0000","updated":"2009-06-29T17:55:47.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12726720","id":"12726720","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Hi Eranda,\r\n\r\nIn the script which reproduces the problem, I believe it is the *third* ALTER TABLE\r\nstatement which crashes, is that correct?\r\n\r\nWhat happens if you remove the first or the second ALTER TABLE statements in\r\nthe script? Does it still fail the same way?\r\n\r\nAlso, what happens if you start with the original script, but in the *third* ALTER TABLE\r\nstatement you change \"c2\" to \"c3\"? Does it still fail the same way?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-07-02T22:49:07.108+0000","updated":"2009-07-02T22:49:07.108+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12726993","id":"12726993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Hi Eranda,\r\n\r\nIf you run the reproduction script with derby.language.statementCacheSize=0,\r\ndoes the problem still occur? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-07-03T14:49:06.172+0000","updated":"2009-07-03T14:49:06.172+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12727071","id":"12727071","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Triaged for 10.5.2, setting \"repro attached\" and \"normal\" urgency.\r\nSaw this back to 10.2, setting affected flags accordingly.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2009-07-03T18:05:26.542+0000","updated":"2009-07-03T18:05:26.542+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12727114","id":"12727114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"body":"Hi Bryan,Thanks for helping me to figure this out.\r\nThis error is causing by the previous command\r\nwithout this command the test runs successfully.\r\nWhen I change the command to,\r\nthe test was successful.\r\nI think there must be remaining part of the previous statement in some\r\nwhere. But,\r\naccording to the test setting derby.language.statementCacheSize=0 did\r\n\"not\" change\r\nthe behavior of the bug.\r\nAnd it means that the remaining part of the statement is not in the cache.\r\nWe can solve the bug if we can find where it get stored?\r\nAm I correct? Are there any misunderstanding of me?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"created":"2009-07-03T20:03:49.975+0000","updated":"2009-07-03T20:03:49.975+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12727148","id":"12727148","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"If I change the next-to-last SQL statement from\r\n\r\n  alter table t0 add column c2 int not null default 0 primary key;\r\n\r\nto\r\n\r\n  alter table t0 add column c2 int not null default 0;\r\n\r\nthen the problem does not occur. This suggests to me that the problem involves\r\nthe cleanup that is performed after this error is encountered\r\n\r\nERROR X0Y58: Attempt to add a primary key constraint to table '\"APP\".\"T0\"' failed because the table already has a constraint of that type.  A table can only have a single primary key constraint.\r\n\r\nI can see in derby.log that the stack trace at the time of this error looks like this:\r\n\r\n        at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:286)\r\n        at org.apache.derby.impl.sql.execute.AlterTableConstantAction.executeConstantAction(AlterTableConstantAction.java:541)\r\n        at org.apache.derby.impl.sql.execute.MiscResultSet.open(MiscResultSet.java:64)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:416)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:297)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1235)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:625)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:555)\r\n        at org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:329)\r\n        at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:521)\r\n        at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:363)\r\n        at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)\r\n        at org.apache.derby.impl.tools.ij.Main.go(Main.java:222)\r\n        at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:177)\r\n        at org.apache.derby.impl.tools.ij.Main.main(Main.java:73)\r\n        at org.apache.derby.tools.ij.main(ij.java:59)\r\n\r\nThis suggests to me that the next step is to study the error handling that is performed in this\r\npart of the code; specifically whether AlterTableConstantAction.executeConstantAction isn't\r\nproperly cleaning everything up when the error occurs.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-07-03T22:07:22.373+0000","updated":"2009-07-03T22:07:22.373+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12727366","id":"12727366","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"body":"Hi Bryan,\r\nI did some tests, and get the results as follows\r\n\r\nij> create table t0(c1 int not null constraint p1 primary key);\r\n\r\n0 rows inserted/updated/deleted\r\n\r\nij> alter table t0 add column c2 int not null default 0 primary key;\r\n\r\nERROR X0Y58: Attempt to add a primary key constraint to table '\"APP\".\"T0\"'\r\nfailed because the table already has a constr\r\n\r\naint of that type.  A table can only have a single primary key constraint.\r\n\r\nij> alter table t0 add column c3 int not null default 0;\r\n\r\nERROR XSCH5: In a base table there was a mismatch between the requested\r\ncolumn number 1 and the maximum number of column\r\n\r\ns 2.\r\n\r\nij> alter table t0 add column c6 int not null default 0;\r\n\r\nERROR XSCH5: In a base table there was a mismatch between the requested\r\ncolumn number 1 and the maximum number of column\r\n\r\ns 2.\r\n\r\nij> alter table t0 add column g6 int not null default 0;\r\n\r\nERROR XSCH5: In a base table there was a mismatch between the requested\r\ncolumn number 1 and the maximum number of column\r\n\r\n\r\nThe test says that by \"alter table t0 add column c2 int not null default 0\r\nprimary key;\" fails it self and also fails other statement of add columns.\r\n\r\nThanks\r\n\r\nEranda\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"created":"2009-07-05T21:44:17.308+0000","updated":"2009-07-05T21:44:17.308+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12727758","id":"12727758","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"I spent some time stepping through the code and thinking about it.\r\n\r\nThe X0Y58 message is generated at line 541 of AlterTableConstantAction.java:\r\n\r\n                            if (cdl.getPrimaryKey() != null)\r\n                            {\r\n                                throw StandardException.newException(\r\n                                    SQLState.LANG_ADD_PRIMARY_KEY_FAILED1,\r\n                                    td.getQualifiedName());\r\n                            }\r\n\r\nHowever, this error is generated *after* the new column has already been added\r\nto the table, which occurs at line 450 of AlterTableConstantAction.java:\r\n\r\n                if (columnInfo[ix].action == ColumnInfo.CREATE)\r\n                {\r\n                    addNewColumnToTable(activation, lcc, dd, tc, ix);\r\n                }\r\n\r\naddnewColumnToTable adds the new column to the table, then updates the\r\ndata in the new column to the default value, using a nested sub-statement. This\r\noccurs at line 3199 of AlterTableConstantAction.java:\r\n\r\n        String updateStmt = \"UPDATE \\\"\" + td.getSchemaName() + \"\\\".\\\"\" +\r\n                            td.getName() + \"\\\" SET \\\"\" +\r\n                             columnName + \"\\\" = \" + defaultText;\r\n\r\n\r\n        AlterTableConstantAction.executeUpdate(lcc, updateStmt);\r\n\r\n    private static void executeUpdate(LanguageConnectionContext lcc, String updateStmt) throws StandardException\r\n    {\r\n        PreparedStatement ps = lcc.prepareInternalStatement(updateStmt);\r\n\r\n        // This is a substatement; for now, we do not set any timeout\r\n        // for it. We might change this behaviour later, by linking\r\n        // timeout to its parent statement's timeout settings.\r\n        ResultSet rs = ps.executeSubStatement(lcc, true, 0L);\r\n        rs.close();\r\n    }\r\n\r\nSo the stack trace, when this is going on, looks something like:\r\n\r\nGenericPreparedStatements.executeStmt:443\r\nGenericPreparedStatement.executeSubStatement:272\r\nAlterTableConstantAction.executeUpdate:3209\r\nAlterTableConstantAction.updateNewColumnToDefault:3199\r\nAlterTableConstantAction.addNewColumnToTable:1374\r\nAlterTableConstantAction.executeConstantAction:450\r\nMiscResultSet.open:64\r\nGenericPreparedStatement.executeStmt:416\r\nGenericPreparedStatement.execute:297\r\nEmbedStatement.executeStatement:1235\r\n\r\nThis leads me to two ideas:\r\n\r\n1) Although the X0Y58 error causes the outer statement to be rolled back to\r\nits savepoint, there must be something that occurs in the nested inner\r\nsub-statement which isn't undone by rolling back the outer statement to\r\nits savepoint. Specifically, something involving the descriptor information\r\nin the DataDictionary. So we could try to investigate that more.\r\n\r\n2) It seems odd that we only catch this error at *execution* time, after\r\nwe have already added the new column to the table, and set all its\r\ndefault values, and only then do we notice that there's an error in the constraint.\r\nI think that the duplicate constraint error should be something that we are\r\nable to catch at *compile* time. So we could investigate the compile time\r\nprocessing of ALTER TABLE ADD COLUMN, and try to figure out why\r\nthis error isn't being caught during compilation.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-07-06T20:17:46.782+0000","updated":"2009-07-06T20:17:46.782+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12728352","id":"12728352","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Hi Eranda,\r\n\r\nAttached code change 'checkAtCompileTime.diff' is a possible fix to pursue. This change\r\nadds some code to the compilation processing for ALTER TABLE to verify that we aren't\r\nadding a duplicate primary key to the table.\r\n\r\nI haven't done much testing, just verified that it fixes the 4-line script in the bug description.\r\n\r\nCan you have a look at this change and see what you think? If it seems reasonable, maybe\r\nyou can do some more testing, and add some additional regression tests into the patch\r\nto turn it into a more complete patch proposal.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-07-07T20:27:12.787+0000","updated":"2009-07-07T20:27:12.787+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12730127","id":"12730127","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Hi Eranda,\r\n\r\nHere's a few comments to hopefully explain how the attached patch works:\r\n\r\nDuring parsing, the parser processes the ALTER TABLE statement and breaks\r\nit down into pieces, then builds up a AlterTableNode instance to describe the statement.\r\n\r\nFor an ALTER TABLE ADD ... statement, information about the column to be added, if any,\r\nand about the constraints that apply to that column, are stored in the table element list.\r\nThis occurs at about lines 12622-12630 of sqlgrammar.jj, in the code:\r\n\r\n    <ADD>\r\n    (\r\n        tableElement = addColumnDefinition(tableElementList)\r\n        |\r\n        tableElement = tableConstraintDefinition()\r\n    )\r\n    {\r\n        if (tableElement instanceof ColumnDefinitionNode)\r\n        {\r\n            //bug 5724 - auto increment columns not allowed in ALTER TABLE statement\r\n            ColumnDefinitionNode cdn = (ColumnDefinitionNode) tableElement;\r\n            if ( cdn.isAutoincrementColumn())\r\n                throw StandardException.newException(SQLState.LANG_ALTER_TABLE_AUTOINCREMENT_COLUMN_NOT_ALLOWED);\r\n        }\r\n        changeType[0] = DDLStatementNode.ADD_TYPE;\r\n        tableElementList.addTableElement(tableElement);\r\n\r\nLater in the compilation of the ALTER TABLE statement, we call the makeConstantAction\r\nmethod in AlterTableNode.java, which in turn calls the prepConstantAction subroutine,\r\nat line 510 or so in AlterTableNode.java, which is the place where my proposed patch\r\ninserts some code.\r\n\r\nThe first part of that new code looks like this:\r\n\r\n for (int conIndex = 0; conIndex < conActions.length; conIndex++)\r\n {\r\n     ConstraintConstantAction cca = conActions[conIndex];\r\n\r\n     if (cca instanceof CreateConstraintConstantAction)\r\n     {\r\n\r\nThis code looks through the constraint information that the parser placed into the tableElementList,\r\nas I described above. As it looks through the list, each constraint action in the list may be one\r\nof several types of constraints:\r\n - primary key constraint\r\n - foreign key constraint (REFERENCES ...)\r\n - check constraint (CHECK ...)\r\n\r\nFor the purposes of this particular patch, we are only interested in primary key constraints,\r\nso we look at each constraint action in the list to see if it is a primary key constraint:\r\n\r\n     int constraintType = cca.getConstraintType();\r\n     if (constraintType == DataDictionary.PRIMARYKEY_CONSTRAINT)\r\n     {\r\n\r\nIf we find such a constraint, then we know that this ALTER TABLE statement is adding a new\r\nPRIMARY KEY constraint, so we want to check to see if the table *already has* such a constraint,\r\nin which case we want to reject this statement because a table can only have 1 PK constraint:\r\n\r\nConstraintDescriptorList cdl =\r\n        dd.getConstraintDescriptors(baseTable);\r\n\r\nif (cdl.getPrimaryKey() != null)\r\n{\r\n    throw StandardException.newException(\r\n            SQLState.LANG_ADD_PRIMARY_KEY_FAILED1,\r\n            baseTable.getQualifiedName());\r\n}\r\n\r\nHopefully the proposed patch makes a little bit more sense now. Let me know what you think!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-07-12T18:27:13.881+0000","updated":"2009-07-12T18:27:13.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12730228","id":"12730228","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"body":"Hi Bryan,\r\nThanks for the explanation. I got the point why we must use that code.\r\nAfter patch using your patch file I ran the test and I got the error that\r\ntables was not there in the schema so I used the\r\nconn.commit() to the line-86 and the test was ran successfully in\r\nmy platform.  Here I am attaching the patch file after successful run.\r\nI think this ends the issue. Please let me know.\r\nI update derby-wiki about this issue, what I've done.\r\nThanks\r\nEranda\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=eranda","name":"eranda","emailAddress":"eranda dot sooriyabandara at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=eranda&avatarId=17101","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=eranda&avatarId=17101","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=eranda&avatarId=17101","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=eranda&avatarId=17101"},"displayName":"Eranda Sooriyabandara","active":true},"created":"2009-07-13T06:32:16.236+0000","updated":"2009-07-13T06:32:16.236+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12732954","id":"12732954","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks for the revised patch, Eranda!\r\n\r\nI ran a complete set of regression tests, and committed the fix, as revision 795459.\r\n\r\nI decided not to remove the THROWASSERT from Heap.java at this time. I agree with Knut's observation that the THROWASSERT was not adding much value, but it also seemed that removing it was not essential to the patch, so in the interests of making a small, focused patch, I simply included the changes to AlterTableNode and AlterTableTest.\r\n\r\nI believe that the work on this issue is complete.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-07-19T01:31:57.917+0000","updated":"2009-07-19T01:31:57.917+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12884462","id":"12884462","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Reopen to 10.5 back port","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-07-01T22:14:10.781+0000","updated":"2010-07-01T22:14:10.781+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12884815","id":"12884815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"working on backporting this to 10.5.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2010-07-02T21:28:52.410+0000","updated":"2010-07-02T21:28:52.410+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12884923","id":"12884923","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"backported fix #795459  from trunk to 10.5 branch.  In order to get the testcase for this issue also backported, needed to backport the AlterTableTest.java also.  \r\n\r\nm105_jdk16:58>svn commit\r\nSending        .\r\nSending        java/engine/org/apache/derby/impl/sql/compile/AlterTableNode.java\r\nSending        java/testing/README.htm\r\nDeleting       java/testing/org/apache/derbyTesting/functionTests/master/altertable.out\r\nSending        java/testing/org/apache/derbyTesting/functionTests/suites/derbylang.runall\r\nAdding         java/testing/org/apache/derbyTesting/functionTests/tests/lang/AlterTableTest.java\r\nSending        java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java\r\nDeleting       java/testing/org/apache/derbyTesting/functionTests/tests/lang/altertable.sql\r\nDeleting       java/testing/org/apache/derbyTesting/functionTests/tests/lang/altertable_derby.properties\r\nTransmitting file data ....\r\nCommitted revision 960222.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2010-07-03T14:27:39.490+0000","updated":"2010-07-03T14:27:39.490+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12884924","id":"12884924","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"resetting original issue owner.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2010-07-03T14:29:10.141+0000","updated":"2010-07-03T14:29:10.141+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/12885215","id":"12885215","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Changed 10.5 fix version to match the version on the branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-07-05T12:53:51.245+0000","updated":"2010-07-05T12:53:51.245+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426193/comment/13685255","id":"13685255","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"[bulk update] Close all resolved issues that haven't been updated for more than one year.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-06-17T09:19:29.075+0000","updated":"2013-06-17T09:19:29.075+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4244/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06vgf:"}}