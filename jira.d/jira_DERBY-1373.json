{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12343880","self":"https://issues.apache.org/jira/rest/api/latest/issue/12343880","key":"DERBY-1373","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311972","id":"12311972","description":"","name":"10.1.3.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313478","id":"12313478","description":"Head of 10.1 branch. Maintenance version bump for sps update ","name":"10.1.3.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-06-22 04:40:04.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22466","customfield_12310222":"1_*:*_1_*:*_4724900000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_43499718948","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-07-27T21:49:38.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1373/watchers","watchCount":0,"isWatching":false},"created":"2006-06-03T05:21:18.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"7.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-07-05T17:32:34.564+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11412","id":"11412","name":"Store"}],"timeoriginalestimate":null,"description":"An encrypted database cannot be booted when using the jar subprotocol.\n\nThe problem lies in the method run from JCECipherFactory. The call to getRandomAccessFile returns null when the verifyKeyFile is an instance of InputStreamFile and the key verification therefore fails.\n\nThe implementation of getRandomAccessFile for InputStreamFile states that its code cannot be reached which is untrue.\n\nThe provided patch does two things, it provides a new class InputStreamRandomAccessFile in package org.apache.derby.impl.io. This class provides simple implementations of readInt and readFully so the key verification process succeeds. A quick scan of the derby source tree showed no problem or possible impact of this simple implementation.\n\nThe second thing the patch does is to modify org/apache/derby/impl/io/InputStreamFile.java so the getRandomAccessFile creates an instance of InputStreamRandomAccessFile instead of returning null.\n\nThis patch has been tested against trunk 410361. It solves the problem at least under the jar subprotocol.\n\nThe patch has not been tested against http/https/classpath.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"37987","summary":"Encrypted databases cannot be booted using the jar subprotocol (and possibly also using http/https/classpath)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Environment does not matter.","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":18,"total":18,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12414531","id":"12414531","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"body":"Patch mentioned in the problem description.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"created":"2006-06-03T05:23:46.000+0000","updated":"2006-06-03T05:23:46.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12417195","id":"12417195","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Thanks Mathias for finding this issue and posting a patch. It would be nice if you could add some tests so we dont regress this issue in the future.  Also I was wondering, if you considered Suresh's comment  on an alternate way of how this could be fixed. \r\n\r\nSuresh's comment is in the mail with subject 'Problem using encrypted databases with jar subprotocol'\r\n\"I think the verifyKey file can be read by wrapping the file InputStream with a DataInputStream instead of reading it as RandomAccessFile in the JCECipherFactory itself. If that works then there is no need to add  InputStreamRandomAccessFile.java class. \" \r\n\r\nThe copyright notice is missing from the InputStreamRandomAccessFile.  Can you please svn add this file and generate a new patch.  We have a useful checklist on the wiki.http://wiki.apache.org/db-derby/DerbyContributorChecklist\r\n\r\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-06-22T04:40:04.000+0000","updated":"2006-06-22T04:40:04.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12417652","id":"12417652","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Mathias, if you can address the issues with the patch mentioned by Sunitha by midday Monday, we can get this into 10.1.3.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-06-25T06:51:59.000+0000","updated":"2006-06-25T06:51:59.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12417674","id":"12417674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"body":"I had a look to the suggestion Suresh made. Implementing his idea would require changes to JCECipherFactory to return a RandomAccessFile when the verifyKey file has to be written (created) and a DataInput when it has to be read. This is a change I do not have time to implement as it would mean revalidate all other cases which are currently working.\r\n\r\nTherefore I'll stick with my initial fix consisting in adding an InputStreamRandomAccessFile class.\r\n\r\nAs for a test I do not see an easy way of implementing it as it requires to create a DB with encryption, package it into a jar and boot it from the jar. I do not know how to do that simply using JUnit. What I could think of would imply running Ant from the test to create a jar file and then access it. I do not know if this is the cleanest way to do it.\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"created":"2006-06-25T19:32:52.000+0000","updated":"2006-06-25T19:32:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12417675","id":"12417675","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"body":"Patch meant to be applied to the 10.1 branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=herberts","name":"herberts","emailAddress":"Mathias dot Herberts+apache-jira at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mathias Herberts","active":true},"created":"2006-06-25T19:34:39.000+0000","updated":"2006-06-25T19:34:39.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12417867","id":"12417867","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"In my opinion, it seems like it would be good to pursue suresh's suggestion since then we wont need to add a extra class.  Regarding your concern about tests - there are some existing tests that would test the current codepaths for encryptionKey which is in store/encryptionKey.sql.   \r\n\r\nI think it would be great to have this issue resolved and I'd be willing to work with you to add tests in case you want to pursue this.  You can add jar files to the tests.  For an example of a test where this is used - see  java/testing/org/apache/derbyTesting/functionTests/tests/tools/dblook_test.java and the corresponding files associated with it - dblook_test_app.properties that makes use of the supportfiles attribute. \r\n\r\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-06-27T01:20:03.000+0000","updated":"2006-06-27T01:20:03.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12417875","id":"12417875","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"I'm going to pass on this for 10.1.3 as I've run out of time to verify the fix before finalizing the 10.1.3 release candidate, and no tests for the fix were contributed. Also, the user affected by the problem has indicated they are comfortable continuing to patch their local copy to workaround the problem.\r\n\r\nWe should work on a complete fix for this for the 10.2 release, as it looks like that may be the next release after 10.1.3.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-06-27T01:41:30.000+0000","updated":"2006-06-27T01:41:30.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12421191","id":"12421191","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Mathias wrote:\r\n\"I had a look to the suggestion Suresh made.This is a change I do not have time to implement as it would mean revalidate all other cases which are currently working. \"\r\n\r\nSo I followed up on Suresh's suggestion and am attaching a patch 'derby1373.diff.txt' and 'derby1373.stat.txt' for review.\r\n\r\nThis patch makes the following changes:\r\n1) Instead of using RandomAccessFile, the verifyKey.dat is read as a InputStream. \r\n\r\n2)   Add a new test (encryptionKey_jar.sql) for booting encrypted database using encryptionKey via classpath, and jar subprotocol. \r\nPlease note, as already mentioned in an earlier comment - There are existing test (encryptionKey.sql) that test cases for encryptionKey.\r\n\r\nThe test will fail without the code change, and will pass with  the code changes.\r\n\r\nsvn stat\r\nM      java\\engine\\org\\apache\\derby\\impl\\services\\jce\\JCECipherFactory.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\copyfiles.ant\r\nA      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\encryptionKey_jar.sql\r\nA      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\encryptionKey_jar_app.properties\r\nA      java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\encryptionKey_jar.out\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\suites\\encryptionAll.runall\r\n\r\nI ran derbyall on ibm142 on linux ok. I made one small change to a comment in the test after that. I have run the test again and it passed ok.\r\n\r\nCan someone please review this patch.  \r\n\r\nThanks to Mathias for finding the problem, reporting it, providing a fix and for the good discussion that followed on this issue.  If you have the time, it would be nice if you can verify if this works for you.\r\n\r\nThanks,\r\nSunitha.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-07-14T18:51:02.000+0000","updated":"2006-07-14T18:51:02.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12422009","id":"12422009","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"body":"I am planning to  review/commit  derby1373.diff.txt patch,  if  any one else is reviewing  this patch, please let me  know. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"created":"2006-07-19T00:46:11.000+0000","updated":"2006-07-19T00:46:11.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12422263","id":"12422263","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"body":"I reviewed the patch , it looks good.  Thanks for adding  the test to test  the encryption with jar and classpath protocols.   While reviewing the test I  noticed  it  is not running under  security manager. \r\n\r\n+# Test fails with security manager because it uses some functions in \r\n+# org/apache/derbyTesting/functionTests/tests/lang/dbjarUtil.java for\r\n+# creating archive and these methods do not use a privileged block\r\n+# to read the properties etc.  \r\n+noSecurityManager=true\r\n\r\nIt would be good if  this test can run under the security manager.   I also thing some methods in the dbjarUtil.java would require privilegded blocks because the methods in them are called indirectly through the java procedures using the derby  engine.    I think recently  some one  addded  framework  that allows to specify test specific permissions., incase if this test  needs any special permissions.  if  you don't have time to address  this issue now, could you please file a JIRA entry.\r\n\r\nI am running  derbyall ,  so far i have not seen any failures .  I  will commit the patch,  if  all the tests pass. \r\n  \r\nThanks\r\n-suresh\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"created":"2006-07-19T21:53:00.000+0000","updated":"2006-07-19T21:53:00.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12422304","id":"12422304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"body":"Committed derby1373.diff.txt  patch  to trunk with revision 423682.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"created":"2006-07-20T00:38:01.000+0000","updated":"2006-07-20T00:38:01.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12422451","id":"12422451","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Thanks Suresh for reviewing and committing this patch.  I opened DERBY-1552 to add priv blocks to dbjarUtil.java.  \r\n\r\nI would like this fix to go into 10.1.  I'll post the merge command for this after running tests. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-07-20T17:04:29.000+0000","updated":"2006-07-20T17:04:29.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12422710","id":"12422710","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"I  would like this fix to go into 10.1 branch. \r\n\r\nThe below merge command to put this fix to 10.1 does not apply cleanly because of conflict in encryptionAll.runall\r\nsvn merge -r 423681:423682 https://svn.apache.org/repos/asf/db/derby/code/trunk/\r\n\r\nSo, I am attaching a patch 10.1_derby1373.diff.txt for 10.1 codeline. Please note, it is the same changes as derby1373.diff.txt.\r\n\r\nsvn stat:\r\nM      java\\engine\\org\\apache\\derby\\impl\\services\\jce\\JCECipherFactory.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\copyfiles.ant\r\nA  +   java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\encryptionKey_jar.sql\r\nA  +   java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\encryptionKey_jar_app.properties\r\nA  +   java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\encryptionKey_jar.out\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\suites\\encryptionAll.runall\r\n\r\n\r\nRan derbyall on ibm142/linux ok.\r\n\r\nCan someone please commit this change.\r\n\r\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-07-21T16:52:49.000+0000","updated":"2006-07-21T16:52:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12422728","id":"12422728","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"In the earlier patch 10.1_derby1373.diff.txt' the new files didnt get added to the patch because,merge adds the files to the codeline but does not do a svn add.  In this case, svn stat shows A+ which is just the property file changes.  It does not add the file.  \r\n\r\nI am attaching a new patch '10.1_explicitsvnadd_derby1373.diff.txt'  that has all the newly added files in it.  \r\n\r\nsvn stat \r\nM      java\\engine\\org\\apache\\derby\\impl\\services\\jce\\JCECipherFactory.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\copyfiles.ant\r\nA      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\encryptionKey_jar.sql\r\nA      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\encryptionKey_jar_app.properties\r\nA      java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\encryptionKey_jar.out\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\suites\\encryptionAll.runall\r\n\r\nCan someone look at this patch. \r\n\r\nThanks to Deepa for pointing the issue with 'A+' in the svn stat. .\r\n\r\nThanks,\r\nSunitha.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-07-21T17:49:47.000+0000","updated":"2006-07-21T17:49:47.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12423140","id":"12423140","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"Committed  the 10.1_explicitsvnadd_derby1373.diff.txt patch to the 10.1 branch:\r\nm101_142:149>svn commit\r\n\r\nSending        java\\engine\\org\\apache\\derby\\impl\\services\\jce\\JCECipherFactory.java\r\nAdding         java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\encryptionKey_jar.out\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\suites\\encryptionAll.runall\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\copyfiles.ant\r\nAdding         java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\encryptionKey_jar.sql\r\nAdding         java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\encryptionKey_jar_app.properties\r\nTransmitting file data ......\r\nCommitted revision 425172.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2006-07-24T20:05:01.000+0000","updated":"2006-07-24T20:05:01.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12423147","id":"12423147","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Adding fix version 10.1.3.2","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-07-24T20:13:19.000+0000","updated":"2006-07-24T20:13:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12423940","id":"12423940","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"This issue has been fixed on trunk as well as 10.1. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-07-27T21:49:38.000+0000","updated":"2006-07-27T21:49:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343880/comment/12551346","id":"12551346","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"This issue has been resolved for over a year with no further movement. Closing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2007-12-13T09:04:56.943+0000","updated":"2007-12-13T09:04:56.943+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1373/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06v6v:"}}