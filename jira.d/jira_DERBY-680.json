{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12325305","self":"https://issues.apache.org/jira/rest/api/latest/issue/12325305","key":"DERBY-680","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-12-28 03:18:41.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22091","customfield_12310222":"1_*:*_1_*:*_38507780359_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_31599012277","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-01-23T19:39:48.359+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-680/watchers","watchCount":0,"isWatching":false},"created":"2005-11-04T03:03:28.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-01-24T13:10:00.566+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11414","id":"11414","name":"Tools"}],"timeoriginalestimate":null,"description":"NPE is thrown in ij when executing prepared statement which \n- has numeric/decimal parameters\n- does not return any result set\n\nRepro for this problem is the test lang/cast.sql. This test currently fails in CDC/FP.\n\nThe following lines in the test throw NPE:\nexecute q10 using 'values 123456.78';\nexecute q11 using 'values 123456.78';\n\nwhere q10 is \"prepare q10 as 'insert into t1 (num) values cast(? as numeric(18))';\"\nand q11 is \"prepare q11 as 'insert into t1 (dc) values cast(? as decimal(18))';\"\n\nThe stack trace for failure is:\njava.lang.NullPointerException\n        at org.apache.derby.impl.tools.ij.util.DisplayMulti(util.java:666)\n        at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:398)\n        at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:290)\n        at org.apache.derby.impl.tools.ij.Main.go(Main.java:203)\n        at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169)\n        at org.apache.derby.impl.tools.ij.Main.main(Main.java:75)\n        at org.apache.derby.tools.ij.main(ij.java:56)\n\n\nThis happens in the following code. Since the above prepared statements do not return result sets, call to getMetaData() will return null. But in the code, no check is done to see if getMetaData() returns null before calling getColumnType.\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\t\t\t\t\t// In J2ME there is no object that represents\n\t\t\t\t\t\t// a DECIMAL value. By default use String to\n\t\t\t\t\t\t// pass values around, but for integral types\n\t\t\t\t\t\t// first convert to a integral type from the DECIMAL\n\t\t\t\t\t\t// because strings like 3.4 are not convertible to\n\t\t\t\t\t\t// an integral type.\n\t\t\t\t\t\tswitch (ps.getMetaData().getColumnType(c))\n\t\t\t\t\t\t{\n\t\t\t\t\t\tcase Types.BIGINT:\n\t\t\t\t\t\t\tps.setLong(c, rs.getLong(c));\n\t\t\t\t\t\t    break;\n\t\t\t\t\t\tcase Types.INTEGER:\n\t\t\t\t\t\tcase Types.SMALLINT:\n\t\t\t\t\t\tcase Types.TINYINT:\n\t\t\t\t\t\t\tps.setInt(c, rs.getInt(c));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tps.setString(c,rs.getString(c));\n\t\t\t\t\t\t    break;\n\t\t\t\t\t\t}\t\t\t\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n\n\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39604","summary":"In ij, executing a prepared statement with numeric/decimal parameter fails with NullPointerException in J2ME/CDC/FP","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"j9_foundation VM in IBM WCTME 5.7","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":14,"total":14,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12357621","id":"12357621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"By changing the above code to check for the value returned by ps.getMetaData() , the prepared statements q10 and q11 listed in the description above work. The test lang/cast.sql also passes with JSR169.\r\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\t\t\t\t\t\t// In J2ME there is no object that represents\r\n\t\t\t\t\t\t// a DECIMAL value. By default use String to\r\n\t\t\t\t\t\t// pass values around, but for integral types\r\n\t\t\t\t\t\t// first convert to a integral type from the DECIMAL\r\n\t\t\t\t\t\t// because strings like 3.4 are not convertible to\r\n\t\t\t\t\t\t// an integral type.\r\n\t\t\t\t\t\tResultSetMetaData  psmd = ps.getMetaData();\r\n\t\t\t\t\t\tif(psmd != null) {\r\n\t\t\t\t\t\t\tswitch (psmd.getColumnType(c))\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcase Types.BIGINT:\r\n\t\t\t\t\t\t\t\tps.setLong(c, rs.getLong(c));\r\n\t\t\t\t\t\t\t    break;\r\n\t\t\t\t\t\t\tcase Types.INTEGER:\r\n\t\t\t\t\t\t\tcase Types.SMALLINT:\r\n\t\t\t\t\t\t\tcase Types.TINYINT:\r\n\t\t\t\t\t\t\t\tps.setInt(c, rs.getInt(c));\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tps.setString(c,rs.getString(c));\r\n\t\t\t\t\t\t\t    break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tps.setString(c,rs.getString(c));\r\n\t\t\t\t\t\t}\r\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nBut the following case does not work because there is no way to get parameter metadata in JSR169 since ParameterMetaData is not available. So, there is no equivalent to \"switch (ps.getMetaData().getColumnType(c))\" to determine the the column/parameter type and call the corresponding setXXX method.\r\n\r\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\nij> create table int_tab (i int);\r\nij> prepare i1  as 'insert into int_tab values (?)';\r\nij> execute i1 using 'values 3.4';\r\nIJ WARNING: Autocommit may close using result set\r\nERROR 22018: Invalid character string format for type INTEGER.\r\nERROR 22018: Invalid character string format for type INTEGER.\r\n        at org.apache.derby.iapi.error.StandardException.newException(StandardEx\r\nception.java:311)\r\n        at org.apache.derby.iapi.types.DataType.invalidFormat(DataType.java:1049\r\n)\r\n        at org.apache.derby.iapi.types.SQLInteger.setValue(SQLInteger.java:340)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.setString(EmbedPrep\r\naredStatement.java:452)\r\n        at org.apache.derby.impl.tools.ij.util.DisplayMulti(util.java:684)\r\n        at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:3\r\n98)\r\n        at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:290)\r\n        at org.apache.derby.impl.tools.ij.Main.go(Main.java:203)\r\n        at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:169)\r\n        at org.apache.derby.impl.tools.ij.Main.main(Main.java:75)\r\n        at org.apache.derby.tools.ij.main(ij.java:56)\r\n-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nI would like to know if anyone has suggestions to handle this. Thanks.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2005-11-15T05:11:23.000+0000","updated":"2005-11-15T05:11:23.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12360462","id":"12360462","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Attaching a patch 'derby-680.diff'. This patch removes the check \"ps.getMetaData().getColumnType(c)\" from org.apache.derby.impl.tools.ij.util.java. This was checking ResultSetMetaData, whereas the actual check should be for ParameterMetaData. But ParameterMetaData is not available in JSR169. So currently, get/set String has to be used for all types. With this change, lang/cast.sql does not give NPE. I have added a new master for ejbql.sql. This test was passing because coincidentally ResultSetMetaData and ParameterMetaData were of same type in the statements used. \r\n\r\nWith this patch, I ran derbyall with Sun JDK1.4.2 and j9_foundation vm in IBM WCTME5.7. No new failures. Please review/commit this patch.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2005-12-15T07:30:42.000+0000","updated":"2005-12-15T07:30:42.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12361280","id":"12361280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I'm looking at reviewing & committing this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2005-12-28T03:18:41.000+0000","updated":"2005-12-28T03:18:41.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12361874","id":"12361874","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I think the code is correct but I wonder if the ejbql test should be modified so that a CDC/Foundation specific master file is not required?\r\nWould the purpose of the test be changed by adding a cast to the expression that causes the failure in J2ME?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-01-06T03:12:04.000+0000","updated":"2006-01-06T03:12:04.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12361879","id":"12361879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Thanks Dan for looking at this patch. lang/ejbql.sql tests abs and absval functions. I think using cast may not be okay.  These are the execute statements which fail in J2ME (leaving out statements which pass):\r\n\r\ncreate table myint( a int );\r\ninsert into myint values (null);\r\nautocommit off;\r\n\r\n-- Prepare Statements, should pass and return 1\r\nprepare p1 as 'select abs(?) from myint';\r\nprepare p1 as 'select 1 from myint where ? <= 4';\r\nexecute p1 using 'values absval( 4.4 )';\r\nexecute p1 using 'values absval( -4.4 )';\r\n\r\n-- Prepare Statements, should pass and return 1\r\nprepare p2 as 'select {fn abs(?)} from myint';\r\nprepare p2 as 'select 1 from myint where ? <= 4';\r\nexecute p2 using 'values {fn abs( 4.4 )}';\r\nexecute p2 using 'values {fn abs( -4.4 )}';\r\nexecute p2 using 'values {fn abs( -4.44444444444444444444444 )}';\r\n\r\nPlease look at these statements and let me know if you think it is okay to change them . ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-01-06T04:52:58.000+0000","updated":"2006-01-06T04:52:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12362228","id":"12362228","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I think it's ok to change these SQL statements to not use prepared statements and ij's using clause.\r\nThe return value of the fn abs is what is being tested here, not the fact that if you pass 4.4 into a prepared statement  and compare it to 4 you get false.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-01-10T02:55:42.000+0000","updated":"2006-01-10T02:55:42.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12362244","id":"12362244","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Attaching 'derby-680_v2.diff'. This patch changes the test lang/ejbql.sql as suggested by Dan. Avoids a new master for j9_foundation.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-01-10T05:01:38.000+0000","updated":"2006-01-10T05:01:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12362247","id":"12362247","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"lang/cast.sql is failing in J2ME because of some recent additions to the test which require BigDecimal class. Resubmitting the patch without enabling lang/cast.sql.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-01-10T05:17:26.000+0000","updated":"2006-01-10T05:17:26.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12363504","id":"12363504","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Since the prepared statements have been taken out of lang/ejbql.sql, I wonder if we are still testing the case that was giving the NPE ( ij, executing a prepared statement with numeric/decimal parameters).    Is that covered in another test?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-01-21T14:28:20.000+0000","updated":"2006-01-21T14:28:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12363686","id":"12363686","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"lang/ejbql.sql tests 'abs' and 'absval' functions. So removing the prepared statements from lang/ejbql.sql does not remove any testing. Dan mentioned this in an earlier comment. \r\n\r\nThe test that was giving NPE was lang/cast.sql. With the patch, I have run the test in J2ME and verified that the NPE does not occur. However, this test is still disabled in J2ME because some recent additions to the test require BigDecimal class. Because of these additional tests, it fails towards the end but the failure is not related to this issue. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-01-24T01:16:10.000+0000","updated":"2006-01-24T01:16:10.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12364002","id":"12364002","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I think we should have a regression test that verifies the fix submitted with the fix, , either by enabling cast.sql with J2ME  or adding the case to another test that already runs with J2ME\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-01-26T06:15:52.000+0000","updated":"2006-01-26T06:15:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12364854","id":"12364854","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Submitted changes to ejbql test from patch derby-680_v2.diff , as they are separate from the code change to ij.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-02-02T04:01:14.000+0000","updated":"2006-02-02T04:01:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12466811","id":"12466811","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I believe this was fixed by the changes to ij.util for DERBY-2228. The NPE resulted due to fetching the ResultSetMetaData for an INSERT statement which was of course null. The fixed code no longer uses the ResultSetMetaData which was incorrect anyway.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-01-23T19:39:48.337+0000","updated":"2007-01-23T19:39:48.337+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325305/comment/12562047","id":"12562047","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dyret","name":"dyret","emailAddress":"Dyre dot Tjeldvoll at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dyre Tjeldvoll","active":true},"body":"This issue is resolved and has not been updated in the last 12 months (since 24/Jan/07). ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dyret","name":"dyret","emailAddress":"Dyre dot Tjeldvoll at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dyre Tjeldvoll","active":true},"created":"2008-01-24T13:10:00.558+0000","updated":"2008-01-24T13:10:00.558+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-680/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07567:"}}