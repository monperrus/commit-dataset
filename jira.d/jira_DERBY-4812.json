{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12474876","self":"https://issues.apache.org/jira/rest/api/latest/issue/12474876","key":"DERBY-4812","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315436","id":"12315436","description":"Head of 10.5 branch - version bump for DERBY-4835","name":"10.5.3.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315434","id":"12315434","description":"Head of 10.6 branch as of 2014-01-13","name":"10.6.2.4","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315564","id":"12315564","description":"First release on the 10.7 branch.","name":"10.7.1.1","archived":false,"released":true,"releaseDate":"2010-12-14"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-09-23 16:56:11.98","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24475","customfield_12310222":"1_*:*_1_*:*_2923164301_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-10-26T18:00:32.717+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4812/watchers","watchCount":0,"isWatching":false},"created":"2010-09-22T22:01:08.416+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314182","id":"12314182","description":"Old head of 10.5 branch","name":"10.5.3.1","archived":false,"released":false}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12338497","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12338497","type":{"id":"12310050","name":"Regression","inward":"is broken by","outward":"breaks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310050"},"outwardIssue":{"id":"12480623","key":"DERBY-4910","self":"https://issues.apache.org/jira/rest/api/2/issue/12480623","fields":{"summary":"Four replication tests fail on z/OS with junit.framework.AssertionFailedError: startMaster did not succeed.     ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-04-08T08:22:08.302+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312050","id":"12312050","name":"Replication"}],"timeoriginalestimate":null,"description":"One of our nightly tests failed with the exception (db path slightly edited) below.\r\nLooking at the source of org.apache.derby.impl.store.replication.net.ReplicationMessageTransmit.run, it seems that the code does not completely unwrap the PrivilegedActionException (compared to how this is done in for example org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.getFileInputStream()).\r\nIt could be that the test is looking for the java.io.IOException, which it doesn't get (it gets the PrivilegedActionException instead).\r\n\r\n----------------------\r\n1) testReplication_Local_StateTest_part1_1(org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_StateTest_part1_1)junit.framework.AssertionFailedError: Got -1 XRE42 DERBY SQL error: SQLCODE: -1, SQLSTATE: XRE42, SQLERRMC: Replicated database '/test/results/db_slave/wombat' shutdown.. Expected XRE41\r\n        at java.lang.Throwable.<init>(Throwable.java:67)\r\n        at junit.framework.AssertionFailedError.<init>(AssertionFailedError.java:11)\r\n        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.assertException(ReplicationRun.java:3427)\r\n        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_StateTest_part1_1._testPostStartedMasterAndSlave_StopSlave(ReplicationRun_Local_StateTest_part1_1.java:150)\r\n        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_StateTest_part1_1.testReplication_Local_StateTest_part1_1(ReplicationRun_Local_StateTest_part1_1.java:134)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)\r\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\r\n        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:109)\r\n        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.runBare(ReplicationRun.java:201)\r\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:16)\r\n----------------------\r\n\r\nThe exception in the db_master-derby.log was:\r\n\r\n------------------------\r\nDatabase Class Loader started - derby.database.classpath=''\r\n----  BEGIN REPLICATION ERROR MESSAGE (9/13/10 9:40 AM) ----\r\nReplication slave got a fatal error for database '/test/results/db_master/wombat'. Replication will be stopped.\r\nERROR XRE04: Could not establish a connection to the peer of the replicated database '/test/results/db_master/wombat' on address 'localhost:8888'.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\r\n\tat org.apache.derby.impl.store.replication.master.MasterController.setupConnection(Unknown Source)\r\n\tat org.apache.derby.impl.store.replication.master.MasterController.startMaster(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.RawStore.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.RAMAccessManager.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.db.BasicDatabase.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleStartReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)\r\n\tat org.apache.derby.impl.drda.Database.makeConnection(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.getConnFromDatabaseName(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.verifyUserIdPassword(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseSECCHK(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseDRDAConnection(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)\r\nCaused by: java.security.PrivilegedActionException: java.net.ConnectException: Connection refused\r\n\tat java.security.AccessController.doPrivileged(AccessController.java:255)\r\n\tat org.apache.derby.impl.store.replication.net.ReplicationMessageTransmit.initConnection(Unknown Source)\r\n\t... 17 more\r\nCaused by: java.net.ConnectException: Connection refused\r\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\r\n\tat java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:352)\r\n\tat java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:214)\r\n\tat java.net.PlainSocketImpl.connect(PlainSocketImpl.java:201)\r\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:378)\r\n\tat java.net.Socket.connect(Socket.java:528)\r\n\tat org.apache.derby.impl.store.replication.net.ReplicationMessageTransmit$1.run(Unknown Source)\r\n\tat java.security.AccessController.doPrivileged(AccessController.java:251)\r\n\t... 18 more\r\n============= begin nested exception, level (1) ===========\r\njava.security.PrivilegedActionException: java.net.ConnectException: Connection refused\r\n\tat java.security.AccessController.doPrivileged(AccessController.java:255)\r\n\tat org.apache.derby.impl.store.replication.net.ReplicationMessageTransmit.initConnection(Unknown Source)\r\n\tat org.apache.derby.impl.store.replication.master.MasterController.setupConnection(Unknown Source)\r\n\tat org.apache.derby.impl.store.replication.master.MasterController.startMaster(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.RawStore.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.RAMAccessManager.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.db.BasicDatabase.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleStartReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)\r\n\tat org.apache.derby.impl.drda.Database.makeConnection(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.getConnFromDatabaseName(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.verifyUserIdPassword(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseSECCHK(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseDRDAConnection(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)\r\nCaused by: java.net.ConnectException: Connection refused\r\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\r\n\tat java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:352)\r\n\tat java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:214)\r\n\tat java.net.PlainSocketImpl.connect(PlainSocketImpl.java:201)\r\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:378)\r\n\tat java.net.Socket.connect(Socket.java:528)\r\n\tat org.apache.derby.impl.store.replication.net.ReplicationMessageTransmit$1.run(Unknown Source)\r\n\tat java.security.AccessController.doPrivileged(AccessController.java:251)\r\n\t... 18 more\r\n============= end nested exception, level (1) ===========\r\n============= begin nested exception, level (2) ===========\r\njava.net.ConnectException: Connection refused\r\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\r\n\tat java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:352)\r\n\tat java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:214)\r\n\tat java.net.PlainSocketImpl.connect(PlainSocketImpl.java:201)\r\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:378)\r\n\tat java.net.Socket.connect(Socket.java:528)\r\n\tat org.apache.derby.impl.store.replication.net.ReplicationMessageTransmit$1.run(Unknown Source)\r\n\tat java.security.AccessController.doPrivileged(AccessController.java:251)\r\n\tat org.apache.derby.impl.store.replication.net.ReplicationMessageTransmit.initConnection(Unknown Source)\r\n\tat org.apache.derby.impl.store.replication.master.MasterController.setupConnection(Unknown Source)\r\n\tat org.apache.derby.impl.store.replication.master.MasterController.startMaster(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.RawStore.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.RAMAccessManager.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.db.BasicDatabase.startReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleStartReplicationMaster(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)\r\n\tat org.apache.derby.impl.drda.Database.makeConnection(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.getConnFromDatabaseName(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.verifyUserIdPassword(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseSECCHK(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseDRDAConnection(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)\r\n============= end nested exception, level (2) ===========\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10369","value":"Regression Test Failure","id":"10369"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36603","summary":"ReplicationMessageTransmit run does not unwrap PrivilegedActionException which can lead to failure of replicationTests.ReplicationRun_Local_StateTest_part1_1","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10102","value":"Patch Available","id":"10102"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"AIX 64 bit, IBM 1.6 jvm","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":9,"total":9,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12914098","id":"12914098","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Here is a patch for this issue. The replication tests passed and I will run the full suite now. i see other instances PrivilegeActionException being thrown, especially in PlanExporter. I will file another issue for that.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-09-23T16:56:11.980+0000","updated":"2010-09-23T16:56:11.980+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12914135","id":"12914135","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Hi Kathey,\r\n\r\nPerhaps you could remove PrivilegedActionException from the method's throws clause too? I mean from the method signature, not only from the javadoc.\r\n\r\nAnd one nit: It looks like the patch mixes tabs and spaces, sometimes even on the same line. This class is a tab-free one, it would be good to keep it that way.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-09-23T18:08:02.806+0000","updated":"2010-09-23T18:08:02.806+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12914233","id":"12914233","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thanks Knut, here is the revised patch.  I will commit in a bit.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-09-23T21:26:13.173+0000","updated":"2010-09-23T21:26:13.173+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12914240","id":"12914240","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks Kathey. Looks like there's still a mix of tabs and spaces in ReplicationMessageReceive, though.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-09-23T21:42:22.464+0000","updated":"2010-09-23T21:42:22.464+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12914268","id":"12914268","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Sorry for the trouble. one more try. I went back to emacs to double check. Hopefully all those nasty tabs are really gone this time and my Eclipse is properly positioned for next time.  Apparently I lost my setup when I upgraded eclipse and had to use  the following tip from Lily.\r\nright click you mouse and choose preference\r\n\t<lilywei>\tIn the General->Editor->Text Editors->choose insert spaces for tabs and show whitespace characters\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-09-23T22:40:29.869+0000","updated":"2010-09-23T22:40:29.869+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12914276","id":"12914276","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Sorry... I get so distracted by tab/space issues that I forget to look at the code... :(\r\n\r\n+                public Object run() throws IOException, StandardException {\r\n+                    ServerSocketFactory sf = ServerSocketFactory.getDefault();\r\n+                    return sf.createServerSocket(slaveAddress.getPortNumber(),\r\n+                            0, slaveAddress.getHostAddress());\r\n+                }\r\n+            });\r\n+            return ss;\r\n+        } catch(PrivilegedActionException pea) {\r\n+            throw (IOException) pea.getException();\r\n+        }\r\n\r\nCan the run() method really throw a StandardException here? (Its throws clause says it can...) If so, the catch block needs to check the type of the exception and not cast it unconditionally to IOException.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-09-23T23:05:09.901+0000","updated":"2010-09-23T23:05:09.901+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12914289","id":"12914289","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I don't see that it could and it compiles fine without it, so I think  the right thing to do is to take out the throws clause, but now it is the end of my day. I will take a less hurried approach tomorrow.  Thank you for your careful attention in what must be the wee hours of the morning for you.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-09-24T00:23:53.084+0000","updated":"2010-09-24T00:23:53.084+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12915360","id":"12915360","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Just for testing purpose, I take out the StandardException and attach patch derby-4812-2_diff.txt. The test runs inside the debugger. However, the test hangs outside the debugger in my git environment. I sync up to 1001564 and reverts all the changes. The test still hangs. I am afraid it could be my environment. Does anyone have any suggestion for me to try to fix the hanging problem?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-09-27T17:04:26.926+0000","updated":"2010-09-27T17:04:26.926+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12474876/comment/12915845","id":"12915845","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I didn't realize Lily had posted a patch, but I think I will use this one., which I tested last night.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-09-28T17:26:36.701+0000","updated":"2010-09-28T17:26:36.701+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4812/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06mnb:"}}