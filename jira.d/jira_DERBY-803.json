{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12327439","self":"https://issues.apache.org/jira/rest/api/latest/issue/12327439","key":"DERBY-803","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-06-02 07:15:54.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22157","customfield_12310222":"1_*:*_1_*:*_21782139000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_20511724557","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-09-19T06:57:31.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-803/watchers","watchCount":0,"isWatching":false},"created":"2006-01-10T04:21:52.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311972","id":"12311972","description":"","name":"10.1.3.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12313358","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12313358","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12329278","key":"DERBY-1020","self":"https://issues.apache.org/jira/rest/api/2/issue/12329278","fields":{"summary":"Network Server treats errors on cleanup of connections as an unexpected error after intentional shutdown of the database/server","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12311625","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12311625","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"32498","key":"DERBY-273","self":"https://issues.apache.org/jira/rest/api/2/issue/32498","fields":{"summary":"The derbynet/dataSourcePermissions_net.java test fails intermittently","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12313180","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12313180","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12348473","key":"DERBY-1751","self":"https://issues.apache.org/jira/rest/api/2/issue/12348473","fields":{"summary":"derbynet/testSecMec.java fails with ShutdownException in DerbyNetClient framework","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-01T00:09:14.886+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11410","id":"11410","name":"Network Server"}],"timeoriginalestimate":null,"description":"DerbyNetAutoStart fails intermittently with the following diff:\n\nThis issue is likely related to DERBY-1020\n\n********* Diff file derbyall/derbynetmats/DerbyNet/derbynetmats/DerbyNetAutoStart.diff\n*** Start: DerbyNetAutoStart jdk1.4.2 DerbyNet derbynetmats:derbynetmats 2006-01-05 23:39:40 ***\n1a2,3\n> org.apache.derby.iapi.services.context.ShutdownException: \n> \tat org.apache.derby.impl.drda.Session.close(Unknown Source)agentThread[DRDAConnThread_3,5,derby.daemons]\nTest Failed.\n*** End:   DerbyNetAutoStart jdk1.4.2 DerbyNet derbynetmats:derbynetmats 2006-01-05 23:41:10 ***\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10369","value":"Regression Test Failure","id":"10369"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38578","summary":"derbynet/DerbyNetAutoStart.java test fails intermittently with org.apache.derby.iapi.services.context.ShutdownException","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":15,"total":15,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12362239","id":"12362239","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"In this test an intentional shutdown causes the close of the connection by network server to encounter an error that prints to the console.  It appears it may be  the same issue as  DERBY-273.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-01-10T04:24:22.000+0000","updated":"2006-01-10T04:24:22.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12414324","id":"12414324","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"I have not been able to repro this intermittent failure on my machine. I was using the stack traces attached to DERBY-273 to try to understand the scenario. I am thinking of following options to solve this problem:\r\n\r\n1. Solve the intermittent test failure by using the same solution as in DERBY-273. This will solve the test issue.\r\n2. Try to see if we can distinguish \"expected\" exceptions during shutdown and ignore them. However, I don't see a clear way of distinguishing this.\r\n3. I think the following thread explains the scenario:\r\nhttp://www.nabble.com/-jira--Commented%3A-%28DERBY-273%29-The-derbynet-dataSourcePermissions_net.java-test-fails-intermittently-p190292.html\r\n\r\nScenario is: Server is shutdown. One of the threads finds that the client has disconnected. It tries to close the session but gets an exception during rollback because the shutdown has already taken place.\r\n\r\nThe code where closeSession gets called is in DRDAConnThread.run method:\r\n\r\n} catch (Exception e) {\r\n\t\t\t\tif (e instanceof DRDAProtocolException && \r\n\t\t\t\t\t\t((DRDAProtocolException)e).isDisconnectException())\r\n\t\t\t\t{\r\n\t\t\t\t \t// client went away - this is O.K. here\r\n\t\t\t\t\tcloseSession();\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\thandleException(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\nIn this scenario, since the client has already disconnected, can we ignore the exceptions when closing the session? Then, we can pass a flag to closeSession method asking to ignore exceptions if we are calling it when we receive a DisconnectException in the server. Any comments/suggestions ? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-06-02T07:15:54.000+0000","updated":"2006-06-02T07:15:54.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12416098","id":"12416098","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I got the diff in a run against trunk - build 413780\r\n\r\nFailure Details:\r\n********* Diff file derbyall/derbynetclientmats/DerbyNetClient/derbynetmats/derbynetmats/DerbyNetAutoStart.diff\r\n*** Start: DerbyNetAutoStart jdk1.5.0_02 DerbyNetClient derbynetmats:derbynetmats 2006-06-12 21:15:02 ***\r\n2a3,4\r\n> SQL Exception: No current connection.\r\n> agentThread[DRDAConnThread_7,5,derby.daemons]\r\nTest Failed.\r\n*** End:   DerbyNetAutoStart jdk1.5.0_02 DerbyNetClient derbynetmats:derbynetmats 2006-06-12 21:15:46 ***\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2006-06-14T05:56:55.000+0000","updated":"2006-06-14T05:56:55.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12417196","id":"12417196","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Of late, I see this intermittent test failure is reported by few people. However, I have not been able to repro this issue on my machine. I am unassigning myself from this issue thinking someone else may be interested to pick it up.\r\n\r\nHere is what I have found along with a recap of the discussions so far on this issue and DERBY-1020:\r\n\r\n* This test uses derby.drda.startNetworkServer property. It checks that when embedded driver is loaded, it starts network server and when we do a system shutdown, it shuts down network server.\r\n\r\n* The shutdown of network server happens asynchronously. DRDAServerStarter calls NetworkServerControlImpl.directShutdown which simply notifies the waiting thread and returns. Thus the shutdown of network server happens in parallel with remaining shutdown processing in the engine.\r\n\r\n* Network server shutdown involves rollback and close of the EngineConnection object. Before calling these methods, it checks that the connection is not closed. From this, it seemed that this exception can occur only if the engine shutdown takes place in the meantime (after we check conn.isClosed() and when we are in conn.rollback())\r\n\r\nI think the exception occurs when the system shutdown happens in the meantime:\r\n\r\n\t\t\tif ((conn != null) && !conn.isClosed())\r\n\t\t\t{\r\n\t\t\t\t// --------------------------> Derby shutdown\r\n\t\t\t\tif (! forXA)\r\n\t\t\t\t{\r\n\t\t\t\t\tconn.rollback();\r\n\t\t\t\t}\r\n\t\t\t\tconn.close();\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\r\nThe closest I have been able to simulating this error is only by introducing a sleep here:\r\n\r\n\t\t\tif ((conn != null) && !conn.isClosed())\r\n\t\t\t{\r\n\t\t\t\t// Introduce a sleep here ... just an attempt to simulate the failure\r\n\t\t\t\ttry {\r\n\t\t\t\t\tThread.sleep(5000);\r\n\t\t\t\t} catch (InterruptedException ie) {\r\n\t\t\t\t\t// \r\n\t\t\t\t}\r\n\t\t\t\tif(conn.isClosed()) {\r\n\t\t\t\t\tSystem.out.println(\"Connection has been closed in the meantime !!!\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (! forXA)\r\n\t\t\t\t{\r\n\t\t\t\t\tconn.rollback();\r\n\t\t\t\t}\r\n\t\t\t\tconn.close();\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\nIf I run the test with this additional sleep, I always get \"Connection has been closed in the meantime !!!\" message and an exception in conn.rollback().\r\n\r\n* Irrespective of where the exception happens, the gist of the problem is what Kathey reported in DERBY-1020 (Network Server treats errors on cleanup of connections as an unexpected error after intentional shutdown of the database/server)\r\n\r\n* Possible solutions. These are just some ideas:\r\n\r\n1. Catch any SQLExceptions thrown in conn.rollback() and conn.close(). In the catch block, call conn.isClosed() to check if connection has been closed. If so, ignore the exception. However, this solution has drawback because we do not know if the connection is no longer active because of some unexpected event. Kathey made this comment in DERBY-1020 \r\n\"\r\nIf an exception happens on rollback() or close() there are basically three scenarios\r\n.\r\n.\r\n.\r\n\r\n3) The connection is no longer active because of some unexpected event like a crash. There has been some debate in the past whether this type of exception needs to be logged. I thought session level exceptions in this block of code could safely be ignored since the fact that they were session severity meant the session was shutdown. Tomohito thought it was not good to ignore them and I understand that point.\r\n\r\n\r\n\"\r\nBased on this, it may not be okay to just ignore exceptions.\r\n\r\n2. Use NetworkServerControlImpl.shutdown instead of NetworkServerControlImpl.directShutdown method. This is to ensure network server has done all the cleanup related to shutdown before we proceed with rest of shutdown processing in the engine. However, this will slow down the shutdown processing.\r\n\r\n3. Modify the test to redirect the exceptions during shutdown, similar to what is done in DERBY-273 for dataSourcePermissions_net test. This way, we can avoid seeing the intermittent failures in the regression test runs. This will not solve the real problem. Also, we may miss some real exceptions. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-06-22T04:40:33.000+0000","updated":"2006-06-22T04:40:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12423857","id":"12423857","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"I have managed to reproduce this failure, and I agree with Deepa's interpretation of what is happening. In the attached file (suggestion-803.diff), I have implemented an alternative solution to this problem than those suggested earlier. I have added the method rollbackAndClose() to EngineConnection. This method will check that the connection is opened, rollback and close the connection in a synchronized manner. This diff is not intended to be committed but I would appreciate if someone could comment the approach. Thank you!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-07-27T15:22:24.000+0000","updated":"2006-07-27T15:22:24.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12423919","id":"12423919","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Thanks Fernanda for picking this up. \r\n\r\nI am wondering if this solution will fix all cases. I think this solution is in same lines as what was discussed in DERBY-1020 (use of forceClose() method) to do a rollback and close together. At that time itself, I was not convinced this solution will solve the problem. There are at least three different exceptions seen during shutdown in this test (stack traces are spread between DERBY-803, DERBY-273 and DERBY-1020). As seen from the stack traces, these exceptions can occur at calls to conn.rollback() or conn.close().  In a previous comment, Mike had posted another exception: \"SQL Exception: No current connection. \" The full stack trace for this exception is:\r\njava.sql.SQLException: No current connection.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:44)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:88)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:104)\r\n\tat org.apache.derby.impl.jdbc.Util.noCurrentConnection(Util.java:208)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkIfClosed(EmbedConnection.java:1335)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.setupContextStack(EmbedConnection.java:1513)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.close(EmbedConnection.java:992)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.close(EmbedConnection.java:970)\r\n\tat org.apache.derby.impl.drda.Database.close(Database.java:320)\r\n\tat org.apache.derby.impl.drda.Session.close(Session.java:110)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.closeSession(DRDAConnThread.java:7270)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:269)\r\n\r\nThis is similar to the exception I was getting when I was trying to simulate the failure by adding a sleep. When the network server thread was sleeping, the engine shutdown runs to completion and so I was getting  \"SQL Exception: No current connection. \".\r\n\r\nI think we can get these exceptions when we call conn.close() or conn.rollback() during shutdown of network server and in the meantime engine shutdown is:\r\n1)  in progress - In this case, we get org.apache.derby.iapi.services.context.ShutdownException\r\n2)  complete  - In this case, we get java.sql.SQLException: No current connection.  \r\n\r\nI may be mistaken here but just wanted to share my thoughts. \r\n\r\nLeaving my thoughts aside, if this patch solves the failure on your machine, then it may be okay to proceed with this approach. I have only a small comment about the changes in the patch. It may not be okay to remove this check \"if ((conn != null) && !conn.isClosed())\" before calling conn.rollbackAndClose() or conn.close() in Database.close().  I think we need to at least check the case that conn is not null.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-07-27T20:56:27.000+0000","updated":"2006-07-27T20:56:27.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12430273","id":"12430273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"I have tested the solution using the rollbackAndClose() method (semantically equal to the forceClose() method discussed in DERBY-1020) and it actually does not help avoiding any of the exceptions seen in this issue from happening.\r\n\r\nThe rollbackAndClose() method checks that the connection is open, rolls back and closes the connection synchronized on the connection. This does not prevent the exceptions from happening because the connection is being closed implicitly when the server shutdown stops the InternalDriver and/or the Database. Since the connection is being closed using its close method, the synchronization that was added does not prevent the connection from being closed by the shutdown (since that does not synchronize on the connection object).\r\n\r\nIn my opinion there are two possible solutions for this issue: (1) change the test so that the set of exceptions will either not happen or does not show in the diff; (2) distinguish the exceptions that happen because the server was shut down from those happening for other reasons (Kathey Marsden has enumerated the scenarios in DERBY-1020), and ignore those that happen because the server was shut down.\r\n\r\nI think that (2) is a better solution, and I was wondering whether we can say that exceptions that happen during rollbackAndClose() can be considered as exceptions that happen due to a server shutdown iff (i)the connection is closed at the time the exception happens, and (ii)the session is being closed because the client left? For example, is there any other way to stop InternalDriver and/or the Database than a shutdown?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-08-24T15:39:09.000+0000","updated":"2006-08-24T15:39:09.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12430632","id":"12430632","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"body":"This test  is  failing  with  a different  error message  also , might be related to the same  issue:\r\n********* Diff file derbynetmats/DerbyNet/derbynetmats/DerbyNetAutoStart.diff\r\n*** Start: DerbyNetAutoStart jdk1.4.2 DerbyNet derbynetmats:derbynetmats 2006-08-25 11:00:42 ***\r\n1a2,4\r\n> java.sql.SQLException: No current connection.\r\n> agentError in Thread[DRDAConnThread_3,5,derby.daemons]\r\n> org.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of Permanent Agent Error: SVRCOD = 40; RDBNAM = database1; diagnostic msg = No current connection.\r\nTest Failed.\r\n*** End:   DerbyNetAutoStart jdk1.4.2 DerbyNet derbynetmats:derbynetmats 2006-08-25 11:01:29 ***\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"created":"2006-08-25T21:25:05.000+0000","updated":"2006-08-25T21:25:05.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12433150","id":"12433150","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Couldn't we just wrap DRDAConnThread.run()'s call to closeSession() in a synchronized block (synchronizing on NetworkServerControlImpl.getShutdownSync()) and only call it if NetworkServerControlImpl.getShutdown() returns false? The server shutdown will take care of closing the sessions anyway.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-09-07T15:50:23.000+0000","updated":"2006-09-07T15:50:23.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12433256","id":"12433256","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I am seeing the following similar to what Suresh reported, against an ibm1.4.2 jvm, against the trunk\r\n\r\nGenerating report for RunSuite derbynetmats  null null DerbyNet true \r\n------------------ Java Information ------------------\r\nJava Version:    1.4.2\r\nJava Vendor:     IBM Corporation\r\nJava home:       c:\\cloudtst\\jartest\\ibm142\\jre\r\nJava classpath:  c:/cloudtst/jartest/classes/derby.jar;c:/cloudtst/jartest/classes/derbytools.jar;c:/cloudtst/jartest/classes/derbynet.jar;c:/cloudtst/jartest/classes/derbyclient.jar;c:/cloudtst/jartest/classes/functionTests.jar;c:/cloudtst/jartest/classes/derbyTesting.jar;c:/cloudtst/jartest/tools/java/jndi/fscontext.jar;c:/cloudtst/jartest/drda/jcc/2.6_latest/db2jcc.jar;c:/cloudtst/jartest/drda/jcc/2.6_latest/db2jcc_license_c.jar;c:/cloudtst/jartest/tools/java/junit.jar;c:/cloudtst/jartest/classes/derbyLocale_zh_TW.jar;c:/cloudtst/jartest/classes/derbyLocale_zh_CN.jar;c:/cloudtst/jartest/classes/derbyLocale_pt_BR.jar;c:/cloudtst/jartest/classes/derbyLocale_ko_KR.jar;c:/cloudtst/jartest/classes/derbyLocale_ja_JP.jar;c:/cloudtst/jartest/classes/derbyLocale_it.jar;c:/cloudtst/jartest/classes/derbyLocale_fr.jar;c:/cloudtst/jartest/classes/derbyLocale_es.jar;c:/cloudtst/jartest/classes/derbyLocale_de_DE.jar;\r\nOS name:         Windows XP\r\nOS architecture: x86\r\nOS version:      5.1\r\nJava user name:  cloudtest\r\nJava user home:  C:\\Documents and Settings\\cloudtest\r\nJava user dir:   C:\\cloudtst\\jartest\\JarResults.2006-09-06\\ibm142_derbynetmats_jcc_2.6_latest\r\njava.specification.name: Java Platform API Specification\r\njava.specification.version: 1.4\r\n--------- Derby Information --------\r\nJRE - JDBC: J2SE 1.4.2 - JDBC 3.0\r\n[C:\\cloudtst\\jartest\\classes\\derby.jar] 10.3.0.0 alpha - (440936)\r\n[C:\\cloudtst\\jartest\\classes\\derbytools.jar] 10.3.0.0 alpha - (440936)\r\n[C:\\cloudtst\\jartest\\classes\\derbynet.jar] 10.3.0.0 alpha - (440936)\r\n[C:\\cloudtst\\jartest\\classes\\derbyClient.jar] 10.3.0.0 alpha - (440936)\r\n[C:\\cloudtst\\jartest\\drda\\jcc\\2.6_latest\\db2jcc.jar] 2.6 - (87)\r\n[C:\\cloudtst\\jartest\\drda\\jcc\\2.6_latest\\db2jcc_license_c.jar] 2.6 - (87)\r\n------------------------------------------------------\r\n\r\n\r\n*** Start: DerbyNetAutoStart jdk1.4.2 DerbyNet derbynetmats:derbynetmats 2006-09-07 11:22:14 ***\r\n1a2,4\r\n> org.apache.derby.iapi.services.context.ShutdownException: \r\n> agentError in Thread[DRDAConnThread_5,5,derby.daemons]\r\n> org.apache.derby.impl.drda.DRDAProtocolException: Execution failed because of Permanent Agent Error: SVRCOD = 40; RDBNAM = database1; diagnostic msg = Java exception: ': org.apache.derby.iapi.services.context.ShutdownException'.\r\nTest Failed.\r\n*** End:   DerbyNetAutoStart jdk1.4.2 DerbyNet derbynetmats:derbynetmats 2006-09-07 11:23:11 ***\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2006-09-07T22:07:46.000+0000","updated":"2006-09-07T22:07:46.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12433859","id":"12433859","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"The attached patch (derby-803.diff) changes the test so that the exception will not happen. I have successfully run the DerbyNetAutoStart 100 times with this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-09-11T13:57:20.000+0000","updated":"2006-09-11T13:57:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12434076","id":"12434076","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thank you, Fernanda! Although your patch only works around the problem, I think the fix is OK. The general problem is logged as DERBY-1020, and until it has been fixed, I think it is good to have a workaround which makes this test run cleanly. I added a comment about why the sleep was needed and committed revision 442490.\r\n\r\nLeaving the issue open until it has been merged to 10.2.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-09-12T07:00:37.000+0000","updated":"2006-09-12T07:00:37.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12435705","id":"12435705","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Merged to 10.2 in Rick's mega-merge.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-09-19T06:57:30.000+0000","updated":"2006-09-19T06:57:30.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12441314","id":"12441314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"This test fails on 10.1.3.2 also. Does it make sense for this fix to be  backported to 10.1 codeline ?\r\n\r\nThanks. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-10-10T23:08:56.000+0000","updated":"2006-10-10T23:08:56.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12327439/comment/12441356","id":"12441356","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Since this was a minor change to the test that fixed the problem, and this test is a bit of an annoyance for 10.1 testing, I merged Fernanda's test change to 10.1 with revision 462705.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-10-11T06:19:15.000+0000","updated":"2006-10-11T06:19:15.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-803/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06yu7:"}}