{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12514787","self":"https://issues.apache.org/jira/rest/api/latest/issue/12514787","key":"SOLR-2666","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316683","id":"12316683","description":"Major release after 3.3","name":"3.4","archived":false,"released":true,"releaseDate":"2011-09-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314992","id":"12314992","description":"Alpha release of 4.x series","name":"4.0-ALPHA","archived":false,"released":true,"releaseDate":"2012-07-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-09-16 14:48:52.01","customfield_12312323":null,"customfield_12310420":"4885","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_678653_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-07-20T13:43:10.034+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-2666/watchers","watchCount":0,"isWatching":false},"created":"2011-07-20T13:31:57.149+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316683","id":"12316683","description":"Major release after 3.3","name":"3.4","archived":false,"released":true,"releaseDate":"2011-09-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314992","id":"12314992","description":"Alpha release of 4.x series","name":"4.0-ALPHA","archived":false,"released":true,"releaseDate":"2012-07-03"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-09-16T14:48:52.011+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313140","id":"12313140","name":"Build","description":"Changes/issues w/ the build"}],"timeoriginalestimate":null,"description":"Under {{solr/solrj/}} on branch_3x, {{ant compile-test}} fails because of incomplete backport of the SOLR-2452 changes: {{TestNamedListCodec}} still depends on a Solr test class {{TestDistributedSearch}}.\r\n\r\nThis problem is masked by the inclusion of Solr test compilation output in Solrj's {{test.classpath}}, which is inherited from {{solr/common-build.xml}}; when {{ant compile-test}} is run from {{solr/}}, the Solr core tests are compiled first, thus allowing Solrj test compilation to succeed.\r\n\r\nOn trunk, {{ant compile-test}} under {{solr/solrj/}} does not fail, because {{TestNamedListCodec}} depends on {{BaseDistributedSearchTestCase}}, located in Solr's test-framework, instead of on {{TestDistributedSearch}}.  This issue should nevertheless be addressed on trunk too, to surface future inadvertent solrj test->solr core test dependencies.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"18574","summary":"Solrj test.classpath should not include Solr core test compilation output","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":3,"total":3,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514787/comment/13068373","id":"13068373","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"body":"Here's the patch to fix Solrj's {{test.classpath}}, applicable to both branch_3x and trunk:\r\n\r\n{code:xml}\r\nIndex: solr/solrj/build.xml\r\n===================================================================\r\n--- solr/solrj/build.xml        (revision 1148740)\r\n+++ solr/solrj/build.xml        (working copy)\r\n@@ -20,6 +20,13 @@\r\n \r\n   <import file=\"../common-build.xml\"/>\r\n \r\n+  <!-- Specialized common-solr.test.classpath, to remove the Solr core test output -->\r\n+  <path id=\"test.classpath\">\r\n+    <pathelement path=\"${common-solr.dir}/build/solr-test-framework/classes/java\"/>\r\n+       <pathelement path=\"${tests.userdir}\"/>\r\n+       <path refid=\"test.base.classpath\"/>\r\n+  </path>\r\n+\r\n   <target name=\"compile-test\" depends=\"compile-solr-test-framework,common.compile-test\"/>\r\n \r\n   <target name=\"test\" depends=\"compile-test,junit-mkdir,junit-sequential,junit-parallel\"/>\r\n{code}\r\n\r\nOn branch_3x, this patch removes the Solr core test dependency:\r\n\r\n{code:java}\r\nIndex: solr/solrj/src/test/org/apache/solr/common/util/TestNamedListCodec.java\r\n===================================================================\r\n--- solr/solrj/src/test/org/apache/solr/common/util/TestNamedListCodec.java    (revision 1148740)\r\n+++ solr/solrj/src/test/org/apache/solr/common/util/TestNamedListCodec.java    (working copy)\r\n@@ -17,9 +17,9 @@\r\n package org.apache.solr.common.util;\r\n \r\n import org.apache.lucene.util.LuceneTestCase;\r\n+import org.apache.solr.BaseDistributedSearchTestCase;\r\n import org.apache.solr.common.SolrDocument;\r\n import org.apache.solr.common.SolrDocumentList;\r\n-import org.apache.solr.TestDistributedSearch;\r\n \r\n import java.io.ByteArrayOutputStream;\r\n import java.io.ByteArrayInputStream;\r\n@@ -246,7 +246,7 @@\r\n       byte[] arr = baos.toByteArray();\r\n       // System.out.println(arr.length);\r\n       res = (NamedList) new JavaBinCodec().unmarshal(new ByteArrayInputStream(arr));\r\n-      cmp = TestDistributedSearch.compare(nl,res, 0, null);\r\n+      cmp = BaseDistributedSearchTestCase.compare(nl, res, 0, null);\r\n \r\n       if (cmp != null) {\r\n         System.out.println(nl);\r\n{code}\r\n\r\nCommitting shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"created":"2011-07-20T13:37:28.009+0000","updated":"2011-07-20T13:37:28.009+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514787/comment/13068377","id":"13068377","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"body":"Committed:\r\n- r1148763: trunk\r\n- r1148766: branch_3x","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"created":"2011-07-20T13:43:10.042+0000","updated":"2011-07-20T13:43:10.042+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12514787/comment/13106211","id":"13106211","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"bulk close for 3.4","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2011-09-16T14:48:52.010+0000","updated":"2011-09-16T14:48:52.010+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-2666/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i03jdz:"}}