{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12331782","self":"https://issues.apache.org/jira/rest/api/latest/issue/12331782","key":"DERBY-1191","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12310220":"2006-04-08 00:57:55.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22361","customfield_12310222":null,"customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1191/watchers","watchCount":2,"isWatching":false},"created":"2006-04-07T22:51:35.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_triage10_10","derby_triage10_8"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12325672","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12325672","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12386268","key":"DERBY-3319","self":"https://issues.apache.org/jira/rest/api/2/issue/12386268","fields":{"summary":"Logical connections do not check if a transaction is active on close","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12326274","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12326274","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12433091","key":"DERBY-4350","self":"https://issues.apache.org/jira/rest/api/2/issue/12433091","fields":{"summary":"javaException is created but not thrown or logged  in DRDAConnThread.closeStream(InputStream stream)","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2012-09-26T19:00:29.345+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"}],"timeoriginalestimate":null,"description":"I found this when working on DERBY-1047.   Exceptions thrown  using \r\norg.apache.derby.impl.jdbc.Util.generateCsSQLException()\r\ndo not print to derby.log even when derby.stream.error.logSeverityLevel=0\r\n\r\nFor example the attached repro  generates an expected exception but does not  print the error to the log.\r\n\r\njava -Dderby.stream.error.logSeverityLevel=0 Derby1047\r\n\r\n\r\nThis causes an expected exception to be thrown but it does not print to the derby.log\r\n\r\n10.2.0.0 alpha\r\nApache Derby\r\nApache Derby Embedded JDBC Driver\r\ndone creating  table\r\nCOL1\r\n-----------\r\n1\r\n2\r\nPASS: Expected Exception can'tholdable cusror in global xact:Cannot set holdability ResultSet.HOLD_CURSORS_OVER_COMMIT for a global transaction.\r\nCOL1\r\n-----------\r\n1\r\n2\r\n3\r\n\r\n\r\nThe code generating the exception is in org.apache.derby.iapi.jdbc.BrokeredStatement\r\n\r\n  final void checkHoldability() throws SQLException {\r\n        int holdability = controlCheck().checkHoldCursors(resultSetHoldability);\r\n        if (holdability != resultSetHoldability)\r\n            throw Util.generateCsSQLException(SQLState.CANNOT_HOLD_CURSOR_XA);\r\n\r\n    }\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"35357","summary":"Some SQLExceptions, for example those generated from BrokeredStatements,  do not print to derby.log even  when  derby.stream.error.logSeverityLevel=0","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10424","value":"Repro attached","id":"10424"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10053","value":"Low","id":"10053"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":24,"total":24,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12373652","id":"12373652","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I wanted to clarify that I don't think  this issue is not limited to XA.\r\nThere are  errors are thrown using this mechanism, for example:\r\n\r\nEmbeddedConnection.close()\r\nEmbeddedConnection.createBoot()\r\nSavepoint code in EmbeddedConnection30\r\n\r\nPlaces where Util.javaException(Throwable)  is  used, for example network server and \r\nEmbeddedConnection.bootDatabase()  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-04-07T23:34:12.000+0000","updated":"2006-04-07T23:34:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12373658","id":"12373658","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Fixing priority.  There  will be a bit of a delay to post repro because I need to change the case as it doesn't actually throw the exception anymore with the fix for DERBY-1158.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-04-08T00:48:52.000+0000","updated":"2006-04-08T00:48:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12373660","id":"12373660","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"It's not clear to me that such exceptions belong in derby.log. Most exceptions that are a result of an application error (incorrect use of the JDBC api) do not end up in derby.log. E.g. calling ResultSet.getXXX when not on a row, calling a method on a closed JDBC object, calling ResultSet.getXXX with an out of range column identifier.\r\n\r\nI think derby.log should be reserved for errors that occur within the engine, not those at  the JDBC api level.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-04-08T00:57:55.000+0000","updated":"2006-04-08T00:57:55.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12373669","id":"12373669","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I disagree.\r\n\r\nThe description of  derby.stream.error.logSeverityLevel the property says:\r\nSpecifies which errors are logged to the Derby error log (typically the derby.log file). In test environments, use the setting derby.stream.error.logSeverityLevel=0 so that *all*  problems are reported.\r\n\r\nhttp://db.apache.org/derby/docs/dev/tuning/rtunproper26985.html\r\n\r\nOnly printing some of the exceptions causes support issues. When users get unexpected exceptions, we usually ask them to set derby.stream.error.logSeverityLevel=0  and send the derby.log.  It is very useful to have the exception there, complete with the full exception chain,  regardless of where it came from and not have to worry about getting traces output from the application.\r\n\r\n\r\nHere is one current support case example:  \r\n\r\nIssue: Create database fails with \"Database not found\" exception after creating the database.\r\n\r\nThere have been multiple round trips so far:\r\n\r\n1) Initial issue:\r\n\"We are seeing this error  creating the database but the database actually gets created ok\"\r\nij> connect 'jdbc:derby:databases/TopDown1;create=true';\r\nERROR XJ004: Database 'databases/TopDown1' not found.\r\nSQL Exception: Database 'databases/TopDown1' not found.\r\n\r\n2) Asked for derby.log with derby.stream.error.logSeverityLevel=0\r\n\"Here is the log file  <derby.log>\r\nHowever, it does not contain any useful info :-(\"\r\n\r\n3) Asked for  ij stack trace with ij.exceptionTrace=true\r\n[java] ij> connect 'jdbc:derby:databases/TopDown1;create=true';\r\n     [java] ERROR XJ004: Database 'databases/TopDown1' not found.\r\n     [java] SQL Exception: Database 'databases/TopDown1' not found.\r\n     [java] \tat java.lang.Throwable.<init>(Throwable.java:196)\r\n     [java] \tat java.lang.Exception.<init>(Exception.java:41)\r\n     [java] \tat java.sql.SQLException.<init>(SQLException.java:40)\r\n     [java] \tat org.apache.derby.impl.jdbc.EmbedSQLException.<init>(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(Unknown Source)\r\n     [java] \tat org.apache.derby.jdbc.Driver30.getNewEmbedConnection(Unknown Source)\r\n     [java] \tat org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)\r\n     [java] \tat java.sql.DriverManager.getConnection(DriverManager.java:525)\r\n     [java] \tat java.sql.DriverManager.getConnection(DriverManager.java:140)\r\n     [java] \tat org.apache.derby.impl.tools.ij.ij.dynamicConnection(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.tools.ij.ij.ConnectStatement(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.tools.ij.ij.ijStatement(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.tools.ij.Main.go(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)\r\n     [java] \tat org.apache.derby.impl.tools.ij.Main14.main(Unknown Source)\r\n     [java] \tat org.apache.derby.tools.ij.main(Unknown Source)\r\n\r\nMany other cases regarding errors thrown from the JDBC API occur  because we have a bug or  user expectations are different (ala DERBY-1158).  Regardless of whether this issue is a bug or not,  when communicating with  users it is really good for the derby.log to be a one stop shop for exceptions.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-04-08T01:36:33.000+0000","updated":"2006-04-08T01:36:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12373678","id":"12373678","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"The example you give is a problem with the engine, thus the error should be in the log. I just don't think application errors should make it to the derby.log, they are not a \"problem\" with Derby.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-04-08T02:36:28.000+0000","updated":"2006-04-08T02:36:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12415229","id":"12415229","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidvc","name":"davidvc","emailAddress":"david at vancouvering dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Van Couvering","active":true},"body":"I was thinking of working on this, but reading the comments, it is not clear to me what ultimately needs to be fixed here.  It sounds like we want engine-level exceptions, not application errors, to be logged.  How does one distinguish between the two in a programmatic way?  I'm not clear what approach I would follow to fix this.   Should they just be fixed on a case-by-case basis or is there a determinant available in the code?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=davidvc","name":"davidvc","emailAddress":"david at vancouvering dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"David Van Couvering","active":true},"created":"2006-06-08T05:31:38.000+0000","updated":"2006-06-08T05:31:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12730997","id":"12730997","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Changing this to major. I think it is very important for users trying to diagnose issues particularly for the new exceptions now thrown on connection close if the transaction has not been rolled back with DERBY-3319.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-07-14T17:43:10.199+0000","updated":"2009-07-14T17:43:10.199+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12730998","id":"12730998","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Linking DERBY-3319\r\nThis issue will be very important users trying to determine what application changes are required after that fix.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-07-14T17:44:30.919+0000","updated":"2009-07-14T17:44:30.919+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12734399","id":"12734399","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Looking back at the comments in this issue, I see that Dan had some objection to logging exceptions at the JDBC API level especially usage errors.  I still think logging all  exceptions is useful.  The one I especially am interested in logging  at the moment is:\r\n\r\nSQLState 25001\r\njava.sql.SQLException: Cannot close a connection while a transaction is still active.\r\n\r\nwhich is new after the DERBY-3319 fix for pooled connections and has proved hard to track down in the cases of DERBY-4053, DERBY-4225 and I think perhaps a current user case I am trying to diagnose.\r\n\r\nI think this exception would fall into the category of  usage error and JDBC API level, but  it sure would be helpful to see it especially for something that used to work.   \r\n\r\nDo others have opinions on this?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-07-23T00:11:16.283+0000","updated":"2009-07-23T00:11:16.283+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12734661","id":"12734661","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I can see Dan's point but I do believe that it will be good to have one central place to look at all the exceptions irrespective of what code caused it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2009-07-23T17:46:37.083+0000","updated":"2009-07-23T17:46:37.083+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12737615","id":"12737615","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Attaching a reproduction for this issue.  ReproDerby1191.  It includes just the one exception that we really need logged after the fix for DERBY-3319.  I am sure fixing this one will fix others as well, but there may be additional code paths that need attention.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-07-31T17:54:31.304+0000","updated":"2009-07-31T17:54:31.304+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12737623","id":"12737623","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Note a fix for this issue might be helpful in diagnosing a recent user report:\r\nhttp://www.nabble.com/Derby-10.5.1.1-regression-tt24733315.html#a24733315\r\n\r\nHere an XCL30/XJ001 error shows up only in the protocol tracing and is not otherwise reported.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-07-31T18:03:19.184+0000","updated":"2009-07-31T18:03:19.184+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12739624","id":"12739624","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Lily helped me explore possible options for this issue (Thanks Lily!) .  Basically there seem to be two.\r\n1) log the exception when the exception is created in SQLExceptionFactory and SQLExceptionFactory40 getSQLException().  Adding a method logException(SQLException se)  to SQLExceptionFactory and calling it just before returning the exception.  The  advantage to this approach is that it requires a small amount of centralized code.  The disadvantages are  that it requires access to the Monitor which seems a little out of place here.  Also at least in one case we create an exception that we normally never throw. In EmbeddedConnection we have:\r\n  public static final SQLException NO_MEM =\r\n       Util.generateCsSQLException(SQLState.LOGIN_FAILED, \"java.lang.OutOfMemoryError\");\r\n\r\nand then only throw that if we run out of memory.  There would have to be special casing to handle this.\r\n\r\nThe side effect of logging from a Factory class seems a little odd.\r\n\r\n2)  Add a method to the Util class throwAndLogSQLException(SQLException se) which logs the exception and then throws it. Then  change the individual  code calls to instead  of doing:\r\n  throw Util.generateCsSQLException(...);\r\n\r\nto call \r\n  throwAndLog(Util.generateCsSQLException(...));\r\n\r\nThis seems clearer and the exception does not get logged until it is thrown.  The downside is that it changes a lot of code and it is possible some exceptions might get missed. Developers need to be aware that for new exceptions they need to call the method instead of just throwing the exception.  \r\n\r\nIt might be tricky to backport to release branches since it would change so much code.\r\n\r\nI am really about split on the two options and welcome opinions or better ideas.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-08-05T17:14:36.560+0000","updated":"2009-08-05T17:14:36.560+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12739725","id":"12739725","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I would worry about making a large code change in older branches. But it does seem - without actually looking at the code - that the second suggestion is clearer in the way the process flows.\r\nIt seems to me, could you do both - do approach 1 for older releases (10.4 and earlier) and approach 2 for trunk (and 10.5?) or would that be too much work and cause too much pain backporting fixes? \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-08-05T20:27:29.205+0000","updated":"2009-08-05T20:27:29.205+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12739735","id":"12739735","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"We certainly could take a different approach on the branches, If we choose option 2 on trunk and do not backport  it may indeed  interfere with merging unrelated fixes since so many methods will be impacted.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-08-05T20:38:42.522+0000","updated":"2009-08-05T20:38:42.522+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12740200","id":"12740200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"derby-1191_factory_hack_no_commit_diff.txt  contains the SQLExceptionFactory solution. On implementing it, it really looks like it is in the wrong place, but I will give it to someone having a problem with 10.5 to help debug their problem.  I am posting it here in case someone else needs to log the JDBC and network server errors for debugging.  The patch is against 10.5.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-08-06T18:56:03.583+0000","updated":"2009-08-06T18:56:03.583+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12742669","id":"12742669","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Here is a patch that takes the approach of adding a public static void logAndThrowSQLException(SQLException se) method and then calling that instead of just throwing the exception.\r\n\r\nThe initial patch only uses the method for EmbedConnection.checkForTransactionInProgress() which is the most important exception to log after the fix for DERBY-3319.\r\n\r\nIf everyone agrees on the approach, I would like to commit this patch and backport it to 10.5 and then follow up with larger patches that use the method for other SQLExceptions thrown by Derby embedded JDBC and network server.\r\n\r\nI am running regression tests now. I manually tested that the exception gets logged always with a sane build and with the appropriate derby.stream.error.logSeverityLevel with an insane build.  I didn't add a regression test because we don't really have a good way I think to test  error log contents.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-08-13T00:58:12.537+0000","updated":"2009-08-13T00:58:12.537+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12742823","id":"12742823","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"tests all passed for derby1191_checkForTransactionInProgress_diff.txt. I will check in in an about an hour unless someone asks for more time for review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-08-13T13:51:56.925+0000","updated":"2009-08-13T13:51:56.925+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12743236","id":"12743236","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Is the intention here (with the new Util.logAndThrowSQLException method), that this be\r\nused everywhere we now just do \"throw newSQLException\", so we should use new method in all new\r\nengine code?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2009-08-14T15:31:29.217+0000","updated":"2009-08-14T15:31:29.217+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12743254","id":"12743254","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Yes.  If everyone agrees this is the right approach,  I will start in September submitting patches to make all the changes and then put some documentation on the Wiki.  I thought I would start with this one exception that I really needed now and then let it sit a few weeks to make sure there are not better implementation  ideas out there.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-08-14T15:56:17.256+0000","updated":"2009-08-14T15:56:17.256+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12744485","id":"12744485","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I agree that option 2 sounds better, but I have some comments to the patch that was committed:\r\n\r\n1) Many of the lines mix tabs and spaces (that is, they are mixed on the same line), and some lines exceed 80 characters\r\n\r\n2) The error stream is automatically redirected to System.err if derby.log cannot be opened, so the special case for printing to the console is probably not necessary\r\n\r\n3) Checking the exact contents of the error message is likely to break in some locales, or if the message text is changed without updating the magic string. Better to follow the getCause() chain to look for OutOfMemoryError? Or perhaps just change the condition to se == EmbedConnection.NO_MEM?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2009-08-18T12:41:44.165+0000","updated":"2009-08-18T12:41:44.165+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12749594","id":"12749594","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thank you Knut for reviewing the change.  I had tried initially to put the check se == Embedconnection.NO_MEM but for some reason it wasn't working. I will research further and will make the other changes.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-08-31T20:00:16.472+0000","updated":"2009-08-31T20:00:16.472+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/12887739","id":"12887739","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"Clearing patch available flag, there are comments to address.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2010-07-13T12:51:20.456+0000","updated":"2010-07-13T12:51:20.456+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12331782/comment/13464064","id":"13464064","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Unmarking HVF as they really critical ones like the connection not closing due to an open transaction have been fixed.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-09-26T19:00:29.329+0000","updated":"2012-09-26T19:00:29.329+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1191/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06eyf:"}}