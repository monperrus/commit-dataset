{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12313585","self":"https://issues.apache.org/jira/rest/api/latest/issue/12313585","key":"DERBY-522","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12310615","id":"12310615","description":"","name":"10.1.2.1","archived":false,"released":true,"releaseDate":"2005-11-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-10-06 08:33:32.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21996","customfield_12310222":"3_*:*_1_*:*_1193201000_*|*_1_*:*_1_*:*_4065011000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_8460146000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2005-10-20T03:56:09.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-522/watchers","watchCount":0,"isWatching":false},"created":"2005-08-20T07:19:17.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12310615","id":"12310615","description":"","name":"10.1.2.1","archived":false,"released":true,"releaseDate":"2005-11-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-01-26T01:58:35.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"Comments before a  select statement Throws exception with Network Client\nFor Example a statement like the one below in the attached program with throw an exception.\n\nstmt.execute(\"-- This is a comment \\n Select c11 from TAB1\");\n\n\n\norg.apache.derby.client.am.SqlException: Statement.executeUpdate() cannot be called with a statement that returns a ResultSet.\n        at org.apache.derby.client.am.Statement.completeSqlca(Statement.java:1354)\n        at org.apache.derby.client.am.Statement.completeExecuteImmediate(Statement.java:964)\n        at org.apache.derby.client.net.NetStatementReply.parseEXCSQLIMMreply(NetStatementReply.java:199)\n        at org.apache.derby.client.net.NetStatementReply.readExecuteImmediate(NetStatementReply.java:50)\n        at org.apache.derby.client.net.StatementReply.readExecuteImmediate(StatementReply.java:44)\n        at org.apache.derby.client.net.NetStatement.readExecuteImmediate_(NetStatement.java:123)\n        at org.apache.derby.client.am.Statement.readExecuteImmediate(Statement.java:960)\n        at org.apache.derby.client.am.Statement.flowExecute(Statement.java:1587)\n        at org.apache.derby.client.am.Statement.executeX(Statement.java:631)\n        at org.apache.derby.client.am.Statement.execute(Statement.java:622)\n        at CommentBeforeSelect.createAndPopulateTable(CommentBeforeSelect.java:70)\n        at CommentBeforeSelect.main(CommentBeforeSelect.java:35)\n$\nTo reproduce run the attached program \njava CommentBeforeSelect\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40832","summary":"ERROR X0Y79 raised when adding comments using \"--\" before sql queries with Network Client","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":12,"total":12,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12319436","id":"12319436","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The problem comes I think because the client looks at the SQL statement and sends it as  EXCSQLIMM ,  because it does not  start with SELECT, VALUES, etc.\r\nEXCSQLIMM cannot be used for a statement that returns result sets.\r\n\r\nClient needs to treat the statement as a select and handle it properly.\r\n\r\nNote:\r\nCurrently IJ currently has code to strip out the comments for Network Client so the issue will not reproduce with IJ.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-08-20T07:27:29.000+0000","updated":"2005-08-20T07:27:29.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12331444","id":"12331444","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Changing fixin to be 10.1.2.0 and 10.2.0.0 since I have a fix ready and will be posting it once I have written corresponding tests.  The fix should be ready for the 10.1.2 bug fix release, and of course it should go into the trunk, as well, hence my choice of fixin values.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-10-06T08:33:32.000+0000","updated":"2005-10-06T08:33:32.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12331609","id":"12331609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching a patch for this issue.  The patch does the following:\r\n\r\n1) Updates client to look for statements that begin with comments and to ignore the comments when deciding the kind of statement that is being executed.\r\n2) Adds test cases for statements that begin with comments to the jdbcapi/nullSQLText.java test\r\n3) Creates two new masters for nullSQLText: one for DerbyNet, one for DerbyNetClient, to reflect the additional test cases.\r\n4) Updates lang/syscat.sql master for DerbyNetClient to match the new behavior.\r\n\r\nI couldn't find an existing test that really matched the condition, so I chose \"nullSQLText\" since it involves testing edge cases for statements that are passed to Derby via the JDBC \"execute\" call, which is similar to what the new tests do.  If, however, anyone thinks I should create a new test for this particular issue (for the sake of clarity), I can certainly go ahead and do so.\r\n\r\nI ran derbyall with Sun JDK 1.4 on Windows 2000 and saw no failures.\r\n\r\nMany thanks to Kathey for the helpful comment regarding where the problem was--she was absolutely right.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-10-08T01:25:04.000+0000","updated":"2005-10-08T01:25:04.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12331731","id":"12331731","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I know there is code in ij that strips of the comments for client. It would be great if  it could be changed to not strip off the comments for a 10.2 client.  Then you will see that there are actually lots of test cases checked in in many of the sql files.  I think ij should remain the same and strip off the comments for 10.1 clients even when this is ported to 10.1, so as not to cause trouble with old clients.    \r\n\r\nI wonder about comments before Stored procedures that return result sets.  Do those work ok?\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-10-11T02:46:49.000+0000","updated":"2005-10-11T02:46:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12332017","id":"12332017","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching an second version of the patch that has the following changes (w.r.t the first version):\r\n\r\n1) Logic in client/am/Statement.java has been re-written to account for some edge cases that weren't covered in the initial patch.\r\n\r\n2) Per Kathey Marsden's suggestion, the ij code has been changed so that it no longer strips leading comments when passing statements to the Derby Client.  NOTE: to be safe, this particular part of the patch probably should _not_ be ported to 10.1.\r\n\r\n3) In working with this patch, I noticed that statements which _end_ in comments do not work when passed through JDBC--rather, the result will be a syntax error in all modes (embedded, Derby Client, and JCC); see below for more on that issue.  The new version of the patch fixes that problem in addition to the other documented problems in this Jira issue.\r\n\r\n4) Updated additional master files to reflect the new changes.\r\n\r\n------\r\nNOTES:\r\n------\r\n\r\nRegarding #3 above: it turns out that if one tries to execute a SQL statement that _ends_ with a comment via JDBC, the result will be a syntax error.  This occurs in embedded mode as well as client/server mode.  Ex:\r\n\r\n    ResultSet rs = st.execute(\"values 2, 3, 4\\n-- trailing comment\");\r\n\r\nwill result in the following error:\r\n\r\n ERROR 42X01: Syntax error: Encountered \"-\" at line 2, column 1.\r\n\r\nNote, though, that if you add an end-of-line character to the exact same statement, it will work:\r\n\r\n    ResultSet rs = st.execute(\"values 2, 3, 4\\n-- trailing comment\\n\");\r\n\r\nThe reason is because the grammar in sqlgrammar.jj defines a comment as always ending with either \"\\n\", \"\\r\", or \"\\r\\n\".  Thus, in the first example above, since the comment doesn't end with any of these three characters, the result is a syntax error.\r\n\r\nTo fix this, I just made the final \"\\n\", \"\\r\", or \"\\r\\n\" optional--then in situations where the comment is the last part of the statement and there's no trailing newline, it will still be recognized as a comment and processed accordingly (i.e. ignored).\r\n\r\nI ran derbyall after making this simple change and there were no failures, so I _think_ it's safe.  However, I'm hoping to get a second opinion on this, just to be safe.\r\n\r\nNote that this change WILL have one side effect: in the edge case where a user tries to execute a statement that consists of ALL  comments, the error message will now be:\r\n\r\n ERROR 42X01: Syntax error: Encountered \"<EOF>\" at line 1, column 3.\r\n\r\ninstead of:\r\n\r\n ERROR 42X01: Syntax error: Encountered \"-\" at line 1, column 3.\r\n\r\nTo me, this seems like an acceptable change in behavior since the new behavior matches what currently happens if the user passes in an empty string--and, if the entire statement is just comments, that is in effect the what we're doing.  However, if anyone thinks this is unacceptable, please let me know and I'll just file a separate JIRA entry for that issue, to be addressed later.\r\n\r\nFinally, regarding Kathey's question of whether or not this fix will work if a comment precedes a stored procedure call that returns result sets, the answer is \"Yes.\"  I ran something like:\r\n\r\n  ResultSet rs = st.executeQuery(\"-- leading comment\\ncall proc1()\");\r\n\r\nand was able to process the results successfully.  Did you have a particular concern with this Kathey?  I added this test case to the set of cases for DERBY-522 in jdbcapi/nullSQLText.java, just to be certain.\r\n\r\nI ran derbyall on Windows 2000 with Sun JDK 1.4.2 with this patch and saw no failures.\r\n\r\nMany thanks to anyone who has additional comments/feedback on this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-10-14T01:19:12.000+0000","updated":"2005-10-14T01:19:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12332094","id":"12332094","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I reviewed this patch and my only comment is that I think that the ij change should strip comments for JCC or for     Derby client drivers  whose version is less than 10.2.  That way the behaviour is dependent upon which client the ij tool is working with and a 10.2 ij will continue to work with 10.1 client.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-10-15T02:57:29.000+0000","updated":"2005-10-15T02:57:29.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12332095","id":"12332095","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Thanks for the review, Kathey.  I misunderstood what you meant when you initially talked about not trimming for the 10.1 or earlier clients, hence my last patch didn't deal with that (sorry).  I'll work on another version of the patch and will post it soon.  Thanks again!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-10-15T03:18:17.000+0000","updated":"2005-10-15T03:18:17.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12332151","id":"12332151","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Updated patch so that ij will continue to remove comments from a statement against the Derby Client driver _if_ the client version is earlier than 10.2.  This makes it so that a 10.2 ij will still work a 10.1 Derby Client.  Thanks for catching this, Kathey.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-10-15T23:58:11.000+0000","updated":"2005-10-15T23:58:11.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12332304","id":"12332304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Committed this to the trunk:  Please submit the merge command for merge to 10.1 when ready.\r\n\r\nDate: Mon Oct 17 15:41:03 2005\r\nNew Revision: 325993\r\n\r\nURL: http://svn.apache.org/viewcvs?rev=325993&view=rev\r\nLog:\r\nDERBY-522\r\n\r\n1) Updates client to look for statements that begin with comments and to ignore the comments when deciding the kind of statement that is being executed.\r\n2) Changes ij to only strip comments for client versions less than 10.2\r\n3) Adds test cases for statements that begin with comments to the jdbcapi/nullSQLText.java test\r\n4) Updates masters\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-10-18T07:52:30.000+0000","updated":"2005-10-18T07:52:30.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12332388","id":"12332388","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Command to merge to 10.1 is:\r\n svn merge -r 325992:325993 https://svn.apache.org/repos/asf/db/derby/code/trunk","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-10-19T03:29:49.000+0000","updated":"2005-10-19T03:29:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12332424","id":"12332424","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching a master update for the _10.1_ codeline that fixes a diff for lang/forUpdate.sql.\r\n\r\nThe new logic in ij only strips comments if the client is 10.1 or earlier, and since the original patch was against 10.2, the master file that was submitted reflects the fact that the comments were NOT stripped.  For the 10.1 branch, the comments are still stripped, hence the diff.  The attached \"d10_1Master.patch\" file fixes that diff for 10.1.\r\n\r\nCould a committer please commit?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-10-19T08:40:14.000+0000","updated":"2005-10-19T08:40:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12313585/comment/12332499","id":"12332499","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Patch for this has been committed:\r\n\r\nsvn 325993  -- 10.2\r\nsvn 326222, 326308 -- 10.1\r\n\r\nI've verified the repro and the new test cases in both the 10.2 and 10.1 branches and all looks to be correct.  So I'm marking this as  resolved.\r\n\r\nKathey, I'll leave it to you to close this issue if everything looks okay.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2005-10-20T03:56:09.000+0000","updated":"2005-10-20T03:56:09.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-522/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07cr3:"}}