{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12333438","self":"https://issues.apache.org/jira/rest/api/latest/issue/12333438","key":"DERBY-1308","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-05-10 15:18:06.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22425","customfield_12310222":"1_*:*_1_*:*_1783939000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_3649405000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-05-30T19:54:26.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1308/watchers","watchCount":1,"isWatching":false},"created":"2006-05-10T04:22:07.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-06-29T22:43:01.463+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"}],"timeoriginalestimate":null,"description":"05/05/2006 regression test run of derbyall shows the following test failure with wctme5.7_foundation, \n\nderbyall/derbyall.fail:jdbcapi/HoldabilityTest.junit\nderbyall/derbyall.fail:jdbcapi/UpdateXXXTest.junit\nderbyall/derbyall.fail:jdbcapi/SURTest.junit\n\nDiff is a CNFE with ConnectionPoolDataSource.\n\n********* Diff file derbyall/jdbcapi/HoldabilityTest.diff\n*** Start: HoldabilityTest jdkJ2ME Foundation Specification v1.0 derbyall:jdbcapi 2006-05-07 11:31:05 ***\n0 add\n> Exception in thread \"main\" java.lang.NoClassDefFoundError: javax.sql.ConnectionPoolDataSource\nTest Failed.\n*** End:   HoldabilityTest jdkJ2ME Foundation Specification v1.0 derbyall:jdbcapi 2006-05-07 11:31:06 ***\n\nMy guess is these tests need to excluded from running in this environment. Can someone please confirm.  Thanks. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10369","value":"Regression Test Failure","id":"10369"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39026","summary":"Tests jdbcapi/HoldabilityTest.junit, jdbcapi/UpdateXXXTest.junit,jdbcapi/SURTest.junit fail on wctme5.7_foundation","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10102","value":"Patch Available","id":"10102"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"derby jars used - 10.2.0.0 alpha - (400220), machine is a win2000.","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":8,"total":8,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12333438/comment/12378852","id":"12378852","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"I think this could be a regression, since as part of DERBY-993, Myrna was able to run the following tests:\r\n\r\n>With the changes in place, I can successfully run with both jdk142 and wctme5.7_foundation the >following tests:\r\n>junitTests/lang/LangSuite.java\r\n>jdbcapi/SURTest.junit\r\n>jdbcapi/SURQueryMixTest.junit\r\n>jdbcapi/ConcurrencyTest.junit \r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-10T15:18:06.000+0000","updated":"2006-05-10T15:18:06.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12333438/comment/12413122","id":"12413122","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I'm attaching a patch - DERBY-1308_20060524.* - for this issue.\r\nI'd like to get some feedback on the approach I have taken.\r\nThe problem is that the j9 jvms do not contain some of the classes available in a full-fledged jvm. \r\nFor j9_foundation, there is no java.sql.Driver. For the other versions, there is no support for javax.sql.DataSource, XADataSource, nor ConnectionPooledDataSource.\r\n\r\nWhat was happening is that after the contribution of adding a number of methods returning these various datasources in util/BaseJDBCTestCase.java these j9-jvms would fall over with a ClassDefNotFoundError. Apparently this happened as soon as a method was added that returned one of these not-available classes, even though the tests in question did not actually use those methods.\r\n\r\nSo, I have 2 questions:\r\n1. could that be a jvm bug - i.e. when should a ClassDefNotFoundError get thrown? In this case, it gets thrown when the superclass is returning a non-available class...\r\n2. Either way, is it acceptable to split the BaseJDBCTestClass in two in the way I did with this patch?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-05-24T21:09:38.000+0000","updated":"2006-05-24T21:09:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12333438/comment/12413127","id":"12413127","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"I think you may have forgotten to add the new file SubBaseJDBCTestCase using svn add, so it is not showing up in the diff / stat file.\r\n\r\n1. I guess some code refers to a class which is not part of the runtime library for the VM. Do you know if  javax.sql.ConnectionPoolDataSource is part of the class library for the VM ? \r\n2. I guess it could be ok, however I have not seen the code yet.\r\n\r\nDo you have a stack trace for the error ? I think it could be in the .tmp file for the test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-24T21:35:52.000+0000","updated":"2006-05-24T21:35:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12333438/comment/12413143","id":"12413143","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching a patch - DERBY-1308_2_20060524.* - that actually has the SubBaseJDBCTestCase.java in it.\r\n\r\nThere never is a stack trace - the only output one sees is like this:\r\nfor wctme5.7 (j9 2.2) jvm: \r\n> Failed to invoke suite():java.lang.NoClassDefFoundError: javax.sql.DataSource\r\nfor wctme5.7_foundation:\r\n> Failed to invoke suite():java.lang.NoClassDefFoundError: javax.sql.ConnectionPoolDataSource\r\n\r\nAnd that is the complete contents of the .tmp also.\r\n\r\nIf anyone has a suggestion on where I can add a printStack trace so I can see more please let me know.\r\n\r\nIf this is ok, how about the name, any quick suggestions for something more meaningful than SubBaseJDBCTestCase.java?\r\nI didn't want to change the name for BaseJDBCTestCase.java because it would involve changing various jdbc4 tests...\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-05-24T23:36:17.000+0000","updated":"2006-05-24T23:36:17.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12333438/comment/12413162","id":"12413162","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"|What was happening is that after the contribution of adding a number of methods returning these various datasources in |util/BaseJDBCTestCase.java these j9-jvms would fall over with a ClassDefNotFoundError. Apparently this happened as soon as a |method was added that returned one of these not-available classes, even though the tests in question did not actually use those |methods. \r\n\r\nI think that the methods added, should not be part of BaseJDBCTestCase. BaseJDBCTestCase should be usable in all environments, and if some special methods are needed, they could be made part of a subclass of BaseJDBCTestCase.\r\n\r\nTherefore: instead of introducing a new super class (called SubBaseJDBCTestCase), BaseJDBCTestCase should be simplified to only contain the methods which can be used in all environments. \r\nSince the added methods are static anyway, they do not even need to be part of the BaseTestCase hierarchy, i.e they could be in a utiltity class, however if you prefer to use inheritance, you could add a subclass of BaseJDBCTestCase with these methods (i.e if the methods are JDBC4 specific, the new subclass could be named BaseJDBC4TestCase). Then you would not need to change the SURTest, UpdateXXTest, .., to run in J2ME environment, however some of the JDBC4 testcase classes would need to be changed to inherit from BaseJDBC4TestCase.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-25T01:55:54.000+0000","updated":"2006-05-25T01:55:54.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12333438/comment/12413579","id":"12413579","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching patch DERBY-1308_3_20060527.*. In this patch, I moved the get*DataSource* methods from functionTests/util/BaseJDBCTestCase.java to a new file, functionTests/util/TestDataSourceFactory.java, and the method getDefaultSourceProperties into functionTests/util/TestConfiguration.java.\r\nI adjusted affected tests that I could find, and verified the affected tests where applicable  with wctme5.7, wsdd5.6, wctme5.7_foundation. jdk142 and jdk16.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-05-27T20:50:25.000+0000","updated":"2006-05-27T20:50:25.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12333438/comment/12413781","id":"12413781","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"The patch looks good. I have tested it on the jdbc40 test suite, and got no failures in the junit tests.\r\nA minor comment: utility classes like TestDataSourceFactory and TestUtil should have a private constructor to enforce noninstantiabilit, since these classes are not designed to be instantiated. Do not need to add it as part of this patch, it could be handled in a separate jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-30T15:39:12.000+0000","updated":"2006-05-30T15:39:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12333438/comment/12413822","id":"12413822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Committed revision 410267.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-05-30T19:54:26.000+0000","updated":"2006-05-30T19:54:26.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1308/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i071lr:"}}