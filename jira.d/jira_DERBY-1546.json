{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12346340","self":"https://issues.apache.org/jira/rest/api/latest/issue/12346340","key":"DERBY-1546","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-07-20 18:18:14.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22563","customfield_12310222":"3_*:*_1_*:*_59147000_*|*_1_*:*_1_*:*_525884000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_25175251044","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-07-27T07:26:55.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1546/watchers","watchCount":0,"isWatching":false},"created":"2006-07-20T12:56:24.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-05-14T16:34:26.042+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"}],"timeoriginalestimate":null,"description":"For 10.2 the DatabaseMetaData.getJDBCMajorVersion() is returning \"3\" for \nthe Derby JDBC 4.0 driver.  It should return 4.  This is easily \nreproduced by running a simple test to obtain a connection and \noutput the value,\n\nDatabase product: Apache Derby\nDatabase version: 10.2.0.4 alpha\nDriver name:      Apache Derby Embedded JDBC Driver\nDriver version:   10.2.0.4 alpha\nJDBC driver major version: 3\nJDBC driver minor version: 0\n\nTest code:\n\n        \norg.apache.derby.jdbc.EmbeddedConnectionPoolDataSource40 ds =\n            new \norg.apache.derby.jdbc.EmbeddedConnectionPoolDataSource40();\n\n        \nds.setDatabaseName(\"C:\\\\drivers\\\\derby\\\\databases\\\\JDBC40DB\");\n\n        ds.setUser(\"dbuser1\");\n        ds.setPassword(\"dbpwd1\");\n\n        PooledConnection pooledConn = \nds.getPooledConnection();\n        Connection conn = pooledConn.getConnection();\n\n        System.out.println(\"Database product: \" + \nconn.getMetaData().getDatabaseProductName());\n        System.out.println(\"Database version: \" + \nconn.getMetaData().getDatabaseProductVersion());\n        System.out.println(\"Driver name:      \" + \nconn.getMetaData().getDriverName());\n        System.out.println(\"Driver version:   \" + \nconn.getMetaData().getDriverVersion());\n        System.out.println(\"JDBC driver major version: \" + \nconn.getMetaData().getJDBCMajorVersion());\n        System.out.println(\"JDBC driver minor version: \" + \nconn.getMetaData().getJDBCMinorVersion());\n\n\nRelevant Derby Embedded code in EmbedDatabaseMetaData is:\n * JDBC 3.0\n    *\n    * Retrieves the major JDBC version number for this driver.\n    *\n    * @return JDBC version major number\n\t*/\n\tpublic int getJDBCMajorVersion()\n\t{\n\t\treturn 3;\n\t}\n\nand client code in org.apache.derby.client.am.DatabaseMetaData:\npublic int getJDBCMajorVersion() throws SQLException {\n        checkForClosedConnection();\n        return 3;\n    }\n\nI am not sure if this should be JVM dependent or if it should always return 4  regardless of the JVM version.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40037","summary":"Derby JDBC 4.0 driver returns 3 for JDBC driver major version","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12346340/comment/12422464","id":"12422464","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"This is the correct behavior if you are running on jvm 1.4 or 1.5.\r\n\r\nIf you are running on 1.6, the major version should be 4. It isn't, so this is a bug.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-07-20T18:18:14.000+0000","updated":"2006-07-20T18:18:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12346340/comment/12423665","id":"12423665","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"derby-1546-v1.diff makes getJDBCMajorVersion() return 4 when using the\r\nJDBC 4.0 driver and 3 otherwise (the method was not present in JDBC\r\n2.0, so there is no need to return 2 for the 2.0 driver).\r\n\r\nDescription of the changes:\r\n\r\n  * EmbedDatabaseMetaData40 and NetDatabaseMetaData40 override\r\n    getJDBCMajorVersion() and getJDBCMinorVersion().\r\n\r\n  * jdbcapi/dbMetaDataJdbc30.java was modified to print \"AS EXPECTED\"\r\n    instead of the returned value from the JDBC version methods (of\r\n    course, it prints something else if the version is not as\r\n    expected). This was done in order to avoid the need for separate\r\n    jdk16 canons.\r\n\r\n  * TestUtil.getJDBCMajorVersion() was updated to recognize JDBC major\r\n    version > 3.\r\n\r\n  * Fixed a bug in build.xml in functionTests/util. TestUtil.java is\r\n    incorrectly compiled with source and target level 1.4. It works\r\n    correctly after an 'ant clobber' because some other 1.3 class\r\n    depends on it and causes it to be compiled as part of another ant\r\n    target, but if TestUtil.java is the only file that needs\r\n    recompilation, jdk 1.4 is used.\r\n\r\nDerbyall runs cleanly (with the exception of the DERBY-1578 failures)\r\non Sun JVM 1.5 and 1.6. Reviews would be greatly appreciated! Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-07-26T15:04:23.000+0000","updated":"2006-07-26T15:04:23.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12346340/comment/12423667","id":"12423667","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Knut Anders. Thanks for the ample explanation of the changes. They look good to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-07-26T15:26:04.000+0000","updated":"2006-07-26T15:26:04.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12346340/comment/12423788","id":"12423788","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thank you for looking at the patch, Rick. Committed revision 425987.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-07-27T07:26:55.000+0000","updated":"2006-07-27T07:26:55.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1546/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i077uf:"}}