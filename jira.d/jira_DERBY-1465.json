{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12345203","self":"https://issues.apache.org/jira/rest/api/latest/issue/12345203","key":"DERBY-1465","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12310220":"2006-06-29 21:50:41.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22524","customfield_12310222":"1_*:*_1_*:*_28261092771_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_14532691_*|*_4_*:*_1_*:*_77908771050","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2009-11-09T19:57:08.512+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1465/watchers","watchCount":0,"isWatching":false},"created":"2006-06-29T20:17:12.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"15.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12310615","id":"12310615","description":"","name":"10.1.2.1","archived":false,"released":true,"releaseDate":"2005-11-18"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12316141","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12316141","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12364338","key":"DERBY-2412","self":"https://issues.apache.org/jira/rest/api/2/issue/12364338","fields":{"summary":"Refactor NetworkServerControlImpl","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-11-09T19:57:08.510+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11410","id":"11410","name":"Network Server"}],"timeoriginalestimate":null,"description":"NetworkServerControl.start()  will not throw an exception  if another server is already running on the same port.    I am not sure but think perhaps this was changed at  one point to accomodate the derby.drda.startNetworkServer property  so that the embedded server could continue to boot even if the network server failed to start, but  I think this is wrong for normal usage.\r\n\r\nhttp://www.nabble.com/Questions-about-Network-Server-API-Behavior-p5055814.html\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38295","summary":"NetworkServerControl.start() should throw an exception and not just  print  exceptions  if the server fails to start","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10422","value":"High Value Fix","id":"10422"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10101","value":"Release Note Needed","id":"10101"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":47,"total":47,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12418481","id":"12418481","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"body":"The relationship between the Network Server API and the derby.drda.startNetworkServer property (and its related functionality) is indeed puzzling. See my comment to DERBY-1326 (June 16th), particularly observation b), for another example:\r\n\r\nhttp://issues.apache.org/jira/browse/DERBY-1326#action_12416494\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"created":"2006-06-29T21:50:41.000+0000","updated":"2006-06-29T21:50:41.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12497621","id":"12497621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Attached is a patch for this issue.  I ran derbynetclientmats, derbynetmats and suites.All.\r\nI am a little unsure about this patch.  I wait only 5 seconds for any error to occur on startup.  It will catch the most common error that there is already another server on the same port, but still the server can't be verified as up until ping is successful.   I'll submit another patch for DERBY-1467 which allows a timeout to be specified.  That seems the preferred way to go.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-21T22:55:42.465+0000","updated":"2007-05-21T22:55:42.465+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12497924","id":"12497924","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The patch attached has a conflict with DERBY-2671, so needs to be redone.  Ignore the patch DERBY-1465_diff.txt\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-22T16:37:18.373+0000","updated":"2007-05-22T16:37:18.373+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12497984","id":"12497984","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Patch for this issue.  start() will now wait until the server has been started.  It will wait until just before the server started message prints to return and will throw an exception if one occurred. One possible problem with the existing.  One possible problem with the existing code is that it prints \"server started\" before launching the client thread.  If that needs to be moved, I will log it as a separate issue.\r\n\r\nderbynetmats, derbynetclientmats and suites.All passed.\r\nI'll commit this late today if I hear no comments, but I would appreciate if someone would take a look.\r\n\r\nThanks\r\n\r\nKathey","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-22T20:13:30.460+0000","updated":"2007-05-22T20:13:30.460+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498044","id":"12498044","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Committed revision 540779","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-22T22:35:24.738+0000","updated":"2007-05-22T22:35:24.738+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498051","id":"12498051","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Should the thread you create via this start method be a daemon thread? I couldn't really tell either way from the diff.\r\n\r\nIs it possible to add some comments to the code you added while it's fresh in your mind? At least on the\r\nserverStartComplete variable and its wait/notify. Give future readers some clue as to what is going on. :-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-05-22T23:00:46.820+0000","updated":"2007-05-22T23:00:46.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498057","id":"12498057","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thanks Dan for looking.\r\n\r\nI don't think it should be a daemon thread if I understand the concept of a daemon thread correctly.  I don't want the jvm to exit while this thread is running.   I'll add comments for serverStartComplete.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-22T23:15:23.584+0000","updated":"2007-05-22T23:15:23.584+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498058","id":"12498058","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Could you also explain the lifetime of this new thread then?\r\n\r\nDoes this change mean that starting the network server now has an extra Thread for the lifetime of the network server?\r\n\r\nDoes it mean a change in behaviour where previously the JVM could exit but now it cannot until the network server is shutdown?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-05-22T23:33:06.159+0000","updated":"2007-05-22T23:33:06.159+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498061","id":"12498061","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Dan asked:\r\n>Could you also explain the lifetime of this new thread then?\r\n>Does this change mean that starting the network server now has an extra Thread for the lifetime of the network server? \r\n\r\nNo.  We used to start with DRDAServerStarter which made a thread to start network server. Now NetworkServerControl\r\n\r\nold:\r\nNetworkServerControl.start() called DRDAServerStarter which started a thread calling blockingStart.  blockingStart would log any exceptions.\r\n\r\nnew:\r\nNetworkServerControl.start() creates its own thread calling blockingStart and throws any exceptions that occur during the startup phase.  To determine the end of the startup phase it waits on serverStartComplete. \r\nIf start is  successful ...\r\n When blockingStart gets to the point that it would print the server is up, it notifies serverStartComplete so the start method can return or throw any exception that occurred and waits to be shutdown.\r\n\r\nIf start fais....\r\nblockingStart will throw an exception, notify serverStartComplete  and the thread will end.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-22T23:53:50.930+0000","updated":"2007-05-22T23:53:50.930+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498068","id":"12498068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"The old thread was started as a daemon thread, in derby's daemon thread group, but this new thread isn't (for either).\r\n\r\nI think Bryan was trying to clean up the code to start the network server, I wonder if that has progressed to be useable, because this is adding another mechanism to start the server in already confused code.\r\n\r\nThere are a couple of timing bugs in the wait code:\r\n\r\n - There is a chance the server can fail to start but the start method will not throw any exceptions.\r\nThis is because the waiter is notified before 'runtimeException' is set, thus the waiter may see runtimeException as null and not throw an exception.\r\n\r\n- There is a chance the start() method will hang, if the spawned thread reaches the notifyAll() before the start() call reaches the wait().\r\n   The standard way to avoid this is to include boolean state information, so that the sync calls are like:\r\n            \r\n\t\t\tsynchronized (serverStartComplete) {\r\n                                completedBoot = true;\r\n\t\t\t\tserverStartComplete.notifyAll();\r\n\t\t\t}\r\n\r\n\r\n\r\n      \t\t     synchronized(serverStartComplete){\r\n                        while (!completedBoot )\r\n\t\t    \t      serverStartComplete.wait();\r\n\t\t    }\r\n\r\nI wonder if the code could be modifed slightly to use the old thread, rather than creating a new thread ...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-05-23T01:04:41.990+0000","updated":"2007-05-23T01:04:41.990+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498084","id":"12498084","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"There are some issues with the change noted in Dan's comments.  Backing out the change and reopen until those can be resolved.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-23T02:37:37.449+0000","updated":"2007-05-23T02:37:37.449+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498287","id":"12498287","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Dan said\r\n>I think Bryan was trying to clean up the code to start the network server, I wonder if that has progressed to be >useable, because this is adding another mechanism to start the server in already confused code.\r\n\r\nI think actually it was Bernt who was working on rewriting NetworkServerControlImpl.  I agree that it makes sense to wait until that work is done and see if it perhaps resolves this issue.  My hope was to get it resolved for 10.3 because we already have a bunch of Network Server incompatible changes and if this is going to affect anyone, it is better to have one big hit with 10.3 instead of hitting users again with 10.4. Bernt do you ...\r\n1) expect your rewrite of NetworkServerControlImpl to go in for 10.3?\r\n2) think your changes will address this issue.\r\n\r\nKathey\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-23T16:31:42.961+0000","updated":"2007-05-23T16:31:42.961+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498595","id":"12498595","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"body":"1) I am not going to finish the rewrite of NetworkServerControlImpl for 10.3 (DERBY-2412). My approach to keep the internal code an chop the class into smaller pieces proved not to solve the basic problems. We need to rewrite some basic mechanisms (e.g. exception handling and reporting) first. I plan to do the rewrite for the next release.\r\n2) Yes (or at least make it much easier to fix it).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"created":"2007-05-24T11:26:24.176+0000","updated":"2007-05-24T11:26:24.176+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12498734","id":"12498734","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Per Dan's recommendation, I think I will hold off on this issue until Bernt's changes go in.  Unassigning myself for now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-05-24T17:41:35.648+0000","updated":"2007-05-24T17:41:35.648+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12641992","id":"12641992","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Since Bernt has now (see update to DERBY-2412) no plans to complete redesign of NetworkServerControlImpl, I was thinking it might make sense to revisit this issue.\r\n\r\nHowever, I am not sure about one of Dan's comments:\r\n\" wonder if the code could be modifed slightly to use the old thread, rather than creating a new thread ... \"\r\n\r\nI can imagine DRDAServerStarter.boot(...) carrying an additional parameter to indicate whether to throw an exception or not, is that what was meant? Or is there another solution?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-10-22T23:02:33.578+0000","updated":"2008-10-22T23:02:33.578+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12647120","id":"12647120","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I'm attaching a patch for this issue...\r\nIt's basically Kathey's latest patch, but with the synchronization changes suggested by Dan, and the Thread has been made a daemon thread.\r\nThere's also some extra comments.\r\n\r\nI tried to make DRDAServerStarter.boot carry an extra parameter, and based on that parameter, exceptions got thrown as well as logged, but the exception in the test (NSinSameJVMTest fixture testShutdown has a new test case) came from DRDAServerStarter.run (invocationException), which did not allow me to throw a standard exception. Also, I felt the code got more convoluted and expansive.\r\n\r\nAnyone have another suggestion on how to fix this, or how Dan's comment (\"maybe the code could be slightly modified to use the old thread\") could be interpreted?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-11-12T23:36:11.708+0000","updated":"2008-11-12T23:36:11.708+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12648375","id":"12648375","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"No suggestions/comments so far. \r\nsuites.All ran without failures. I plan to commit this tomorrow.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-11-17T22:10:01.846+0000","updated":"2008-11-17T22:10:01.846+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12648611","id":"12648611","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I committed the latest patch with revision 718616.\r\n\r\nNow - this issue has 'release note needed' flagged, but I'm not certain why\r\nIt does need to be in the release notes, of course, but does this need a special explanation? It seems to me, that either way, the server is not started (as it's already started), and we're still also printing the exceptions, so I have some trouble seeing how this could affect existing applications. Any thoughts?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-11-18T14:36:34.613+0000","updated":"2008-11-18T14:36:34.613+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12648649","id":"12648649","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Applications may have only been expecting exceptions when they ping the server to see if it is is up, not from start() since start would always succeed before.  Applications need to be prepared for an exception to be thrown from start().\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-11-18T16:56:45.460+0000","updated":"2008-11-18T16:56:45.460+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12648682","id":"12648682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching a first attempt at a release note.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-11-18T18:10:36.431+0000","updated":"2008-11-18T18:10:36.431+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12648683","id":"12648683","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"pretty much the same release note, but replace reference to NetworkServerControlImpl.start() with NetworkServerControl.start()","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-11-18T18:12:55.952+0000","updated":"2008-11-18T18:12:55.952+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12648782","id":"12648782","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Release note looks fine to me.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-11-18T22:19:19.230+0000","updated":"2008-11-18T22:19:19.230+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12649102","id":"12649102","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I wanted to close this today, but I see in the nightlies that this has resulted in an intermittent failure - and with sun jdk 1.4.2, it's all over.\r\nI'll investigate.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-11-19T17:17:23.340+0000","updated":"2008-11-19T17:17:23.340+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12649448","id":"12649448","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching a patch that I think gets around the trouble the previous attempt caused in the nightly tests.\r\n\r\nHowever, I need to do some more research before I commit - I ran suites.All twice, once I got this failure:\r\n--------------------------------\r\n1) testStartStopManagementFromApplication(org.apache.derbyTesting.functionTests.tests.management.ManagementMBeanTest)junit.framework.AssertionFailedError: expected:<4> but was:<6>\r\n\tat org.apache.derbyTesting.functionTests.tests.management.ManagementMBeanTest.startStopManagement(ManagementMBeanTest.java:76)\r\n\tat org.apache.derbyTesting.functionTests.tests.management.ManagementMBeanTest.testStartStopManagementFromApplication(ManagementMBeanTest.java:56)\r\n--------------------------------\r\nI think I get this intermittently, so this may be unrelated.\r\nBut once I got a hang after an error:\r\n--------------------------------\r\ntestXAConnection used 0 ms EEjava.lang.Exception: DRDA_InvalidReplyTooShort.S:Invalid reply from network server: Insufficient data.\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.consolePropertyMessageWork(Unknown Source)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.consolePropertyMessage(Unknown Source)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.fillReplyBuffer(Unknown Source)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.readResult(Unknown Source)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.pingWithNoOpen(Unknown Source)\r\n\tat org.apache.derby.impl.drda.NetworkServerControlImpl.ping(Unknown Source)\r\n\tat org.apache.derby.drda.NetworkServerControl.ping(Unknown Source)\r\n\tat org.apache.derbyTesting.junit.NetworkServerTestSetup.pingForServerUp(NetworkServerTestSetup.java:561)\r\n\tat org.apache.derbyTesting.junit.NetworkServerTestSetup.pingForServerStart(NetworkServerTestSetup.java:630)\r\n\tat org.apache.derbyTesting.junit.NetworkServerTestSetup.setUp(NetworkServerTestSetup.java:191)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:18)\r\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)\r\n\tat junit.extensions.TestSetup$1.protect(TestSetup.java:19)\r\n\tat junit.framework.TestResult.runProtected(TestResult.java:124)\r\n\tat junit.extensions.TestSetup.run(TestSetup.java:23)\r\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\r\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\r\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\r\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\r\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\r\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\r\n\tat junit.framework.TestSuite.runTest(TestSuite.java:208)\r\n\tat junit.framework.TestSuite.run(TestSuite.java:203)\r\n\tat junit.textui.TestRunner.doRun(TestRunner.java:116)\r\n\tat junit.textui.TestRunner.start(TestRunner.java:172)\r\n\tat junit.textui.TestRunner.main(TestRunner.java:138)\r\n--------------------------------","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-11-20T19:10:08.373+0000","updated":"2008-11-20T19:10:08.373+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12652477","id":"12652477","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching another patch - it has only 2 differences vs. patch diff4;\r\n1. setting runtimeException to null at the top of start (or the exception might not get cleared out)\r\n2. add some comments","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-02T19:45:10.234+0000","updated":"2008-12-02T19:45:10.234+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12652479","id":"12652479","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I have not seen the hang anymore on my own machine; however, it seems that since my check-in of November 18, tests are hanging regularly in nightlies on windows, see: http://people.apache.org/~myrnavl/derby_test_results/main/windows/index.html\r\n\r\nI don't understand the hang, so I don't have a solution...\r\n\r\nI have two approaches currently;\r\n1. check in the latest patch\r\n2. back out my first change\r\n\r\nOr is there someone who can spot a mistake in the (patch) code?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-02T19:50:54.269+0000","updated":"2008-12-02T19:50:54.269+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12652511","id":"12652511","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"body":"I am also seeing this, after November 18, on \r\n\r\nRed Hat Enterprise Linux AS release 4 (Nahant Update 3) 64bits\r\nLinux 2.6.9-34.ELsmp #1 SMP Fri Feb 24 16:56:28 EST 2006 GNU/Linux\r\nand\r\nSolaris 10 5/08 s10x_u5wos_10 X86 64bits\r\nSunOS 5.10 Generic_127128-11\r\n\r\nwith\r\nSun Microsystems Inc.\r\njava version \"1.5.0_14\"\r\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_14-b03)\r\nJava HotSpot(TM) Client VM (build 1.5.0_14-b03, mixed mode)\r\n\r\nSee e.g.\r\nhttp://dbtg.thresher.com/derby/test/trunk15/jvm1.5/testing/testlog/SunOS-5.10_i86pc-i386/722171-org.apache.derbyTesting.functionTests.suites.All_diff.txt\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"created":"2008-12-02T21:12:42.378+0000","updated":"2008-12-02T21:12:42.378+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12652551","id":"12652551","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I couldn't figure out off hand where the trouble is that causes the hang. Somehow, it seems there is no ClientThread running to handle the clients' requests, and thus, the whole thing hangs - can't start a new server, can't connect to the current one, can't shut it down.\r\n\r\nI've backed out the changes of revision 718616 with revision 722639.\r\n\r\nSorry for all the trouble.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-02T22:27:13.207+0000","updated":"2008-12-02T22:27:13.207+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12654796","id":"12654796","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I don't know why it hung, but since blockingStart() calls startNetworkServer() before the try/finally block, it's possible that an exception is thrown without completedBoot being set to true, which will leave the main thread waiting forever.\r\n\r\nIt also looks like #718616 did not address this comment (by Dan):\r\n>  - There is a chance the server can fail to start but the start method will not throw any exceptions.\r\n> This is because the waiter is notified before 'runtimeException' is set, thus the waiter may see runtimeException as null and not throw an exception.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2008-12-09T13:22:18.005+0000","updated":"2008-12-09T13:22:18.005+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12656691","id":"12656691","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching a next iteration - DERBY-1465.diff6\r\n\r\nDan's comment cited by Knut Anders:\r\n\"There is a chance the server can fail to start but the start method will not throw any exceptions, because the waiter is notified before 'runtimeException' is set, thus the waiter may see runtimeException as null and not throw an exception\"\r\nwas actually addressed by patch 4.\r\n(patch 5 corrected the fact that the runtimeException never got set to null, so you'd get that message all the time).\r\n\r\nPatch 6 I think addresses the second logic issue spotted by Knut Anders:\r\n\"since blockingStart() calls startNetworkServer() before the try/finally block, it's possible that an exception is thrown without completedBoot being set to true, which will leave the main thread waiting forever\"\r\nThis is addressed by (simply) setting completedBoot to true when an error is encountered. \r\n\r\nI ran NSinSameTest withouth problems 50 times (this at one time would reproduce the hang occassionally). I ran suitesall 4 times on 2 different windows machines, and derbyall once, and I hit the following known problems:\r\n- DERBY-654; derbyall: unit/T_RawStoreFactory.unit\r\n< -- Unit Test T_RawStoreFactory finished\r\n 2 add\r\n > There should be 0 observers, but we still have 1 observers.\r\n> Shutting down due to unit test failure.\r\n   (maybe this is a j9 technology issue rather than j2me).\r\n- DERBY-3915: \r\n1) testReplication_Local_3_p3_StateNegativeTests\r\n(org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_3_p3)\r\njunit.framework.AssertionFailedError: Expected SQLState'08004', but got connection!\r\n-  DERBY-3689:\r\n1) testAttributeAccumulatedConnectionCount(org.apache.derbyTesting.functionTests.tests.management.NetworkServerMBeanTest)\r\njava.security.PrivilegedActionException: javax.management.InstanceNotFoundException: \r\n- DERBY-3757:\r\n1) testStressMulti(org.apache.derbyTesting.functionTests.tests.multi.StressMultiTest)junit.framework.AssertionFailedError: \r\nCaused by: \r\njava.sql.SQLException: Java exception: 'ASSERT FAILED transaction table has null entry: \r\norg.apache.derby.shared.common.sanity.AssertFailure'.\r\n\r\nIn addition, I got: \r\n1) ttestSetPortPriority(org.apache.derbyTesting.functionTests.tests.derbynet.ServerPropertiesTest)\r\njunit.framework.AssertionFailedError: failed to start server with port 1529\r\n\tat org.apache.derbyTesting.functionTests.tests.derbynet.ServerPropertiesTest.checkWhetherNeedToShutdown(ServerPropertiesTest.java:378)\r\nI think this is probably the same as DERBY-3873, or DERBY-2779, but because we now throw the Exception when the server doesn't start, we see the problem earlier. Which is exactly what this fix is intended to do.\r\n\r\nSo I think this is ok now.\r\n\r\nReady for review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-15T18:44:51.223+0000","updated":"2008-12-15T18:44:51.223+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12657045","id":"12657045","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"In patch 6, completedBoot is set to true in the catch block in\r\nstartNetworkServer() after consolePropertyMessage() has been\r\ncalled. If I understand the code in consolePropertyMessage()\r\ncorrectly, it will in many cases throw an exception in addition to\r\nprinting a message to the console, in which case completedBoot is not\r\nset to true. And I guess notifyAll() would have to be called there as\r\nwell.\r\n\r\nShould completedBoot also be reset when runtimeException is reset?\r\n\r\nPerhaps this is a more robust approach:\r\n\r\n  1) Remove the runtimeException instance variable, and don't set it\r\n     in blockingStart()\r\n\r\n  2) Move the setting of completedBoot out of the finally block in\r\n  blockingStart(), and don't set it in startNetworkServer(), so that\r\n  it's only set if there was no error\r\n\r\n  3) Put this in the start() method:\r\n\r\n    completedBoot = false; // reset before we boot\r\n    final Exception[] exceptionHolder = new Exception[1];\r\n    .\r\n    .\r\n    .\r\n    Thread t = new Thread(\"NetworkServerControl\") {\r\n        public void run() {\r\n            try {\r\n                blockingStart(consoleWriter);\r\n            } catch (Exception e) {\r\n                synchronized (serverStartComplete) {\r\n                    exceptionHolder[0] = e;\r\n                    serverStartComplete.notifyAll();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    .\r\n    .\r\n    .\r\n    t.start();\r\n    // wait until the server has started successfully\r\n    // or an error has been detected\r\n    synchronized (serverStartComplete) {\r\n        while (!completedBoot && exceptionHolder[0] == null) {\r\n            serverStartComplete.wait();\r\n        }\r\n    }\r\n    if (!completedBoot) {\r\n        // boot was not successful, throw the exception\r\n        throw exceptionHolder[0];\r\n    }\r\n\r\nWith this approach, we make the tracking of the exception simpler (all\r\nexception handling is local to the start() method), and since\r\ncompletedBoot is only set on successful boot, we don't need to track\r\ndown all error paths where it needs to be set.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2008-12-16T16:30:52.189+0000","updated":"2008-12-16T16:30:52.189+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12657477","id":"12657477","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Thanks for the suggestions.\r\n\r\nI implemented them with this latest patch.\r\nI saw no new failures with this and no hangs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-17T18:42:24.292+0000","updated":"2008-12-17T18:42:24.292+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12658653","id":"12658653","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks for making the changes, Myrna.\r\n\r\nI think the entire synchronization block, including the call to notifyAll(), should be moved out of the finally block along with the setting of completedBoot to true in blockingStart(). It's probably going to work without that change, but the setting of completedBoot and the call to notifyAll() belong together logically, so I think it would be clearer if they were located the same place in the code.\r\n\r\nOtherwise, the patch looks good to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2008-12-22T20:29:59.296+0000","updated":"2008-12-22T20:29:59.296+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12658655","id":"12658655","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Just one tiny nit in the test. We have this code:\r\n\r\n+        } catch (Exception e) {\r\n+            assertTrue(e.getMessage().indexOf(\"java.net.BindException\") > 1);\r\n+        }\r\n\r\nPerhaps it's better with something like this (untested):\r\n\r\ncatch (Exception e) {\r\n    boolean ok = false;\r\n    for (Throwable t = e; t != null; t = t.getCause()) {\r\n        if (t instanceof java.net.BindException) {\r\n            ok = true;\r\n            break;\r\n        }\r\n    }\r\n    if (!ok) {\r\n        throw e;\r\n    }\r\n}\r\n\r\nThe advantage is that we keep the original exception if it's not the one we expected, and that we don't depend on the contents of the message text (don't know, but it may perhaps vary between different JVMs).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2008-12-22T20:40:10.745+0000","updated":"2008-12-22T20:40:10.745+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12659007","id":"12659007","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I'm still looking at the previous comment, but the last comment throws me for a loop.\r\n\r\nIn the latest patch, using the exceptionHolder array as suggested and not using a global variable to hold the exception, we do not know what kind of exception it is in the start() method. So we can't actually check for the BindException class in the test, all we have there is a java.lang.Exception.\r\n\r\nWhen we use a global variable (we used runtimeException in earlier patches), and assign the Exception underlying the PrivilegedActionException at the top of the privilegedException block to it, then the cause of the Exception, at least  for IOExceptions (i.e. in the case of the java.net.BindException the test is forcing) is saved off. Like so:\r\n\t\t} catch (PrivilegedActionException e) {\r\n\t\t\tException e1 = e.getException();\r\n\t\t\truntimeException = e1;\r\n\r\nI could reinstate the runtimeException, and in the start() method do some tomfoolery like:\r\n                        if (runtimeException != null)\r\n                            exceptionHolder[0] = runtimeException;\r\n                        else\r\n                            exceptionHolder[0] = e; \r\nThen I can check for the bindException instance in the test...But that's reintroducing the global variable...\r\nWhat is the better approach?\r\nI do like the fact that with the global variable you can actually check for IOExceptions in the test (and thus app) code, gives more info/control...But maybe it's enough to have an Exception?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-24T00:23:08.881+0000","updated":"2008-12-24T00:23:08.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12659110","id":"12659110","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Right, I assumed that the BindException was in the exception chain, but I see now that that's not the case. If we just want to preserve the exception in case it's an unexpected one in the test, we could simply do this and ignore that we don't really have a BindException in the chain:\r\n\r\ncatch (Exception e) {\r\n    if (e.getMessage().indexOf(\"java.net.BindException\") == -1) {\r\n        throw e;\r\n    }\r\n}\r\n\r\nAs to the issue of preserving the original exception when a BindException (or any other exception) is thrown, I think the problem here is that consolePropertyMessage() only takes the message to print as an argument. Since it in many cases generates and throws a new exception, it should also take the underlying exception as an argument, and it should either re-throw it or put it in the chain with initCause() so that we preserve the stack trace of the root cause. It doesn't have to be fixed as part of this issue, but I think it would be worth fixing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2008-12-24T16:03:55.746+0000","updated":"2008-12-24T16:03:55.746+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12659141","id":"12659141","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Yes, it would be better if consolePropertyMessage passed on the underlying Exception.\r\n\r\nI'll create one last patch modifying just the start and blockingStart methods and changing the test - then (after one more test cycle) commit that.\r\n\r\nI can then look into the consolePropertyMessage change - and will decide then whether to do it as part of this issue in a follow up commit or log a new issue.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-24T18:48:04.107+0000","updated":"2008-12-24T18:48:04.107+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12659183","id":"12659183","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"uploading patch diff8, which addresses further comments, as discussed, in the start and blockingStart methods of NetworkServerControlImpl, and the NSinSameJVMTest, but doesn't try to modify consolePropertyMessage method.\r\n\r\nsuites.all passed without mishap.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-25T03:33:56.544+0000","updated":"2008-12-25T03:33:56.544+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12659316","id":"12659316","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"diff8 looks fine to me. +1 to commit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2008-12-27T09:11:50.028+0000","updated":"2008-12-27T09:11:50.028+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12659585","id":"12659585","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I committed diff8 with revision 729933. If no hangs are reported in a week I'll consider this part done...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-29T16:36:02.668+0000","updated":"2008-12-29T16:36:02.668+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12659851","id":"12659851","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Well, it seems there still is a hang.\r\n\r\nWith ibm142 on another machine than where I ran my tests before, suites.All is hanging (it's been at it for about 11 hours, should take about 5 hours on this particular machine) - the test run seems wedged currently in testReplication_Local_existingTestsAsReplLoad.\r\n\r\nI'll back out my changes...(again). Apologies for the trouble.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-12-30T17:10:29.339+0000","updated":"2008-12-30T17:10:29.339+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12661345","id":"12661345","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"On Dec 30, I also ran with ibm15 and ibm16 on the same machine, and although ibm16 ran through without trouble, the ibm15 run got wedged in StressMultiTest.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-01-06T21:24:09.584+0000","updated":"2009-01-06T21:24:09.584+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12661347","id":"12661347","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching stack traces of the javacore dump I caused to be generated while the test was hanging in the replication test.\r\n\r\nThe db_master dir had a derby.log in it with the following:\r\n---------------------\r\n2008-12-30 09:05:59.447 GMT : Could not listen on port 1527 on host 0.0.0.0:\r\n java.net.BindException: Address already in use: NET_Bind\r\n---------------------\r\n\r\nThis is probably one of the faster machines I run on...(2 cpu,  3.40 Ghz).\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-01-06T21:29:55.413+0000","updated":"2009-01-06T21:29:55.413+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12661373","id":"12661373","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching a java core dump of the test run that hung with ibm15. \r\n\r\nI only now noticed that there were a number (15 to 20) of Errors both with ibm142 and ibm15, starting with the fixture testGrantAndRevoke. But of course there is no list of these at the bottom of the output, because I killed the test run...\r\n\r\nUnfortunately, there is no 'fail' directory, not sure why not...\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-01-06T23:32:56.125+0000","updated":"2009-01-06T23:32:56.125+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12731917","id":"12731917","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I think this issue was possibly blocked by DERBY-4053, or perhaps DERBY-4034, or the additional bind error and hang described in https://issues.apache.org/jira/browse/DERBY-4155?focusedCommentId=12731086&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_12731086.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-07-16T12:19:06.279+0000","updated":"2009-07-16T12:19:06.279+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12768855","id":"12768855","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I have been thinking about this issue which I filed back in Jan, 2006.  At the time it seemed to make sense, but now the compatibility risks seem significant, now that Derby has been out for years. I think by now folks have figured out that they need to ping the server to determine if it is up. If it now starts throwing an exception it might cause problems.\r\n\r\nI think Myrna's work on this issue has been valuable as it helped expose the issues mentioned in the previous comment, but I am beginning to think we should close this won't fix.  There had been talk about a new API for network server to replace the one that we have, if we do that then the exception on start issue can be taken under consideration.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-10-22T20:11:33.246+0000","updated":"2009-10-22T20:11:33.246+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12345203/comment/12775098","id":"12775098","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Closing as won't fix after reporter's reconsidering.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2009-11-09T19:57:08.468+0000","updated":"2009-11-09T19:57:08.468+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1465/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06x3b:"}}