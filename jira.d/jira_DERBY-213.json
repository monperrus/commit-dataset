{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"31588","self":"https://issues.apache.org/jira/rest/api/latest/issue/31588","key":"DERBY-213","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-05-31 20:54:33.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21838","customfield_12310222":"3_*:*_1_*:*_7267773000_*|*_1_*:*_1_*:*_4885679000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_2_*:*_12870309000_*|*_4_*:*_1_*:*_227000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2005-08-30T21:28:01.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-213/watchers","watchCount":0,"isWatching":false},"created":"2005-04-11T10:43:24.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"13.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12310605","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12310605","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12314007","key":"DERBY-545","self":"https://issues.apache.org/jira/rest/api/2/issue/12314007","fields":{"summary":"Should ResultSet Close implicitly?","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-01-26T01:49:52.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"Network Server closes the result set if ResultSet.next() is \ncalled after the last row of the result set.  The test code \nbelow throws the following exception.\n\nSQLState:   null\nSeverity: -99999\nMessage:  Invalid operation: result set closed\ncom.ibm.db2.jcc.am.SqlException: Invalid operation: result set \nclosed\n        at \ncom.ibm.db2.jcc.am.ResultSet.checkForClosedResultSet(ResultSet.j\nava:3419)\n        at \ncom.ibm.db2.jcc.am.ResultSet.nextX(ResultSet.java:290)\n        at \ncom.ibm.db2.jcc.am.ResultSet.next(ResultSet.java:277)\n        at AfterLast.test(AfterLast.java:75)\n        at AfterLast.main(AfterLast.java:32)\n\n\nstmt.executeUpdate(\"CREATE  TABLE TAB ( I INT)\");\nstmt.executeUpdate(\"INSERT INTO TAB VALUES(1)\");\nstmt.executeUpdate(\"INSERT INTO TAB VALUES(2)\");\nString sql =\"SELECT * from tab\";\t\t\nps = conn.prepareStatement(sql);\nResultSet rs = ps.executeQuery();\nSystem.out.println(sql);\nwhile (rs.next())\nSystem.out.println(rs.getInt(1));\ntry {\n\tSystem.out.println(\"one more next\");\n\trs.next();\n\t\t}\n    catch (Exception e)\n\t\t{\n\t\tSystem.out.println(\"FAIL: next should return false not throw \nexception\");\n\t\te.printStackTrace();\n\t\t}\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40833","summary":"ResultSet.next() after last row of FORWARD_ONLY cursor throws an SQL Exception with Network Server","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[{"id":"12311127","key":"DERBY-343","self":"https://issues.apache.org/jira/rest/api/2/issue/12311127","fields":{"summary":"Clean up DRDA classes handling of OPNQRY options","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}}],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":25,"total":25,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/62525","id":"62525","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"This problem appears to be that if the client sends \r\nQRYCLSIMP_SERVER_CHOICE or doesn't send any QRYCLSIMP value, \r\nthe server will default to QRYCLSIMP_YES for fowrard only \r\ncursors.  I am not sure of the implications of changing it.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-04-11T10:43:50.000+0000","updated":"2005-04-11T10:43:50.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/66607","id":"66607","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"Stand alone java tests designed to illustrate the DERBY-213 bug. \r\n\r\nCreate: Creates the database for the server to use\r\nServer: Activates the server to listen for net connects\r\nClient: Operates in 3 modes - embedded, DerbyNet and DerbyNetClient. Currently only embedded is functioning as per the ResultSet API.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-05-31T20:54:33.000+0000","updated":"2005-05-31T20:54:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/66609","id":"66609","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"A modification to the resultset test to test for DERBY-213 issue","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-05-31T21:00:28.000+0000","updated":"2005-05-31T21:00:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/66894","id":"66894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"Just to mix things up a bit this morning I'll be doing the Summary for the IRC chat Kathey and I had at IRC://irc.freenode.net/#derby June 2, 9:00 a.m. PST about DERBY-213.\r\n\r\n* Talked about instances QRYCLSIMP in the DRDA Technical standard Version 3, Volume 1\r\n* Implemented a few small changes including the removal of the QRYCLSIMP value from DRDA statment to no observed ill effect.\r\n* Noted a bug in the Database.getDRDAStatement() method and assigned Philip to open a jira entry.\r\n* Discussed the merits of a closeImplicitly() method vs. the use of getQryclsimp() in conjunction with additional logic eventually rejecting closeImplictly().\r\n* Decided that \r\nif (getQryclsimp() != CodePoint.QRYCLSIMP_NO ... \r\nshould be \r\nif (getQryclsimp() == CodePoint.QRYCLSIMP_YES ... \r\neffectively changing the default setting to NOT close the ResultSet object implicitly unless the client specifies that the server should do so with a QRYCLSIMP_YES value.\r\n* Discovered that implementing this change had no effect on ResultSet implicit close behavior. Tested client server interaction while ignoring client input (overriding it with QRYCLSIMP_NO), same result.\r\n* Discussed tips on how I might better trace DRDA protocol behavior. Specifically through the use of the tracefile=trace.out in your connection url and derby.drda.debug in your derby.properties.\r\n* Concluded meeting and assigned tasks for the next meeting to be held June 3, 5:00 a.m. PST / 9:00 a.m. AST\r\n\r\nWe also decided that we would try this format for all future chat transcripts, posting the transcript to Jira as a file and providing the summary as a comment. Feel free to express any opinions on this chosen format.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-03T03:06:58.000+0000","updated":"2005-06-03T03:06:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/66895","id":"66895","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"Update to previous client submission.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-03T03:09:56.000+0000","updated":"2005-06-03T03:09:56.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/66896","id":"66896","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"Update on the previous resultset.java submission","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-03T03:11:36.000+0000","updated":"2005-06-03T03:11:36.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/66898","id":"66898","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"If Jira does not support multiple assignees, Philip Wilder can also be considered an assignee.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-03T03:17:09.000+0000","updated":"2005-06-03T03:17:09.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12312621","id":"12312621","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Phiip and I chatted on IRC today for a bit about DERBY-213\r\n\r\n* We determined that even if QRYCLSIMP is set to no on the server, the client will still throw an error.\r\n* We started to debug the client but came to no conclusion yet.\r\n* We decided to clean up the qryclsimp handling in the server. We will move the logic that handles determines whether to close the result set implicitly out of DRDAConnThread and into a  isQryCloseImplicit() method in DRDAResultSet.\r\n\r\nTranscript attached.\r\n\r\nNext meeting Tuesday June 7, 5am PST.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-06-04T15:08:07.000+0000","updated":"2005-06-04T15:08:07.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12312891","id":"12312891","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"DERBY-213 chat transcript for June 7, 2005\r\n\r\nSummary:\r\n\r\n* Discovered a typo in change file.\r\n* Decided a minor change to the new setOPNQRYOptions() was needed\r\n* Discussed differences in how DerbyNet and DerbyNetClient frameworks use the QRYCLSIMP value. DerbyNetClient does not appear to send any QRYCLSIMP value.\r\n* Decided that we should implement the proposed changes together. \r\n* In the course of implementing the changes we decided that:\r\n     - The setOPNQRYOptions method should be moved to DRDAResultSet with a delegation method in DRDAStatement\r\n     - The qryclsimp value in DRDAResultSet should be changed to private.\r\n* After finishing the changes decided that a subtask would be beneficial so that only the related functionality would be changed in the final DERBY-213 fix\r\n* Assigned tasks for next meeting and established next meeting time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-07T23:35:58.000+0000","updated":"2005-06-07T23:35:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12313042","id":"12313042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"IRC Chat 6/8/2005 Summary\r\n\r\nPhilip Wilder and Kathey Marsden\r\n\r\n* Looked at client side issues related to DERBY-213.\r\n* The client was closing  FORWARD_ONLY result sets after the last row. Also closing the resultset when the number of rows in setMaxRows is reached.\r\n* Determined that client should not be closing the result set in either case.  Changed the client accordingly  and are adding a test case using setMaxRows.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-06-08T22:46:31.000+0000","updated":"2005-06-08T22:46:31.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12313176","id":"12313176","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"IRC chat transcript June, 9 2005\r\n#########################\r\nSummary:\r\n\r\n* Noted Philip's first contribution to Derby Source (DERBY-343).\r\n* Addressed the importance of signing an Individual Contributor License Agreement.\r\n* Discussed Modifications to the resultset.java test class. Tests now check the functionality of statements that have a maximum number of rows set with the java.sql.Statement.setMaxRows(int) method and report how many rows were returned by a ResultSet.\r\n* Discussed the test failures caused by potential patch for Derby-213. Came to the conclusion that the test failures were likely harmless but assigned Philip the task of comparing the new DerbyNetClient .out files against the Embedded .out files for verification.\r\n* Reviewed Client/Server interaction and discovered that DRDAStatement.setMaxRows() functionality is handled only on the client side. Searched DRDA specs to find any evidence to the contrary to no success. Determined this is an issue that could use more analysis (later deciding to open a Jira Issue about it).\r\n* Toyed with the idea of assigning Philip the task of running StmtCloseFunTest.java against the DerbyNetClient Framework with the proposed modifications but eventually rejected it on the ground that this test is already run under the derbyall testsuite.\r\n* Assigned tasks and agreed upon next meeting time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-10T03:16:38.000+0000","updated":"2005-06-10T03:16:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12313632","id":"12313632","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"DERBY-213 chat transcript for June 13, 2005 \r\n\r\nBackground information:\r\nIt was the intention of both Kathey and I to release a patch to the development community June 10, 2005. However, prior to its release a problematic issue was identified.\r\n\r\nSummary: \r\n* Discussed the problem with the latest patch. While the patch solves the problem of closing the ResultSet implicitly the fix in question caused the ResultSet not to commit properly, as per java.sql.Connection.setAutoCommit() java documentation.\r\n* Discussed changes to the tester to help identify this new problem and ways in which the tester could be further improved. The tester now checks to see if any locks are held by the ResultSet post commit (using the org.apache.derby.diag.LockTable class) and the details of this lock.\r\n* Discussed alternatives to the current autocommit model and established the Client also needed to execute the autocommit logic inside the nextX() method.\r\n* Determined that the Client was not communicating with the Server as expected (commit was not successful) but not the cause.\r\n* Assigned tasks for the next meeting to be held on June 15, 2005. Kathey was to investigate the DRDA communications to establish why the auto commit was not functioning as expected. Philip was to organize all ResultSet behavior according to the JDBC specification in a coherent manner and research Derby locking policy for both client and embedded to establish where they differ.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-15T04:29:11.000+0000","updated":"2005-06-15T04:29:11.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12313634","id":"12313634","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"Expected ResultSet behavior as per JDBC specifications V1.0","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-15T04:33:04.000+0000","updated":"2005-06-15T04:33:04.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12313824","id":"12313824","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"***** Update *****\r\nIt would seem that the nature of the problem has changed. Stemming from our discussions surrounding the issue Kathey and I have come to the conclusion that the current method of ResultSet comitting is convoluted in some regards and broken in others. At the moment all of the Commit logic is found in the client.am.Result.closeX() method which is being called improperly on the final ResultSet.next() call and little effort is made to accommodate multiple ResultSets per Statement. In order to address this issue we propose the following 2 steps:\r\n\r\n1) Move the commit logic out of client.am.ResultSet, place it in client.am.Statement and generally adapt a format that more closely follows Embedded model. Hopefully in the days that follow I will be able to provide a more concrete implementation for analysis.\r\n\r\n2) Develop a series of tests that more fully probe the different combinations of commit functionality (ResultSet.CLOSE_CURSORS_AT_COMMIT vs ResultSet.HOLD_CURORS_ON_COMMIT, autoCommit == true vs autocommit == false, etc.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-16T22:44:21.000+0000","updated":"2005-06-16T22:44:21.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12313920","id":"12313920","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"Proposed Changes:\r\n\r\nThe following are a series of changes I propose to rectify the problem of Derby-213 and bring the client code more in line with Embedded. Initial tests look promising, but a full series of tests have not yet been developed. Any and all feedback is appreciated, sorry for the length.\r\n\r\n\r\n####################\r\nclient.am.Connection\r\n####################\r\n\r\nIn the method flowAutoCommit()\r\n-Change \r\nThe return value to boolean on successful flow which returns true on a successful flow.\r\n\r\n###################\r\nclient.am.Statement\r\n###################\r\n\r\n- Create new methods:\r\n    \r\n    /**\r\n     * Convenience method for resultSetCommitting(ResultSet, boolean)\r\n     * \r\n     * @see Statement#resultSetCommitting(ResultSet, boolean)\r\n     * @param closingRS The ResultSet to be closed\r\n     * @throws SqlException\r\n     */\r\n    public void resultSetCommitting(ResultSet closingRS) throws SqlException {\r\n    \tresultSetCommitting(closingRS, false);\r\n    }\r\n    \r\n    /**\r\n     * Method that checks to see if any other ResultSets are open. If not\r\n     * proceeds with the autocommit.\r\n     * \r\n     * @param closingRS The ResultSet to be closed\r\n     * @param writeChain A Boolean indicating whether this method\r\n     * is part of a chain of write from client to Server\r\n     * @throws SqlException\r\n     */\r\n    public void resultSetCommitting(ResultSet closingRS, boolean writeChain) throws SqlException {\r\n\r\n\t\t// If the Connection is not in auto commit then this statement completion\r\n\t\t// cannot cause a commit.\r\n\t\tif (!connection_.autoCommit_ || closingRS.autoCommitted_)\r\n\t\t\treturn;\r\n\r\n\t\t// If we have multiple results, see if there is another result set open.\r\n\t\t// If so, then no commit. The last result set to close will close the statement.\r\n\t\tif (resultSetList_ != null) {\r\n\t\t\tfor (int i = 0; i < resultSetList_.length; i++) {\r\n\t\t\t\tResultSet crs = resultSetList_[i];\r\n\t\t\t\tif (crs == null)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tif (!crs.openOnClient_)\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tif (crs == closingRS)\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t// at least one still open so no commit now.\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (writeChain) {\r\n\t\t\tconnection_.writeAutoCommit();\r\n\t\t} else {\r\n\t\t\tif (connection_.flowAutoCommit())\r\n\t\t\t\tclosingRS.markAutoCommitted();\r\n\t\t}\r\n\t}\r\n\r\n\r\n###################\r\nclient.am.ResultSet\r\n###################\r\n\r\nIn the method nextX()\r\n\r\n- Change \r\nif ((!isValidCursorPosition_ && cursor_ != null) || (statement_.maxRows_ > 0 && \r\n            \t\tcursor_.rowsRead_ > statement_.maxRows_)) { \r\n    isValidCursorPosition_ = false;\r\n...\r\nto\r\nif (statement_.maxRows_ > 0 && cursor_.rowsRead_ > statement_.maxRows_) { \r\n    isValidCursorPosition_ = false; \r\n}\r\n\r\nThis provides a simplification of the logic as there is no need to set isValidCursorPosition_ = false when\r\n!isValidCursorPosition_ == true\r\n\r\n-Remove\r\nA trailing '}' to insure that braces match\r\n\r\n- Change \r\n            if (!openOnServer_) {\r\nto\r\n            if (!isValidCursorPosition_ && !openOnServer_) {\r\n\r\nFollows from the first change.\r\n\r\n-Remove\r\ntry {\r\n    closeX(); // the auto commit logic is in closeX()\r\n} catch (SqlException sqle) {\r\n    sqlException = Utils.accumulateSQLException(sqle, sqlException);\r\n}\r\n\r\nThere should be no reference to closeX() in the ResultSet.nextX() method. If the ResultSetHoldability == ResultSet.CLOSE_CURSORS_AT_COMMIT then the ResultSet should close properly anyway.\r\n\r\n-Remove from \r\nif (isValidCursorPosition_) {\r\n    updateColumnInfoFromCache();\r\n    // check if there is a non-null SQLCA for the current row for rowset cursors\r\n    checkRowsetSqlca();\r\n    if (isBeforeFirst_) {\r\n       isFirst_ = true;\r\n    }\r\n    isBeforeFirst_ = false;\r\n} else {\r\n    isFirst_ = false;\r\n    return isValidCursorPosition_;\r\n}\r\nthe line \r\nreturn isValidCursorPosition_;\r\nfrom the else clause. For reasons that shall become apparent.\r\n\r\n-Remove \r\nif (!openOnClient_) {\r\n            isValidCursorPosition_ = false;\r\n        } else \r\n\r\nI'm confident that this can't actually happen because of the checkForClosedResultSet() call earlier\r\n\r\n-Add (immediately before the Return)\r\n\r\n        //An invalid cursor position is synonymous with a completed \r\n        //ResultSet thus we should make the call to \r\n        //statement_.resultSetComitting(this) for both FORWARD_ONLY\r\n        //and SCROLLABLE as per embedded behaviour\r\n        if (!isValidCursorPosition_)\r\n        \tstatement_.resultSetCommitting(this);\r\n\r\nIn the Method writeCloseAndAutoCommitIfNotAutoCommitted()\r\n\r\n- Change one of two things\r\n  * Remove autoCommitted_ = false;\r\n  This strikes me as misleading for a method called writeCloseAndAutoCommit*IfNotAutoCommitted*()\r\n  \r\n  * Change the name to writeCloseAndAutoCommit()\r\n  Acknowledges that a auto commit is necessary after a close regardless of its autocommit status and change the name to match the functionality. In conjuction with this change it would be necessary to change the method named \r\nflowCloseAndAutoCommitIfNotAutoCommitted() \r\nto\r\nflowCloseAndAutoCommit()\r\nand\r\nreadCloseAndAutoCommitIfNotAutoCommitted()\r\nto\r\nreadCloseAndAutoCommit()\r\n\r\n-Remove\r\n   writeAutoCommitIfNotAutoCommitted(); \r\n\r\n-Add\r\n   statement_.resultSetCommitting(this, true);\r\noutside the if block.\r\n\r\nThese two methods do similar things but the statement_.resultSetCommitting() method:\r\na) Places the commit logic within the Statement class which is where it belongs\r\nb) Checks to see if there are any open ResultSets before committing which I understand may not be necessary for the moment but could be useful for future compatibility. We do not wish to set the autoCommitted_ value to true because we are part of a write read chain and autoCommited_ will be set to true at the end.\r\n\r\nIn the method closeX()\r\n\r\n-Change\r\n\r\nif (openOnServer_) {\r\n    flowCloseAndAutoCommitIfNotAutoCommitted();\r\n} else {\r\n    flowAutoCommitIfNotAutoCommitted() // in case of early close\r\n}\r\nto\r\nif (openOnServer_) {\r\n    flowCloseAndAutoCommitIfNotAutoCommitted();\r\n} else {\r\n    statement_.resultSetCommitting(this);\r\n}\r\n\r\n-Remove\r\nflowAutoCommitIfLastOpenMultipleResultSetWasJustClosed();\r\n\r\nThe statement_.resultSetCommitting(this); already checks for multiple ResultSets and commits only if the the only open ResultSet is the ResultSet which called the method. \r\n\r\nRemove the method flowAutoCommitIfNotAutoCommitted()\r\nRemove the method flowAutoCommitIfLastOpenMultipleResultSetWasJustClosed()\r\n\r\nAdd a method\r\n    /**\r\n     * Getter used exclusively for testing purposes.\r\n     * \r\n     * @return autoCommited_\r\n     */\r\n    public boolean isAutoCommitted() {\r\n    \treturn autoCommitted_;\r\n    }\r\n\r\n####################\r\nimpl.jdbc.EmbedResultSet\r\n####################\r\n\r\n-Add\r\nInstance variable \r\nboolean isAutoCommitted\r\nfor testing Purposes\r\n\r\n-Add method\r\n\r\n\t/**\r\n\t * For testing purposes only. Returns whether this ResultSet has been\r\n\t * automatically committed\r\n\t * \r\n\t * @return isAutoCommitted.\r\n\t */\r\n\tpublic boolean isAutoCommitted() {\r\n\t\treturn isAutoCommitted;\r\n\t}\r\n\r\n####################\r\nimpl.jdbc.EmbedStatement\r\n####################\r\n\r\nAt the bottom of the method \r\n\r\n- Add \r\n\t\t//For testing\r\n\t\tclosingLRS.isAutoCommitted = true;\r\n\r\n#####################\r\nderbyTesting.functionTests.tests.jdbcapi.resultTest\r\n#####################\r\n\r\nThe tests to insure the code is operating are somewhat generally simple in their format yet difficult in that there are a number of them and there is little that can be done in the way of code reuse. I propose a series of tests akin to this format:\r\n\r\n\t private static void runTests(Connection conn) throws SQLException {\r\n\t \tStatement s = conn.createStatement();\r\n\t \tResultSet rs = s.executeQuery(\"select tablename from sys.systables \" +\r\n\t \t\t\t\"where tablename = '\" + tableName.toUpperCase() + \"'\");\r\n\t \tif (rs.next()) {\r\n\t \t\trs.close();\r\n\t \t\ts.execute(\"delete from \" + tableName);\r\n\t \t} else {\r\n\t \t\trs.close();\r\n\t \t\ts.execute(\"create table \" + tableName + \" (num int)\");\r\n\t \t}\r\n\t \ts.execute(\"insert into \" + tableName + \" values (1)\");\r\n\t \ts.execute(\"insert into \" + tableName + \" values (2)\");\r\n            boolean commitVal = conn.getAutoCommit();\r\n\t \ttest1(conn); //test1 through testX\r\n\t \tconn.setAutoCommit(commitVal);\r\n\t \ts.execute(\"drop table \" + tableName);\r\n\t }\r\n\r\n\t /**\r\n\t  * Tests\r\n\t  * - autoCommit == true\r\n\t  * - resultSetType == TYPE_FORWARD_ONLY\r\n\t  * - holdability == HOLD_CURSORS_OVER_COMMIT\r\n\t  * - limit returned ResultSets == false\r\n\t  * \r\n\t  * @param conn\r\n\t  * @throws SQLException\r\n\t  */\r\n\t private static void test1(Connection conn) throws SQLException {\r\n\t \tSystem.out.print(\"test1: \");\r\n        conn.setAutoCommit(true);\r\n        Statement s = conn.createStatement(ResultSet.TYPE_FORWARD_ONLY, \r\n        \tResultSet.CONCUR_READ_ONLY, ResultSet.HOLD_CURSORS_OVER_COMMIT);\r\n\t \tResultSetWrapper rsw  = new ResultSetWrapper(s.executeQuery(\"select * from \" + tableName));\r\n\t \t\r\n\t \tint count = 0;\r\n\t \twhile (rsw.next()) count++;\r\n\t \t\r\n\t \tif (!rsw.isAutoCommitted()) {\r\n\t \t\tSystem.out.println(\"Failed. Not committed properly\");\r\n\t \t}\r\n\t \t\r\n\t \ttry {\r\n\t \t\tif (rsw.next())\r\n\t \t\t\tSystem.out.println(\"Failed. ResultSet returned true after last.\");\r\n\t \t\t\r\n\t \t\tif (count == 2)\r\n\t \t\t\tSystem.out.println(\"Succeeded\");\r\n\t \t\telse\r\n\t \t\t\tSystem.out.println(\"Failed. Unexpected row count of \" + count);\r\n\t \t\trsw.close();\r\n\t \t} catch (SQLException e) {\r\n\t \t\tSystem.out.println(\"Failed. Unexpected exception: \");\r\n\t \t\te.printStackTrace(System.out);\r\n\t \t} \r\n\t \ts.close();\r\n\t }\r\n\t \r\n\t \r\n\t /**\r\n\t  * This class provides me with a simple way of check if a ResultSet\r\n\t  * has been auto committed regardless of the underlying ResultSet \r\n\t  * being used\r\n\t  *  \r\n\t  * @author Philip Wilder\r\n\t  */\r\n\t private class ResultSetWrapper {\r\n\t \tpublic ResultSetWrapper(ResultSet rs) {\r\n\t \t\tif (rs instanceof org.apache.derby.client.am.ResultSet)\r\n\t \t\t\tclientRS = (org.apache.derby.client.am.ResultSet)rs;\r\n\t \t\telse if (rs instanceof org.apache.derby.impl.jdbc.EmbedResultSet)\r\n\t \t\t\tembedRS = (org.apache.derby.impl.jdbc.EmbedResultSet)rs;\r\n\t \t\t\r\n\t \t\tthis.rs = rs;\r\n\t \t}\r\n\t \t\r\n\t \tpublic boolean next() throws SQLException {\r\n\t \t\treturn rs.next(); \r\n\t \t}\r\n\t \t\r\n\t \tpublic void close() throws SQLException {\r\n\t \t\trs.close();\r\n\t \t}\r\n\t \t\r\n\t \tpublic String getAutoCommittedString() {\r\n\t \t\tif (clientRS != null)\r\n\t \t\t\treturn clientRS.isAutoCommitted() ? \"true\" : \"false\";\r\n\t \t\telse if (embedRS != null) \r\n\t \t\t\treturn embedRS.isAutoCommitted() ? \"true\" : \"false\";\r\n\t \t\telse\r\n\t \t\t\treturn \"Unknown\";\r\n\t \t}\r\n\t \t\r\n\t \tpublic boolean isAutoCommitted() {\r\n\t \t\tif (clientRS != null)\r\n\t \t\t\treturn clientRS.isAutoCommitted();\r\n\t \t\telse if (embedRS != null)\r\n\t \t\t\treturn embedRS.isAutoCommitted();\r\n\t \t\telse\r\n\t \t\t\treturn false;\r\n\t \t}\r\n\t \t\r\n\t \tprivate org.apache.derby.client.am.ResultSet clientRS = null;\r\n\t \tprivate org.apache.derby.impl.jdbc.EmbedResultSet embedRS = null;\r\n\t \tprivate ResultSet rs = null;\r\n\t }\r\n\t \r\n\t private String tableName = \"commitTestTable\";","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-06-18T05:24:12.000+0000","updated":"2005-06-18T05:24:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12318487","id":"12318487","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"An interim patch to bring client in line with embedded. Includes the following changes:\r\n- Additional tests in jdbcapi/resultset.java\r\n- Change to special flag to fix a small NullPointerException\r\n- modified output files for resultset.out, updatableResultSet.out, holdCursorJDBC30, forupdate.out\r\n- Changes to ResultSet, Statement and Connection in the org.apache.derby.client.am package. These changes have the following effects: \r\n      * FORWARD_ONLY ResultSets will no longer close implicitly after the last ResultSet has been retrieved. \r\n      * Checks to see if an auto-commit should be performed have been moved to Statement to mimic embedded functionality.\r\n      * Multiple ResultSets will now auto-commit if all ResultSets are closed if auto-commit is turned on.\r\n\r\nWhile the derbyall test suite was run with only one failure (since rectified), there are still a couple of issues worthy of consideration.\r\n- Connection.setAutoCommit() java documentation states \" In advanced cases, a single statement may return multiple results as well as output parameter values. In these cases, the commit occurs when all results and output parameter values have been retrieved.\" While my solution auto-commits when all ResultSets have been closed, it does not take into consideration output parameters. However, looking at the embedded implementation it does not look like embedded takes output parameters into consideration either.\r\n- The SVN patch tool seems to act very strangely for updatableResultSet.out, deleting then adding lines that were identical. I cannot account for this behavior.\r\n- CallableStatements are a new addition to the resultset.java test class. I felt it was an appropriate addition because I was still testing ResultSets (albeit multiple ResultSets) but I'm open to alternate suggestions.\r\n- The changes to jdbcapi/resultset.java are not particularly compatible with java 1.3.X as I make reference to change ResultSet holdability in multiple places. This did not appear to cause any problems but it is something to be aware of. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-08-11T22:38:34.000+0000","updated":"2005-08-11T22:38:34.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12319905","id":"12319905","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"I have attempted to address the concerns raised by Kathey's email:\r\nhttp://mail-archives.apache.org/mod_mbox/db-derby-dev/200508.mbox/%3c43038278.8000102@sbcglobal.net%3e\r\n\r\nPrimary changes are stripping down tests somewhat for simplicity, using a different method to check to see if auto-commit has occurred and changing some of the java documentation a bit to match the changes.\r\n\r\nRun successfully with derbyall","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-08-25T05:14:01.000+0000","updated":"2005-08-25T05:14:01.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12320415","id":"12320415","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Committed revision 264128.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-08-29T21:40:43.000+0000","updated":"2005-08-29T21:40:43.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12320441","id":"12320441","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"As of revision 264128 Client ResultSet functionality should match embedded. However, the JDBC Specification *may* indicate that a ResultSet should close implicitly on completion. My research into this issue has been inconclusive but I have no more leads to follow.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-08-30T02:40:54.000+0000","updated":"2005-08-30T02:40:54.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12320458","id":"12320458","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I tend to think it would be ok to close this as Fixed and open another  Jira entry for any outstanding issues,  because if you look at the description  ResultSet.next() after last row of FORWARD_ONLY cursor throws an SQL Exception with Network Server, you fixed it!\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-08-30T03:51:37.000+0000","updated":"2005-08-30T03:51:37.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12320566","id":"12320566","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"body":"As per Kathey's suggestion, I'm changing this resolution to fixed and creating issue DERBY-545 to assauge any lingering concerns I might have.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=acadia_student_01","name":"acadia_student_01","emailAddress":"050503w at acadiau dot ca","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Philip Wilder","active":true},"created":"2005-08-30T21:28:01.000+0000","updated":"2005-08-30T21:28:01.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12322883","id":"12322883","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"New Revision: 279420\r\n\r\nURL: http://svn.apache.org/viewcvs?rev=279420&view=rev\r\nLog:\r\nDERBY-213 additional checkin to rearrange tests\r\nMoved procedure tests to lang/procedure.java so that resultset.java \r\ncan run with J2ME\r\n\t\t\r\n\t","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-09-08T06:00:16.000+0000","updated":"2005-09-08T06:00:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12323099","id":"12323099","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Additional checkin for master update for jdk131\r\nDate: Fri Sep  9 18:26:34 2005\r\nNew Revision: 279930\r\n\r\nURL: http://svn.apache.org/viewcvs?rev=279930&view=rev","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-09-10T10:29:59.000+0000","updated":"2005-09-10T10:29:59.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12363960","id":"12363960","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The comments (and resolution=fixed) indicate that we should close this issue. Any objections?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-01-25T23:38:02.000+0000","updated":"2006-01-25T23:38:02.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31588/comment/12363978","id":"12363978","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"issue fixed.  There was still some outstanding discussion on autocommit behaviour in general but the original issue is fixed.  Thanks Philip!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-01-26T01:49:52.000+0000","updated":"2006-01-26T01:49:52.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-213/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07crb:"}}