{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12560051","self":"https://issues.apache.org/jira/rest/api/latest/issue/12560051","key":"MAHOUT-1030","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310751","id":"12310751","key":"MAHOUT","name":"Mahout","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310751&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310751&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310751&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310751&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13060","id":"13060","description":"Apache Mahout","name":"Mahout"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324577","id":"12324577","description":"Last release before 0.10.0, will contain the features for 0.10.0, the time between 0.9 and 0.10.0 is going to be used to stabilize the release","name":"0.9","archived":false,"released":true,"releaseDate":"2014-02-01"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-06-09 21:03:52.194","customfield_12312323":null,"customfield_12310420":"243581","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_47207415835_*|*_1_*:*_1_*:*_10174371_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-12-08T04:08:46.924+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAHOUT-1030/watchers","watchCount":9,"isWatching":false},"created":"2012-06-09T16:08:56.754+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"8.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12319261","id":"12319261","description":"Primarily a cleanup and refactoring release. Some new functionality which has been previously completed and tested may be introduced.","name":"0.7","archived":false,"released":true,"releaseDate":"2012-05-15"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-01-28T16:41:12.290+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312151","id":"12312151","name":"Clustering","description":"Bugs related to any of the clustering packages"},{"self":"https://issues.apache.org/jira/rest/api/2/component/12313154","id":"12313154","name":"Integration"}],"timeoriginalestimate":null,"description":"Looks like this won't make it into this build. Pretty widespread impact on code and tests and I don't know which properties were implemented in the old version. I will create a JIRA and post my interim results.\r\n\r\nOn 6/8/12 12:21 PM, Jeff Eastman wrote:\r\n> That's a reversion that evidently got in when the new ClusterClassificationDriver was introduced. It should be a pretty easy fix and I will see if I can make the change before Paritosh cuts the release bits tonight.\r\n>\r\n> On 6/7/12 1:00 PM, Pat Ferrel wrote:\r\n>> It appears that in kmeans the clusteredPoints are now written as WeightedVectorWritable where in mahout 0.6 they were WeightedPropertyVectorWritable? This means that the distance from the centroid is no longer stored here? Why? I hope I'm wrong because that is not a welcome change. How is one to order clustered docs by distance from cluster centroid?\r\n>>\r\n>> I'm sure I could calculate the distance but that would mean looking up the centroid for the cluster id given in the above WeightedVectorWritable, which means iterating through all the clusters for each clustered doc. In my case the number of clusters could be fairly large.\r\n>>\r\n>> Am I missing something?\r\n>>\r\n>>\r\n>\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"22393","summary":"Regression: Clustered Points Should be WeightedPropertyVectorWritable not WeightedVectorWritable","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":53,"total":53,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13292411","id":"13292411","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"body":"Here's a patch that modifies the cluster classification code to emit WeightedPropertyVectorWritables instead of WeightedVectorWritables. It does not compute a distance property; however, as this is not generally available for all Cluster types (really only DistanceMeasureClusters).\r\n\r\nThe more I think about the distance property calculation the more I am comfortable with the current (trunk) implementation. Consider that, for DistanceMeasureClusters at least, the pdf is:\r\n\r\npdf = 1/(1+distance)\r\n\r\nIt is trivial to back-calculate the distance from the pdf value that is already written in the WeightedVectorWritable. This is because, in the new implementation, the pdfs are calculated by the classify() policy method and it is the pdfs that are written.\r\n\r\nSooo, I'm not sure this is a must-fix or even a want-fix. Thoughts?\r\n\r\nThis patch also fixes a bug in the ClusterDumperWriter that correctly catches null properties fields read when the written properties map contains 0 entries. This part of the patch should go into trunk regardless of the above.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"created":"2012-06-09T18:57:29.012+0000","updated":"2012-06-09T18:57:29.012+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13292412","id":"13292412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"body":"Not sure this patch is what we want to do for the reasons mentioned above. I think the current implementation provides enough information already.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"created":"2012-06-09T18:58:31.101+0000","updated":"2012-06-09T18:58:31.101+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13292427","id":"13292427","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"body":"Integrated in Mahout-Quality #1537 (See [https://builds.apache.org/job/Mahout-Quality/1537/])\r\n    MAHOUT-1030: adding null check when empty properties are written (Revision 1348491)\r\n\r\n     Result = SUCCESS\r\njeastman : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1348491\r\nFiles : \r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/ClusterDumperWriter.java\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"created":"2012-06-09T21:03:52.194+0000","updated":"2012-06-09T21:03:52.194+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13292438","id":"13292438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"body":"Integrated in Mahout-Quality #1538 (See [https://builds.apache.org/job/Mahout-Quality/1538/])\r\n    MAHOUT-1030: adding better null check when empty properties are written (Revision 1348494)\r\nMAHOUT-1030: adding better null check when empty properties are written (Revision 1348493)\r\n\r\n     Result = SUCCESS\r\njeastman : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1348494\r\nFiles : \r\n* /mahout/trunk/examples/bin/cluster-reuters.sh\r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/ClusterDumperWriter.java\r\n\r\njeastman : http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&view=rev&rev=1348493\r\nFiles : \r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/ClusterDumperWriter.java\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"created":"2012-06-09T22:40:16.702+0000","updated":"2012-06-09T22:40:16.702+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13292840","id":"13292840","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"body":"I'm moving this to 0.8 to allow for more discussion on whether or not it needs to be implemented at all. Given that the existing pdf weights allow for distance to be computed I don't view it as a showstopper for 0.7.\r\n\r\nI committed the patch to ClusterDumperWriter after the release bits were cut but, since it has not presented itself to date and since clustering no longer produces WeightedPropertyVectorWritables, I don't view it as a showstopper for 0.7 either.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"created":"2012-06-11T15:37:42.809+0000","updated":"2012-06-11T15:37:42.809+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13403570","id":"13403570","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"Jeff said; \"It is trivial to back-calculate the distance from the pdf value that is already written in the WeightedVectorWritable.\"\r\n\r\nHmm, I don't see how the pdf is included in the WeightedVectorWritable, at least for kmeans. The weight therein is the probability it belongs to the cluster, for kmeans 1 or 0, right? clusteredPoints/part-m-00000 is made of IntWritable clusterIDs and WeightedVectorWritable so how do you find a non-binary pdf for a specific doc? \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2012-06-28T23:15:06.563+0000","updated":"2012-06-28T23:15:06.563+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13404028","id":"13404028","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"body":"Here's a small patch that actually sets the documented weights in the WeightedVectorWritables in the ClusterClassificationMapper. Needs more testing to make sure it doesn't break something else though.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"created":"2012-06-29T17:04:53.232+0000","updated":"2012-06-29T17:04:53.232+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13404516","id":"13404516","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"body":"This patch modifies the classify() method of AbstractClusteringPolicy to remove the normalization in order that pdf values in the WeightedVectorWritable can be back-converted into the original distance measure distance.\r\n\r\nNot sure which direction to go on this issue right now. If this fixes the regression adequately, it introduces another incompatibility with AbstractVectorClassifier's expectation of normalized results. The downside of this approach needs to be weighed against the much larger patch needed to return WeightedPropertyVectorWritables in the first version of the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeastman","name":"jeastman","emailAddress":"jeff at windwardsolutions dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jeastman&avatarId=12232","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jeastman&avatarId=12232","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jeastman&avatarId=12232","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jeastman&avatarId=12232"},"displayName":"Jeff Eastman","active":true},"created":"2012-06-30T15:34:34.841+0000","updated":"2012-06-30T15:34:34.841+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13404581","id":"13404581","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"Personally I have a work around that's independent of putting the distance or pdf in the clusteredPoints WeightedVectorWritable.\r\n\r\nClearly there are larger issues regarding the refactoring that have to be considered. I'll rely on my work around until the mahout team has determined what should get into the trunk and will then convert to that solution.\r\n\r\nIf you think this patch is the right thing to do I'll test it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2012-06-30T17:40:52.442+0000","updated":"2012-06-30T17:40:52.442+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13404650","id":"13404650","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lancenorskog","name":"lancenorskog","emailAddress":"lance dot norskog at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lance Norskog","active":true},"body":"bq.  If this fixes the regression adequately, it introduces another incompatibility with AbstractVectorClassifier's expectation of normalized results.\r\nI have not used this code, but have a general request: it is hard to describe the difficulty of approaching this kind of code from outside. Inconsistency makes it that much more frustrating.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lancenorskog","name":"lancenorskog","emailAddress":"lance dot norskog at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lance Norskog","active":true},"created":"2012-06-30T23:16:37.204+0000","updated":"2012-06-30T23:16:37.204+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13404737","id":"13404737","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"A couple other thoughts:\r\n\r\n1) With non-partitioning clustering like fuzzy kmeans the weight is used to communicate the probability of inclusion in the cluster. I'd expect it is required. Whatever you do can't change the meaning of the weight for anything but kmeans.\r\n\r\n2) Strictly speaking the probability of a vectors inclusion in a cluster for kmeans is always 1.0 or 0. Therefore if you attach the underlying pdf to the clusteredPoints aren't you actually turning kmeans into fkmeans, at least by some loose definition? or is the weight calculated differently for fkmeans--see #1.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2012-07-01T14:59:25.755+0000","updated":"2012-07-01T14:59:25.755+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13678785","id":"13678785","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"body":"[~pferrel]Did you have a chance to try the last patch that Jeff had submitted here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"created":"2013-06-08T17:39:32.996+0000","updated":"2013-06-08T17:39:32.996+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13678847","id":"13678847","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"+1 to Lance's point.\r\n\r\nMy point of 01/Jul/12 was that the membership for kmeans should be 1 or 0 (it was prior to Jeff's patch I believe) and so can't be used to calculate the distance to the centroid. The membership is being overloaded and so I was voting to return to the old method for storing the distance in a WeightedPropertyVectorWritable and leaving the membership 0 or 1.\r\n\r\nSince I was voting to not use the membership I implemented a recalc of the distance during ingest of the clustered vectors so that my code would continue to work either way. I rather expected someone to complain that membership was now fuzzy in some sense and dependent on the distance metric. Lance and Jeff also point out the problem with normalization expectations.\r\n\r\nIn general there are lots of places a WeightedPropertyVectorWritable would be nice, even nicer than a NamedVectorWritable. Using them seems like a good way to add properties without breaking backward compatibility. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2013-06-08T20:27:32.993+0000","updated":"2013-06-08T20:27:32.993+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13679170","id":"13679170","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"Pat, do you have a patch for this that demonstrates what you are suggesting so that we can compare?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2013-06-09T21:29:30.290+0000","updated":"2013-06-09T21:29:30.290+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13679620","id":"13679620","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"Not really. What I do now is recalculate the distance to the centroid when I store the vectors in a DB. \r\n\r\nWhat used to happen, pre 0.8 (or ?) was the distance was stored in a WeightedPropertyVectorWritable, in the properties. During the kmeans refactoring of 0.8 the type of the vector was changed to NamedVectorWritable so the property that held the distance was lost. To put back WeightedPropertyVectorWritable and store the distance in it was more than I wanted to maintain outside of the trunk.\r\n\r\nSo I just recalculate it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2013-06-10T16:42:59.485+0000","updated":"2013-06-10T16:42:59.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13679624","id":"13679624","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"BTW you can look at the code of 0.6 or 0.7 to see how the distance was stored. The key thing is changing the output vector type otherwise there is no good place to put it.\r\n\r\nThis is more of a feature that was lost than a completely new feature request.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2013-06-10T16:47:32.247+0000","updated":"2013-06-10T16:47:32.247+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13680391","id":"13680391","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"I'm going to push this.  I know that for 0.9 we are looking at reworking the way we handle vectors and their associated properties (i.e. get rid of NamedVector, etc.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2013-06-11T14:04:06.483+0000","updated":"2013-06-11T14:04:06.483+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13809686","id":"13809686","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Grant, who should I talk to to get up to speed on this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-10-30T22:07:24.233+0000","updated":"2013-10-30T22:07:24.233+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13809813","id":"13809813","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"Andrew, I suppose it depends on what part of it you want to address.  If it is the literal part of this bug, Pat has been pretty responsive.  If it is the reworking of the properties of vectors, that is probably best handled on the mailing list.  The basic gist being we want to more intelligently handle vector properties and get rid of NamedVector.  [~tdunning], [~robinanil] and others may have some thoughts here as well.\r\n\r\n(FWIW, I'd prefer the latter to be tackled.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2013-10-31T00:52:10.889+0000","updated":"2013-10-31T00:52:10.889+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13834990","id":"13834990","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"I'll dig through the 0.6 code for this; in the meantime does anyone remember if every usage of WeightedPropertyVectorWritable was changed to WeightedVectorWritable, or just certain ones used in clustering?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-11-28T17:30:15.543+0000","updated":"2013-11-28T17:30:15.543+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13835031","id":"13835031","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"Broken record warning: The bigger issue (I agree with Grant about tackling it) is that each part of Mahout may or may not support NamedVectors, let alone WeightedPropertyVectorWritable. It is probably a big job but before 1.0 it would sure be nice to have something like WeightedPropertyVectorWritable supported optionally everywhere in Mahout. I've run across many occasions where it would save a lot of extra import/export code and do it in a completely scalable way. Import/export code is almost always non-scalable because people, including me, are too lazy to write external-id to internal-id to external-id lookup code in a scalable way. There are a fair number of cases where using a WeightedPropertyVectorWritable raises some issues like matrix transpose and multiply. Maybe a better way to solve the external to internal to external problem is with a scalable implementation supplied as a separate tool in Mahout. If there is a feature request for this larger issue maybe that is a better place for this discussion. \r\n\r\nAs far as this issue is concerned, it is related only to refactoring of the clustering code. In 0.6 the distance to centroid was stored in a WeightedPropertyVectorWritable. In 0.7 during refactoring, the vector type was changed and the distance to centroid was no longer stored with the clustered vectors. Restoring this would make iterating through every clustered vector to recalculate the distance unnecessary.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2013-11-28T18:34:27.151+0000","updated":"2013-11-28T18:34:27.151+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13835036","id":"13835036","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"I'm planning on fixing this for clustering to get into the 0.9 release next week, and then do the bigger change for 1.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-11-28T19:01:11.000+0000","updated":"2013-11-28T19:01:11.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13835946","id":"13835946","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Using WeightedPropertyVectorWritable in place of WeightedVectorWritable where it's used for clustering.\r\n\r\nGot both TestKmeansClustering and ClusterClassificationDriverTest passing; let me know if I've missed something.\r\n\r\nThe plan is to ship this regression fix in 0.9 and do the more expansive refactoring for 1.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-01T04:16:48.713+0000","updated":"2013-12-01T04:16:48.713+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13835947","id":"13835947","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Hm, just noticed my patch is very similar to the one submitted two Junes ago.\r\n\r\nWere people just waiting for the bigger fix to get this quick fix in, and/or should this be sorted out now too:\r\n\r\n\"If this fixes the regression adequately, it introduces another incompatibility with AbstractVectorClassifier's expectation of normalized results.\"","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-01T04:21:31.923+0000","updated":"2013-12-01T04:21:31.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13836085","id":"13836085","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"Don't have time to fully test this right now but skimming the patch seems to indicate that the pdf is being used as a proxy for the distance to the centroid? Jeff tried this earlier. If I'm jumping to the wrong conclusion then disregard the following.\r\n\r\nThe pdf for kmeans will be 0 or 1 to indicate the vector is or is not a member of a cluster. It therefore can't be used to calculate distance. The actual distance is calculated somewhere else in the flow, I haven't looked into where that is, but I believe it changed from 0.6 to 0.7 due to the refactoring and this is one reason it was no longer stored in the WPVW for each clustered point. For many applications, we need to know the closest vectors to the centroid or use the distance as a way to sort member vectors. It is used as an indicator of strength of membership in the cluster. Without the distance all member vectors are treated equally, and this is often not a good thing to do.\r\n\r\nFor some clustering methods, the pdf may be used to recalculate the distance to centroid, but this method is not general as I recall.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2013-12-01T18:33:48.012+0000","updated":"2013-12-01T18:33:48.012+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13836087","id":"13836087","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"I hope Jeff can answer about normalized results, but I believe that had to do with using the pdf in lieu of using the true distance to centroid. If the true distance from the WPVW to the already calculated centroid is stored in the WPVW, I don't believe Jeff's comment applies. \r\n\r\nHe's calling this a regression because the distance was in the vector and now is not. His proposed fix didn't work out because of the above comment. Again, as I recall.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2013-12-01T18:41:03.091+0000","updated":"2013-12-01T18:41:03.091+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13836091","id":"13836091","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Okay; I did the distance calculation in the mapper and put that into a property called \"distance\" like in 0.6.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-01T19:01:55.602+0000","updated":"2013-12-01T19:01:55.602+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13836099","id":"13836099","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"Thanks, I see now. That looks correct. This is fine for my needs. The only suggestion I'd have is to call it distance-squared or some such in case someone wants to calculate actual distance.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2013-12-01T19:29:19.323+0000","updated":"2013-12-01T19:29:19.323+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13836280","id":"13836280","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Or output square-root of distance-squared in \"distance\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-02T06:19:46.637+0000","updated":"2013-12-02T06:19:46.637+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13836677","id":"13836677","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"as you wish, either is clear, thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2013-12-02T16:46:44.266+0000","updated":"2013-12-02T16:46:44.266+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13838284","id":"13838284","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Changing property name from \"distance\" to \"distance-squared\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-03T22:53:10.834+0000","updated":"2013-12-03T22:53:10.834+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13842400","id":"13842400","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"New patch per reviewboard, closing as fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-08T04:08:10.293+0000","updated":"2013-12-08T04:08:10.293+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13842401","id":"13842401","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Closing per reviewboard as fixed/ship it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-08T04:08:46.954+0000","updated":"2013-12-08T04:08:46.954+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13842553","id":"13842553","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Removing redundant if block, tmp variable, and unused imports.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-08T17:04:21.478+0000","updated":"2013-12-08T17:04:21.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13842554","id":"13842554","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Closing","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2013-12-08T17:04:46.939+0000","updated":"2013-12-08T17:04:46.939+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13842574","id":"13842574","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"body":"Patch committed to trunk, Thanks Andrew.  \r\nP.S. Please don't close JIRAs, they are closed at the time of Release.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"created":"2013-12-08T18:19:12.122+0000","updated":"2013-12-08T18:19:12.122+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13842680","id":"13842680","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"body":"SUCCESS: Integrated in Mahout-Quality #2356 (See [https://builds.apache.org/job/Mahout-Quality/2356/])\r\nMAHOUT-1030:Regression: Clustered Points Should be WeightedPropertyVectorWritable not WeightedVectorWritable (smarthi: rev 1549089)\r\n* /mahout/trunk/core/src/main/java/org/apache/mahout/clustering/classify/ClusterClassificationDriver.java\r\nMAHOUT-1030: Regression: Clustered Points Should be WeightedPropertyVectorWritable not WeightedVectorWritable (smarthi: rev 1549087)\r\n* /mahout/trunk/CHANGELOG\r\n* /mahout/trunk/core/src/main/java/org/apache/mahout/clustering/classify/ClusterClassificationMapper.java\r\n* /mahout/trunk/core/src/test/java/org/apache/mahout/clustering/classify/ClusterClassificationDriverTest.java\r\n* /mahout/trunk/core/src/test/java/org/apache/mahout/clustering/kmeans/TestKmeansClustering.java\r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/AbstractClusterWriter.java\r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/CSVClusterWriter.java\r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/ClusterDumper.java\r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/ClusterDumperWriter.java\r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/GraphMLClusterWriter.java\r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/clustering/JsonClusterWriter.java\r\n* /mahout/trunk/integration/src/main/java/org/apache/mahout/utils/vectors/lucene/ClusterLabels.java\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"created":"2013-12-08T19:29:51.206+0000","updated":"2013-12-08T19:29:51.206+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13881226","id":"13881226","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"This fixes a very literal reading of the bug. The distance-squared is indeed included in clusteredPoints BUT there are no vector ids so the distance can't actually be used. Without a vector id in clusteredPoints, Mahout doesn't really perform unsupervised categorization. I will now have to loop through all vectors, recalculate the distance and categorize them according to the cluster centroid they are closest to. \r\n\r\nThe clusteredPoints and distance-squared can't actually be used without knowing the vector id. I think named vectors work here but many cases including mine do not have names only Mahout integer ids.\r\n\r\nPlease correct me if I've missed something.\r\n\r\nWhen I cluster the user preference data used in the Mahout recommender I get clusteredPoints something like this. The data from the vector is given but not its id??? The Key here is a cluster id.\r\n\r\npat$ mahout seqdumper -i /Users/pat/big-data/temp/clusters/clusteredPoints/ | more\r\nJan 24, 2014 10:02:05 AM org.slf4j.impl.JCLLoggerAdapter info\r\nINFO: Command line arguments: {--endPhase=[2147483647], --input=[/Users/pat/big-data/temp/clusters/clusteredPoints/], --startPhase=[0], --tempDir=[temp]}\r\n2014-01-24 10:02:05.707 java[29221:1003] Unable to load realm info from SCDynamicStore\r\nInput Path: file:/Users/pat/big-data/temp/clusters/clusteredPoints/part-m-00000\r\nKey class: class org.apache.hadoop.io.IntWritable Value Class: class org.apache.mahout.clustering.classify.WeightedPropertyVectorWritable\r\nKey: 39: Value: wt: 1.0 distance-squared: 9.656875  vec: [0:1.000, 2:1.000, 5:1.000, 9:1.000, 12:1.000, 13:1.000, 17:1.000, 18:1.000, 19:1.000, 20:1.000]\r\nKey: 48: Value: wt: 1.0 distance-squared: 22.229166666666686  vec: [25:1.000, 26:1.000, 27:1.000, 28:1.000, 29:1.000, 30:1.000, 31:1.000, 36:1.000, 38:1.000, 39:1.000, 40:1.000, 41:1.000, 43:1.000, 44:1.000, 46:1.000, 48:1.000, 53:1.000, 54:1.000, 55:1.000, 56:1.000, 57:1.000, 58:1.000, 60:1.000, 63:1.000, 64:1.000, 66:1.000, 67:1.000, 68:1.000, 69:1.000, 70:1.000, 71:1.000, 72:1.000]\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2014-01-24T18:08:14.590+0000","updated":"2014-01-24T18:08:14.590+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13881273","id":"13881273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Yes, was looking at this last night with Suneel.  I think he found where it's happening and we'll check it out.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2014-01-24T18:34:21.009+0000","updated":"2014-01-24T18:34:21.009+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13881283","id":"13881283","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"Hmm, Suneel recommends creating a new Jira so I will\r\n\r\nComments from Suneel,\r\n\r\nI concur that we r presently not capturing the vectorIds (unless its a Named Vector) and also concur that its hard to infer as to which vector belongs to which cluster without that. It seems easy to use NamedVector for now to be able to determine the vectors that belong to a cluster.\r\n\r\nThe Clustering algos are only reading VectorWritable() and if the VectorWritable() did not have the vector key (i.e. is not a Named Vector) the clustering algorithm just wouldn't have it.\r\n\r\nSee the following code snippet from PartialVectorMergeReducer.java :-\r\n\r\n{Code}\r\n\r\n    if (namedVector) {\r\n      vector = new NamedVector(vector, key.toString());\r\n    }\r\n\r\n    // drop empty vectors.\r\n    if (vector.getNumNondefaultElements() > 0) {\r\n      VectorWritable vectorWritable = new VectorWritable(vector);\r\n      context.write(key, vectorWritable);\r\n    }\r\n\r\n{Code}\r\n\r\nSo from the above code snippet if its not a Named Vector then the corresponding vector key is not captured (in the VectorWritable).\r\n\r\nThe RowIdJob reads the same Tf-Idf vectors and creates a docIndex and matrix (I am sure u know their layout and what they are intended for so I'll avoid the details here).\r\n\r\nThe following code snippet from ClusterIterator.iterateSeq() only reads the VectorWritable but not the Key:\r\n\r\n      for (VectorWritable vw : new SequenceFileDirValueIterable<VectorWritable>(inPath, PathType.LIST,\r\n          PathFilters.logsCRCFilter(), conf)) {\r\n\r\nIt should have been reading a Pair<Text, VectorWritable> to capture the Key for the vector as well.\r\n\r\nI presently have a 0.9 Release sitting out there in staging waiting to be finalized.  Please create a JIRA for this and we should have it fixed in the next major release (or Release Candidate).\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2014-01-24T18:38:33.434+0000","updated":"2014-01-24T18:38:33.434+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13881287","id":"13881287","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"adde a https://issues.apache.org/jira/browse/MAHOUT-1410\r\nnot sure if it's needed.\r\n\r\nI can promise an instant test on some real world data if you have a patch, very sorry I didn't notice sooner!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2014-01-24T18:43:01.421+0000","updated":"2014-01-24T18:43:01.421+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13881762","id":"13881762","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"body":"My bad, should have caught this earlier. While working on the fix for M-1410 realized that this fix only takes care of MR version, the sequential version still uses WeightedVectorWritable() and doesn't preserve distance.\r\n\r\nThe patch for M-1410 should include the fix for this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"created":"2014-01-25T08:54:12.920+0000","updated":"2014-01-25T08:54:12.920+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883103","id":"13883103","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"using cosine similarity for clustering I'm getting what must be wrong values in the clusteredPoints. The distance is often > 1\r\n\r\nIn fact in the above output when the job was putting distance-squared in clusteredPoints, the results were often larger than 1 too.\r\n\r\nusing cosine, isn't it impossible to get a distance: 4.92391969868745 or  distance-squared: 9.656875 for that matter?\r\n\r\nusing kmeans, command line arguments: {--clustering=null, --clusters=[/Users/pat/big-data/guide/temp/cluster-seeds], --convergenceDelta=[0.0010], --distanceMeasure=[org.apache.mahout.common.distance.CosineDistanceMeasure], --endPhase=[2147483647], --input=[/Users/pat/big-data/guide/temp/tmp1/pairwiseSimilarity], --maxIter=[50], --method=[mapreduce], --numClusters=[20], --output=[/Users/pat/big-data/guide/temp/clusters], --overwrite=null, --startPhase=[0], --tempDir=[temp]}\r\n\r\n\r\nExample for one point in clusteredPoints from seqdumper\r\nKey: 950: Value: wt: 1.0 distance: 4.92391969868745  vec: 24 = [39:0.855, 43:0.698, 72:0.829, 260:0.829, 336:0.829, 341:0.829, 346:0.829, 363:0.807, 365:0.896, 427:0.855, 438:0.896, 787:0.855, 795:0.855, 921:0.855, 926:0.855, 932:0.807, 939:0.896, 1144:0.829, 1269:0.896, 1271:0.896, 1273:0.896, 1275:0.896, 1277:0.896, 1278:0.896, 1279:0.896, 1280:0.896, 1281:0.896, 1283:0.896, 1286:0.896, 1287:0.829, 1288:0.896, 1289:0.952, 1290:0.952, 1291:0.896, 1293:0.896, 1294:0.896, 1296:0.896, 1297:0.896, 1299:0.896, 1302:0.896, 1303:0.896, 1307:0.829, 1344:0.855, 1346:0.855, 1394:0.829, 1409:0.855, 1977:0.896, 1978:0.896, 1979:0.896, 1980:0.896, 1981:0.896, 1982:0.896]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2014-01-27T18:51:14.960+0000","updated":"2014-01-27T18:51:14.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883138","id":"13883138","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"As I recall that distance is the distance of that vector to the centroid of the cluster it's been assigned to, which wouldn't be using the cosine similarity metric I wouldn't think.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2014-01-27T19:12:34.771+0000","updated":"2014-01-27T19:12:34.771+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883149","id":"13883149","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"body":"That's correct Andrew. Its the distance of the vector to the cluster centroid. I was wrong.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"created":"2014-01-27T19:19:10.671+0000","updated":"2014-01-27T19:19:10.671+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883188","id":"13883188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"The distance should be measured the same way that the cluster is created, right? Otherwise how would you know what metric is used?\r\n\r\nAlso the data is from boolean recommender data (all dimensions = 0,1) it is the item-item similarity matrix calculated using loglikelihood and looks like the stuff below. Andrew and Suneel have copies of it.\r\n\r\nKey: 0: Value: {5:0.854718643737767,172:0.8292121703264371,192:0.854718643737767,13:0.8962379566075429,198:0.8962379566075429,20:0.8962379566075429,9:0.8962379566075429,19:0.8962379566075429,201:0.8962379566075429,207:0.8962379566075429,43:0.6976395601234899,193:0.8962379566075429,18:0.8962379566075429,184:0.8962379566075429,209:0.8962379566075429,187:0.854718643737767,2:0.8962379566075429,211:0.854718643737767,27:0.7327087555023397,177:0.854718643737767,183:0.8292121703264371,214:0.8962379566075429,17:0.854718643737767,190:0.854718643737767,176:0.8292121703264371,12:0.8962379566075429,191:0.854718643737767}\r\nKey: 2: Value: {5:0.8962379566075429,12:0.919419979968322,19:0.919419979968322,9:0.919419979968322,17:0.8962379566075429,20:0.919419979968322,18:0.919419979968322,13:0.919419979968322}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2014-01-27T19:46:58.849+0000","updated":"2014-01-27T19:46:58.849+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883321","id":"13883321","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"body":"I hope I am wrong but someone please verify this. I don't see the CLI supplied DistanceMeasure being honored in both KMeans and FuzzyKMeans.\r\nThis seems to have been an issue with Mahout Kmeans/FuzzyKMeans clustering forever,  but was never noticed or reported. \r\n\r\nPlease file a JIRA for this.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"created":"2014-01-27T21:19:10.361+0000","updated":"2014-01-27T21:19:10.361+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883555","id":"13883555","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Something's wrong with those distances for sure, but the command-line parameter is making it through to the instantiation of Kluster.\r\n\r\nI attached a debugger and watched that work, as well as watched a correct measure make it through a job.\r\n\r\nThe issue is that when I built the \"distance\" property I used the Vector method getDistanceSquared, which does not know what metric we used for the clustering.\r\n\r\nSo it's debatable if this is a show-stopper, but it's not ideal.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2014-01-28T00:23:04.958+0000","updated":"2014-01-28T00:23:04.958+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883774","id":"13883774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"body":"Andrew, looking at this issue now and u're right that its not a show stopper but needs to be fixed nevertheless. The mistake's with the distance calculation wherein we are always using 'squaredDistance' as opposed to using the CLI provided DistanceMeasure.\r\n\r\nBelow code snippet should fix the issue (needs to be added in both ClusterClassificationMapper and ClusterClassificationDriver where the distance is being calculated):\r\n\r\n{Code}\r\n    DistanceMeasureCluster distanceMeasureCluster = (DistanceMeasureCluster) cluster;\r\n    DistanceMeasure distanceMeasure = distanceMeasureCluster.getMeasure();\r\n    double d = distanceMeasure.distance(cluster.getCenter(), vw.get());\r\n{Code}\r\n\r\nWith this change and CosineDistanceMeasure, the distances are now in the range [0,1].  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"created":"2014-01-28T05:20:38.592+0000","updated":"2014-01-28T05:20:38.592+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883801","id":"13883801","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"body":"Attaching patch for this fix. Please verify the same before its committed to trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"created":"2014-01-28T06:06:24.658+0000","updated":"2014-01-28T06:06:24.658+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883826","id":"13883826","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"body":"Looks good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andrew.musselman","name":"andrew.musselman","emailAddress":"andrew dot musselman at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=andrew.musselman&avatarId=18977","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andrew.musselman&avatarId=18977","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andrew.musselman&avatarId=18977","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andrew.musselman&avatarId=18977"},"displayName":"Andrew Musselman","active":true},"created":"2014-01-28T06:52:16.149+0000","updated":"2014-01-28T06:52:16.149+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13883887","id":"13883887","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"body":"Patch committed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smarthi","name":"smarthi","emailAddress":"smarthi at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suneel Marthi","active":true},"created":"2014-01-28T08:20:34.134+0000","updated":"2014-01-28T08:20:50.481+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12560051/comment/13884313","id":"13884313","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"body":"Ran it through KMeans, FuzzyKMeans, sequential and m/r, and all are producing distances in the right range.\r\n\r\nLooks closed to me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pferrel","name":"pferrel","emailAddress":"pat at occamsmachete dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pat Ferrel","active":true},"created":"2014-01-28T16:41:12.290+0000","updated":"2014-01-28T16:41:12.290+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAHOUT-1030/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i046yn:"}}