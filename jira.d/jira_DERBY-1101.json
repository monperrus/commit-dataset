{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12330197","self":"https://issues.apache.org/jira/rest/api/latest/issue/12330197","key":"DERBY-1101","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-03-13 19:05:58.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22306","customfield_12310222":"1_*:*_1_*:*_2110893000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_40481000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-04-06T14:55:49.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1101/watchers","watchCount":0,"isWatching":false},"created":"2006-03-13T04:34:16.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12318777","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12318777","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12385906","key":"DERBY-3311","self":"https://issues.apache.org/jira/rest/api/2/issue/12385906","fields":{"summary":"Client ResultSet.getHoldabilty will return incorrect value when the ResultSet is obtained from a procedure call","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-01-09T17:39:02.050+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"}],"timeoriginalestimate":null,"description":"EmbedResultSet40.getHoldability returns the holdability of the statement returned by ResultSet.getStatement().\nWhen a ResultSet is created by a procedure call, its holdability may not match the holdability of the Statement  that called the procedure, which is probably what ResultSet.getStatement() should return.\n\nThis may not be exposed as a bug yet, but I think this method should be directly obtaining the holdability of the ResultSet using the Activation.getResultSetHoldability() method, rather than through a Statement. Seems a safer approach.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39616","summary":"ResultSet.getHoldabilty will return incorrect value when the ResultSet is obtained from a procedure call","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":13,"total":13,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12370114","id":"12370114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Statement's can't change their holdability, but I think there is a problem or potential problem here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-03-13T11:21:37.000+0000","updated":"2006-03-13T11:21:37.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12370153","id":"12370153","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Dan Debrunner wrote:\r\n\r\n> EmbedResultSet40.getHoldability returns the holdability of the\r\n> statement returned by ResultSet.getStatement().  When a ResultSet is\r\n> created by a procedure call, its holdability may not match the\r\n> holdability of the Statement that called the procedure, which is\r\n> probably what ResultSet.getStatement() should return.\r\n\r\nAre you saying that there is a problem with\r\nEmbedResultSet.getStatement()? It doesn't return what you say it\r\n\"probably should return\".\r\n\r\nFor instance, if you have \r\n\r\n  stmt.execute(\"call mystoredprocedure(1,2,3)\");\r\n  ResultSet rs = stmt.getResultSet();\r\n\r\nthen\r\n\r\n  stmt != rs.getStatement()\r\n\r\nThe javadoc for ResultSet.getStatement() says:\r\n\r\n  Retrieves the Statement object that produced this ResultSet\r\n  object. If the result set was generated some other way, such as by a\r\n  DatabaseMetaData method, this method may return null.\r\n\r\nSince the ResultSet object was produced by a Statement internally in\r\nthe stored procedure, and not by the Statement which called the\r\nprocedure, I believe the current implementation of\r\nEmbedResultSet.getStatement() is correct.\r\n\r\n> This may not be exposed as a bug yet, but I think this method should\r\n> be directly obtaining the holdability of the ResultSet using the\r\n> Activation.getResultSetHoldability() method, rather than through a\r\n> Statement. Seems a safer approach.\r\n\r\nActually, at one point I tried to use Activation to get the result set\r\nholdability, but since TemporaryRowHolderResultSet.getActivation() has\r\na THROWASSERT to make sure it is not called, I used getStatement()\r\ninstead.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-03-13T19:05:58.000+0000","updated":"2006-03-13T19:05:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12370158","id":"12370158","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attaching a small program that tests what\r\nEmbedResultSet40.getHoldability() returns when the result set is\r\nreturned from a stored procedure.\r\n\r\nAll combinations of the CallableStatement being holdable/non-holdable\r\nand the statement inside the stored procedure being holdable or\r\nnon-holdable are tested. The program also tests whether it is possible\r\nto do next() after commit().\r\n\r\nOutput from the test program:\r\n\r\nTesting holdability - \r\n  Statement: HOLD_CURSORS_OVER_COMMIT\r\n  Procedure: HOLD_CURSORS_OVER_COMMIT\r\nInternally in stored procedure:\r\n  ResultSet.getHoldability(): HOLD_CURSORS_OVER_COMMIT\r\n  ResultSet is in fact holdable\r\nExternally:\r\n  ResultSet.getHoldability(): HOLD_CURSORS_OVER_COMMIT\r\n  ResultSet is in fact holdable\r\n\r\nTesting holdability - \r\n  Statement: HOLD_CURSORS_OVER_COMMIT\r\n  Procedure: CLOSE_CURSORS_AT_COMMIT\r\nInternally in stored procedure:\r\n  ResultSet.getHoldability(): CLOSE_CURSORS_AT_COMMIT\r\n  ResultSet is in fact not holdable\r\nExternally:\r\n  ResultSet.getHoldability(): CLOSE_CURSORS_AT_COMMIT\r\n  ResultSet is in fact not holdable\r\n\r\nTesting holdability - \r\n  Statement: CLOSE_CURSORS_AT_COMMIT\r\n  Procedure: HOLD_CURSORS_OVER_COMMIT\r\nInternally in stored procedure:\r\n  ResultSet.getHoldability(): HOLD_CURSORS_OVER_COMMIT\r\n  ResultSet is in fact holdable\r\nExternally:\r\n  ResultSet.getHoldability(): HOLD_CURSORS_OVER_COMMIT\r\n  ResultSet is in fact holdable\r\n\r\nTesting holdability - \r\n  Statement: CLOSE_CURSORS_AT_COMMIT\r\n  Procedure: CLOSE_CURSORS_AT_COMMIT\r\nInternally in stored procedure:\r\n  ResultSet.getHoldability(): CLOSE_CURSORS_AT_COMMIT\r\n  ResultSet is in fact not holdable\r\nExternally:\r\n  ResultSet.getHoldability(): CLOSE_CURSORS_AT_COMMIT\r\n  ResultSet is in fact not holdable\r\n\r\nFor all these cases, the observed holdability is the same as the\r\nholdability returned by getHoldability(). Hence, I don't think the\r\ncurrent implementation of getHoldability() returns wrong results when\r\nusing stored procedures.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-03-13T19:20:22.000+0000","updated":"2006-03-13T19:20:22.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12370189","id":"12370189","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Thanks for following up on this Knut, you said:\r\n\r\n> Since the ResultSet object was produced by a Statement internally in\r\n> the stored procedure, and not by the Statement which called the\r\n> procedure, I believe the current implementation of\r\n> EmbedResultSet.getStatement() is correct. \r\n\r\nI'm not sure, for four reasons:\r\n\r\n   1) It's impossible to match this behaviour in client mode.\r\n\r\n   2) Logically the statement that created the JDBC ResultSet is the one that executed\r\n    the CALL statement. I think the model defined by the SQL standard is that the\r\n    JDBC ResultSet created within the procedure is turned into a SQL result set\r\n    by the database engine and then the client JDBC creates a JDBC ResultSet from \r\n     the SQL result set. It just so happens that Derby can omit the conversion into\r\n     an internal ResultSet.\r\n\r\n   3) Once Derby supports SQL procedures, and a JDBC ResultSet is returned\r\n    then the only Statement that makes sense is the one that invoked the CALL procedure.\r\n\r\n    4) JDBC 4.0 - Why was the method ResultSet.getHoldability added? It can only be because\r\n     it can return a different value to rs.getStatement().getResultSetHoldability().\r\n  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-03-13T23:06:32.000+0000","updated":"2006-03-13T23:06:32.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12370196","id":"12370196","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"OK, I see your point. I'm not able to tell whether or not you are\r\nright, though...\r\n\r\nOne way to implement getHoldability() without being dependent on\r\ngetStatement() is to add a holdability variable to EmbedResultSet and\r\nput something like this in the constructor:\r\n\r\n    if (theResults instanceof TemporaryRowHolderResultSet ||\r\n        !theResults.getActivation().getResultSetHoldability()) {\r\n        holdability = JDBC30Translation.CLOSE_CURSORS_AT_COMMIT;\r\n    } else {\r\n        holdability = JDBC30Translation.HOLD_CURSORS_OVER_COMMIT;\r\n    }\r\n\r\nDo you think this is a better approach?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-03-13T23:47:28.000+0000","updated":"2006-03-13T23:47:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12370247","id":"12370247","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"This code\r\n\r\n if (theResults instanceof TemporaryRowHolderResultSet || \r\n\r\nis pushing knowledge of the underlying implementation layers up into the JDBC layer,\r\nideally JDBC layer should just be dealing with the interfaces specified by the language layer.\r\n\r\nI have a long term idea for improving performance by removing most/all runtime statistics code from\r\nany language ResultSet implementation, and instead having it in a single delegation/wrapper\r\nlanguage ResultSet. Thus when runtime statistics is enabled each real implementation of a language\r\nResultSet would be wrapped in one of these runtime statistics  that would maintain costs, timing etc.\r\nCurrently this is not an easy change because there is code that performs specific instanceof checks\r\non ResultSet references in various places, which is really a breakdown of modularity.\r\n\r\nI'd be more interested to know why TemporaryRowHolderResultSet is breaking the contract of getActivation.\r\n\r\nNot sure why a field is needed in EmbedResultSet, when the activation already maintains the state, it seems a\r\nbug to me that TemporaryRowHolderResultSet  is not honouring its contract.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-03-14T05:54:51.000+0000","updated":"2006-03-14T05:54:51.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12370267","id":"12370267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"> Daniel John Debrunner commented on DERBY-1101:\r\n> ----------------------------------------------\r\n>\r\n> Not sure why a field is needed in EmbedResultSet, when the\r\n> activation already maintains the state, it seems a bug to me that\r\n> TemporaryRowHolderResultSet is not honouring its contract.\r\n\r\nNo need to have a field. (But having code in the constructor really\r\nhelped exposing errors in derbyall, since the constructor is run far\r\nmore frequently than getHoldability().)\r\n\r\nIt seems like all places a new TemporaryRowHolderImpl is created, an\r\nActivation is readily available. Would it make sense to simply pass\r\nthat activation down to the TemporaryRowHolderImpl object and further\r\ndown to the TemporaryRowHolderResultSet?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-03-14T06:50:07.000+0000","updated":"2006-03-14T06:50:07.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12371546","id":"12371546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I have attached a patch (derby-1101-testcase-v1.diff) which adds a regression test for this issue to the jdbc40 test suite. The test doesn't fail, since the bug isn't exposed until DERBY-1111 is fixed. Test case is committed in revision 388144.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-03-23T19:12:56.000+0000","updated":"2006-03-23T19:12:56.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12371686","id":"12371686","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Patch derby-1101-v1.diff modifies EmbedResultSet.getHoldability() so that it uses getActivation() instead of getStatement(). Please let me know if you have any comments. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-03-24T16:03:49.000+0000","updated":"2006-03-24T16:03:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12373440","id":"12373440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Just to add that section 16.1.3.1 of JDBC 4.0 (proposed final draft) states:\r\n\r\n\"In the case of a SQL CALL statement, the holdability of any returned ResultSets are determined\r\nby the stored procedure, independent of the holdability level specified to the SQL CALL statement.\"\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-04-06T07:19:03.000+0000","updated":"2006-04-06T07:19:03.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12373445","id":"12373445","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Patch derby-1101-v1.diff  committed (had to merge EmbedResultSet.java by hand)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-04-06T07:38:35.000+0000","updated":"2006-04-06T07:38:35.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12373487","id":"12373487","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks for committing the patch, Dan! I had forgotten that it was there myself. Please close the issue if you think it is resolved.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-04-06T14:55:49.000+0000","updated":"2006-04-06T14:55:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12330197/comment/12373525","id":"12373525","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Closed - Actually I only realised once I was adding the contribution line in the commit message that this was a patch provided by a committer. For some reason I thought it was someone else. Since I'd got so far I thought I might as well continue. :-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-04-07T02:10:28.000+0000","updated":"2006-04-07T02:10:28.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1101/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0758v:"}}