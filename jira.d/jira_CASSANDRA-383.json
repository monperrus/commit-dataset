{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12433523","self":"https://issues.apache.org/jira/rest/api/latest/issue/12433523","key":"CASSANDRA-383","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310865","id":"12310865","key":"CASSANDRA","name":"Cassandra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310865&avatarId=12034","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310865&avatarId=12034","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310865&avatarId=12034","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310865&avatarId=12034"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11961","id":"11961","description":"Apache Cassandra related projects","name":"Cassandra"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313862","id":"12313862","description":"","name":"0.4","archived":false,"released":true,"releaseDate":"2009-09-27"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2009-08-20 01:08:07.632","customfield_12312322":null,"customfield_12312323":null,"customfield_12310222":"3_*:*_1_*:*_1470655_*|*_10002_*:*_1_*:*_403330623_*|*_1_*:*_1_*:*_38680_*|*_5_*:*_1_*:*_0","customfield_12310420":"19662","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2009-08-24T16:49:25.693+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-383/watchers","watchCount":0,"isWatching":false},"created":"2009-08-20T00:22:05.735+0000","customfield_10022":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12311124":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12326387","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12326387","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"outwardIssue":{"id":"12433392","key":"CASSANDRA-375","self":"https://issues.apache.org/jira/rest/api/2/issue/12433392","fields":{"summary":"Echo writes to bootstrapping nodes","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-08-25T14:21:26.967+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312978","id":"12312978","name":"Core"}],"timeoriginalestimate":null,"description":"insertBlocking should use getNStorageEndPointMap (like insert) instead of just getNStorageEndPoint so that it can perform hinted handoff.\r\n\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12417085","id":"12417085","filename":"383-v1.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-20T00:47:06.650+0000","size":3363,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12417085/383-v1.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12417209","id":"12417209","filename":"383-v2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-21T02:15:17.084+0000","size":3610,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12417209/383-v2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12417283","id":"12417283","filename":"383-v3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-21T16:55:29.271+0000","size":3504,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12417283/383-v3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12417301","id":"12417301","filename":"383-v4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-21T18:55:11.980+0000","size":4483,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12417301/383-v4.patch"}],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"91203","summary":"StorageProxy.insertBlocking does not perform hinted handoff","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"customfield_12311420":null,"customfield_12311421":null,"environment":"all","customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":14,"total":14,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12745252","id":"12745252","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"body":"Need to fix this so both insert paths can echo writes to the bootstrapping nodes for CASSANDRA-375","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-20T00:28:18.066+0000","updated":"2009-08-20T00:28:18.066+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12745257","id":"12745257","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"body":"insertBlocking now uses getNStorageEndPointMap","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-20T00:47:06.735+0000","updated":"2009-08-20T00:47:06.735+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12745268","id":"12745268","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"eyeballing it looks ok.  will commit after i get to my machine that has Thrift installed tomorrow to run nosetests. :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-08-20T01:08:07.632+0000","updated":"2009-08-20T01:08:07.632+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12745476","id":"12745476","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"I get many nosetests failures with this patch (on a single machine ofc)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-08-20T16:20:20.429+0000","updated":"2009-08-20T16:20:20.429+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12745769","id":"12745769","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"body":"Oops, can't quite cast to EndPoint[] like I was doing.\r\nv2 passes nosetests and ant test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-21T02:15:17.122+0000","updated":"2009-08-21T02:15:17.122+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12745818","id":"12745818","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=euphoria","name":"euphoria","emailAddress":"michael dot greene at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Greene","active":true},"body":"I think this is what you'll want to do, getting rid of the temp counter.\r\n{{{\r\nEndPoint[] endPoints = (EndPoint[])endpointMap.keySet().toArray(new EndPoint[endpointMap.size()]);\r\n}}}\r\n\r\nIt might be pedantic, but I also think we should be making the quorum calculation consistent, instead of\r\navailability style\r\n{{{\r\n(DatabaseDescriptor.getReplicationFactor() / 2) + 1)\r\n}}}\r\nversus blocking style\r\n{{{\r\n(DatabaseDescriptor.getReplicationFactor() >> 1) + 1)\r\n}}}\r\n\r\nApart from these, looks good.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=euphoria","name":"euphoria","emailAddress":"michael dot greene at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Greene","active":true},"created":"2009-08-21T06:01:03.277+0000","updated":"2009-08-21T06:01:03.277+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12746085","id":"12746085","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"body":"Thanks -- v3 with Michaels' suggestions.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-21T16:55:29.308+0000","updated":"2009-08-21T16:55:29.308+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12746091","id":"12746091","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"instead of\r\n            if (endpointMap.size() < (DatabaseDescriptor.getReplicationFactor() / 2) + 1)\r\n            {\r\n                throw new UnavailableException();\r\n            }\r\n            int blockFor = determineBlockFor(consistency_level);\r\n\r\nwe should have\r\n\r\n            int blockFor = determineBlockFor(consistency_level);\r\n            if (endpointMap.size() < blockFor)\r\n            {\r\n                throw new UnavailableException();\r\n            }\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-08-21T17:02:12.417+0000","updated":"2009-08-21T17:02:12.417+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12746093","id":"12746093","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"minor point: the (EndPoint[]) is redundant in the toArray call","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-08-21T17:03:56.451+0000","updated":"2009-08-21T17:03:56.451+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12746110","id":"12746110","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"rather belatedly I realized that we have a deeper problem here.\r\n\r\nwe don't want to count hint destinations as counting towards the W consistency level, or we are violating our contract that W + R > N = consistent (or unavailableexception).\r\n\r\nwe do want to write hints if for instance a quorum write is requested and we have 2 of 3 nodes live, we write the third to a hint.  but that can't count towards the quorum since that node won't be a potential read target.  so getNStorageEndPointMap is the wrong thing to do here.\r\n\r\ni think we actually have to go below that abstraction: use getStorageEndPoints directly, count the live nodes to see if we have enough to satisfy consistency_level, write those out, and if that is less than N, then add hinted writes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-08-21T17:47:50.434+0000","updated":"2009-08-21T17:47:50.434+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12746129","id":"12746129","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"body":"True, the blockFor semantics so far has simply been a W-durability guarantee.\r\nIf we want to guarantee W + R > N = consistent, HHO nodes can't count towards W.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-21T18:27:53.906+0000","updated":"2009-08-21T18:27:53.906+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12746147","id":"12746147","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"body":"v4 fixes blockFor semantics to actually block for W live nodes and then do hinted handoff after that succeeds.\r\n\r\nWe don't want to do HHO in parallel to make sure we don't write any value in case the quorum write fails .. clients will see a failed write, but quorum reads might succeed after handoff.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep_tata","name":"sandeep_tata","emailAddress":"sandeep dot tata at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Tata","active":true},"created":"2009-08-21T18:55:12.000+0000","updated":"2009-08-21T18:55:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12746946","id":"12746946","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"committed v4 w/ minor changes (renamed getLiveNodes -> getUnhintedNodes)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-08-24T16:48:00.975+0000","updated":"2009-08-24T16:48:00.975+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12433523/comment/12747431","id":"12747431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"body":"Integrated in Cassandra #177 (See [http://hudson.zones.apache.org/hudson/job/Cassandra/177/])\r\n    allow blocking write to create hints if not enough of the \"correct\" nodes are live, but enough are to fulfil the requested consistency level.  patch by Sandeep Tata; reviewed by jbellis and Michael Greene for \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"created":"2009-08-25T14:21:26.934+0000","updated":"2009-08-25T14:21:26.934+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-383/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0fylj:"}}