{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12390770","self":"https://issues.apache.org/jira/rest/api/latest/issue/12390770","key":"DERBY-3523","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[],"aggregatetimespent":null,"resolution":null,"customfield_12310220":"2008-03-11 17:08:55.737","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"23687","customfield_12310222":null,"customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-3523/watchers","watchCount":2,"isWatching":false},"created":"2008-03-11T16:50:37.717+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_triage10_5_2"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313771","id":"12313771","description":"build: 764942, 14/Apr/09. Voted release: 28/Apr/09. Announced: 1/May/09","name":"10.5.1.1","archived":false,"released":true,"releaseDate":"2009-04-28"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12319499","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12319499","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12386534","key":"DERBY-3330","self":"https://issues.apache.org/jira/rest/api/2/issue/12386534","fields":{"summary":"provide support for unique constraint over keys that include one or more nullable columns.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-02-15T21:09:04.969+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"There are three messages which after Derby-3330 checkin now giving wrong information. These are\r\n\r\n42831:'{0}' cannot be a column of a primary key or unique key because it can contain null values.\r\n42Z20:Column '{0}' cannot be made nullable. It is part of a primary key or unique constraint, which cannot have any null able columns.\r\nX0Y63.S:The command on table '{0}' failed because null data was found in the primary key or unique constraint/index column(s). All columns in a primary or unique index key must not be null.\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36819","summary":"sql states (X0Y63, X0Y63, X0Y63.S) related to nulls in unique constraints are associated with wrong message texts ","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10053","value":"Low","id":"10053"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":25,"total":25,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577511","id":"12577511","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"There can be two ways to fix this problem\r\n\r\n1. Change the message to remove unique constraint from the message.\r\n\r\nProblem\r\nDuring soft upgrade run unique constraint can't have null able columns. \r\nWhile using the data base throwing new message may give wrong information \r\nto the user claiming that he was using primary key when actually he was using \r\nunique constraint.\r\n\r\n\r\n2. Introduce new message with a new state and use older state only during soft upgrade run.\r\n\r\nProblem\r\nThere will be impact of existing application if they are relying on \r\nsql state to detect the cause of failure in creating primary key.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-11T16:52:03.933+0000","updated":"2008-03-11T16:52:03.933+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577517","id":"12577517","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I see examples in messages.xml, such as 8006 where we have more than one instance of a message with the same SQLState but different messages.   Is that a possibility.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-11T17:08:55.737+0000","updated":"2008-03-11T17:08:55.737+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577750","id":"12577750","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jorgenlo","name":"jorgenlo","emailAddress":"jorgen dot loland at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jørgen Løland","active":true},"body":"(Attaching mail thread)\r\n\r\nNarayanan wrote:\r\n> Jørgen Løland wrote:\r\n>> Mike Matrigali wrote:\r\n>> > It does seem like the best case would be for the error message \r\n>> system to\r\n>> > somehow return a different error message for the same number if it is\r\n>> > in soft upgrade vs. hard upgrade.  Does the error message system \r\n>> support\r\n>> > such a thing?\r\n>>\r\n>> Yes, it does. If you want multiple messages with the same SQL state, \r\n>> you need to add the \".<severity>.<#>\" information to the error state \r\n>> in SQLState.java. E.g, all these messages have SQL State 08004:\r\n>>\r\n>> ----- snip from SQLState.java ----\r\n>> String LOGIN_FAILED = \"08004\";\r\n>> String NET_CONNECT_AUTH_FAILED                          = \"08004.C.1\";\r\n>> String NET_DATABASE_NOT_FOUND                           = \"08004.C.2\";\r\n>> String AUTH_DATABASE_CONNECTION_REFUSED                 = \"08004.C.3\";\r\n>> String AUTH_SHUTDOWN_NOT_DB_OWNER                       = \"08004.C.4\";\r\n>> String AUTH_ENCRYPT_NOT_DB_OWNER                        = \"08004.C.5\";\r\n>> ...\r\n>> ----- snip -------\r\n>>\r\n>> If, e.g., both these messages\r\n>>\r\n>> '{0}' cannot be a column of a primary key or unique key because it can \r\n>> contain null values.\r\n>> '{0}' cannot be a column of a primary key because it can contain null \r\n>> values.\r\n>>\r\n>> ... should have the same 42831 error code, you would need something \r\n>> like this in the SQLState.java file:\r\n>>\r\n>> String LANG_DB2_ADD_UNIQUE_OR_PRIMARY_KEY_ON_NULL_COLS = \"42831.S.1\";\r\n>> String LANG_DB2_ADD_PRIMARY_KEY_ON_NULL_COLS = \"42831.S.2\";\r\n>>\r\n>> 'S' because 42831 is statement severity level (see class javadoc in \r\n>> SQLState.java), while 1 and 2 are used to tell the messages apart. \r\n>> messages.xml also needs to be updated, of course.\r\n>>\r\n> But how will this  help in printing different error messages in hard and \r\n> soft upgrade? I thought this would be useful\r\n> in grouping together the same family of messages, but can this act as a \r\n> switch for messages that need to be printed\r\n> in hard and soft upgrade?\r\n> \r\n> Narayanan\r\n> \r\n\r\nI misinterpreted Mike's question. The code where these exceptions are thrown needs to explicitly use the correct exception. However, this is the same thing that must be done if fix suggestion 2 is chosen. \r\n\r\nI think suggestion 2 should be modified like this:\r\n\r\n2b: Introduce new message without changing the state and use old messages only during soft upgrade run.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jorgenlo","name":"jorgenlo","emailAddress":"jorgen dot loland at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jørgen Løland","active":true},"created":"2008-03-12T08:15:39.616+0000","updated":"2008-03-12T08:17:07.761+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577761","id":"12577761","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=narayanan","name":"narayanan","emailAddress":"v dot narayanan at sun dot com-disabled","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V.Narayanan","active":true},"body":"Anurag says -\r\n\r\nthanks every one for pitching.\r\nLet me try to summarize it\r\n\r\nDerby doesn;t directly supports choosing message based on\r\nthe type of run (soft upgrade more or a regular mode), but it\r\ndoes allow associating multiple messages to a single sql state\r\nbye adding \".\" extension (sqlstate.1, sqltate.2 etc).\r\nFrom the code this can be used to throw correct error message\r\nafter detecting the mode engine is running under (use existing sql\r\nstates during soft upgrade and newer once during regular operation).\r\n\r\nThe extensions of the sql state is dropped while setting the sql\r\nstate to SQLException so user won't experience any difference\r\nduring soft upgrade and will get newer message with same sql state\r\nduring regular operation.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=narayanan","name":"narayanan","emailAddress":"v dot narayanan at sun dot com-disabled","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V.Narayanan","active":true},"created":"2008-03-12T08:47:13.271+0000","updated":"2008-03-12T08:47:13.271+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577883","id":"12577883","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"I am planning to introduce similar to the following \r\n\r\n\r\nString errorState = null;\r\nif (getLanguageConnectionContext().getDataDictionary()\r\n            .checkVersion(DataDictionary.DD_VERSION_DERBY_10_4,\r\n             null))\r\n{\r\n       errorState =\r\n              SQLState.LANG_MODIFY_COLUMN_EXISTING_PRIMARY_KEY;\r\n}\r\nelse\r\n{\r\n//soft upgrade mode\r\nerrorState =\r\n        SQLState.LANG_MODIFY_COLUMN_EXISTING_CONSTRAINT;\r\n}\r\nthrow StandardException.newException(errorState, name);\r\n\r\n\r\n\r\nList of effected files\r\njava/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj\r\njava/engine/org/apache/derby/impl/sql/compile/TableElementList.java\r\njava/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java\r\njava/engine/org/apache/derby/impl/sql/execute/AlterTableConstantAction.java\r\njava/shared/org/apache/derby/shared/common/reference/SQLState.java\r\njava/engine/org/apache/derby/loc/messages.xml\r\n\r\n\r\nIn addition to these, out files of few harness tests will also need modifications.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-12T15:51:05.341+0000","updated":"2008-03-12T15:51:05.341+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577893","id":"12577893","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=narayanan","name":"narayanan","emailAddress":"v dot narayanan at sun dot com-disabled","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V.Narayanan","active":true},"body":"You could consider introducing a newException method in the StandardException class\r\nthat would accept two SQLStates (one for hard, one for soft upgrade), the data dictionary\r\nversion.\r\n\r\nThis method would use the appropriate SQLState depending on whether hard upgrade\r\nor soft upgrade is being done for the mentioned data dictionary version.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=narayanan","name":"narayanan","emailAddress":"v dot narayanan at sun dot com-disabled","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V.Narayanan","active":true},"created":"2008-03-12T16:07:13.386+0000","updated":"2008-03-12T16:07:13.386+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577911","id":"12577911","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"I don't think adding information about specific sql states StandardException is a good idea.\r\n\r\nIts not very frequently where error messages needs modification. I prefer keeping information about it in the respective classes only. These classes are anyway aware about the soft upgrade as they allow or disallow creation of unique constraint based on it.\r\n\r\nStanduardException does very specialized job of creating SQLException and filling it with SQLState and messages. IMO Its better if we don't add too many functionality to it.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-12T16:40:40.896+0000","updated":"2008-03-12T16:40:40.896+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577934","id":"12577934","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"thanks for everyone's input on this, I didn't realize we had this flexibility with the messages so now definitely don't think we should create new states for these messsages.  Given the existing support seems like best solution would be to return same error number but different message.  I will leave it to Anurag whether to inline the code that figures out which message, or\r\nto create a utility routine somewhere.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2008-03-12T17:15:30.824+0000","updated":"2008-03-12T17:15:30.824+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12577939","id":"12577939","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=narayanan","name":"narayanan","emailAddress":"v dot narayanan at sun dot com-disabled","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V.Narayanan","active":true},"body":">I don't think adding information about specific sql states StandardException is a good idea.\r\n\r\nSorry about the ambiguity in the previous comment. I did not mean to ask you to push this specific\r\nSQLState creation into StandardException. \r\n\r\nIf you were to following my suggestion you would have one method in StandardException whose\r\n\"first three\" parameters would probably be (String SQLState1, String SQLState2, <type of upgrade>).\r\n\r\nIn the simplest case You could choose the type of upgrade to be a boolean called hardupgrade, where\r\nit being,\r\nfalse - would indicate that SQLState1 is to be used\r\ntrue  - would indicate that SQLState2 is to be used\r\n\r\nIn the above case you would be retaining the logic for determining if it is a hard or a soft upgrade\r\nin the calling method.\r\n\r\nYou could even decide on pushing the type of upgrade deciding logic into StandardException based on\r\nif you think it would be appropriate.\r\n\r\nOfcourse I must say I do agree with\r\n\r\n\"StanduardException does very specialized job of creating SQLException and filling it with SQLState and messages. \r\nIMO Its better if we don't add too many functionality to it.\"\r\n\r\nyou have a strong case and your argument does leave me in a dilemna as to what would be most appropriate here.\r\n\r\nSorry about the confusion, \r\n\r\n<Narayanan tells himself not to write comments on JIRA issues when it is past\r\nbed-time :( >","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=narayanan","name":"narayanan","emailAddress":"v dot narayanan at sun dot com-disabled","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V.Narayanan","active":true},"created":"2008-03-12T17:20:15.183+0000","updated":"2008-03-12T17:20:15.183+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12578252","id":"12578252","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"This patch () adds new messages for X0Y63, X0Y63 and X0Y63.S\r\n\r\nI have added new message ids X0Y63.1, X0Y63.1, X0Y63.S.1 and assigned \r\nnew messages to them. I have also introduced new constraints in SQLState to point to these message ids.\r\n\r\nA new method in StandardException (newException (string, string, boolean, Object), \r\nbased on 3rd parameter,  decides weather to use existing message id or the newer \r\none.\r\n\r\nModified files\r\n\r\njava/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj\r\n\r\nModified existing checkVersion method to return boolean (same as DataDictionary.checkVersion).\r\n\r\nUpdated two instances where X0Y63 was thrown to use new method from StandardExcetion to use message based on mode its running under.\r\n\r\njava/engine/org/apache/derby/impl/sql/compile/TableElementList.java\r\njava/engine/org/apache/derby/impl/sql/compile/ModifyColumnNode.java\r\n\r\nUpdated to choose between older and newer message using StandardExcetion.\r\n\r\njava/engine/org/apache/derby/impl/sql/execute/AlterTableConstantAction.java\r\n\r\nAdded additional identify SQLState.LANG_NULL_DATA_IN_PRIMARY_KEY as case \r\nwhere setting not null is possible because of constraint.\r\n\r\n\r\njava/engine/org/apache/derby/iapi/error/StandardException.java\r\nAdded a new method which accepts two message id and decides which one to use based on third parameter (boolean).\r\n\r\njava/engine/org/apache/derby/loc/messages.xml\r\n\r\nadded new messages and message id.\r\n\r\njava/shared/org/apache/derby/shared/common/reference/SQLState.java\r\nadded constant for new message ids.\r\n\r\njava/testing/org/apache/derbyTesting/functionTests/master/db2Compatibility.out\r\njava/testing/org/apache/derbyTesting/functionTests/master/altertable.out\r\njava/testing/org/apache/derbyTesting/functionTests/master/nulls.out\r\n\r\nupdated tests results to expect new message.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-13T11:41:17.722+0000","updated":"2008-03-13T11:41:17.722+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12578264","id":"12578264","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jorgenlo","name":"jorgenlo","emailAddress":"jorgen dot loland at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jørgen Løland","active":true},"body":"I think the severity-level ('S') is mandatory if the SQL state is more than 5 characters long. Thus, I think you need to use 42831.S.1 instead of 42831.1. I might be wrong, but at least that's how I interpret the SQLState class javadoc:\r\n\r\n\"The SQL state of an error message dictates the error's severity.\r\n\tThe severity is determined from the first two characters of the\r\n\tstate if the state is five characters long, otherwise the state\r\n\tis expected to be 7 characters long and the last character determines\r\n\tthe state. If the state is seven characters long then only the first\r\n\tfive will be seen by the error reporting code and exception.\"","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jorgenlo","name":"jorgenlo","emailAddress":"jorgen dot loland at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jørgen Løland","active":true},"created":"2008-03-13T12:05:43.079+0000","updated":"2008-03-13T12:05:43.079+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12578296","id":"12578296","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"Thanks Jorgen for pointing out.\r\n\r\nAttaching new version (derby-3523v2.diff) with new ids (severity set to S)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-13T13:59:29.627+0000","updated":"2008-03-13T13:59:29.627+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12578385","id":"12578385","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thank you for the patch.  It looks good to me except I am a bit unsure about the new method in StandardException.  It seems specialized for the single argument case and a little out of place.  I think I would rather see the logic in the calling code, but I realize this was discussed earlier and perhaps this was the consensus that was reached.  If I am the only one that is uncomfortable with it I will go ahead and commit the patch as is tomorrow.\r\n\r\nShould we have tests for the soft upgrade case?\r\n\r\nKathey\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-13T16:48:21.923+0000","updated":"2008-03-13T16:48:21.923+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12578390","id":"12578390","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"The new method in StandardException seems a little overkill for what really could be a ? : operator in the calling code.\r\n\r\n String sqlState = checkVersion(....) ? SQLState.XXX : SQLState.YYY;\r\n\r\nIf the method is to be kept, it might be clearer to have its name reflect what it is doing. Just reading the calling code in its current from\r\nmight make the reader think that it returns an exception with two SQLStates, e.g. one nested within the other.\r\n\r\nHaving the ? : code in-line I think would be clearer code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2008-03-13T17:03:58.006+0000","updated":"2008-03-13T17:03:58.006+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12578555","id":"12578555","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=narayanan","name":"narayanan","emailAddress":"v dot narayanan at sun dot com-disabled","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V.Narayanan","active":true},"body":">The new method in StandardException seems a little overkill for what really could be a ? : operator in the calling code.\r\n\r\n> String sqlState = checkVersion(....) ? SQLState.XXX : SQLState.YYY;\r\n\r\n> If the method is to be kept, it might be clearer to have its name reflect what it is doing.\r\n\r\nI agree that using ? : would be a better way of implementing this and also that the name of the method\r\ncould probably be changed to reflect what it is doing.\r\n\r\nBut I do not agree that it is overkill to factor out logic to choose a SQLState based on whether it is soft or\r\nhard upgrade.\r\n\r\nWhy would it be wrong to put in a utility method in StandardException that chooses one of the two\r\nSQLStates based on a boolean if a valid case for its usage could be justified (e.g. choosing one\r\nbased on if it is hard or soft upgrade) ?\r\n\r\nThis is not a case that is specific to the class using this logic but a generic case that could\r\noccur in multiple parts of the codebase.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=narayanan","name":"narayanan","emailAddress":"v dot narayanan at sun dot com-disabled","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"V.Narayanan","active":true},"created":"2008-03-14T00:35:11.718+0000","updated":"2008-03-14T00:53:32.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12578667","id":"12578667","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"I have taken off the new method from standardException and moved the code \r\nto select mesage id inline derby-3523v3.diff.\r\n\r\nI don't any strong feeling about either of the approach. Based on  \r\ndiscussion either v2 (with new method in StandardException) and v3 (inline \r\nmessage id selection) can be used.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-14T09:50:07.581+0000","updated":"2008-03-14T09:50:07.581+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12578843","id":"12578843","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thanks Anurag, the v3 patch looks good. I verified the soft upgrade messages manually and am running tests and then will commit.\r\nIt would be nice to have upgrade tests in a follow-up patch.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-14T16:40:57.130+0000","updated":"2008-03-14T16:40:57.130+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12581507","id":"12581507","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"thanks kathey for committing the patch. \r\nI will upload the followup patch with updated upgrade tests in a days time.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-24T10:08:11.239+0000","updated":"2008-03-24T10:08:11.239+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12582207","id":"12582207","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"upgrade tests for modified error messages.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-26T09:41:29.402+0000","updated":"2008-03-26T09:41:29.402+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12582343","id":"12582343","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Committed revision 641398 for the upgrade tests.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-26T16:55:23.314+0000","updated":"2008-03-26T16:55:23.314+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12582462","id":"12582462","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Backed out the change to the upgrade tests. It was causing failures in the \r\ntinderbox run.\r\nhttp://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/Limited/testSummary-641405.html\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-26T22:40:27.846+0000","updated":"2008-03-26T22:40:27.846+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12582582","id":"12582582","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"body":"In Derby 10.0 the syntax for creating primary key along with table creation was \r\n\r\ncreate table t1 (i integer not null primary key)\r\n\r\nin latter version not null wasn't mandatory. In my previous patch there was no 'not null' and thats why there were failure. \r\nI had tested it with upgrades from 10.3 only. Sorry for the trouble.\r\n\r\nIn my new patch I have added 'not null; in create table statement and also checking if the version is at least 10.2 while trying \"alter table alter column i null\" as this was not \r\navailable in 10.2. \r\n\r\nI have tested upgrade tests with following version in release directory\r\n\r\n10.0.2.1 \r\n10.1.1.0  \r\n10.1.2.1  \r\n10.1.3.1 \r\n10.2.1.6  \r\n10.2.2.0  \r\n10.3.1.4  \r\n10.3.2.1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=anurag","name":"anurag","emailAddress":"anurag dot shekhar at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Anurag Shekhar","active":true},"created":"2008-03-27T10:06:48.894+0000","updated":"2008-03-27T10:06:48.894+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12727777","id":"12727777","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=espinha","name":"espinha","emailAddress":"tiago dot derby at espinhas dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tiago R. Espinha","active":true},"body":"Triaged for 10.5.2. \r\nIt seems like this issue is fixed.\r\n\r\nKathey, can you resolve if it is?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=espinha","name":"espinha","emailAddress":"tiago dot derby at espinhas dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tiago R. Espinha","active":true},"created":"2009-07-06T20:44:50.904+0000","updated":"2009-07-06T20:44:50.904+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12728368","id":"12728368","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"No I don't think this is ready to be resolved. It looks like I committed a patch and then backed it out and then there was another one posted that hasn't been committed.  Maybe it should be marked patch available and we can see if the patch still applies.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2009-07-07T21:09:24.978+0000","updated":"2009-07-07T21:09:24.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12390770/comment/12782498","id":"12782498","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Unassigning this, as there has been no activity on it for quite some time, so others can pick it up.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2009-11-25T16:48:50.668+0000","updated":"2009-11-25T16:48:50.668+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-3523/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06nzb:"}}