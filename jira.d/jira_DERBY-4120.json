{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12419485","self":"https://issues.apache.org/jira/rest/api/latest/issue/12419485","key":"DERBY-4120","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314182","id":"12314182","description":"Old head of 10.5 branch","name":"10.5.3.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313727","id":"12313727","description":"Feature release","name":"10.6.1.0","archived":false,"released":true,"releaseDate":"2010-05-18"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2009-07-02 18:51:38.742","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24037","customfield_12310222":"1_*:*_1_*:*_18665737011_*|*_5_*:*_2_*:*_22301345519_*|*_4_*:*_1_*:*_3455535","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-07-13T17:47:41.065+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4120/watchers","watchCount":4,"isWatching":false},"created":"2009-03-26T13:05:23.238+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313345","id":"12313345","description":"","name":"10.4.2.0","archived":false,"released":true,"releaseDate":"2008-09-05"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12388714","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12388714","type":{"id":"10020","name":"Cloners","inward":"is cloned by","outward":"is a clone of","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10020"},"inwardIssue":{"id":"12716443","key":"DERBY-6586","self":"https://issues.apache.org/jira/rest/api/2/issue/12716443","fields":{"summary":"CLONE - derbyclient.jar conflict with derby.jar on package export, which is problematic on OSGI environment","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12330524","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12330524","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12457672","key":"DERBY-4574","self":"https://issues.apache.org/jira/rest/api/2/issue/12457672","fields":{"summary":"derby.jar not a valid R4 OSGi bundle","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12332967","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12332967","type":{"id":"12310040","name":"Required","inward":"is required by","outward":"requires","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310040"},"inwardIssue":{"id":"12468384","key":"DERBY-4728","self":"https://issues.apache.org/jira/rest/api/2/issue/12468384","fields":{"summary":"10.5 backport effort tracking issue ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-01-21T00:23:46.260+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310670","id":"12310670","name":"Eclipse Plug-in"},{"self":"https://issues.apache.org/jira/rest/api/2/component/11415","id":"11415","name":"Services"}],"timeoriginalestimate":null,"description":"The manifest in derbyclient.jar is incomplete for usage in OSGi.  There are no packages exported.  This appears to only be a problem in standalone equinox (outside of eclipse).  Note that I did not try other OSGi containers.\r\n\r\nThe fix is relatively simple.  Adding the Export-Package manifest header should take care of the problem.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10363","value":"Embedded/Client difference","id":"10363"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36468","summary":"derbyclient.jar is not a complete OSGi bundle","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jjsnyder","name":"jjsnyder","emailAddress":"jjsnyder83 at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"JJ Snyder","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10422","value":"High Value Fix","id":"10422"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10426","value":"Known fix","id":"10426"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jjsnyder","name":"jjsnyder","emailAddress":"jjsnyder83 at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"JJ Snyder","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"OSGi","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":24,"total":24,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12726625","id":"12726625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Triaged July 2, 2009: Marked as \"Known Fix\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2009-07-02T18:51:38.742+0000","updated":"2009-07-02T18:51:38.742+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12768542","id":"12768542","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Where do I go to learn more about Export-Package and what it should contain?\r\n\r\nI did a bit of poking about in the 10.5.3.0 distribution of Derby, and I see:\r\n\r\n- derby.jar's Manifest.mf contains the following Export-Package information:\r\n\r\nExport-Package: org.apache.derby.authentication,org.apache.derby.datab\r\n ase,org.apache.derby.io,org.apache.derby.jdbc,org.apache.derby.vti\r\n\r\n- none of the other Derby jar files (derbyclient.jar, derbytools.jar, derbynet.jar, derbyrun.jar)\r\n  seem to contain Export-Package lines\r\n\r\nSo I guess my questions are:\r\n1) Should we add Export-Package to *all* the Derby jar files? Or just derbyclient.jar?\r\n2) What value should it contain? Is it the same for each Derby jar file? Or should it\r\nhave a different value in derbyclient.jar than it does in derby.jar?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-10-22T01:39:31.616+0000","updated":"2009-10-22T01:39:31.616+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12768754","id":"12768754","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"A little bit of research on the web:\r\n\r\nThis article mentions both Export-Package and Import-Package:\r\nhttp://www.javaworld.com/javaworld/jw-03-2008/jw-03-osgi1.html?page=3\r\n\r\nThis article also says that importing must be done correctly:\r\nhttp://www.osgi.org/blog/2007/04/importance-of-exporting-nd-importing.html\r\n\r\nThis article presents the Export-Package information from the Eclipse POV:\r\nhttp://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/bundle_manifest.html\r\n\r\nIt seems like the simplest change would be to put the identical Export-Package\r\nline into derbyclient.jar as is used for derby.jar.\r\n\r\nI don't understand what this would *fix*, but I can at least prototype this and\r\nverify that it doesn't *break* anything (that is revealed by the regression tests).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-10-22T16:35:01.178+0000","updated":"2009-10-22T16:35:01.178+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12769009","id":"12769009","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"After reading through the papers a bit, and looking at the actual contents of derbyclient.jar,\r\nit seems to me that the only thing we should put into the Manifest  for derbyclient.jar is:\r\n\r\nExport-Package: org.apache.derby.jdbc\r\n\r\nI think that all the other packages in derbyclient.jar are internal, and the only externally-visible\r\npackage should be the above package, which contains ClientDriver.class\r\n\r\nI'll try that change, as it is the smallest and most focused.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-10-23T00:59:29.488+0000","updated":"2009-10-23T00:59:29.488+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12769140","id":"12769140","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I see that the list of exported packages in derby.jar is close to, but not exactly the same as the list of packages in the published API (http://db.apache.org/derby/javadoc/publishedapi/jdbc4/). Based on what you have found till now, do you think they should be identical?\r\n\r\nExporting org.apache.derby.jdbc in derbyclient.jar sounds like a fine, focused fix to the problem reported here, so +1 from me. (But all I know about this is what I read from the links you provided, so I'm definitely not an authority.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2009-10-23T09:08:24.760+0000","updated":"2009-10-23T09:08:24.760+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12769246","id":"12769246","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jjsnyder","name":"jjsnyder","emailAddress":"jjsnyder83 at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"JJ Snyder","active":true},"body":"All packages that contain classes that clients may want to cast to the derby implementation must be exported.  For example, if you think that a client application wants to cast the Statement to org.apache.derby.client.am.PreparedStatement40 then the org.apache.derby.client.am package must be exported.\r\n\r\nExporting all of the packages gives client applications the option to directly access the classes in those packages.  So unless a package is intended to be private then it should probably be exported","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jjsnyder","name":"jjsnyder","emailAddress":"jjsnyder83 at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"JJ Snyder","active":true},"created":"2009-10-23T15:01:01.759+0000","updated":"2009-10-23T15:01:01.759+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12769438","id":"12769438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Here's a simple diff to the master build.xml file which causes the Manifest.mf\r\nfor derbyclient.jar to have the following additional lines:\r\n\r\nBundle-SymbolicName: derbyclient\r\nDynamicImport-Package: *\r\nExport-Package: org.apache.derby.jdbc\r\n\r\nRegression tests with this modified derbyclient.jar file were clean.\r\n\r\nI see that we already had\r\n\r\nBundle-Vendor: Apache Software Foundation\r\nBundle-Name: Apache Derby 10.6\r\nBundle-Version: 10.6.0000000.828905M\r\n\r\nDo we need to set \r\n\r\nBundle-ManifestVersion:2\r\n\r\nI'm not sure what Bundle-ManifestVersion does, but I see it referenced here:\r\nhttp://publib.boulder.ibm.com/infocenter/forms/v3r0m0/index.jsp?topic=/com.ibm.help.forms.doc/forms_services_platform/fsp_t_creating_manifest_file.html\r\n\r\nAccording to this, if we don't set Bundle-ManifestVersion to 2, we may be \r\nrecognized as a legacy bundle:\r\nhttp://markmail.org/message/lnfjsdgpoh2qj3li\r\n\r\nI'm also still uncertain about which packages we ought to list in the\r\nExport-Package line. In my own experience, I don't ever need to\r\nrefer to any other classes from derbyclient.jar other than the packages\r\nin org.apache.derby.jdbc. In fact, for my applications I only use\r\norg.apache.derby.jdbc.ClientDriver directly, so that would be sufficient for me.\r\n\r\nTo get some other examples, I tried grepping around in the .java files in the\r\njava/testing subdirectory of the trunk, to see if any of our existing regression\r\ntest programs access other packages from derbyclient. There were only a handful\r\nof hits, and from what I can tell these occur in code which would NOT be\r\nwritten by typical client applications.\r\n\r\nSo I'm tempted to leave the Export-Package line very short for now, and\r\nonly add to it if we come across cases where an application needs to access\r\none of these classes.\r\n\r\n-bash-2.05b$ find . -name '*.java' -exec grep org.apache.derby.client {} \\; -print\r\nimport org.apache.derby.client.ClientXid;\r\n./jdbcapi/XATransactionTest.java\r\n        if (c instanceof org.apache.derby.client.am.Connection) {\r\n                    ((org.apache.derby.client.am.Connection) c).\r\n./jdbcapi/CacheSessionDataTest.java\r\n        // org.apache.derby.client.net.EbcdicCcsidManager\r\n./jdbcapi/AuthenticationTest.java\r\n                        || s.startsWith(\"org.apache.derby.client\"))\r\n./jdbcapi/ParameterMappingTest.java\r\nimport org.apache.derby.client.am.ByteArrayCombinerStream;\r\n./derbynet/ByteArrayCombinerStreamTest.java\r\nimport org.apache.derby.client.am.SqlException;\r\nimport org.apache.derby.client.am.ClientMessageId;\r\n./derbynet/SqlExceptionTest.java\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-10-23T20:51:38.895+0000","updated":"2009-10-23T20:51:38.895+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12770938","id":"12770938","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Committed to the trunk as revision 830545.\r\n\r\nI hope that this change is sufficient to enable derbyclient.jar to be used as an OSGi bundle.\r\n\r\nIf not, please let us know what additional problems arise, and we can address those.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2009-10-28T14:00:59.966+0000","updated":"2009-10-28T14:00:59.966+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12887841","id":"12887841","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Reopening to backport to 10.5. Changing assignee from Bryan to myself for that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2010-07-13T16:50:05.512+0000","updated":"2010-07-13T16:50:05.512+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12887884","id":"12887884","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Committed backport to 10.5 with revision 963799.\r\nMerge command was: svn merge -c 830545 https://svn.apache.org/repos/asf/db/derby/code/trunk\r\n\r\nI confirmed that the appropriate entry is present in the META-INF/MANIFEST.MF file in derbyclient.jar.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2010-07-13T17:47:41.000+0000","updated":"2010-07-13T17:47:41.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12998932","id":"12998932","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=magnet","name":"magnet","emailAddress":"schemouil at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Chemouil","active":true},"body":"Using 10.6.1, we experienced a problem with the manifest of derbyclient.jar which exports org.apache.derby.jdbc, a package that is *already* exported by derby.jar. It is thus impossible to use them both at the same time, in the same OSGi container, because the resolver will do the package wiring with only one of these. In our case it prevented us from using the Embedded JDBC driver from derby.jar.\r\n\r\nThree fixes are possible:\r\n- change the name of the jdbc driver package of derbyclient (e.g org.apache.derby.client.jdbc). That's the cleanest solution, even though it might break code. The *old* package name could be kept for backwards compatibility but not exported (in the Export-Package manifest header), so only OSGi installations would be affected (read: it would be 100% backwards compatible for others, but it might be interesting to deprecate the classes in the old package).\r\n- make derbyclient a \"fragment\" bundle of derby.jar, so they would be merged at runtime. I don't think this is proper, because it would imply a dependency of derbyclient on derby (that doesn't currently exist), and I'm not sure it makes sense. Then again, I don't know derby at all :-). I'm just integrating code that's using it.\r\n- use the split-package directive to tell the OSGi framework to do more complex package wiring, this is not recommanded though, but it's a solution. See http://code9.com/2008/08/22/tip-split-packages-and-visibility/ (google has more on the topic)\r\n\r\nSo I believe this bug should be re-opened. Thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=magnet","name":"magnet","emailAddress":"schemouil at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Chemouil","active":true},"created":"2011-02-24T16:54:03.958+0000","updated":"2011-02-24T16:55:46.405+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/12999175","id":"12999175","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Why do you want to use both derbyclient.jar and derby.jar at the same time?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2011-02-25T01:15:18.196+0000","updated":"2011-02-25T01:15:18.196+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/13028214","id":"13028214","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris%40die-schneider.net","name":"chris@die-schneider.net","emailAddress":"chris at die-schneider dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chris%40die-schneider.net&avatarId=10355","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chris%40die-schneider.net&avatarId=10355","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chris%40die-schneider.net&avatarId=10355","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chris%40die-schneider.net&avatarId=10355"},"displayName":"Christian Schneider","active":true},"body":"A typical use case where you want both jars is if you want to host a networked derby server and one or more derby clients in the same osgi container. I think this should be possible.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris%40die-schneider.net","name":"chris@die-schneider.net","emailAddress":"chris at die-schneider dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chris%40die-schneider.net&avatarId=10355","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chris%40die-schneider.net&avatarId=10355","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chris%40die-schneider.net&avatarId=10355","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chris%40die-schneider.net&avatarId=10355"},"displayName":"Christian Schneider","active":true},"created":"2011-05-03T13:21:11.089+0000","updated":"2011-05-03T13:21:11.089+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/13506738","id":"13506738","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cvgaviao","name":"cvgaviao","emailAddress":"cvgaviao at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cristiano Gavião","active":true},"body":"The same problem is in version 10.9.1.0 of derbyclient. Not all packages are being exported.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cvgaviao","name":"cvgaviao","emailAddress":"cvgaviao at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Cristiano Gavião","active":true},"created":"2012-11-29T20:01:55.460+0000","updated":"2012-11-29T20:01:55.460+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14007711","id":"14007711","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tcharl","name":"tcharl","emailAddress":"cmordant1 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Charlie Mordant","active":true},"body":"Why is it resolved?\r\n\r\nIt's not resolved at all! derby.jar and derbyclient.jar are both exporting org.apache.derby.jdbc package, thus make it impossible to have a derby db and a client on the same OSGI runtime...\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tcharl","name":"tcharl","emailAddress":"cmordant1 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Charlie Mordant","active":true},"created":"2014-05-23T21:14:26.835+0000","updated":"2014-05-23T21:14:26.835+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14007727","id":"14007727","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris%40die-schneider.net","name":"chris@die-schneider.net","emailAddress":"chris at die-schneider dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chris%40die-schneider.net&avatarId=10355","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chris%40die-schneider.net&avatarId=10355","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chris%40die-schneider.net&avatarId=10355","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chris%40die-schneider.net&avatarId=10355"},"displayName":"Christian Schneider","active":true},"body":"I think a small tweak can solve this problem. Simply export and import the package org.apache.derby.jdbc in both jars. Then OSGi will make sure the package from one of the jars is exported and the exported one is then also used for the derbyclient and derby bundles internally. This avoids the classloading problems that can occur if you export a package from two jars.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris%40die-schneider.net","name":"chris@die-schneider.net","emailAddress":"chris at die-schneider dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chris%40die-schneider.net&avatarId=10355","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chris%40die-schneider.net&avatarId=10355","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chris%40die-schneider.net&avatarId=10355","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chris%40die-schneider.net&avatarId=10355"},"displayName":"Christian Schneider","active":true},"created":"2014-05-23T21:26:30.909+0000","updated":"2014-05-23T21:26:30.909+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14009625","id":"14009625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"None of the Derby committers are experts on OSGi. If someone can supply a patch and verify that it works in OSGi environments, then one of the committers can verify that it doesn't break our regression tests and check it in. If this is done in the next two weeks, then the patch will make its way into the upcoming 10.11 release. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2014-05-27T12:39:03.888+0000","updated":"2014-05-27T12:39:03.888+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14009649","id":"14009649","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tcharl","name":"tcharl","emailAddress":"cmordant1 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Charlie Mordant","active":true},"body":"Hi,\r\n\r\nI made a superbundle made of the aggregation of derby, derbyclient, derbynetwork and derbytools, exporting all their contents (let's call it derby-all). I tested it, and it works for my use-case:\r\nStarting a server, creating a xadatasource, tables and querying it.\r\n\r\nI'll publish it as soon as possible, then attach it with this ticket.\r\nIt is one of the solutions for that kind of issues (and easy as possible: consists on just a pom.xml and another two lined file).\r\n\r\nIn order to integrate well and easily in an OSGI environment Derby team/a good soul should have to rename the most part of derby packages: for example, suffixing all packages by .network in the derbynet jar, .client in the client one...\r\nOne of the goals to be OSGI compliant is to avoid having the same package exported by two different jars (bundle).\r\nOnce that stuff is done, you just have to declare the maven-bundle-plugin in your pom to have an out-of-box OSGI compliant manifest (but this kind of changes should preferably be for the 11 release;) )\r\n\r\nSee you (very) soon!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tcharl","name":"tcharl","emailAddress":"cmordant1 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Charlie Mordant","active":true},"created":"2014-05-27T13:21:29.108+0000","updated":"2014-05-27T13:21:29.108+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14009655","id":"14009655","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Charlie, I don't mean to send you on a wild goose chase here. What we're looking for is a change to the Derby build scripts which will produce the standard jar files with the enough OSGi metadata in the manifests to fix this problem. Maybe that's not possible. Aggregating all of the jars into a single super jar ball won't be a solution which we can use in a Derby release. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2014-05-27T13:26:18.342+0000","updated":"2014-05-27T13:26:18.342+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14009675","id":"14009675","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tcharl","name":"tcharl","emailAddress":"cmordant1 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Charlie Mordant","active":true},"body":"Hi Rick,\r\n\r\nMany other framework use this solution as an easier solution than changing all their architecture: for example ActiveMQ community choose the name 'activemq-osgi' to wrap the entire amq fwk without taking care of their internal design.\r\nIf it is something that is not acceptable for Derby, I think that it will be very difficult to find an OSGI compliant, see a simple picture resuming the problem in attachement","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tcharl","name":"tcharl","emailAddress":"cmordant1 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Charlie Mordant","active":true},"created":"2014-05-27T13:45:41.192+0000","updated":"2014-05-27T13:45:41.192+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14009683","id":"14009683","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris%40die-schneider.net","name":"chris@die-schneider.net","emailAddress":"chris at die-schneider dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chris%40die-schneider.net&avatarId=10355","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chris%40die-schneider.net&avatarId=10355","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chris%40die-schneider.net&avatarId=10355","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chris%40die-schneider.net&avatarId=10355"},"displayName":"Christian Schneider","active":true},"body":"If I understand correctly the issue is that derby and derby client have the package org.apache.derby.jdbc with different contents. This does not work in OSGi. So the first step should be to move the code to different packages. The client jar seems to contain less packages so it is probably easer to move these.\r\n\r\nIf you want to stay compatible you could create a new package org.apache.derby.client.jdbc and copy the classes there while keeping them in the original place too with @Deprecated to mark that people should switch. Then you could only export the new package in the Manifest. So OSGi users can/have to use the new packages while other users have some time to switch until the next major version where you could remove the old package.\r\n\r\nAnother option would be to add the client classes into the derby jar so people can simply either install derby or client and do not need both.\r\n\r\nWhat do you think?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris%40die-schneider.net","name":"chris@die-schneider.net","emailAddress":"chris at die-schneider dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=chris%40die-schneider.net&avatarId=10355","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=chris%40die-schneider.net&avatarId=10355","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=chris%40die-schneider.net&avatarId=10355","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=chris%40die-schneider.net&avatarId=10355"},"displayName":"Christian Schneider","active":true},"created":"2014-05-27T13:57:12.145+0000","updated":"2014-05-27T13:57:12.145+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14009703","id":"14009703","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"That's a useful analysis, Christian. I agree that the factoring of the packages into jar files is broken. I don't think we're going to refactor Derby in the 10.11 timeframe. We may be able to fix this when we refactor Derby to take advantage of the Jigsaw work being done in Java 9. But that won't provide any near term relief for OSGi users. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2014-05-27T14:21:30.632+0000","updated":"2014-05-27T14:21:30.632+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14010165","id":"14010165","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tcharl","name":"tcharl","emailAddress":"cmordant1 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Charlie Mordant","active":true},"body":"Just in case someone have the same need as I, or if you change your mind as a temporary solution (or even if Jigsaw never see the light...), find attached the uber jar pom and bundle plugin osgi complementary file.\r\nEven if it herds cats...\r\n\r\nRegards, \r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tcharl","name":"tcharl","emailAddress":"cmordant1 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Charlie Mordant","active":true},"created":"2014-05-27T19:24:40.014+0000","updated":"2014-05-27T19:24:40.014+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12419485/comment/14284857","id":"14284857","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"bulk change to close all issues resolved but not closed and not changed since June 1, 2014.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2015-01-21T00:23:46.253+0000","updated":"2015-01-21T00:23:46.253+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4120/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06ltb:"}}