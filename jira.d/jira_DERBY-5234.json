{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12507367","self":"https://issues.apache.org/jira/rest/api/latest/issue/12507367","key":"DERBY-5234","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/5","id":"5","description":"All attempts at reproducing this issue failed, or not enough information was available to reproduce the issue. Reading the code produces no clues as to why this behavior would occur. If more information appears later, please reopen the issue.","name":"Cannot Reproduce"},"customfield_12310220":"2011-05-16 19:19:14.435","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24725","customfield_12310222":"1_*:*_1_*:*_17865423706_*|*_6_*:*_2_*:*_21449440_*|*_5_*:*_1_*:*_7751134_*|*_4_*:*_2_*:*_34920451671","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-01-16T20:48:31.358+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-5234/watchers","watchCount":9,"isWatching":false},"created":"2011-05-16T13:57:15.463+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.png","name":"Critical","id":"2"},"labels":["ERROR","XSDG0","apache","corruption","data","derby","derby_triage10_10","derby_triage10_9"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"12.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314117","id":"12314117","description":"Next release after 10.5.2.0 release candidate #1","name":"10.5.3.0","archived":false,"released":true,"releaseDate":"2009-08-21"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12376995","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12376995","type":{"id":"12310010","name":"Incorporates","inward":"is part of","outward":"incorporates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"},"outwardIssue":{"id":"12674427","key":"DERBY-6382","self":"https://issues.apache.org/jira/rest/api/2/issue/12674427","fields":{"summary":"After Inplace compress: java.sql.SQLException: Page Page(10219,Container(0, 1136)) could not be read from disk caused by Caused by: java.io.EOFException: Reached end of file while attempting to read a whole page.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12351416","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12351416","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12553680","key":"DERBY-5738","self":"https://issues.apache.org/jira/rest/api/2/issue/12553680","fields":{"summary":"SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE only returns to the OS pages in the last extent","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12353075","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12353075","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12396485","key":"DERBY-3683","self":"https://issues.apache.org/jira/rest/api/2/issue/12396485","fields":{"summary":"SYSCS_COMPRESS_TABLE gets deadlock while executing concurrently with other user threads","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12353076","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12353076","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12515751","key":"DERBY-5358","self":"https://issues.apache.org/jira/rest/api/2/issue/12515751","fields":{"summary":"SYSCS_COMPRESS_TABLE failed with conglomerate not found exception","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12351763","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12351763","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12554938","key":"DERBY-5761","self":"https://issues.apache.org/jira/rest/api/2/issue/12554938","fields":{"summary":"Add more comments to file compression code and add more tests for file compression.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}},{"id":"12358228","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12358228","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12599854","key":"DERBY-5876","self":"https://issues.apache.org/jira/rest/api/2/issue/12599854","fields":{"summary":"Overhaul table compression code","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-10-19T03:12:49.571+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11412","id":"11412","name":"Store"}],"timeoriginalestimate":null,"description":"\r\nOne of the derby database table \"gets corrupted\"/\"indicates connection not available\" during processing inserts from java client application as shown in the trace and the only way to recover from this error is to rebuild the DB - by deleting the data and creating the tables again. This happens once in a while (thrice in a span of two months) and the java application (run in multiple servers), which updates the database, processes around 100 million transactions per hour (in total and each transation results in 4-5 updates to the DB) \r\n\r\nThere are eight tables in the derby database.\r\n\r\n   TABLE NAME                           ROWS COUNT (at time of corruption)\r\n---------------------------------------------------------------------------------\r\n   KPI.KPI_MERGEIN;                     362917\r\n   KPI.KPI_IN;                                 422508\r\n   KPI.KPI_DROPPED;                    53667\r\n   KPI.KPI_ERROR1;                       0\r\n   KPI.KPI_ERROR2;                       2686\r\n   KPI.KPI_ERRORMERGE;            0\r\n   KPI.KPI_MERGEOUT;                 362669\r\n   KPI.KPI_OUT;                             125873\r\n\r\nThe derby database has been started with the following parameters \r\n\r\nCMD=\"java -Dderby.system.home=$DERBY_OPTS -Dderby.locks.monitor=true -Dderby.locks.deadlockTrace=true -Dderby.locks.escalationThreshold=50000 -Dderby.locks.waitTimeout=\r\n-1 -Dderby.storage.pageCacheSize=100000 -Xms512M -Xmx3072M -XX:NewSize=256M -classpath $DERBY_CLASSPATH org.apache.derby.drda.NetworkServerControl start -h $KPIDERBYHOST -p $DERBY_KPI_PORT\"\r\n\r\nThe corrupted database tar (filesystem) in live environment was moved to a test system (Solaris system) and few checks were run on the corrupted DB as part of analysis (DB does start fine)\r\n\r\nWhile trying to insert a row in any table expect KPI.KPI_MERGEIN, it is successful. But when a new row is inserted into KPI.KPI_MERGEIN table using command line tool it's throwing below error message (the same message that appeared in live \r\n\r\nij> INSERT INTO KPI.KPI_MERGEIN (A0_TXN_ID, A1_NE_ID, A2_CHU_IP_ADDR, A3_BATCH_DATE,A5_CODE) VALUES (-1, 'BMTDE', '192.2.1.3', 231456879, 'KSD');\r\nERROR 08006: A network protocol error was encountered and the connection has been terminated: the requested command encountered an unarchitected and implementation-specific condition for which there was no architected message\r\n\r\n\r\nand in derby.log file it shows below error stacktrace.\r\n\r\nERROR XSDG0: Page Page(51919,Container(0, 1104)) could not be read from disk.\r\n        at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.CachedPage.readPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(Unknown Source)\r\n        at org.apache.derby.impl.services.cache.ConcurrentCache.find(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.FileContainer.initPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.FileContainer.newPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.BaseContainer.addPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.HeapController.doInsert(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.HeapController.insertAndFetchLocation(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.InsertResultSet.open(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source)\r\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLIMM(Unknown Source)\r\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source)\r\n        at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)\r\nCaused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(Unknown Source)\r\n        ... 20 more\r\n============= begin nested exception, level (1) ===========\r\njava.io.EOFException: Reached end of file while attempting to read a whole page.\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.CachedPage.readPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(Unknown Source)\r\n        at org.apache.derby.impl.services.cache.ConcurrentCache.find(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.FileContainer.initPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.FileContainer.newPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.BaseContainer.addPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.HeapController.doInsert(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.HeapController.insertAndFetchLocation(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.InsertResultSet.open(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source)\r\n        at org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLIMM(Unknown Source)\r\n        at org.apache.derby.impl.drda.DRDAConnThread.processCommands(Unknown Source)\r\n        at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)\r\n============= end nested exception, level (1) ===========\r\n\r\n2011-05-16 10:37:21.392 GMT:\r\nShutting down instance a816c00e-012f-f85f-7892-ffff874c3ff6\r\n----------------------------------------------------------------\r\nCleanup action completed\r\n\r\n\r\nThe problem is only with INSERT statement. When i try SELECT statement on KPI.KPI_MERGEIN table it is working well.The database file system size (in seg0) is 1.3 GB\r\n\r\nCan anyone help me out in identifying the problem that why for one table alone its throwing the above error message ? Would upgrade to a new version help ? \r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10364","value":"Data corruption","id":"10364"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"35359","summary":"Unable to insert data into table. Failed due be \"ERROR XSDG0: Page Page(51919,Container(0, 1104)) could not be read from disk.\"","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"HP-UX 11iv2 in production environment with JDK1.6; Solaris 5/10 in test environment with JDK 1.6","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10051","value":"Urgent","id":"10051"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":86,"total":86,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13034210","id":"13034210","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"Hi,\r\n\r\nI can't say what has gone wrong, but have a few initial questions that may inform the debugging process:\r\n a) Can you run with the debug version of Derby?\r\n     This would be best during normal operation, before the error has happened, but may not work because all the extra asserts slow down Derby a lot.\r\n     Booting and accessing (SELECT/INSERT) the corrupted database with the debug version is also useful in some cases, and that's a lot simpler to do.\r\n b) Have you verified that there are no limits on the size of the database files, i.e. OS quotas or file system limitations, in the production environment?\r\n c) What happens if you run SYSCS_UTIL.SYSCS_COMPRESS_TABLE on KPI.KPI_MERGEIN after the insert fails?\r\n     If the compress-operation succeeds, does the insert still fail afterwards?\r\n d) Looking at the data file for the corrupted table, is the size a multiple of the page size?\r\n\r\nThe failing code is using NIO, but there doesn't seem to be a problem with interrupts (based on current info only). The two obvious ways the code can fail are if the file for some reason has been truncated or that the position argument is incorrect.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2011-05-16T19:19:14.435+0000","updated":"2011-05-16T19:19:14.435+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13034679","id":"13034679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"body":"Hi,\r\n\r\nTried the above options mentioned.\r\na) Given the below debug option which starting the derby database.\r\n-Dderby.debug.true=CacheTrace,DaemonTrace,DeadLockTrace,LockStackTrace,LockTrace,LogTrace,memoryLeakTrace,ScanTrace,SerializedTrace,SpaceTrace,TEST_LOG_FULL\r\n\r\nBut this didn't print any additional information in the logs.\r\n\r\nb) Below are the command output's on test environment. \r\n-bash-3.00$ ulimit -a | grep file\r\ncore file size        (blocks, -c) unlimited\r\nfile size             (blocks, -f) unlimited\r\nopen files                    (-n) 256\r\n-bash-3.00$ plimit 5036\r\n5036:   java -Dderby.system.home=/export/home/cmd -Dderby.locks.monitor=true -\r\n   resource              current         maximum\r\n  time(seconds)         unlimited       unlimited\r\n  file(blocks)          unlimited       unlimited\r\n  data(kbytes)          unlimited       unlimited\r\n  stack(kbytes)         10240           unlimited\r\n  coredump(blocks)      unlimited       unlimited\r\n  nofiles(descriptors)  65536           65536\r\n  vmemory(kbytes)       unlimited       unlimited\r\n\r\nyou can see that there are no limits on the file system and 65536 is the hard limit for the file descriptors.\r\n\r\nc) After running SYSCS_UTIL.SYSCS_COMPRESS_TABLE procedure on KPI.KPI_MERGEIN table. INSERT command is working on KPI.KPI_MERGEIN table.\r\n\r\nd) How to find out the list of .dat files corresponding to a table in seg0 directory?\r\n \r\nThis same application was load tested for higher transcation volume and no such error were reported during development. However the problem in production seems to be pointing to cumulative data/disk usage. Also would it be recommeneded to run SYSCS_UTIL.SYSCS_COMPRESS_TABLE once in a while?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"created":"2011-05-17T10:19:28.082+0000","updated":"2011-05-17T10:19:28.082+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13034987","id":"13034987","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Varma,\r\n\r\nTo find the data files corresponding to your tables, you can run the following script:\r\n\r\ncreate function toHexString( a bigint ) returns varchar( 25 )\r\nlanguage java parameter style java no sql\r\nexternal name 'java.lang.Long.toHexString';\r\n\r\nselect t.tableName, 'c' || toHexString( c.conglomerateNumber ) || '.dat'\r\nfrom sys.systables t, sys.sysconglomerates c, sys.sysschemas s\r\nwhere t.tableID = c.tableID\r\nand t.schemaID = s.schemaID\r\nand s.schemaName not like 'SYS%';\r\n\r\ndrop function toHexString;\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2011-05-17T19:13:17.191+0000","updated":"2011-05-17T19:13:17.191+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13035242","id":"13035242","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"Varma, some comments below:\r\n\r\na) It's not clear to me if you run with the Derby debug build, i.e. the debug bundle named \"db-derby-10.x.y.z-lib-debug.zip\" (downloadable from the Apache Derby site).\r\n    My hope was that it would detect if there was invalid metadata when accessing the table.\r\n\r\nb) This is probably a dead end anyway (unless item d suggests otherwise). In any case, I think it would only matter on the production system since I assume that's where the data was actually written to disk.\r\n\r\nc) Interesting. So it appears that the compress operation is able to rectify the state that's causing the insert to fail.\r\n    If asked for, could the data file for the apparently corrupted table (or the whole database) be made public?\r\n\r\nCompressing a table is done to reclaim unused disk space for the base table and the indexes. If your load consists of a high rate of deletes and updates, it might be worth running it periodically if possible. See the Reference Guide and \"Reclaiming unused space\" in the Derby Server and Administration Guide for details.\r\n\r\nI'm hoping someone with a more intimate knowledge about the Derby store can point us in the right direction, and it would be nice to obtain the size of the corrupted table.\r\nIt seems Derby fails to read back a newly created page, which is odd...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2011-05-18T09:15:42.124+0000","updated":"2011-05-18T09:15:42.124+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13035384","id":"13035384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"body":"@Kristian, Thanks for the help. The data however can't be made public\r\n\r\n1) Ran the corrupt db data with debug libraries. Here is the output in derby.log\r\n\r\nERROR XSDG0: Page Page(51919,Container(0, 1104)) could not be read from disk.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:336)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.readPage(CachedPage.java:695)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(CachedPage.java:190)\r\n\tat org.apache.derby.impl.services.cache.ConcurrentCache.find(ConcurrentCache.java:295)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.initPage(FileContainer.java:2317)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.newPage(FileContainer.java:1800)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainer.addPage(BaseContainer.java:314)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(BaseContainerHandle.java:183)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.doInsert(HeapController.java:302)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.insertAndFetchLocation(HeapController.java:599)\r\n\tat org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(RowChangerImpl.java:452)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1022)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:495)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:416)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:297)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1235)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:625)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(EmbedStatement.java:175)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLIMM(DRDAConnThread.java:5022)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:750)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:290)\r\nCaused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(RAFContainer4.java:474)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(RAFContainer4.java:242)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(RAFContainer4.java:212)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.readPage(CachedPage.java:671)\r\n\t... 19 more\r\n============= begin nested exception, level (1) ===========\r\njava.io.EOFException: Reached end of file while attempting to read a whole page.\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(RAFContainer4.java:474)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(RAFContainer4.java:242)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(RAFContainer4.java:212)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.readPage(CachedPage.java:671)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(CachedPage.java:190)\r\n\tat org.apache.derby.impl.services.cache.ConcurrentCache.find(ConcurrentCache.java:295)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.initPage(FileContainer.java:2317)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.newPage(FileContainer.java:1800)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainer.addPage(BaseContainer.java:314)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(BaseContainerHandle.java:183)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.doInsert(HeapController.java:302)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.insertAndFetchLocation(HeapController.java:599)\r\n\tat org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(RowChangerImpl.java:452)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1022)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:495)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:416)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:297)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1235)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:625)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(EmbedStatement.java:175)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLIMM(DRDAConnThread.java:5022)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:750)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:290)\r\n============= end nested exception, level (1) ===========\r\n\r\n\r\n------------  END SHUTDOWN ERROR STACK -------------\r\n\r\nDEBUG FileContainer OUTPUT: got exception from initPage:\r\nreuse = true\r\nsyncFlag = 0\r\nallocPage = *** Alloc page ***\r\nnextAllocPageNumber = -1\r\nnextAllocPageOffset = 0\r\nreserved1 = 0\r\nreserved2 = 0\r\nreserved3 = 0\r\nreserved4 = 0\r\nborrowedSpace = 0\r\nextent = ------------------------------------------------------------------------------\r\nExtent map of from page 51918 to page 62341\r\n\tpage 51918: valid, in use page\r\n\tpage 51919: free page\r\n\tpage 51920: free page\r\n\tpage 51921: free page\r\n\tpage 51922: free page\r\n\tpage 51923: free page\r\n\tpage 51924: free page\r\n\tpage 51925: free page\r\n\tpage 51926: free page\r\n\tpage 51927: free page\r\n\tpage 51928: free page\r\n\tpage 51929: free page\r\n\tpage 51930: free page\r\n\tpage 51931: free page\r\n\tpage 51932: free page\r\n\tpage 51933: free page\r\n\tpage 51934: free page\r\n\tpage 51935: free page\r\n\tpage 51936: free page\r\n\tpage 51937: free page\r\n\tpage 51938: free page\r\n\tpage 51939: free page\r\n\tpage 51940: free page\r\n\tpage 51941: free page\r\n\tFrom 51941 to 62341 are un-allocated pages\r\n------------------------------------------------------------------------------\r\n\r\n---------------------------------------------------\r\npage id: Page(51917,Container(0, 1104)) Overflow: false PageVersion: 51 SlotsInUse: 0 DeletedRowCount: 0 PageStatus: 1 NextId: 6 firstFreeByte: 109 freeSpace: 3979 totalSpace: 3979 spareSpace: 20% minimumRecordSize : 12 PageSize: 4096\r\n---------------------------------------------------\r\nHex dump:\r\n00000000: 0076 0000 0001 0000 0000 0000 0033 0000  .v...........3..\r\n00000010: 0000 0006 0000 0000 0000 0000 0000 0000  ................\r\n00000020: 0000 0000 0001 0000 0000 0000 0000 0000  ................\r\n00000030: 0000 0000 0000 0000 0000 0000 ffff ffff  ................\r\n00000040: ffff ffff 0000 0000 0000 0000 0000 0000  ................\r\n00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000060: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000070: 000c ace0 0000 0000 0000 00ca ce00 0000  ..?........??...\r\n00000080: 0000 00f3 8500 0000 1830 0000 1200 0000  ....?....0......\r\n00000090: 1800 0000 0000 0000 0000 0000 0000 0000  ................\r\n000000a0: 0000 0000 0000 0000 187f ffff 0000 0018  ................\r\n000000b0: 7fff ff00 0000 0000 0000 0000 0000 0000  ................\r\n000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000100: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000110: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000120: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000130: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000140: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000150: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000160: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000170: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000180: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000200: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000210: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000290: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000002a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000002b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000002c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000002d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000002e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000002f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000300: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000310: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000320: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000330: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000340: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000350: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000360: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000370: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000380: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000400: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000410: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000460: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000470: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000480: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000490: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000500: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000510: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000520: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000530: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000540: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000550: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000560: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000570: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000580: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000590: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000005a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000005b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000005c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000005d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000005e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000005f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000600: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000610: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000620: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000630: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000640: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000650: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000660: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000670: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000680: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000690: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000006a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000006b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000006c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000006d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000006e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000006f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000700: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000710: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000720: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000730: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000740: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000750: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000760: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000770: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000780: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000800: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000810: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000880: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000890: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000008a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000008b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000008c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000008d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000008e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000008f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000900: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000910: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000920: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000930: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000940: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000950: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000960: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000970: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000980: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000990: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................\r\n00000ff0: 0000 0000 0000 0000 0000 0000 4dc3 fccd  ............M?.?\r\n---------------------------------------------------\r\n\r\n2011-05-18 12:30:24.189 GMT Thread[DRDAConnThread_3,5,main] (XID = 28699230), (SESSIONID = 1), (DATABASE = kpidb), (DRDAID = GAEDD120.O4F6-4110096304207220172{1}), Cleanup action starting\r\n2011-05-18 12:30:24.189 GMT Thread[DRDAConnThread_3,5,main] (XID = 28699230), (SESSIONID = 1), (DATABASE = kpidb), (DRDAID = GAEDD120.O4F6-4110096304207220172{1}), Failed Statement is: INSERT INTO KPI.KPI_MERGEIN (A0_TXN_ID, A1_NE_ID, A2_CHU_IP_ADDR, A3_BATCH_DATE,A5_CODE) VALUES (-1, 'BMTDE', '192.2.1.3', 231456879, 'KSD')\r\nERROR XSDG0: Page Page(51919,Container(0, 1104)) could not be read from disk.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:336)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.readPage(CachedPage.java:695)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(CachedPage.java:190)\r\n\tat org.apache.derby.impl.services.cache.ConcurrentCache.find(ConcurrentCache.java:295)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.initPage(FileContainer.java:2317)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.newPage(FileContainer.java:1800)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainer.addPage(BaseContainer.java:314)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(BaseContainerHandle.java:183)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.doInsert(HeapController.java:302)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.insertAndFetchLocation(HeapController.java:599)\r\n\tat org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(RowChangerImpl.java:452)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1022)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:495)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:416)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:297)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1235)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:625)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(EmbedStatement.java:175)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLIMM(DRDAConnThread.java:5022)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:750)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:290)\r\nCaused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(RAFContainer4.java:474)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(RAFContainer4.java:242)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(RAFContainer4.java:212)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.readPage(CachedPage.java:671)\r\n\t... 19 more\r\n============= begin nested exception, level (1) ===========\r\njava.io.EOFException: Reached end of file while attempting to read a whole page.\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(RAFContainer4.java:474)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(RAFContainer4.java:242)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(RAFContainer4.java:212)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.readPage(CachedPage.java:671)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(CachedPage.java:190)\r\n\tat org.apache.derby.impl.services.cache.ConcurrentCache.find(ConcurrentCache.java:295)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.initPage(FileContainer.java:2317)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.newPage(FileContainer.java:1800)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainer.addPage(BaseContainer.java:314)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(BaseContainerHandle.java:183)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.doInsert(HeapController.java:302)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.insertAndFetchLocation(HeapController.java:599)\r\n\tat org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(RowChangerImpl.java:452)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1022)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:495)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:416)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:297)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1235)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:625)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(EmbedStatement.java:175)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.parseEXCSQLIMM(DRDAConnThread.java:5022)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.processCommands(DRDAConnThread.java:750)\r\n\tat org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:290)\r\n============= end nested exception, level (1) ===========\r\n\r\n2011-05-18 12:30:24.189 GMT:\r\nShutting down instance a816c00e-0130-0313-18c9-ffff874c3ff6\r\n----------------------------------------------------------------\r\nCleanup action completed\r\n\r\n2) The production environment does include delete scripts to delete data older than 7 days and it is run every 15 minutes. Also SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE procedure is run once every day to release free pages to OS. \r\n\r\nIntersting observation however is, it is SYSCS_UTIL.SYSCS_COMPRESS_TABLE procedure on the corrupt db that made it work. Running SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE procedure on the corrupt db returned the following error.\r\n\r\nERROR 38000: DERBY SQL error: SQLCODE: -1, SQLSTATE: 38000, SQLERRMC: java.sql.SQLException: Page Page(51919,Container(0, 1104)) could not be read from disk.38000XSDG0:Page(51919,Container(0, 1104))4096XSDG0.DXJ001:java.io.EOFExceptionReached end of file while attempting to read a whole page.XJ001.U\r\nERROR XSDG0: DERBY SQL error: SQLCODE: 0, SQLSTATE: XSDG0, SQLERRMC: Page(51919,Container(0, 1104))4096XSDG0.D\r\nERROR XJ001: DERBY SQL error: SQLCODE: 0, SQLSTATE: XJ001, SQLERRMC: java.io.EOFExceptionReached end of file while attempting to read a whole page.XJ001.U\r\n\r\nWould it be recommeneded to run the other compress script instead of inplace compress script? Also would upgrading to newer version would help.\r\n\r\n@Rick , regarding Page size query - the file system are indeed mutiple of 32Kb \r\n\r\nKPI_IN\r\n254169088 c400.dat\r\n44179456\t c501.dat\r\n48295936\tc581.dat\r\n197808128\tc481.dat\r\nKPI_ERROR1\t\r\n8192\tc591.dat\r\n8192\tc511.dat\r\n8192\tc491.dat\r\n8192\tc410.dat\r\nKPI_ERROR2\t\r\n1630208\tc420.dat\r\n258048\tc5a1.dat\r\n184320\tc521.dat\r\n2142208\tc4a1.dat\r\nKPI_ERRORMERGE\t\r\n8192\tc4b1.dat\r\n8192\tc430.dat\r\n8192\tc5b1.dat\r\n8192\tc531.dat\r\nKPI_DROPPED\t\r\n4980736\tc5c1.dat\r\n3477504\tc541.dat\r\n15597568\tc4c1.dat\r\n31903744\tc440.dat\r\nKPI_MERGEIN\t\r\n43851776\tc5d1.dat\r\n27942912\tc551.dat\r\n148070400\tc4d1.dat\r\n212660224\tc450.dat\r\nKPI_MERGEOUT\t\r\n121430016\tc4e1.dat\r\n48001024\tc460.dat\r\n45146112\tc5e1.dat\r\n19886080\tc561.dat\r\nKPI_OUT\t\r\n7487488\tc571.dat\r\n15474688\tc5f1.dat\r\n46276608\tc4f1.dat\r\n57602048\tc470.dat\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"created":"2011-05-18T13:52:02.644+0000","updated":"2011-05-18T13:52:02.644+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13035388","id":"13035388","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Any chance you're hitting a filesystem quota of some sort? Have you checked all the ulimit-like settings? This feels like the sort of problem where the operating system is truncating the file or partially writing it because the operating system thinks the process has hit its limit.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2011-05-18T13:57:20.293+0000","updated":"2011-05-18T13:57:20.293+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13035420","id":"13035420","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"body":"@Bryan, I doubt. \r\n\r\nThe corrupted DB was moved from Production (HP-UX) to test environment (Solaris & Windows) and the DB was started with the exact settings.  All three environments return the same error on INSERT in the KPI.KPI_MERGE_IN table","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"created":"2011-05-18T14:53:29.969+0000","updated":"2011-05-18T14:53:29.969+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13035551","id":"13035551","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Varma,\r\n\r\nThis may be a red herring, but it is worth asking: does your application experience thread interrupts?\r\n\r\nSome useful information might surface if you run the DataFileReader tool against the corrupt heap conglomerate. The tool is attached to DERBY-5201. Redirect the output to a file and then attach that file to this JIRA issue. Help on the tool's usage can be obtained by typing\r\n\r\n  java DataFileReader\r\n\r\nI think that the following experiment would be useful (where $dbName is the name of your database directory):\r\n\r\n  java DataFileReader $dbName/seg0/c450.dat -v -p 51916 -n 6 > c450_partial.xml\r\n\r\nYou can also use the -d option of the tool if you are willing to disclose the data which appears in the closing pages of the file. See the help output for a description of how to use the -d option. You can, of course, redact any sensitive information in the output.\r\n\r\nThanks,\r\n-Rick\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2011-05-18T18:29:00.122+0000","updated":"2011-05-18T18:29:00.122+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13036774","id":"13036774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"body":"Attached(DataFileReader_Output.zip) the XML files generated when DataFileReader.class run on KPI.KPI_MERGEIN table .DAT files.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"created":"2011-05-20T10:58:13.668+0000","updated":"2011-05-20T11:10:21.759+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13037748","id":"13037748","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"body":"Current Version of Derby been used in production is 10.5.3.0. Will the problem be resolved by upgrading derby database to latest version(which is 10.8.1.2)?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"created":"2011-05-23T06:14:10.400+0000","updated":"2011-05-23T06:14:10.400+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13038147","id":"13038147","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Varma,\r\n\r\nIt's hard to say if an upgrade will fix this problem since we don't understand the root cause yet. The reason I asked whether your application experiences interrupts is that they could potentially result in a data corruption on version 10.5.3.0. Substantial work was put into protecting Derby from interrupts in 10.8.1.2. Can you say whether your application might be experiencing thread interrupts?\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2011-05-23T19:12:59.151+0000","updated":"2011-05-23T19:12:59.151+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13038293","id":"13038293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"The dump of the data pages seem to indicate that the file has no pages from page 51919 onwards (the last dumped is 515918 on c450.dat). The data dumped show that page 51917 has an extent that coincides with the one we saw dumped:\r\nStart/end:: 51918:62341. And page 51918 is indeed present and valid in the dump. But no further pages are printed. Rick, does the tool continue printiing till it reaches EOF or does it stop according some variable in the container stating how many pages are allocated? I am not very familiar with this code at all, but doesn't the presence of the extent information on page 51917 indicated that pages from 51918:62341 should be allocated (e.g be not handled back to the operating system after an inline compress with truncate end option[1])?\r\n\r\n[1] http://db.apache.org/derby/docs/10.5/ref/rrefproceduresinplacecompress.html\r\n\r\nBtw, Varma, does the app ever perform in-place compress?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2011-05-23T22:41:35.765+0000","updated":"2011-05-23T22:41:35.765+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13038555","id":"13038555","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi, Dag. By default, the DataFileReader tool reads until it reaches EOF. You can also tell it to stop reading after a fixed number of pages. \r\n\r\nThe page size of c450.dat is 4096, the file is 212660224 bytes long according to Varma's comment on 2011-05-18, so the number of pages in the file is 212660224 / 4096 = 51919. This agrees with what the tool found: the tool successfully decoded pages 0 - 51918.\r\n\r\nThe extent lengths are:\r\n\r\ngrep extentLength Output_c450.dat.xml \r\n            <extentLength>10216</extentLength>\r\n            <extentLength>10424</extentLength>\r\n            <extentLength>10424</extentLength>\r\n            <extentLength>10424</extentLength>\r\n            <extentLength>10424</extentLength>\r\n            <extentLength>24</extentLength>\r\n\r\nIt does seem odd that the last allocation page thinks there are 24 more pages but there is really only 1 more page.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2011-05-24T13:40:38.887+0000","updated":"2011-05-24T13:40:38.887+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13039363","id":"13039363","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"The issues here all have the feel of the database getting broken sometime in past.  Usually once broken not much can be\r\ndone, including upgrading - other than rebuild.  I would suggest running the consistency checker across the whole database\r\nto see if there are other hidden problems lurking.\r\n\r\nGiven the end of file issues it would be interesting to know:\r\n    o I see you run online compress once a day, maybe there is a bug in this code.   Can you tell us exactly how you run this, as it has\r\n       3 options that can be set.  This code definitely executes a path that manipulates the end of file which seems to where the problem\r\n       is.  But the case you are noting more has the feel a problem in a normal allocation.  Derby will extend the file the file by a group\r\n       of pages and then force these empty new pages to disk.  For some reason this group has not made it to disk, the extent map is\r\n       indicating that it should be there, so an error results because we can't find it there.  Even though it is a new page, sometimes\r\n       a free page is really a reused page and we need some information from the old page to properly create the new page.  \r\n    o I am not too familar with HP unix, so not sure if these questions are applicable.  Can you describe the file system that derby \r\n       is running on there.  Is there any chance that I/O system forces through java are not being respected by the filesystem/hardware.\r\n       On other unix systems there are options available to force wait on synchronous writes, and derby depends on this.  Unfortunately\r\n       often the default is to pretend that write sync is happening when it is not and this can cause problems for Derby.  \r\n\r\nWithout the actual db it is hard to know what is going on exactly from just the stack.  I thought derby was meant to be able to handle\r\nsome \"missing\" pages at the end of the file, so this would be one case where it might be useful to try a more recent version of the\r\nDerby software.  It could be that I am remembering recovery logic rather than runtime logic.\r\nThe missing pages feels like a lost \"force\" of the free pages thus the questions about filesystem/hardware settings.  Running the \r\nconsistency checker could find other lsot forces that may have existed.\r\n\r\nThis kind of error can also come from users manipulating files in the log directory.  Have you ever \"fixed\" a problem where the\r\ndatabase would not boot by removing files from the log directory?\r\n\r\nIn trying to understand what might have happened to cause the bug, can you correlate at all the problems happening with machine\r\ncrashes at all?  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-05-25T21:59:23.565+0000","updated":"2011-05-25T22:10:50.317+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13039377","id":"13039377","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I am not surprised that SYSCS_UTIL.SYSCS_COMPRESS_TABLE fixed the problem, as it seems the issue is in just the last few pages of the file that are marked free but not actually on disk.  This version of compress which I refer to as offline, just reads through the used pages of the file and inserts into the new table and never looks at the problem empty and not on disk pages at the end of the file.  \r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-05-25T22:15:05.836+0000","updated":"2011-05-25T22:15:05.836+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13039382","id":"13039382","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"it is interesting that the case is exactly at a new extent which may or may not be the issue.  It you have any other examples of this problem it would help to know if the end of the file looks the same as this one.  Again once this problem happens a number of things\r\nare likely to break, and the real problem is not the insert but what allowed the allocate of the free pages to finish without the space on\r\ndisk being forced.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2011-05-25T22:19:39.262+0000","updated":"2011-05-25T22:19:39.262+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13039583","id":"13039583","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"body":"@Dag - Inplace Compress command is called once every day.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=soxdatabase","name":"soxdatabase","emailAddress":"PanindraVarma dot Rudraraju at cognizant dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Varma R","active":true},"created":"2011-05-26T08:15:49.779+0000","updated":"2011-05-26T08:15:49.779+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13165312","id":"13165312","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"body":"I have also problems with the inplace compress function of derby.\r\nWith the attached snippet (DbCompressErrorTester.java) i can reproduce the \"Reached end of file while attempting to read a whole page.\" exception. Perhaps it can help to fix the error.\r\nTested with derby version 10.8.1.2 and 10.8.2.2.\r\n\r\nI insert some data into a table. Then i delete all data and call SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE with PURGE_ROWS=0, DEFRAGMENT_ROWS=0 and TRUNCATE_END=1. After some additional insert derby throws following exception:\r\njava.sql.SQLException: Page Page(10219,Container(0, 1136)) could not be read from disk.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.seeNextException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(Unknown Source)\r\n        at DbCompressErrorTester.insertData(DbCompressErrorTester.java:164)\r\n        at DbCompressErrorTester.test(DbCompressErrorTester.java:118)\r\n        at DbCompressErrorTester.main(DbCompressErrorTester.java:40)\r\nCaused by: java.sql.SQLException: Page Page(10219,Container(0, 1136)) could not be read from disk.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n        ... 13 more\r\nCaused by: java.sql.SQLException: Java exception: 'Reached end of file while attempting to read a whole page.: java.io.EOFException'.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.javaException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n        ... 10 more\r\nCaused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.CachedPage.readPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(Unknown Source)\r\n        at org.apache.derby.impl.services.cache.ConcurrentCache.find(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.FileContainer.initPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.FileContainer.newPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.BaseContainer.addPage(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.HeapController.doInsert(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.HeapController.insert(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.InsertResultSet.open(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)\r\n        ... 6 more\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"created":"2011-12-08T16:36:18.868+0000","updated":"2011-12-08T16:39:34.167+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13165711","id":"13165711","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thanks for the enclosed repro, Stefan! It will increase your chances of getting a fix significantly :)\r\nI managed to reproduced the problem on Derby trunk. In my case it took about a minute.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2011-12-09T00:39:34.561+0000","updated":"2011-12-09T00:42:21.547+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13165910","id":"13165910","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"body":"That would be nice. I was suprised too, it could be reproduced in such an easy way. I hope it is a small thing to fix it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"created":"2011-12-09T07:39:40.287+0000","updated":"2011-12-09T07:39:40.287+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13166205","id":"13166205","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Re-opening this issue. I don't understand why it was closed right after an easy repro was posted.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2011-12-09T14:31:48.012+0000","updated":"2011-12-09T14:31:48.012+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13210451","id":"13210451","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Triage for 10.9. Marking Critical priority,  Urgent Urgency, High Value Fix.  Changing component to store. I was able to reproduce with the attached repro at  10.9.0.0 alpha - (1242867)\r\n\r\njava.sql.SQLException: Page Page(10219,Container(0, 1168)) could not be read from disk.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n        at org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:278)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:431)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2340)\r\n        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:82)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1334)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1715)\r\n        at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(EmbedPreparedStatement.java:311)\r\n        at DbCompressErrorTester.insertData(DbCompressErrorTester.java:162)\r\n        at DbCompressErrorTester.test(DbCompressErrorTester.java:116)\r\n        at DbCompressErrorTester.main(DbCompressErrorTester.java:38)\r\nCaused by: java.sql.SQLException: Page Page(10219,Container(0, 1168)) could not be read from disk.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:42)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:12\r\n2)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n        ... 12 more\r\nCaused by: java.sql.SQLException: Java exception: 'Reached end of file while attempting to read a whole page.: java.io.E\r\nOFException'.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:42)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:12\r\n2)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n        at org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n        ... 10 more\r\nCaused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(RAFContainer4.java:1169)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(RAFContainer4.java:430)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(RAFContainer4.java:370)\r\n        at org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(RAFContainer4.java:263)\r\n        at org.apache.derby.impl.store.raw.data.CachedPage.readPage(CachedPage.java:673)\r\n        at org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(CachedPage.java:193)\r\n        at org.apache.derby.impl.services.cache.ConcurrentCache.find(ConcurrentCache.java:295)\r\n        at org.apache.derby.impl.store.raw.data.FileContainer.initPage(FileContainer.java:2430)\r\n        at org.apache.derby.impl.store.raw.data.FileContainer.newPage(FileContainer.java:1878)\r\n        at org.apache.derby.impl.store.raw.data.BaseContainer.addPage(BaseContainer.java:314)\r\n        at org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(BaseContainerHandle.java:183)\r\n        at org.apache.derby.impl.store.access.heap.HeapController.doInsert(HeapController.java:302)\r\n        at org.apache.derby.impl.store.access.heap.HeapController.insert(HeapController.java:575)\r\n        at org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(RowChangerImpl.java:457)\r\n        at org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:999)\r\n        at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:519)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:443)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:324)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1242)\r\n        ... 5 more\r\n\r\n  I have heard other anecdotal reports of possible corruption after introducing compress.     I hope this is it.\r\n\r\n\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-02-17T19:05:36.709+0000","updated":"2012-02-17T19:05:36.709+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13260654","id":"13260654","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"body":"Is there any fix or workaround available ?\r\n\r\nIt seems to be a problem of the cache. How can i rebuild the cache after the exception occurs ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"created":"2012-04-24T15:22:58.845+0000","updated":"2012-04-24T15:22:58.845+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13260882","id":"13260882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"I also can reproduce this problem by running the repro which Stefan supplied. I will look into this bug.\r\n\r\nHi Stefan: From the stack trace it appears that a base table has become corrupted. I don't know of any way to rebound from this other than to restore your database from the last good backup. Hopefully we will have a fix for this problem in 10.9, but that will only prevent the problem from happening again. The fix will not repair an already broken database.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-04-24T19:43:54.964+0000","updated":"2012-04-24T19:43:54.964+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13261022","id":"13261022","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"What I would do if looking at this would be to see if you can get it to reproduce with flags set to keep all the transaction logs around.  Using that with identifying when the page goes bad should get closer to where the problem is.  I would look for correlation of when \r\npage alloc or page dealloc happens and when log records happen for the bad page.\r\n\r\nThe stack printed has the feel of maybe looking for a page that is past the end of file?  Putting some debugging about the page table and the end of file at that stack might help.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2012-04-24T21:18:11.935+0000","updated":"2012-04-24T21:18:11.935+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13262776","id":"13262776","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"body":"@Mike: How can i set the flags for transaction logging ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"created":"2012-04-26T17:31:12.492+0000","updated":"2012-04-26T17:31:12.492+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13264998","id":"13264998","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching 5234_alloc.out, 5234_page_10219.out, and 5234_summary.out.\r\n\r\nI turned on log archiving by calling SYSCS_UTIL.SYSCS_BACKUP_DATABASE_AND_ENABLE_LOG_ARCHIVE_MODE_NOWAIT. This resulted in accumulating 191 transaction log files. Fortunately, this did not affect the bug. The bug continues to occur on exactly the same page at exactly the same point in the test.\r\n\r\nTo examine the transaction logs, I ran them through the LogFileReader program attached to DERBY-5195 and I looked for log records involving AllocPageOperation actions. 5234_alloc.out is the result of running the following script against the transaction logs:\r\n\r\n#! /bin/bash\r\n\r\nfor file in `ls -1 -r -t *.dat`\r\ndo\r\n  echo XXXXXXXXXXXXXXX $file XXXXXXXXXXXXXXX\r\n\r\n  java LogFileReader $file -v | grep -A 2 -i AllocPageOperation\r\ndone\r\n\r\n5234_page_10219.out was produced by running the following command to find references to actions on the bad page:\r\n\r\n#! /bin/bash\r\n\r\nfor file in `ls -1 -r -t *.dat`\r\ndo\r\n  echo XXXXXXXXXXXXXXX $file XXXXXXXXXXXXXXX\r\n\r\n  java LogFileReader $file -v | grep -A 2 -B 8 -i 10219\r\ndone\r\n\r\n5234_summary.out is a summary of all activity on the bad page which I could find in 5234_page_10219.out.\r\n\r\nI don't see anything odd in the transaction logs so far, but I probably don't know what to look for. Other suggestions for what I should look for in the transaction logs?\r\n\r\nThanks,\r\n-Rick\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-04-30T16:09:13.615+0000","updated":"2012-04-30T16:09:13.615+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13265057","id":"13265057","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching log85.dat and log191.dat.\r\n\r\nlog85.dat is the log file which contains the first, successful allocation of the bad page and then inserts into it. log191 is the last file, where Derby crashed at the point where it should have been logging a checksum.\r\n\r\nI decoded these log files as follows, but the output is too big to be attached to this JIRA:\r\n\r\n   java LogFileReader $logFile -v\r\n\r\nHere is the sequence of good operations from log85.dat:\r\n\r\nbegin transaction\r\ninsert into slot 31 of page 10218\r\nend transaction\r\nchecksum\r\nbegin transaction\r\ninitialize page 10219\r\n\r\nHere is the concluding sequence of operations from log191.dat\r\n\r\nbegin transaction\r\ninsert into slot 31 of page 10218\r\nend transaction\r\n<end of log file, this is where Derby crashes>\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-04-30T17:57:37.030+0000","updated":"2012-04-30T17:57:37.030+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13265148","id":"13265148","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Might be a red herring, but I see that there is only one ChainAllocPageOperation in the transaction logs. That occurs in log85.dat. It allocates page 10217 (2 pages before the bad page) and chains it to page 0. I would expect to see a second ChainAllocPageOperation after the compress. But I don't.\r\n\r\nHere is the sequence of operations from log85.dat:\r\n\r\nbegin transaction\r\ninsert into slot 31 of page 10216\r\nend transaction\r\nchecksum\r\nbegin transaction\r\ninitialize page 10217\r\nchain alloc page 10217 to page 0\r\n\r\nHere is the corresponding sequence of operations from log191.dat\r\n\r\nbegin transaction\r\ninsert into slot 31 of page 10216\r\nend transaction\r\nchecksum\r\nbegin transaction\r\ninitialize page 10218\r\nalloc page 10218 (linking it to 10217)\r\n\r\nSomething asymmetric is happening around page 10217.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-04-30T19:45:22.661+0000","updated":"2012-04-30T19:58:43.462+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13266654","id":"13266654","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching derby-5234-01-aa-emptyAllocPage.diff. These small changes make the repro run correctly. Regression tests pass cleanly on this patch.\r\n\r\nI have stumbled across at least 3 separate problems in the compression code. However, that may simply mean that I don't understand the code. The 3 problems are:\r\n\r\n1) A boundary checking error which causes an allocation extent to think that it still has pages, even though those pages have been released to the operating system. This is what causes the repro to fail.\r\n\r\n2) A confusion about whether a variable represents a bit position or a page number. This causes the code to not understand that all of the pages in an extent have been released. Fixing this check does not change any user-visible behavior, but I think that fixing the check is a step in the right direction.\r\n\r\n3) The inability of the compression code to release pages held by the first allocation page. I don't understand this problem yet. Before looking into this one, I need advice about whether I am heading in the right direction.\r\n\r\nMore information about these 3 problems follows:\r\n\r\n-------------------\r\n\r\nConcerning (1), the boundary check which causes the repro to fail:\r\n\r\nIn AllocExtent.compressPages(), the new_highest_page argument can be -1. This happens if all of the pages in the extent turn out to be empty. However, if new_highest_page is -1, then the code does not fall into the block at line 577; that's the code which actually marks the pages as released. The value of new_highest_page was calculated by AllocExtent.compress(). The variable name new_highest_page is a confusing name. This is a bit position and not a page number, and in the case when it is -1, it is a flag that all pages are empty. AllocExtent.compress() returns new_highest_page + 1, triggering its caller to fall into a block at line 1074 in AllocPage.compress(); that block releases pages to the operating system. That is  how we end up in the situation that the pages are actually released but AllocExtent still thinks they are allocated. That, in turn, is what tricks a later INSERT into trying to write onto a non-existent page.\r\n\r\nThe fix is to make the code fall into the block at 577 if new_highest_page is -1.\r\n\r\n\r\n-------------------\r\n\r\nConcerning (2), the confusion about whether AllocExtent.compress() returns a bit position or a page number:\r\n\r\nAt line 1080 in AllocPage.compress(), the code compares a bit position to a page number. Bit positions are small integers, e.g., in the range 0-200. Page numbers are potentially larger integers in, say, the range 12000-12200. The weird comparison at line 1080 causes AllocPage.compress() to not recognize that all of the pages in the extent have been released.\r\n\r\nI have renamed last_valid_page to last_valid_page_bit to clarify that this is a bit position, not a page number. And I have changed the check at 1080 to compare the bit position to another bit position. This comparison deserves the attention of someone who knows this code better than I do. Is this the right comparison?\r\n\r\nIn a follow-on cleanup issue, it might make sense to change variable names in the allocation code to clarify what is a bit number and what is a page number. This may disclose other questionable code in this area.\r\n\r\n\r\n-------------------\r\n\r\nConcerning (3), the inability of the compression code to release empty pages managed by the first allocation page:\r\n\r\nI had hoped that the change for (2) would cause the compress to release more space. But it didn't. The compress only releases the pages managed by the second (last) allocation page. All of the pages managed by the first allocation page are also empty, but they are not released. This seems wrong to me. I would expect the file to shrink back to its initial size.\r\n\r\nBefore pursuing this follow-on issue, I would like advice about whether I am headed in the right direction. Should the compress shrink the page back to its initial size? Or should SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP', 'OPERATIONS', 0, 0, 1) just release empty pages managed by the second and higher allocation pages?\r\n\r\n\r\n-------------------\r\n\r\nTouches the following files:\r\n\r\nM       java/engine/org/apache/derby/impl/store/raw/data/AllocExtent.java\r\n\r\nFix for (1).\r\n\r\n----------\r\n\r\nM       java/engine/org/apache/derby/impl/store/raw/data/AllocPage.java\r\n\r\nClarification for (2).\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-02T15:53:20.968+0000","updated":"2012-05-02T15:53:20.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13267007","id":"13267007","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"Concerning the 3rd point above I have logged DERBY-5738.   looks like intent was to handle multiple extents but at least in 10.1 and later the code does not handle shrinking past an extent.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2012-05-02T23:16:19.438+0000","updated":"2012-05-02T23:16:19.438+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13268498","id":"13268498","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"the patch changes look right to me.  the existing code (not just your changes) could use more comments, which probably led to the bugs in the first place. I like the changes to \r\nvar names to make it clear they are bit positions of the pages not page numbers.  I would be happy to add comments either after you checkin or produce a new patch based on your work, let me know how you want to procede.\r\n\r\nDefinitely would be good to get a test case checked in with the patch.\r\n\r\nlonger term - does not have to be part of this fix,  trying to think of some complete edge case test, as at least fix for 1 is an off by one error.  probably not for running every night.  Something like\r\n2k page heap, \r\nfor (i up to some number bigger than a few extents)\r\ndrop/create table each time\r\nadd rows such that it fills i pages\r\ndelete all rows\r\ninplace compress \r\nsome set of tests, at least insert i + n rows\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2012-05-04T16:21:31.384+0000","updated":"2012-05-04T16:21:31.384+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13268547","id":"13268547","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks, Mike. I will add a test case to the patch. Please add comments on top of the patch once I've checked it in--I think that your comments will be more useful than mine. I will also put some thought into writing a follow-on patch containing tests for edge cases. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-04T17:21:32.818+0000","updated":"2012-05-04T17:21:32.818+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13269942","id":"13269942","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching Derby5234.java, a simpler, faster version of the repro. On my machine, this repro trips the bug in about 12 seconds. I will probably use this simpler code in the test case which will accompany the first patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-07T19:51:45.411+0000","updated":"2012-05-07T19:51:45.411+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13270455","id":"13270455","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching derby-5234-01-ab-emptyAllocPage.diff. This adds a regression test case to the previous rev of the patch. The test runs correctly with the patch and fails with an EOFException without the patch. I am running full regression tests again.\r\n\r\nTouches the following additional files:\r\n\r\nM       java/testing/org/apache/derbyTesting/functionTests/tests/store/_Suite.java\r\nA       java/testing/org/apache/derbyTesting/functionTests/tests/store/Derby5234Test.java\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-08T13:31:22.312+0000","updated":"2012-05-08T13:31:22.312+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13270522","id":"13270522","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Tests passed cleanly for me. Committed derby-5234-01-ab-emptyAllocPage.diff at subversion revision 1335570.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-08T15:10:43.771+0000","updated":"2012-05-08T15:10:43.771+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13270681","id":"13270681","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching derby-5234-02-aa-edgeCaseTests.diff. This adds a couple more edge cases to the test. Committed at subversion revision 1335677.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-08T18:25:29.390+0000","updated":"2012-05-08T18:25:29.390+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13273382","id":"13273382","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"I am getting the same error, even after calling  SYSCS_UTIL.SYSCS_COMPRESS_TABLE (or  SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE ) programatically, before and/or after the DELETE statement. The DB size is 1.3 gb. \r\nAny updates on when a quick-fix or workaround or the actual fix would be available? This is an urgent requirement. Thanks.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-11T16:03:38.820+0000","updated":"2012-05-11T16:03:38.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13273397","id":"13273397","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Ported 1335570 and 1335677 from trunk to 10.8 branch at subversion revision 1337258.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-11T16:24:04.714+0000","updated":"2012-05-11T16:24:04.714+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13273404","id":"13273404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nThe 10.9 development trunk contains what we think is a fix for this bug. I have just ported that fix to the 10.8 branch.\r\n\r\nThe fix should appear in the 10.9 feature release which we will evaluate later this month: http://wiki.apache.org/db-derby/DerbyTenNineOneRelease\r\n\r\nThere is also talk about producing a 10.8.3 maintenance release after the community publishes a 10.9 feature release. That maintenance release will also contain the fix.\r\n\r\nHope this helps,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-11T16:28:39.221+0000","updated":"2012-05-11T16:28:39.221+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13273429","id":"13273429","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Resolving this issue now that the fix has been backported to 10.8. Follow-on work was discussed on 2012-05-04. That work can continue under DERBY-5761.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-11T17:13:37.257+0000","updated":"2012-05-11T17:13:37.257+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13273496","id":"13273496","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\n\r\nI built version 10.8.2.3, but unfortunately, I'm still getting the same errors. Here's a dump of the same (note that the container exception occurs a little deeper down the stack trace) :-\r\n\r\n*****************************************************************************************************************************************************************************\r\n1 May 2012 11:29 DataDictionary.deleteHRData = deleteCmd = DELETE FROM APP.CPU_059222_HR WHERE SampleTimestamp <= ?\r\n11 May 2012 11:29 DataDictionary.deleteHRData = Delete executed with Timestamp = Thu May 10 11:29:09 PDT 2012\r\n11 May 2012 11:29 DataDictionary.reclaimDiskSpace = compressCmd:->call SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP', 'CPU_059222_HR',0,0, 1)\r\n11 May 2012 11:29 DataDictionary.reclaimDiskSpace = compressSqlStmt executed for Table:->CPU_059222_HR\r\n11 May 2012 11:29 DataDictionary.deleteHRData = Hourly retention = 24\r\n11 May 2012 11:29 DataDictionary.deleteHRData = deleteCmd = DELETE FROM APP.PROCESS_059222_HR WHERE SampleTimestamp <= ?\r\n11 May 2012 11:29 DataDictionary.deleteHRData = deleteHRData: SQL error - Java exception: ': java.lang.NullPointerException'.\r\n11 May 2012 11:29 SchemaDAO.tableExists = Java exception: ': java.lang.NullPointerException'.\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:634)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(EmbedConnection30.java:73)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(EmbedConnection40.java:51)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:70)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:248)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:144)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.SchemaDAO.tableExists(SchemaDAO.java:59)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.DataDictionary.deleteHRData(DataDictionary.java:464)\r\n\tat com.idelji.operations.iasset.plugin.imon.service.CleanUpTask.run(CleanUpTask.java:54)\r\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 16 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:659)\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:589)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.openContainer(Xact.java:1316)\r\n\tat org.apache.derby.impl.store.access.conglomerate.OpenConglomerate.init(OpenConglomerate.java:910)\r\n\tat org.apache.derby.impl.store.access.heap.Heap.open(Heap.java:689)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:476)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:1308)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndexMinion(DataDictionaryImpl.java:9271)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndex(DataDictionaryImpl.java:9229)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.locateSchemaRow(DataDictionaryImpl.java:1722)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getSchemaDescriptor(DataDictionaryImpl.java:1589)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initDefaultSchemaDescriptor(GenericLanguageConnectionContext.java:425)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initialize(GenericLanguageConnectionContext.java:401)\r\n\tat org.apache.derby.impl.db.BasicDatabase.setupConnection(BasicDatabase.java:295)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.startTransaction(TransactionResourceImpl.java:189)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserIsNotARole(EmbedConnection.java:1251)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(EmbedConnection.java:1215)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:422)\r\n\t... 10 more\r\n11 May 2012 11:29 SchemaDAO.tableExists = Java exception: ': java.lang.NullPointerException'.\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:634)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(EmbedConnection30.java:73)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(EmbedConnection40.java:51)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:70)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:248)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:144)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.SchemaDAO.tableExists(SchemaDAO.java:59)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.DataDictionary.deleteHRData(DataDictionary.java:464)\r\n\tat com.idelji.operations.iasset.plugin.imon.service.CleanUpTask.run(CleanUpTask.java:54)\r\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 16 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:659)\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:589)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.openContainer(Xact.java:1316)\r\n\tat org.apache.derby.impl.store.access.conglomerate.OpenConglomerate.init(OpenConglomerate.java:910)\r\n\tat org.apache.derby.impl.store.access.heap.Heap.open(Heap.java:689)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:476)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:1308)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndexMinion(DataDictionaryImpl.java:9271)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndex(DataDictionaryImpl.java:9229)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.locateSchemaRow(DataDictionaryImpl.java:1722)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getSchemaDescriptor(DataDictionaryImpl.java:1589)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initDefaultSchemaDescriptor(GenericLanguageConnectionContext.java:425)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initialize(GenericLanguageConnectionContext.java:401)\r\n\tat org.apache.derby.impl.db.BasicDatabase.setupConnection(BasicDatabase.java:295)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.startTransaction(TransactionResourceImpl.java:189)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserIsNotARole(EmbedConnection.java:1251)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(EmbedConnection.java:1215)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:422)\r\n\t... 10 more\r\n11 May 2012 11:29 SchemaDAO.tableExists = Java exception: ': java.lang.NullPointerException'.\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:634)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(EmbedConnection30.java:73)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(EmbedConnection40.java:51)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:70)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:248)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:144)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.SchemaDAO.tableExists(SchemaDAO.java:59)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.DataDictionary.deleteHRData(DataDictionary.java:464)\r\n\tat com.idelji.operations.iasset.plugin.imon.service.CleanUpTask.run(CleanUpTask.java:54)\r\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 16 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:659)\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:589)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.openContainer(Xact.java:1316)\r\n\tat org.apache.derby.impl.store.access.conglomerate.OpenConglomerate.init(OpenConglomerate.java:910)\r\n\tat org.apache.derby.impl.store.access.heap.Heap.open(Heap.java:689)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:476)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:1308)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndexMinion(DataDictionaryImpl.java:9271)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndex(DataDictionaryImpl.java:9229)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.locateSchemaRow(DataDictionaryImpl.java:1722)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getSchemaDescriptor(DataDictionaryImpl.java:1589)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initDefaultSchemaDescriptor(GenericLanguageConnectionContext.java:425)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initialize(GenericLanguageConnectionContext.java:401)\r\n\tat org.apache.derby.impl.db.BasicDatabase.setupConnection(BasicDatabase.java:295)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.startTransaction(TransactionResourceImpl.java:189)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserIsNotARole(EmbedConnection.java:1251)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(EmbedConnection.java:1215)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:422)\r\n\t... 10 more\r\n11 May 2012 11:29 SchemaDAO.tableExists = Java exception: ': java.lang.NullPointerException'.\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:634)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(EmbedConnection30.java:73)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(EmbedConnection40.java:51)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:70)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:248)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:144)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.SchemaDAO.tableExists(SchemaDAO.java:59)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.DataDictionary.deleteHRData(DataDictionary.java:464)\r\n\tat com.idelji.operations.iasset.plugin.imon.service.CleanUpTask.run(CleanUpTask.java:54)\r\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 16 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:659)\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:589)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.openContainer(Xact.java:1316)\r\n\tat org.apache.derby.impl.store.access.conglomerate.OpenConglomerate.init(OpenConglomerate.java:910)\r\n\tat org.apache.derby.impl.store.access.heap.Heap.open(Heap.java:689)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:476)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:1308)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndexMinion(DataDictionaryImpl.java:9271)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndex(DataDictionaryImpl.java:9229)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.locateSchemaRow(DataDictionaryImpl.java:1722)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getSchemaDescriptor(DataDictionaryImpl.java:1589)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initDefaultSchemaDescriptor(GenericLanguageConnectionContext.java:425)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initialize(GenericLanguageConnectionContext.java:401)\r\n\tat org.apache.derby.impl.db.BasicDatabase.setupConnection(BasicDatabase.java:295)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.startTransaction(TransactionResourceImpl.java:189)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserIsNotARole(EmbedConnection.java:1251)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(EmbedConnection.java:1215)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:422)\r\n\t... 10 more\r\n11 May 2012 11:29 SchemaDAO.tableExists = Java exception: ': java.lang.NullPointerException'.\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:634)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(EmbedConnection30.java:73)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(EmbedConnection40.java:51)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:70)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:248)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:144)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.SchemaDAO.tableExists(SchemaDAO.java:59)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.DataDictionary.deleteHRData(DataDictionary.java:464)\r\n\tat com.idelji.operations.iasset.plugin.imon.service.CleanUpTask.run(CleanUpTask.java:54)\r\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 16 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:659)\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:589)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.openContainer(Xact.java:1316)\r\n\tat org.apache.derby.impl.store.access.conglomerate.OpenConglomerate.init(OpenConglomerate.java:910)\r\n\tat org.apache.derby.impl.store.access.heap.Heap.open(Heap.java:689)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:476)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:1308)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndexMinion(DataDictionaryImpl.java:9271)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndex(DataDictionaryImpl.java:9229)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.locateSchemaRow(DataDictionaryImpl.java:1722)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getSchemaDescriptor(DataDictionaryImpl.java:1589)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initDefaultSchemaDescriptor(GenericLanguageConnectionContext.java:425)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initialize(GenericLanguageConnectionContext.java:401)\r\n\tat org.apache.derby.impl.db.BasicDatabase.setupConnection(BasicDatabase.java:295)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.startTransaction(TransactionResourceImpl.java:189)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserIsNotARole(EmbedConnection.java:1251)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(EmbedConnection.java:1215)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:422)\r\n\t... 10 more\r\n11 May 2012 11:29 SchemaDAO.tableExists = Java exception: ': java.lang.NullPointerException'.\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:634)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(EmbedConnection30.java:73)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(EmbedConnection40.java:51)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:70)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:248)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:144)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.SchemaDAO.tableExists(SchemaDAO.java:59)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.DataDictionary.deleteHRData(DataDictionary.java:464)\r\n\tat com.idelji.operations.iasset.plugin.imon.service.CleanUpTask.run(CleanUpTask.java:54)\r\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 16 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:659)\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:589)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.openContainer(Xact.java:1316)\r\n\tat org.apache.derby.impl.store.access.conglomerate.OpenConglomerate.init(OpenConglomerate.java:910)\r\n\tat org.apache.derby.impl.store.access.heap.Heap.open(Heap.java:689)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:476)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:1308)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndexMinion(DataDictionaryImpl.java:9271)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndex(DataDictionaryImpl.java:9229)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.locateSchemaRow(DataDictionaryImpl.java:1722)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getSchemaDescriptor(DataDictionaryImpl.java:1589)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initDefaultSchemaDescriptor(GenericLanguageConnectionContext.java:425)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initialize(GenericLanguageConnectionContext.java:401)\r\n\tat org.apache.derby.impl.db.BasicDatabase.setupConnection(BasicDatabase.java:295)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.startTransaction(TransactionResourceImpl.java:189)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserIsNotARole(EmbedConnection.java:1251)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(EmbedConnection.java:1215)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:422)\r\n\t... 10 more\r\n11 May 2012 11:29 SchemaDAO.tableExists = Java exception: ': java.lang.NullPointerException'.\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:634)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection30.<init>(EmbedConnection30.java:73)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection40.<init>(EmbedConnection40.java:51)\r\n\tat org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:70)\r\n\tat org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:248)\r\n\tat org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:144)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat java.sql.DriverManager.getConnection(Unknown Source)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.SchemaDAO.tableExists(SchemaDAO.java:59)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.DataDictionary.deleteHRData(DataDictionary.java:464)\r\n\tat com.idelji.operations.iasset.plugin.imon.service.CleanUpTask.run(CleanUpTask.java:54)\r\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 16 more\r\nCaused by: java.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:659)\r\n\tat org.apache.derby.impl.store.raw.data.BaseDataFileFactory.openContainer(BaseDataFileFactory.java:589)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.openContainer(Xact.java:1316)\r\n\tat org.apache.derby.impl.store.access.conglomerate.OpenConglomerate.init(OpenConglomerate.java:910)\r\n\tat org.apache.derby.impl.store.access.heap.Heap.open(Heap.java:689)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:476)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:1308)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndexMinion(DataDictionaryImpl.java:9271)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getDescriptorViaIndex(DataDictionaryImpl.java:9229)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.locateSchemaRow(DataDictionaryImpl.java:1722)\r\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getSchemaDescriptor(DataDictionaryImpl.java:1589)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initDefaultSchemaDescriptor(GenericLanguageConnectionContext.java:425)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.initialize(GenericLanguageConnectionContext.java:401)\r\n\tat org.apache.derby.impl.db.BasicDatabase.setupConnection(BasicDatabase.java:295)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.startTransaction(TransactionResourceImpl.java:189)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserIsNotARole(EmbedConnection.java:1251)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(EmbedConnection.java:1215)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.<init>(EmbedConnection.java:422)\r\n\t... 10 more\r\n11 May 2012 11:29 ProcessDAO.insertData = Page Page(41494,Container(0, 2128)) could not be read from disk.\r\njava.sql.BatchUpdateException: Page Page(41494,Container(0, 2128)) could not be read from disk.\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(EmbedStatement.java:1008)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.ProcessDAO.insertData(ProcessDAO.java:142)\r\n\tat com.idelji.operations.iasset.plugin.imon.comm.CPUProcessDataStoreWriter.onData(CPUProcessDataStoreWriter.java:56)\r\n\tat com.idelji.operations.iasset.plugin.imon.handler.CPUProcessDataHandler.gotData(CPUProcessDataHandler.java:205)\r\n\tat com.idelji.operations.ibase.core.comm.Connector.makeRequest(Connector.java:83)\r\n\tat com.idelji.operations.ibase.core.comm.EntityConnector.makeRequest(EntityConnector.java:36)\r\n\tat com.idelji.operations.iasset.plugin.imon.comm.CPUProcessCommunicator.run(CPUProcessCommunicator.java:98)\r\nCaused by: java.sql.SQLException: Page Page(41494,Container(0, 2128)) could not be read from disk.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:98)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:278)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:431)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:82)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1334)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(EmbedPreparedStatement.java:1040)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(EmbedStatement.java:984)\r\n\t... 6 more\r\nCaused by: java.sql.SQLException: Page Page(41494,Container(0, 2128)) could not be read from disk.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 15 more\r\nCaused by: java.sql.SQLException: Java exception: 'Reached end of file while attempting to read a whole page.: java.io.EOFException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)\r\n\t... 13 more\r\nCaused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readFull(RAFContainer4.java:1165)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage0(RAFContainer4.java:429)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(RAFContainer4.java:369)\r\n\tat org.apache.derby.impl.store.raw.data.RAFContainer4.readPage(RAFContainer4.java:263)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.readPage(CachedPage.java:673)\r\n\tat org.apache.derby.impl.store.raw.data.CachedPage.setIdentity(CachedPage.java:193)\r\n\tat org.apache.derby.impl.services.cache.ConcurrentCache.find(ConcurrentCache.java:295)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.initPage(FileContainer.java:2431)\r\n\tat org.apache.derby.impl.store.raw.data.FileContainer.newPage(FileContainer.java:1879)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainer.addPage(BaseContainer.java:314)\r\n\tat org.apache.derby.impl.store.raw.data.BaseContainerHandle.addPage(BaseContainerHandle.java:183)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.doInsert(HeapController.java:302)\r\n\tat org.apache.derby.impl.store.access.heap.HeapController.insertAndFetchLocation(HeapController.java:599)\r\n\tat org.apache.derby.impl.sql.execute.RowChangerImpl.insertRow(RowChangerImpl.java:452)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.normalInsertCore(InsertResultSet.java:1028)\r\n\tat org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:505)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:438)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:319)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1242)\r\n\t... 8 more\r\n*****************************************************************************************************************************************************************************\r\n\r\nI could give you my database, if you need to run your own tests against it. \r\nBest,\r\nSaurabh\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-11T18:36:32.701+0000","updated":"2012-05-11T18:36:32.701+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13273524","id":"13273524","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Reopening this issue. Although the repro passes, the bug is not fixed in production.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-11T19:22:49.524+0000","updated":"2012-05-11T19:22:49.524+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13273549","id":"13273549","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nI just want to confirm whether your latest bug report was against a table which had been newly created with 10.8.2.3. Note the following:\r\n\r\n1) I observe that I can still reboot a database which was already corrupted by the original form of this bug. And I can successfully delete all rows in the corrupted table and I can run inplace compress on the table.\r\n\r\n2) The patch does not fix an already corrupted table. It only prevents a previously uncorrupted table from being corrupted this way.\r\n\r\nSo I just want to confirm: Did you newly recreate the table using 10.8.2.3? Or was the table already corrupted and you were hoping that the patch would fix the broken table?\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-11T19:44:18.553+0000","updated":"2012-05-11T19:44:18.553+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13273561","id":"13273561","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\n\r\n1) It is an existing/corrupted data table that I ran the fix against.\r\nIt seems like after a certain limit (~1.3 gb), the database starts acting fuzzy and gets corrupted. Our (multi-threaded) application continually inserts data into the tables and periodically (once a day) deletes rows from the previous day and after the delete command, I am using the compress call to squeeze the db back into shape. Originally, I used the 'SYSCS_UTIL.SYSCS_COMPRESS_TABLE' call, but that lead to: DERBY-4275,DERBY-5351, DERBY-3683 & DERBY-5358.\r\nFollowing instructions, I used the 'INPLACE' call and was able to get rid of those 2 problems but now I'm stuck with this one.\r\n\r\n2) Before I try to insert new data, I'm deleting (and compressing) the old (corrupted) data and if the corrupted data is being deleted, then why do I still get the error? \r\n\r\n3) This only started happening after I included the COMPRESS_TABLE calls. Prior to that, even though it didn't release the deleted rows' space back to the OS, but it did not give errors.\r\n\r\nThanks.\r\nBest,\r\nSaurabh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-11T20:02:59.326+0000","updated":"2012-05-11T20:16:44.086+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274679","id":"13274679","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Attaching a revised version of Derby5234.java. This version successfully selects all of the rows from the corrupted table. After the corruption occurs, the repro now does the following:\r\n\r\n1) Brings down the Derby engine.\r\n\r\n2) Gets a new connection to the database.\r\n\r\n3) Reads all of the rows in the table.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-14T15:27:01.824+0000","updated":"2012-05-14T15:27:01.824+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274684","id":"13274684","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nCan you SELECT all of the rows in the corrupted table? I find that the table can still be read after the corruption when I run my toy test case Derby5234.\r\n\r\nIf you can SELECT all of the rows from the corrupted table, then I suggest the following course of action:\r\n\r\nA) Using 10.8.2.3, create a new database.\r\n\r\nB) Copy all of the data from the corrupted database into the new database. You can use the dump and bulk load procedures to do this. Alternatively, you can use the schema-importing VTI attached to DERBY-4962. The latter approach may be faster.\r\n\r\nC) Delete the old, corrupted database or rename it to make it clear that it should not be used in production anymore.\r\n\r\nD) Rename the new database to be the old name of the corrupted database.\r\n\r\nE) Continue running your application with 10.8.2.3 and the new (now renamed) database.\r\n\r\nHope this helps,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-14T15:34:11.682+0000","updated":"2012-05-14T15:34:11.682+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274687","id":"13274687","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\nShould I get the latest branch again? Would it have this fix? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-14T15:36:25.447+0000","updated":"2012-05-14T15:36:25.447+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274690","id":"13274690","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nThere is no additional fix. You just need a build from the 10.8 branch after revision 1337258.\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-14T15:42:18.106+0000","updated":"2012-05-14T15:42:18.106+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274734","id":"13274734","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\n\r\nWhen I try to do a Select * on the table (via Squirrel Client) that I suspect is corrupted, it gives me a \"java.lang.OutOfMemoryError: Java heap space\" due to the fact that \"The query results have exceeded the maximum amount of memory allocated to this application.\". The allocated memory seems to be 247 MB. \r\nCould that be a cause for the fix not working?\r\n\r\nThanks,\r\nSaurabh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-14T16:44:51.070+0000","updated":"2012-05-14T16:44:51.070+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274776","id":"13274776","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nHard to say where the OOM is coming from. It may be that the Squirrel Client runs out of memory while trying to prepare a big window for display. What happens if you SELECT COUNT(*) from the corrupted table? The VTI attached to DERBY-4962 will not try to materialize all of the results at once. You may be able to use it to stream the corrupted table into a new, empty database.\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-14T17:30:00.962+0000","updated":"2012-05-14T17:45:49.939+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274800","id":"13274800","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\nThe count query gives me 626677 rows. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-14T17:52:09.996+0000","updated":"2012-05-14T17:52:09.996+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274805","id":"13274805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"body":"Hi Saurabh,,\r\n\r\nCould it be the you have the SquirrelSQL client option turned off that retrieves only a limited set of rows (by default 100) and are returning many rows which is then causing the client to crash with the OutOfMemory and not the Derby engine crashing?\r\n\r\nJust a thought as I know that I have caused SquirrelSQL to do this when I have turned this option off and retrieved 10's of thousands of rows.  The tool tries to create a Swing table to display the rows and this causes the OutOfMemory condition in the tool, not the database engine.\r\n\r\nBrett\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"created":"2012-05-14T18:00:16.366+0000","updated":"2012-05-14T18:00:16.366+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274807","id":"13274807","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nThe successful completion of the SELECT COUNT(*) is a good sign. At this point, I would try to dump the old, corrupted database and load it into a new 10.8.2.3 database.\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-14T18:00:35.353+0000","updated":"2012-05-14T18:00:35.353+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274813","id":"13274813","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\n\r\nActually, I ran my application with version 10.8.2.3 (before your changes to Derby5234.java), the tables did get created with 10.8.2.3 but the problem reoccurred. \r\n\r\nDo you think running it with the latest changes(post Derby5234.java revision), would make any difference?\r\n\r\nThanks.\r\nBest,\r\nSaurabh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-14T18:07:13.347+0000","updated":"2012-05-14T18:16:02.508+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274817","id":"13274817","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Brett,\r\nActually, I do have the \"Limit rows to 100\" option disabled, so the DB is returning me all the rows.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-14T18:09:50.513+0000","updated":"2012-05-14T18:09:50.513+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274834","id":"13274834","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nDerby5234.java is just a test case. It is not checked into the Derby codeline anywhere. You have the patched version of 10.8.2.3 provided that the revision stamp on derby.jar is bigger than revision 1337258. What do you see when you run sysinfo on your 10.8.2.3 installation:\r\n\r\n  java -jar lib/derbyrun.jar sysinfo\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-14T18:33:39.961+0000","updated":"2012-05-14T18:33:39.961+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13274995","id":"13274995","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\nI'm running 10.8.2.3 (rev. 1338623). The tables were created using this revision and the problem still persists.\r\nThanks.\r\nBest,\r\nSaurabh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-14T22:00:03.211+0000","updated":"2012-05-14T22:00:03.211+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13276076","id":"13276076","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nAre you able to script the problem you are seeing? I am unable to reproduce it. Both of the repros attached to this issue now run correctly for me, even when I boost the number of rows by a factor of 10.\r\n\r\nWhat data compression command are you using? The repros use this command:\r\n\r\n    CALL SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP', 'TABLENAME', 0, 0, 1)\r\n\r\nThanks,\r\n-Rick\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-15T18:12:46.332+0000","updated":"2012-05-15T18:12:46.332+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13276150","id":"13276150","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\n\r\nI still cannot get past the problem. \r\n\r\nI'm using the command : CALL SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP', 'TABLENAME', 0, 0, 1) .\r\n\r\nI don't quite understand what do you mean by \"scripting\" it? Please elaborate.\r\n\r\nThanks.\r\n-Saurabh\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-15T19:42:23.753+0000","updated":"2012-05-15T19:42:23.753+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13276158","id":"13276158","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nBy scripting, I mean: can you attach a program or ij script which causes this corruption? That will allow us to reproduce the problem in the laboratory.\r\n\r\nHave you considered setting the other trailing arguments of the compression procedure, like so:\r\n\r\n    CALL SYSCS_UTIL.SYSCS_INPLACE_COMPRESS_TABLE('APP', 'TABLENAME', 1, 1, 1) \r\n\r\nThis will cause the compression to take longer because Derby will do a more thorough job of garbage-collecting the empty space. That may take Derby down code paths which work around this bug. It would be interesting to know whether the bug occurs when you specify this extra garbage collection. To run this experiment you will again need to start with a new, uncorrupted database created by 10.8.2.3.\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-15T19:50:28.499+0000","updated":"2012-05-15T19:50:28.499+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13276167","id":"13276167","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\n\r\nActually, I did not know about an ij script until you just mentioned. I'll create one and upload here. Also, I'll try to isolate the code that is making the calls and possibly upload that too here along with my db. \r\n\r\nOne problem in doing so is that the application is doing delete, compress and insert operations simultaneously and it might be hard to separate the code, but I'll see if I can do that so that the bug can be reproduced at your end. \r\n\r\nAlso, I did try calling the INPLACE command with all combinations and it did not have any effect.\r\n\r\nThanks.\r\nSaurabh\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-15T19:58:11.890+0000","updated":"2012-05-15T19:58:11.890+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13277899","id":"13277899","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\nI created and ran an ij script against my database, but that does not reproduce the problem. \r\nI'm not really sure what else to do here.\r\nThanks,\r\nSaurabh.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-17T15:40:33.166+0000","updated":"2012-05-17T15:42:56.064+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13277936","id":"13277936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nHave you tried running SYSCS_COMPRESS_TABLE rather than SYSCS_INPLACE_COMPRESS_TABLE? On 2011-05-18, Varma reported that SYSCS_COMPRESS_TABLE improved the situation and may have fixed the corrupted table.\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-17T16:22:02.621+0000","updated":"2012-05-17T16:22:02.621+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13278009","id":"13278009","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Rick,\r\nI was using SYSCS_COMPRESS_TABLE originally, but that lead to: DERBY-4275,DERBY-5351, DERBY-3683 & DERBY-5358, so I had to switch to the INPLACE version. \r\nThanks,\r\nSaurabh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-17T17:42:11.303+0000","updated":"2012-05-17T17:42:11.303+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13278025","id":"13278025","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks, Saurabh. I see that DERBY-4275 is fixed in the trunk and in the 10.8 branch. DERBY-5351 was closed as a duplicate of DERBY-4275. However, it looks like DERBY-3683 and DERBY-5358 are still open.\r\n\r\nHave you tried issuing a LOCK TABLE command to seize exclusive access to the table before you issue SYSCS_COMPRESS_TABLE? This will throttle your concurrency every time you compress the table, but that is better than corrupting the table.\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-17T17:58:26.023+0000","updated":"2012-05-17T17:58:26.023+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13278036","id":"13278036","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Yes Rick, I have tried acquiring an exclusive lock before issuing the SYSCS_COMPRESS_TABLE, but that did not quite work either.\r\nThanks,\r\nSaurabh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-17T18:07:25.171+0000","updated":"2012-05-17T18:07:25.171+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13278039","id":"13278039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks, Saurabh. Can you describe what went wrong when you locked the table before compressing it? Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-17T18:11:08.420+0000","updated":"2012-05-17T18:11:08.420+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13281109","id":"13281109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\nI tried locking the corrupted table but it did not yield any different results. Should I include a LOCK statement with the tables created and populated with the new 10.8 trunk and inform you of the results? ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-22T17:41:27.935+0000","updated":"2012-05-22T17:41:27.935+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13281118","id":"13281118","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Saurabh,\r\n\r\nJust want to make sure we're not talking past one another. The experiment (using a new, 10.8.2.3 database) would be to LOCK the table before compressing the table with SYSCS_COMPRESS_TABLE. On 2012-05-12 you said that you tried that experiment and something went wrong. It would be good to understand what went wrong.\r\n\r\nThanks,\r\n-Rick","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-22T17:53:44.478+0000","updated":"2012-05-22T17:53:44.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13281124","id":"13281124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\nThe \"something\" that went wrong was the same container related exception that this thread is all about. And the new experiment that I'm soon going to try out would be just as you suggested.\r\nThanks.\r\nSaurabh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-22T18:03:48.633+0000","updated":"2012-05-22T18:03:48.633+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13281224","id":"13281224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"Hi Rick,\r\nMy program created a new 10.8.2.3 database along with the regular select, delete, lock, compress and insert statements.\r\nAs per your suggestions, the program executed a LOCK statement (EXCLUSIVE lock)  before executing the SYSCS_COMPRESS_TABLE call. \r\nI'm still getting the deadlock exception (while selecting and inserting) shown below:- \r\n\r\n***********************************************************************************************************************************************************\r\n22 May 2012 13:37:32 ProcessDAO.getLastRecordFromIntervalTableShowGap = A lock could not be obtained due to a deadlock, cycle of locks and waiters is:\r\nLock : TABLE, PROCESS_055234_HR, Tablelock\r\n  Waiting XID : {104215, IS} , APP, SELECT  CpuNum,  SampleTimestamp AS TimeStamp,  ProcBusyPercent AS BusyPercent FROM PROCESS_055234_HR WHERE SampleTimestamp >= ?  AND Volume=?  AND Subvol=?  AND Filename=?  AND ProcessName=?  AND CpuNum=?  AND PIN=?  ORDER BY SampleTimestamp \r\n  Granted XID : {102377, X} \r\nLock : ROW, SYSCONGLOMERATES, (7,9)\r\n  Waiting XID : {102377, X} , APP, alter table \"APP\".\"PROCESS_055234_HR\" compress sequential\r\n  Granted XID : {102377, S} , {104215, S} \r\n. The selected victim is XID : 104215.\r\njava.sql.SQLTransactionRollbackException: A lock could not be obtained due to a deadlock, cycle of locks and waiters is:\r\nLock : TABLE, PROCESS_055234_HR, Tablelock\r\n  Waiting XID : {104215, IS} , APP, SELECT  CpuNum,  SampleTimestamp AS TimeStamp,  ProcBusyPercent AS BusyPercent FROM PROCESS_055234_HR WHERE SampleTimestamp >= ?  AND Volume=?  AND Subvol=?  AND Filename=?  AND ProcessName=?  AND CpuNum=?  AND PIN=?  ORDER BY SampleTimestamp \r\n  Granted XID : {102377, X} \r\nLock : ROW, SYSCONGLOMERATES, (7,9)\r\n  Waiting XID : {102377, X} , APP, alter table \"APP\".\"PROCESS_055234_HR\" compress sequential\r\n  Granted XID : {102377, S} , {104215, S} \r\n. The selected victim is XID : 104215.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:89)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:256)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:424)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:82)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement.<init>(EmbedPreparedStatement.java:151)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement20.<init>(EmbedPreparedStatement20.java:82)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement30.<init>(EmbedPreparedStatement30.java:63)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement40.<init>(EmbedPreparedStatement40.java:40)\r\n\tat org.apache.derby.jdbc.Driver40.newEmbedPreparedStatement(Driver40.java:107)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:1615)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:1443)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.ProcessDAO.getLastRecordFromIntervalTableShowGap(ProcessDAO.java:503)\r\n\tat imon.utils.DataSourceRouter.getLatestProcessData(DataSourceRouter.java:608)\r\n\tat imon.db.ProcessDataProvider.getLatestData(ProcessDataProvider.java:131)\r\n\tat imon.charts.LineChartWithSlider.refreshChartData(LineChartWithSlider.java:558)\r\n\tat imon.charts.LineChartWithSlider$1.handle(LineChartWithSlider.java:327)\r\n\tat imon.charts.LineChartWithSlider$1.handle(LineChartWithSlider.java:322)\r\n\tat com.sun.scenario.animation.shared.TimelineClipCore.visitKeyFrame(TimelineClipCore.java:196)\r\n\tat com.sun.scenario.animation.shared.TimelineClipCore.playTo(TimelineClipCore.java:137)\r\n\tat javafx.animation.Timeline.impl_playTo(Timeline.java:163)\r\n\tat com.sun.scenario.animation.shared.InfiniteClipEnvelope.timePulse(InfiniteClipEnvelope.java:89)\r\n\tat javafx.animation.Animation.impl_timePulse(Animation.java:952)\r\n\tat com.sun.scenario.animation.shared.AnimationPulseReceiver.timePulse(AnimationPulseReceiver.java:75)\r\n\tat com.sun.scenario.animation.AbstractMasterTimer.timePulseImpl(AbstractMasterTimer.java:357)\r\n\tat com.sun.scenario.animation.AbstractMasterTimer$MainLoop.run(AbstractMasterTimer.java:280)\r\n\tat com.sun.javafx.tk.quantum.QuantumToolkit.pulse(QuantumToolkit.java:381)\r\n\tat com.sun.javafx.tk.quantum.QuantumToolkit$8.run(QuantumToolkit.java:311)\r\n\tat com.sun.glass.ui.win.WinApplication._runLoop(Native Method)\r\n\tat com.sun.glass.ui.win.WinApplication.access$100(WinApplication.java:29)\r\n\tat com.sun.glass.ui.win.WinApplication$2$1.run(WinApplication.java:62)\r\n\tat java.lang.Thread.run(Unknown Source)\r\n\r\n22 May 2012 13:37:52 ProcessDAO.insertData = A lock could not be obtained due to a deadlock, cycle of locks and waiters is:\r\nLock : ROW, SYSCONGLOMERATES, (7,9)\r\n  Waiting XID : {104576, S} , APP, INSERT INTO PROCESS_055234_HR (SampleTimestamp,CpuNum,Pin,Priority,UserID,GroupID,ProcessName,Volume,SubVol,FileName,AncestorProcessName,ProcBusyPercent) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)\r\n  Granted XID : {102377, S} \r\nLock : ROW, SYSCONGLOMERATES, (7,8)\r\n  Waiting XID : {102377, X} , APP, alter table \"APP\".\"PROCESS_055234_HR\" compress sequential\r\n  Granted XID : {102377, S} , {104576, S} \r\n. The selected victim is XID : 104576.\r\njava.sql.SQLTransactionRollbackException: A lock could not be obtained due to a deadlock, cycle of locks and waiters is:\r\nLock : ROW, SYSCONGLOMERATES, (7,9)\r\n  Waiting XID : {104576, S} , APP, INSERT INTO PROCESS_055234_HR (SampleTimestamp,CpuNum,Pin,Priority,UserID,GroupID,ProcessName,Volume,SubVol,FileName,AncestorProcessName,ProcBusyPercent) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)\r\n  Granted XID : {102377, S} \r\nLock : ROW, SYSCONGLOMERATES, (7,8)\r\n  Waiting XID : {102377, X} , APP, alter table \"APP\".\"PROCESS_055234_HR\" compress sequential\r\n  Granted XID : {102377, S} , {104576, S} \r\n. The selected victim is XID : 104576.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:89)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:256)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:424)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)\r\n\tat org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:82)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement.<init>(EmbedPreparedStatement.java:151)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement20.<init>(EmbedPreparedStatement20.java:82)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement30.<init>(EmbedPreparedStatement30.java:63)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement40.<init>(EmbedPreparedStatement40.java:40)\r\n\tat org.apache.derby.jdbc.Driver40.newEmbedPreparedStatement(Driver40.java:107)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:1615)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(EmbedConnection.java:1443)\r\n\tat com.idelji.operations.iasset.plugin.imon.dao.ProcessDAO.insertData(ProcessDAO.java:86)\r\n\tat com.idelji.operations.iasset.plugin.imon.comm.CPUProcessDataStoreWriter.onData(CPUProcessDataStoreWriter.java:56)\r\n\tat com.idelji.operations.iasset.plugin.imon.handler.CPUProcessDataHandler.gotData(CPUProcessDataHandler.java:205)\r\n\tat com.idelji.operations.ibase.core.comm.Connector.makeRequest(Connector.java:83)\r\n\tat com.idelji.operations.ibase.core.comm.EntityConnector.makeRequest(EntityConnector.java:36)\r\n\tat com.idelji.operations.iasset.plugin.imon.comm.CPUProcessCommunicator.run(CPUProcessCommunicator.java:98)\r\n\r\n***********************************************************************************************************************************************************","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-22T21:26:36.749+0000","updated":"2012-05-22T21:26:36.749+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13284846","id":"13284846","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Thanks for the deadlock trace Saurabh. It looks similar to the stack trace for DERBY-3683. However, the explicit table lock doesn't help in your case. I am linking this issue to the other issues which prevent you from using SYSCS_COMPRESS_TABLE: DERBY-3683 and DERBY-5358. Until we make progress on those issues, I am unable to recommend a workaround. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-05-29T14:24:31.482+0000","updated":"2012-05-29T14:24:31.482+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13286706","id":"13286706","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"body":"I have given up as well. Resorting to dynamic creation and deletion of tables (as opposed to rows)  for now.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=saurabh_singhi","name":"saurabh_singhi","emailAddress":"zonesaurabh at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Saurabh Singhi","active":true},"created":"2012-05-31T16:18:58.819+0000","updated":"2012-05-31T16:18:58.819+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13419141","id":"13419141","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Unassigning myself from this issue because I obviously haven't done anything on this issue for a long time. My sense is that the table compression code has a number of weaknesses and we should devote some serious effort to overhauling it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-07-20T13:49:37.580+0000","updated":"2012-07-20T13:49:37.580+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13453427","id":"13453427","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Removing fix versions as from the comments it doesn't seem to be fixed.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-09-11T21:27:11.639+0000","updated":"2012-09-11T21:27:11.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13463996","id":"13463996","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Turning off repro attached and high value fix as from the comments it seems the attempted reproductions attached did not reproduce the issue for Rick.  The user resorted to working around the problem. It would be great to get a reproduction for the issue so we could fix it, but until then there is not much we can do.  \r\nShould we close this cannot reproduce?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-09-26T18:00:34.305+0000","updated":"2012-09-26T18:00:34.305+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13464028","id":"13464028","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Linking this issue to DERBY-5876, a master issue for overhauling the table compression code. Hopefully the underlying issue with this bug will be addressed when we revamp table compression. However, without a repro we won't be able to prove that. Now that this issue is linked to DERBY-5876, I don't see much point in keeping this unreproducible bug open. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2012-09-26T18:27:21.260+0000","updated":"2012-09-26T18:27:21.260+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13555437","id":"13555437","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Without more information, we can't reproduce this problem. We can re-open this issue if more information becomes available.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2013-01-16T20:48:31.384+0000","updated":"2013-01-16T20:48:31.384+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13555975","id":"13555975","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"body":"I am very disappointed that even after one year you know this error and have a repro you closed the ticket.\r\nI'm wondering why the problems regarding the compression (inplace and normal) won't be fixed. In my opinion this is essential for running a database.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stefan_sitte","name":"stefan_sitte","emailAddress":"stefan dot sitte at comsoft dot aero","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stefan Sitte","active":true},"created":"2013-01-17T08:18:28.833+0000","updated":"2013-01-17T08:18:28.833+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13556022","id":"13556022","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The state of this bug report is a bit confusing, since it contains multiple reports of issues with similar symptoms. Those issues may or may not be related. One fix has been checked in and seems to have fixed one of the issues, but it also sounds like at least one of the problems remains unsolved.\r\n\r\nMy reading of the comments on this bug report is that the issue Stefan saw could be reproduced, and it has been fixed. That fix is included in the 10.8.3.0 maintenance release. However, the problems reported by Varma and Saurabh have not been reproduced by anyone else yet. Saurabh has tested the fix and concluded that the fix for Stefan's issue did not fix the issue he saw. It is not known whether or not the fix addresses the problem reported by Varma.\r\n\r\nDoes that accurately describe the current state of the bug report?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-01-17T09:56:34.033+0000","updated":"2013-01-17T09:56:34.033+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13556148","id":"13556148","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Knut's understanding of the bug agrees with mine. There seems to be consensus that the table compression code gives rise to many data corruptions and that code needs to be overhauled. That's why this issue was linked to DERBY-5876, an issue which describes a systemic rather than piecemeal mini-project for re-writing that part of Derby. Thanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2013-01-17T13:11:36.779+0000","updated":"2013-01-17T13:11:36.779+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13798572","id":"13798572","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"So, although it was closed CannotReproduce,  I think *something* was fixed in this issue. 1335570 and 1335677 were committed to  trunk and ported to 10.8 branch at subversion revision 1337258.  For bookkeeping and possible further backport it would seem to make sense to open a separate  issue for what was fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2013-10-17T23:07:45.287+0000","updated":"2013-10-17T23:07:45.287+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13799058","id":"13799058","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1533412 from [~kmarsden] in branch 'code/branches/10.7'\r\n[ https://svn.apache.org/r1533412 ]\r\n\r\nDERBY-6382 fter Inplace compress: java.sql.SQLException: Page Page(10219,Container(0, 1136)) could not be read from disk caused by Caused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n\r\nThis is a partial fix for DERBY-5234. Merged revision 1337258 from 10.8\r\nContributed by Rick Hillegas","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-18T12:12:47.586+0000","updated":"2013-10-18T12:12:47.586+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13799256","id":"13799256","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1533540 from [~kmarsden] in branch 'code/branches/10.6'\r\n[ https://svn.apache.org/r1533540 ]\r\n\r\nDERBY-6382 fter Inplace compress: java.sql.SQLException: Page Page(10219,Container(0, 1136)) could not be read from disk caused by Caused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n\r\nThis is a partial fix for DERBY-5234. Merged revision 1337258 from 10.8\r\nContributed by Rick Hillegas","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-18T16:33:26.399+0000","updated":"2013-10-18T16:33:26.399+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507367/comment/13799743","id":"13799743","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1533682 from [~kmarsden] in branch 'code/branches/10.5'\r\n[ https://svn.apache.org/r1533682 ]\r\n\r\nDERBY-6382 fter Inplace compress: java.sql.SQLException: Page Page(10219,Container(0, 1136)) could not be read from disk caused by Caused by: java.io.EOFException: Reached end of file while attempting to read a whole page.\r\n\r\nThis is a partial fix for DERBY-5234. Merged revision 1337258 from 10.8\r\nContributed by Rick Hillegas","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-10-19T03:12:49.571+0000","updated":"2013-10-19T03:12:49.571+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-5234/votes","votes":7,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06eyv:"}}