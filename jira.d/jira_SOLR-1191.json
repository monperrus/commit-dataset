{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12426503","self":"https://issues.apache.org/jira/rest/api/latest/issue/12426503","key":"SOLR-1191","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314371","id":"12314371","description":"Major release after 1.4.1","name":"3.1","archived":false,"released":true,"releaseDate":"2011-03-31"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-06-20 20:07:24.38","customfield_12312323":null,"customfield_12310420":"6456","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_3769708741_*|*_6_*:*_1_*:*_37297116966_*|*_5_*:*_2_*:*_10646805293_*|*_4_*:*_1_*:*_2732688402","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-02-16T23:15:32.115+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-1191/watchers","watchCount":2,"isWatching":false},"created":"2009-05-27T19:16:52.782+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312486","id":"12312486","description":"","name":"1.3","archived":false,"released":true,"releaseDate":"2008-09-16"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313351","id":"12313351","description":"","name":"1.4","archived":false,"released":true,"releaseDate":"2009-11-10"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-03-30T15:45:27.697+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312438","id":"12312438","name":"contrib - DataImportHandler","description":"http://wiki.apache.org/solr/DataImportHandler"}],"timeoriginalestimate":null,"description":"Seeing few of these NullPointerException during delta imports. Once this happens delta import stops working and keeps giving the same error.\r\njava.lang.NullPointerException\r\n        at org.apache.solr.handler.dataimport.DocBuilder.collectDelta(DocBuilder.java:622)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.doDelta(DocBuilder.java:240)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:159)\r\n        at org.apache.solr.handler.dataimport.DataImporter.doDeltaImport(DataImporter.java:337)\r\n        at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:376)\r\n        at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:355)\r\n\r\nRunning delta import for a particular entity fixes the problem and delta import start working again.\r\n\r\nHere is the log just before & after the exception\r\n05/27 11:59:29 86987686 INFO  btpool0-538 org.apache.solr.core.SolrCore  - [localhost] webapp=/solr path=/dataimport params={command=delta-import&optimize=false} status=0 QTime=0\r\n05/27 11:59:29 86987687 INFO  Thread-4162 org.apache.solr.handler.dataimport.SolrWriter  - Read dataimport.properties\r\n05/27 11:59:29 86987687 INFO  Thread-4162 org.apache.solr.handler.dataimport.DataImporter  - Starting Delta Import\r\n05/27 11:59:29 86987687 INFO  Thread-4162 org.apache.solr.handler.dataimport.SolrWriter  - Read dataimport.properties\r\n05/27 11:59:29 86987687 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Starting delta collection.\r\n05/27 11:59:29 86987690 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Running ModifiedRowKey() for Entity: content\r\n05/27 11:59:29 86987690 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed ModifiedRowKey for Entity: content rows obtained : 0\r\n05/27 11:59:29 86987690 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed DeletedRowKey for Entity: content rows obtained : 0\r\n05/27 11:59:29 86987692 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed parentDeltaQuery for Entity: content\r\n05/27 11:59:29 86987692 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Running ModifiedRowKey() for Entity: job\r\n05/27 11:59:29 86987692 INFO  Thread-4162 org.apache.solr.handler.dataimport.JdbcDataSource  - Creating a connection for entity job with URL: jdbc:sqlserver://localhost;databaseName=TestDB\r\n05/27 11:59:29 86987704 INFO  Thread-4162 org.apache.solr.handler.dataimport.JdbcDataSource  - Time taken for getConnection(): 12\r\n05/27 11:59:29 86987707 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed ModifiedRowKey for Entity: job rows obtained : 0\r\n05/27 11:59:29 86987707 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed DeletedRowKey for Entity: job rows obtained : 0\r\n05/27 11:59:29 86987707 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed parentDeltaQuery for Entity: job\r\n05/27 11:59:29 86987707 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Delta Import completed successfully\r\n05/27 11:59:29 86987707 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Starting delta collection.\r\n05/27 11:59:29 86987709 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Running ModifiedRowKey() for Entity: user\r\n05/27 11:59:29 86987709 INFO  Thread-4162 org.apache.solr.handler.dataimport.JdbcDataSource  - Creating a connection for entity user with URL: jdbc:sqlserver://localhost;databaseName=TestDB\r\n05/27 11:59:29 86987716 INFO  Thread-4162 org.apache.solr.handler.dataimport.JdbcDataSource  - Time taken for getConnection(): 7\r\n05/27 11:59:29 86987873 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed ModifiedRowKey for Entity: user rows obtained : 46\r\n05/27 11:59:29 86987873 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed DeletedRowKey for Entity: user rows obtained : 0\r\n05/27 11:59:29 86987873 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed parentDeltaQuery for Entity: user\r\n05/27 11:59:29 86987882 INFO  Thread-4162 org.apache.solr.core.SolrCore  - SolrDeletionPolicy.onInit: commits:num=1\r\n        commit{dir=/usr/share/solr/work/localhost/data/index,segFN=segments_m0,version=1242658668035,generation=792,filenames=[_wv.fdt, _vf.prx, _z2.frq, _z5.frq, _z2.tis, _wv.fdx, _z6.nrm, _z3.tis, segments_\r\nm0, _uh_1.del, _uj.fnm, _yd.fnm, _yz.fdt, _wa.fnm, _ui.prx, _yz.tis, _z0.nrm, _z7.fdt, _vf_6.del, _cy.fnm, _z5.nrm, _yz.fdx, _cy.tii, _z6.fdx, _uh.prx, _z6.fdt, _z7.fdx, _ui.nrm, _uh.fnm, _yz.tii, _uu.fdt, _x\r\ng.fnm, _z3.fdt, _uu.fdx, _z3.fdx, _z3_1.del, _wa.tis, _uj.tis, _ui.frq, _wa.tii, _z0.frq, _wv.nrm, _cy.tis, _xr.prx, _z3.tii, _z4.prx, _z7.prx, _xr.fdt, _z4.fdt, _xr.fdx, _z4.fdx, _uh.nrm, _y2.frq, _y2_1.del,\r\n _uj.tii, _z2.tii, _z2.nrm, _yo.prx, _z5.fnm, _y2.prx, _uu.nrm, _z0_1.del, _cy.prx, _yd.frq, _yo.fnm, _cy.nrm, _z0.fdx, _xg.tis, _z0.fdt, _z2_1.del, _xg.tii, _cy.frq, _xg.frq, _yd.prx, _z7.tis, _z0.tis, _z7.t\r\nii, _yd.nrm, _vf.fnm, _z6.frq, _z2.fdx, _ui.fnm, _z5.tis, _z6_1.del, _z5.tii, _z1.fdt, _z0.tii, _z5_1.del, _uu.tis, _uu.tii, _z1.prx, _z1.fdx, _z6.tii, _y2.fnm, _xr.frq, _z4.frq, _z2.fdt, _z6.tis, _vf.frq, _y\r\no.frq, _uj.fdx, _wv.fnm, _cy.fdt, _z6.prx, _xr.tis, _z4.tis, _yz.fnm, _uu.fnm, _z2.prx, _yo.tii, _z0.prx, _yd_1.del, _z1.frq, _yo.tis, _z7.nrm, _z5.prx, _yd.fdx, _yz.nrm, _cy.fdx, _yd.fdt, _wa_6.del, _z3.prx,\r\n _uj_h.del, _ui_e.del, _z7.fnm, _z3.fnm, _uu.prx, _uh.tii, _z6.fnm, _xg.prx, _xg.fdx, _xg.nrm, _wv.prx, _xg.fdt, _uu_b.del, _xr.nrm, _z4.nrm, _uj.prx, _xr.fnm, _z4.fnm, _uj.nrm, _yz_2.del, _uh.fdx, _vf.fdt, _\r\nuh.fdt, _yo.nrm, _xr.tii, _z4.tii, _vf.fdx, _uh.tis, _uj.fdt, _uj.frq, _yo.fdx, _wa.fdt, _ui.fdt, _z1.tii, _xg_1.del, _wa.fdx, _ui.fdx, _yz.frq, _ui.tii, _z5.fdt, _z5.fdx, _wv.frq, _wa.nrm, _yd.tii, _yd.tis,\r\n_yo_2.del, _y2.tii, _uu.frq, _cy_jd.del, _uh.frq, _y2.tis, _z1_1.del, _wa.prx, _z1.fnm, _ui.tis, _z2.fnm, _wa.frq, _wv.tii, _z0.fnm, _y2.fdx, _y2.fdt, _z7.frq, _wv.tis, _z3.frq, _y2.nrm, _yz.prx, _xr_2.del, _\r\nz1.nrm, _vf.tis, _vf.tii, _vf.nrm, _z3.nrm, _z1.tis, _yo.fdt]\r\n05/27 11:59:29 86987882 INFO  Thread-4162 org.apache.solr.core.SolrCore  - last commit = 1242658668035\r\n05/27 11:59:29 86987944 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Delta Import completed successfully\r\n05/27 11:59:29 86987944 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Starting delta collection.\r\n05/27 11:59:29 86987946 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Running ModifiedRowKey() for Entity: candidateContent\r\n05/27 11:59:29 86987946 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed ModifiedRowKey for Entity: candidateContent rows obtained : 0\r\n05/27 11:59:29 86987946 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed DeletedRowKey for Entity: candidateContent rows obtained : 0\r\n05/27 11:59:29 86987948 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed parentDeltaQuery for Entity: candidateContent\r\n05/27 11:59:29 86987950 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Running ModifiedRowKey() for Entity: candidateMessage\r\n05/27 11:59:29 86987950 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed ModifiedRowKey for Entity: candidateMessage rows obtained : 0\r\n05/27 11:59:29 86987950 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed DeletedRowKey for Entity: candidateMessage rows obtained : 0\r\n05/27 11:59:29 86987950 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed parentDeltaQuery for Entity: candidateMessage\r\n05/27 11:59:29 86987952 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Running ModifiedRowKey() for Entity: candidateCustom\r\n05/27 11:59:29 86987953 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed ModifiedRowKey for Entity: candidateCustom rows obtained : 0\r\n05/27 11:59:29 86987953 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed DeletedRowKey for Entity: candidateCustom rows obtained : 0\r\n05/27 11:59:29 86987953 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Completed parentDeltaQuery for Entity: candidateCustom\r\n05/27 11:59:29 86987953 INFO  Thread-4162 org.apache.solr.handler.dataimport.DocBuilder  - Running ModifiedRowKey() for Entity: candidate\r\n05/27 11:59:29 86987953 INFO  Thread-4162 org.apache.solr.handler.dataimport.JdbcDataSource  - Creating a connection for entity candidate with URL: jdbc:sqlserver://localhost;databaseName=TestDB\r\n05/27 11:59:29 86987960 INFO  Thread-4162 org.apache.solr.handler.dataimport.JdbcDataSource  - Time taken for getConnection(): 7\r\n05/27 11:59:29 86988066 ERROR Thread-4162 org.apache.solr.handler.dataimport.DataImporter  - Delta Import Failed\r\njava.lang.NullPointerException\r\n        at org.apache.solr.handler.dataimport.DocBuilder.collectDelta(DocBuilder.java:622)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.doDelta(DocBuilder.java:240)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:159)\r\n        at org.apache.solr.handler.dataimport.DataImporter.doDeltaImport(DataImporter.java:337)\r\n        at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:376)\r\n        at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:355)\r\n05/27 11:59:29 86988066 INFO  Thread-4162 org.apache.solr.update.UpdateHandler  - start rollback\r\n05/27 11:59:29 86988071 INFO  Thread-4162 org.apache.solr.update.UpdateHandler  - end_rollback\r\n\r\n\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"20006","summary":"NullPointerException in delta import","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smali","name":"smali","emailAddress":"smd dot ali at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ali Syed","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smali","name":"smali","emailAddress":"smd dot ali at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ali Syed","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"OS: Windows & Linux.\r\nJava: 1.6\r\nDB: MySQL & SQL Server ","customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":15,"total":15,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12716716","id":"12716716","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smali","name":"smali","emailAddress":"smd dot ali at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ali Syed","active":true},"body":"Problem was in the db-data-config.xml the  pk=\"a.Id\" and deltaQuery & deletedPkQuery were \"SELECT a.Id ...\" .\r\n\r\nChanged the delta queries as follows \"SELECT a.Id as 'a.Id'  ...\"\r\n\r\nIt might make sense to fail with illegal argument exception instead of a null pointer.\r\n\r\nCould change following code..\r\n//Check to see if this delete is in the current delta set\r\nfor (Map<String, Object> modifiedRow : deltaSet) {\r\n  if (modifiedRow.get(entity.pk).equals(row.get(entity.pk))) {\r\n    deltaRemoveSet.add(modifiedRow);\r\n  }\r\n}\r\n\r\nas follows...\r\n//Check to see if this delete is in the current delta set\r\nfor (Map<String, Object> modifiedRow : deltaSet) {\r\n  if (modifiedRow.get(entity.pk) == null) throw new IllegalArgumentException(entity.pk+\" doesn't exist in row: \" + modifiedRow);\r\n  if (modifiedRow.get(entity.pk).equals(row.get(entity.pk))) {\r\n    deltaRemoveSet.add(modifiedRow);\r\n  }\r\n}\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=smali","name":"smali","emailAddress":"smd dot ali at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ali Syed","active":true},"created":"2009-06-05T18:35:43.365+0000","updated":"2009-06-05T18:35:43.365+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12722259","id":"12722259","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lancenorskog","name":"lancenorskog","emailAddress":"lance dot norskog at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lance Norskog","active":true},"body":"\r\nThis error should appear in the user-visible output as a \"User Error\".\r\n\r\nPlease mark this \"to be fixed in Solr 1.4\". \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lancenorskog","name":"lancenorskog","emailAddress":"lance dot norskog at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lance Norskog","active":true},"created":"2009-06-20T20:07:24.380+0000","updated":"2009-06-20T20:07:24.380+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12722332","id":"12722332","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=noble.paul","name":"noble.paul","emailAddress":"noble dot paul at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=noble.paul&avatarId=18547","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=noble.paul&avatarId=18547","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=noble.paul&avatarId=18547","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=noble.paul&avatarId=18547"},"displayName":"Noble Paul","active":true},"body":"The stacktrace does not refer to trunk. can you just let me know which version you were using? I fixed another NPE recently w/ delta-import. I am not too sure if it is the same","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=noble.paul","name":"noble.paul","emailAddress":"noble dot paul at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=noble.paul&avatarId=18547","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=noble.paul&avatarId=18547","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=noble.paul&avatarId=18547","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=noble.paul&avatarId=18547"},"displayName":"Noble Paul","active":true},"created":"2009-06-21T10:17:50.873+0000","updated":"2009-06-21T10:17:50.873+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12729594","id":"12729594","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=noble.paul","name":"noble.paul","emailAddress":"noble dot paul at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=noble.paul&avatarId=18547","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=noble.paul&avatarId=18547","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=noble.paul&avatarId=18547","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=noble.paul&avatarId=18547"},"displayName":"Noble Paul","active":true},"body":"this should have been fixed in the trunk as a result of SOLR-1228 we can reopen this if it is reported again","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=noble.paul","name":"noble.paul","emailAddress":"noble dot paul at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=noble.paul&avatarId=18547","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=noble.paul&avatarId=18547","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=noble.paul&avatarId=18547","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=noble.paul&avatarId=18547"},"displayName":"Noble Paul","active":true},"created":"2009-07-10T10:25:21.519+0000","updated":"2009-07-10T10:25:21.519+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12775760","id":"12775760","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"Bulk close for Solr 1.4","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2009-11-10T15:52:06.813+0000","updated":"2009-11-10T15:52:06.813+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12982193","id":"12982193","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"body":"I see this still happening on the tip of the 3.1 branch:\r\n\r\n{quote}\r\nJan 15, 2011 9:47:39 PM org.apache.solr.handler.dataimport.DataImporter doDeltaImport\r\nSEVERE: Delta Import Failed\r\njava.lang.NullPointerException\r\n        at org.apache.solr.handler.dataimport.DocBuilder.collectDelta(DocBuilder.java:860)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.doDelta(DocBuilder.java:282)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:176)\r\n        at org.apache.solr.handler.dataimport.DataImporter.doDeltaImport(DataImporter.java:356)\r\n        at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:395)\r\n        at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:374)\r\n{quote}\r\n\r\nSame kind of problem:\r\n\r\n{quote}\r\n                 pk=\"ds.id\"\r\n                 deltaQuery=\"SELECT id FROM [...]\r\n{quote}\r\n\r\nand same kind of workaround:\r\n\r\n{quote}\r\n                 pk=\"ds.id\"\r\n                 deltaQuery=\"SELECT id AS &quot;ds.id&quot;FROM [...]\r\n{quote}\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"created":"2011-01-16T00:44:13.532+0000","updated":"2011-01-16T00:44:13.532+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12982216","id":"12982216","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"body":"I added a patch against branch_3x to resolve this. It resolves deltaQuery columns against pk when they differ by prefix (and reports the error more helpfully when no column matches, or more than one column matches).\r\n\r\nNo unit test, sorry (but there's not much deltaQuery coverage anyway). All existing unit tests pass, and this is working fine for me in production.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"created":"2011-01-16T04:05:14.329+0000","updated":"2011-01-17T15:25:05.576+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12982241","id":"12982241","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"body":"seems like this is not fixed yet","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simonw","name":"simonw","emailAddress":"simonw at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Simon Willnauer","active":true},"created":"2011-01-16T08:10:43.686+0000","updated":"2011-01-16T08:10:43.686+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12985355","id":"12985355","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=koji","name":"koji","emailAddress":"koji dot sekiguchi at rondhuit dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=koji&avatarId=17548","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=koji&avatarId=17548","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=koji&avatarId=17548","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=koji&avatarId=17548"},"displayName":"Koji Sekiguchi","active":true},"body":"bq. No unit test, sorry (but there's not much deltaQuery coverage anyway).\r\n\r\nThere seems to be TestSqlEntityProcessorDelta*.java, no?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=koji","name":"koji","emailAddress":"koji dot sekiguchi at rondhuit dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=koji&avatarId=17548","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=koji&avatarId=17548","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=koji&avatarId=17548","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=koji&avatarId=17548"},"displayName":"Koji Sekiguchi","active":true},"created":"2011-01-23T16:18:58.033+0000","updated":"2011-01-23T16:18:58.033+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12991884","id":"12991884","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"body":"bq. There seems to be TestSqlEntityProcessorDelta*.java, no?\r\n\r\nIndeed there are, and they do seem to cover delta imports to a fair degree. I must have been underslept. : ) [The Hudson coverage report|https://hudson.apache.org/hudson/job/Solr-3.x/clover/] doesn't include the contrib stuff though.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"created":"2011-02-08T10:22:51.882+0000","updated":"2011-02-08T10:22:51.882+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12994795","id":"12994795","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"If someone could whip up a test for this, we could get this fix into the upcoming 3.1 release.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2011-02-15T14:05:59.929+0000","updated":"2011-02-15T14:05:59.929+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12994803","id":"12994803","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"body":"I'll make one later today or tomorrow.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"created":"2011-02-15T14:26:35.832+0000","updated":"2011-02-15T14:26:35.832+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12995381","id":"12995381","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"body":"Updated patch with unit test, against current branch_3x.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gthb","name":"gthb","emailAddress":"gunnlaugur at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Gunnlaugur Thor Briem","active":true},"created":"2011-02-16T16:51:14.040+0000","updated":"2011-02-16T17:09:55.764+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/12995574","id":"12995574","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"Thanks Gunnlaugur, I committed to trunk and 3x.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2011-02-16T23:15:32.128+0000","updated":"2011-02-16T23:15:32.128+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12426503/comment/13013070","id":"13013070","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"Bulk close for 3.1.0 release","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2011-03-30T15:45:27.682+0000","updated":"2011-03-30T15:45:27.682+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-1191/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i03s87:"}}