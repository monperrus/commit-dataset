{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12442600","self":"https://issues.apache.org/jira/rest/api/latest/issue/12442600","key":"MAHOUT-212","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310751","id":"12310751","key":"MAHOUT","name":"Mahout","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310751&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310751&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310751&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310751&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/13060","id":"13060","description":"Apache Mahout","name":"Mahout"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314281","id":"12314281","description":"","name":"0.3","archived":false,"released":true,"releaseDate":"2010-03-17"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-12-07 07:33:27.896","customfield_12312323":null,"customfield_12310420":"9853","customfield_12312320":null,"customfield_12310222":"10002_*:*_1_*:*_308827577_*|*_1_*:*_1_*:*_148276_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2009-12-10T19:12:25.321+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAHOUT-212/watchers","watchCount":0,"isWatching":false},"created":"2009-12-07T05:22:49.468+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313278","id":"12313278","description":"","name":"0.2","archived":false,"released":true,"releaseDate":"2009-11-18"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-05-21T03:24:19.146+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313154","id":"12313154","name":"Integration"}],"timeoriginalestimate":null,"description":"\r\nFor a variety of mining algorithms, it helps to have a uniform way to only process a sub-set of the records in a reducer.\r\n\r\nAs such, I have written a simple generic sampler that filters an Iterator returning a fair sample of at most a specified size.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"23207","summary":"Need random sampler for use in reducers","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":15,"total":15,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12786786","id":"12786786","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"\r\nCode plus test cases.\r\n\r\nReady for use.  I think.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-07T05:25:17.741+0000","updated":"2009-12-07T05:25:17.741+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12786787","id":"12786787","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"Hmm... didn't get asked for where the patch file was when marking the bug as patch available. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-07T05:26:31.113+0000","updated":"2009-12-07T05:26:31.113+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12786806","id":"12786806","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"This kinda already existed as SamplingIterator -- does that do the same thing? could these be merged then, pulling the class into a common location and combining aspects of both?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-12-07T07:33:27.896+0000","updated":"2009-12-07T07:33:27.896+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12786820","id":"12786820","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"\r\nKinda existed, but SamplingIterator takes a sample rate which can't be known if you don't know the total size.  The FixedSizeSampler just takes a desired size and gives you exactly that many.\r\n\r\nMerging them makes sense from the point of view of a user, but there is little in common between the implementations.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-07T08:31:38.514+0000","updated":"2009-12-07T08:31:38.514+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12786841","id":"12786841","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"Sure, understood. How about putting them in the same place, and making them be named / look / act similarly? That brings me to a number of comments on the patch:\r\n\r\n- I had suggested we not use both org.apache.mahout.common and org.apache.mahout.utils as the \"common stuff\" package, since that's redundant. We sort of standardized on common, but, retained utils for various reasons. I think this belongs in core/ and under .common\r\n\r\n- The Random shouldn't be instance variable right, and should be obtained from RandomUtils?\r\n\r\n- It's not necessary to keep the original Iterator since as you show, you really must sample it all upfront as you do. In this sense it's almost not properly a class that should produce an Iterator, but a List, but, I like the tidiness of an Iterator wrapper.\r\n\r\n- Consider providing an Iterable counterpart for easy use with foreach loops, like I did with SamplingIterable\r\n\r\n- Name it something ending with Iterator since it's an Iterator? FixedSizeSampleIterator?\r\n\r\n- Are methods like copyInput() necessarily public, and is there a need to set the generator?\r\n\r\n- Very picky, usually see test cases end in TestCase\r\n\r\n\r\nIf you agree with these but don't care t implement, I can do so.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-12-07T09:55:43.431+0000","updated":"2009-12-07T09:55:43.431+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12787020","id":"12787020","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"bq.  I had suggested we not use both org.apache.mahout.common and org.apache.mahout.utils as the \"common stuff\" package, since that's redundant. We sort of standardized on common, but, retained utils for various reasons. I think this belongs in core/ and under .common\r\n\r\nSounds good.\r\n\r\nbq. The Random shouldn't be instance variable right, and should be obtained from RandomUtils?\r\n\r\nI like having it be injectable for testing purposes.  As long as it exhibits the same interface as j.u.Random, we should be fine.  There may be a better interface from RandomUtils.  Feel free to suggest one, but I really do want to keep the injectability of the generator.\r\n\r\nbq. It's not necessary to keep the original Iterator since as you show, you really must sample it all upfront as you do. In this sense it's almost not properly a class that should produce an Iterator, but a List, but, I like the tidiness of an Iterator wrapper.\r\n\r\nThis is a point I waffled on.  The real question here is whether we care about the corner case where we don't read anything from the iterator.  I went slightly nuts and decided I did care to optimize that point, but you make a strong counter argument that the class could be simpler if copyInput were called from the constructor.  That would simplify testing as well.\r\n\r\nbq. Consider providing an Iterable counterpart for easy use with foreach loops, like I did with SamplingIterable\r\n\r\nQuite doable.\r\n\r\nbq. Name it something ending with Iterator since it's an Iterator? FixedSizeSampleIterator?\r\n\r\nAlso a fine idea.\r\n\r\nbq. Are methods like copyInput() necessarily public, and is there a need to set the generator?\r\n\r\nThey could be package level.  I merely exposed it to be able to do more detailed testing.  This adds weight to your argument about keeping the original iterator.\r\n\r\nbq. Very picky, usually see test cases end in TestCase\r\n\r\nI usually see test cases that start or end with Test.  It is an old convention from many ant builds that required regexes.  I don't much care except that I would have a small preference for making abstract tests end in TestCase in order to distinguish them from concrete tests.\r\n\r\nbq. If you agree with these but don't care t implement, I can do so.\r\n\r\nLet me take one more crack.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-07T18:08:30.833+0000","updated":"2009-12-07T18:08:30.833+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12787033","id":"12787033","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"Yeah test injection was the idea behind using RandomUtils, since it will return a generator that uses the same seed every time when set in test mode. The unit tests do (should) set it globally as such, to make sure the results are deterministic. Yes the returned generator is a MersenneTwisterRNG which just extends Random.\r\n\r\nYes anything for testing should probably be package-private.\r\n\r\n(I'd also suggest making the instance fields private here? not sure there's a big case for extension, at least, one that isn't perhaps better answered with explicit getters)\r\n\r\nI dont' care about the test naming convention.\r\n\r\nOnce this is in place I'll put my similar Iterator next to it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-12-07T18:28:51.371+0000","updated":"2009-12-07T18:28:51.371+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12787143","id":"12787143","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"\r\nHere is another patch.  I moved SamplingIterator and Iterable.  I moved to eager sampling and simplified code and test cases as a result.  In the end, there is no additional functionality from an Iterable (it just wraps the Iterator in a way that it returns that same iterator) so I left it out.  \r\n\r\nbq. Sean>   The Random shouldn't be instance variable right, and should be obtained from RandomUtils?\r\n\r\nbq. ted> I like having it be injectable for testing purposes. As long as it exhibits the same interface as j.u.Random, we should be fine. There may be a better interface from RandomUtils. Feel free to suggest one, but I really do want to keep the injectability of the generator.\r\n\r\nI switched to use RandomUtils, but I still think it is a poor form of injection.  Most notably, we can't inject faults using this approach, only a standard test sequence.  Besides, I hate global variables ( which is what a static class like this is ).  For these tests, those issues don't matter so I switched.\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-07T21:58:04.442+0000","updated":"2009-12-07T21:58:04.442+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12787144","id":"12787144","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"Here is the actual patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-07T21:58:40.763+0000","updated":"2009-12-07T21:58:40.763+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12787157","id":"12787157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"What's the idea behind the Entry class? I am not seeing how that originalIndex is used.\r\n\r\nRandom generator = RandomUtils.getRandom();\r\nThis can be a private static final member.\r\n\r\nThe existing SamplingIterator could use the DelegatingIterator class too if you like.\r\n\r\n\r\nI take the general point about injection but at some level a component isn't meaningfully injectable. What kind of fault would you inject in a Random? testing what happens when it returns a value outside the interval or an Error maybe but is that reasonable. What flexibility would it meaningfully provide, at least in comparison to the extra method and new possible error scenarios.\r\n\r\nstatics have their place and this instance seems like a fine example to me. It's one of the few cases where I really do need to make sure every instance in the whole program works a certain way.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-12-07T22:11:13.172+0000","updated":"2009-12-07T22:11:13.172+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12787169","id":"12787169","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"bq. What's the idea behind the Entry class? I am not seeing how that originalIndex is used.\r\n\r\nIt allows sorting of the results according the original ordering of the data elements.  The originalIndex is used in the comparison function.  Since we have to keep the original index to do this sort I needed a handy way to glue the index to the value.  My preference would have been a side array and a sort function that returns a permutation.  That would have allowed my two classes to merge completely with very little overhead.  Sorts that return permutations are commonly found in R or Matlab, but (to my knowledge) not in Java.\r\n\r\nbq. Random generator = RandomUtils.getRandom();\r\nThis can be a private static final member.\r\n\r\nIt should actually be a local after making the change you suggested.  Sorry I missed that.\r\n\r\nbq. The existing SamplingIterator could use the DelegatingIterator class too if you like.\r\n\r\nAfter you, Gaston!\r\n\r\n(seriously, my tiny window of time for coding just closed.  Feel free to take this and do anything you like) \r\n\r\nbq. I take the general point about injection but at some level a component isn't meaningfully injectable. What kind of fault would you inject in a Random? \r\n\r\nI have had a few cases where very rare, but legal, values from a generator would cause a fault.  It was easiest to provide a mock generator to stimulate these corners.  \r\n\r\nAs a concrete example, an exponential distribution can be generated using -log(u) where u is a random variable from (0, 1].  But most random number generators generator doubles from [0, 1) so the sampling should really be done using -log(1-u).  It is reasonable to inject a generator that returns a 0 to make sure that the edge condition is handled well.\r\n\r\nWhat I would suggest is that if this is or becmes important, we can add a method to truly inject a generator.  It isn't important here so I left it out.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-07T22:26:04.034+0000","updated":"2009-12-07T22:26:04.034+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12788056","id":"12788056","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"In case you're waiting on comment from me, as far as I am concerned you can submit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-12-09T12:10:32.577+0000","updated":"2009-12-09T12:10:32.577+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12788262","id":"12788262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"\r\nI am snowed under and won't get to this for at least a week.  Feel free to commit.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-09T19:43:40.581+0000","updated":"2009-12-09T19:43:40.581+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12788759","id":"12788759","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"body":"Ted I've gone big on this and collapsed a lot more iterator related things into this package, and tried to unify a little. It'll probably break any dependencies you have on it, but not badly. What say?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=srowen","name":"srowen","emailAddress":"srowen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=srowen&avatarId=10104","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=srowen&avatarId=10104","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=srowen&avatarId=10104","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=srowen&avatarId=10104"},"displayName":"Sean Owen","active":true},"created":"2009-12-10T15:56:42.746+0000","updated":"2009-12-10T15:56:42.746+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12442600/comment/12788839","id":"12788839","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"body":"\r\nAwesome.  Thanks.\r\n\r\nI have no dependencies.  I simply wrote this to help you and anybody else with the cooccurrence stuff (you mentioned delaying the sampling until later).\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tdunning","name":"tdunning","emailAddress":"ted dot dunning at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ted Dunning","active":true},"created":"2009-12-10T18:52:49.530+0000","updated":"2009-12-10T18:52:49.530+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/MAHOUT-212/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i04bzj:"}}