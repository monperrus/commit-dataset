{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12511587","self":"https://issues.apache.org/jira/rest/api/latest/issue/12511587","key":"ARIES-690","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310981","id":"12310981","key":"ARIES","name":"Aries","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310981&avatarId=10065","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310981&avatarId=10065","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310981&avatarId=10065","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310981&avatarId=10065"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10520","id":"10520","description":"Apache Aries","name":"Aries"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12318855","id":"12318855","name":"proxy uber bundle 0.4","archived":true,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12318857","id":"12318857","name":"proxy.impl-0.4","archived":true,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-06-27 08:13:13.704","customfield_12312323":null,"customfield_12310420":"69316","customfield_12312320":null,"customfield_12310222":"3_*:*_1_*:*_611323259_*|*_1_*:*_1_*:*_33247261_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-07-04T12:01:54.455+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-690/watchers","watchCount":0,"isWatching":false},"created":"2011-06-27T00:59:04.178+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316139","id":"12316139","description":"","name":"0.4","archived":true,"released":false}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-10-26T16:26:22.842+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[],"timeoriginalestimate":null,"description":"I've run into a ClassCircularityError that's apparently caused by proxy weaving code. I captured the stack trace via debugger:\r\n\r\n{quote}\r\nejbd 1@1196 daemon, prio=5, in group 'main', status: 'RUNNING'\r\n\t  at java.lang.ClassCircularityError.<init>(ClassCircularityError.java:32)\r\n\t  at java.lang.Class.getDeclaringClass(Class.java:-1)\r\n\t  at java.lang.Class.getEnclosingClass(Class.java:1085)\r\n\t  at org.apache.aries.proxy.impl.common.AbstractWovenProxyAdapter.readClass(AbstractWovenProxyAdapter.java:618)\r\n\t  at org.apache.aries.proxy.impl.weaving.WovenProxyAdapter.visitEnd(WovenProxyAdapter.java:75)\r\n\t  at org.objectweb.asm.ClassAdapter.visitEnd(Unknown Source:-1)\r\n\t  at org.objectweb.asm.commons.SerialVersionUIDAdder.visitEnd(Unknown Source:-1)\r\n\t  at org.apache.aries.proxy.impl.weaving.SyntheticSerialVerUIDAdder.visitEnd(SyntheticSerialVerUIDAdder.java:35)\r\n\t  at org.objectweb.asm.ClassReader.accept(Unknown Source:-1)\r\n\t  at org.objectweb.asm.ClassReader.accept(Unknown Source:-1)\r\n\t  at org.apache.aries.proxy.impl.weaving.WovenProxyGenerator.getWovenProxy(WovenProxyGenerator.java:52)\r\n\t  at org.apache.aries.proxy.impl.weaving.ProxyWeavingHook.weave(ProxyWeavingHook.java:63)\r\n\t  at org.eclipse.osgi.internal.baseadaptor.weaving.WovenClassImpl.call(WovenClassImpl.java:129)\r\n\t  at org.eclipse.osgi.internal.serviceregistry.ServiceRegistry.notifyHookPrivileged(ServiceRegistry.java:1239)\r\n\t  at org.eclipse.osgi.internal.serviceregistry.ServiceRegistry.notifyHooksPrivileged(ServiceRegistry.java:1222)\r\n\t  at org.eclipse.osgi.internal.baseadaptor.weaving.WovenClassImpl.callHooks(WovenClassImpl.java:154)\r\n\t  at org.eclipse.osgi.internal.baseadaptor.weaving.WeavingHookConfigurator.processClass(WeavingHookConfigurator.java:68)\r\n\t  at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.defineClass(ClasspathManager.java:596)\r\n\t  at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findClassImpl(ClasspathManager.java:567)\r\n\t  at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClassImpl(ClasspathManager.java:490)\r\n\t  at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass_LockClassLoader(ClasspathManager.java:478)\r\n\t  at org.eclipse.osgi.baseadaptor.loader.ClasspathManager.findLocalClass(ClasspathManager.java:458)\r\n\t  at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.findLocalClass(DefaultClassLoader.java:216)\r\n\t  at org.eclipse.osgi.internal.loader.BundleLoader.findLocalClass(BundleLoader.java:400)\r\n\t  at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:476)\r\n\t  at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:429)\r\n\t  at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:417)\r\n\t  at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107)\r\n\t  at java.lang.ClassLoader.loadClass(ClassLoader.java:248)\r\n\t  at org.apache.openjpa.util.Serialization.deserialize(Serialization.java:86)\r\n\t  at org.apache.openjpa.jdbc.sql.DBDictionary.getBlobObject(DBDictionary.java:623)\r\n\t  at org.apache.openjpa.jdbc.sql.ResultSetResult.getObjectInternal(ResultSetResult.java:402)\r\n\t  at org.apache.openjpa.jdbc.sql.AbstractResult.getObject(AbstractResult.java:696)\r\n\t  at org.apache.openjpa.jdbc.meta.strats.HandlerStrategies.loadDataStore(HandlerStrategies.java:222)\r\n\t  at org.apache.openjpa.jdbc.meta.strats.HandlerFieldStrategy.load(HandlerFieldStrategy.java:187)\r\n\t  at org.apache.openjpa.jdbc.meta.FieldMapping.load(FieldMapping.java:928)\r\n\t  at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1123)\r\n\t  at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1067)\r\n\t  at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initializeState(JDBCStoreManager.java:438)\r\n\t  at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initialize(JDBCStoreManager.java:333)\r\n\t  at org.apache.openjpa.kernel.DelegatingStoreManager.initialize(DelegatingStoreManager.java:112)\r\n\t  at org.apache.openjpa.kernel.ROPStoreManager.initialize(ROPStoreManager.java:57)\r\n\t  at org.apache.openjpa.kernel.BrokerImpl.initialize(BrokerImpl.java:1022)\r\n\t  at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:980)\r\n\t  at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:902)\r\n\t  at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1041)\r\n\t  at org.apache.openjpa.jdbc.sql.AbstractResult.load(AbstractResult.java:280)\r\n\t  at org.apache.openjpa.jdbc.sql.SelectImpl$SelectResult.load(SelectImpl.java:2381)\r\n\t  at org.apache.openjpa.jdbc.sql.AbstractResult.load(AbstractResult.java:274)\r\n\t  at org.apache.openjpa.jdbc.kernel.InstanceResultObjectProvider.getResultObject(InstanceResultObjectProvider.java:59)\r\n\t  at org.apache.openjpa.lib.rop.EagerResultList.<init>(EagerResultList.java:36)\r\n\t  at org.apache.openjpa.kernel.QueryImpl.toResult(QueryImpl.java:1251)\r\n\t  at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:1007)\r\n\t  at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:863)\r\n\t  at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:794)\r\n\t  at org.apache.openjpa.kernel.DelegatingQuery.execute(DelegatingQuery.java:542)\r\n\t  at org.apache.openjpa.persistence.QueryImpl.execute(QueryImpl.java:305)\r\n\t  at org.apache.openjpa.persistence.QueryImpl.getResultList(QueryImpl.java:319)\r\n\t  at org.apache.openejb.core.cmp.jpa.JpaCmpEngine.executeSelectQuery(JpaCmpEngine.java:277)\r\n\t  at org.apache.openejb.core.cmp.jpa.JpaCmpEngine.queryBeans(JpaCmpEngine.java:231)\r\n\t  at org.apache.openejb.core.cmp.CmpContainer.findEJBObject(CmpContainer.java:669)\r\n\t  at org.apache.openejb.core.cmp.CmpContainer.invoke(CmpContainer.java:261)\r\n\t  at org.apache.openejb.core.cmp.CmpContainer.invoke(CmpContainer.java:230)\r\n\t  at org.apache.openejb.server.ejbd.EjbRequestHandler.doEjbHome_FIND(EjbRequestHandler.java:327)\r\n\t  at org.apache.openejb.server.ejbd.EjbRequestHandler.processRequest(EjbRequestHandler.java:152)\r\n\t  at org.apache.openejb.server.ejbd.EjbDaemon.processEjbRequest(EjbDaemon.java:196)\r\n\t  at org.apache.openejb.server.ejbd.EjbDaemon.service(EjbDaemon.java:149)\r\n\t  at org.apache.openejb.server.ejbd.EjbServer.service(EjbServer.java:71)\r\n\t  at org.apache.openejb.server.ejbd.KeepAliveServer$Session.service(KeepAliveServer.java:213)\r\n\t  at org.apache.openejb.server.ejbd.KeepAliveServer.service(KeepAliveServer.java:233)\r\n\t  at org.apache.openejb.server.ejbd.EjbServer.service(EjbServer.java:66)\r\n\t  at org.apache.openejb.server.ServicePool$2.run(ServicePool.java:91)\r\n\t  at org.apache.openejb.server.ServicePool$3.run(ServicePool.java:120)\r\n\t  at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\r\n\t  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\r\n\t  at java.lang.Thread.run(Thread.java:680)\r\n{quote}\r\n\r\nIf I exclude 'org.apache.openjpa' from weaving (by adding a check in ProxyWeavingHook), everything works fine... \r\n\r\nI may commit this as a temporary work-around -- to help Geronimo testing. However, this seems like a general proxy issue. So, I think we'll need to understand the underlying issue...\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"166289","summary":"ClassCircularityError caused by proxy weaving","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511587/comment/13055273","id":"13055273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"body":"BTW, underlying issue may be a JRE bug. Even so, will need to enable a work-around.\r\n\r\nAnother instance where it is in our best interest to make ignored packages dynamically configurable.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"created":"2011-06-27T01:19:39.879+0000","updated":"2011-06-27T01:19:39.879+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511587/comment/13055388","id":"13055388","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"body":"This would appear to be a manifestation of http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6508296\r\n\r\nI will have a think about how to code round this problem...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"created":"2011-06-27T08:13:13.704+0000","updated":"2011-06-27T08:13:13.704+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511587/comment/13055449","id":"13055449","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"body":"This patch should avoid the bug in the Java Runtime, but I can't reproduce the failure locally to test","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"created":"2011-06-27T10:15:14.685+0000","updated":"2011-06-27T10:15:14.685+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12511587/comment/13055529","id":"13055529","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"body":"General note -- most projects expect patches to be generated relative to trunk. I couldn't get your patch to apply, even after cd'ing to proxy. Not sure how you generated...\r\n\r\nAnyway, I did hack your changes in. And tests look good from my side. I'd say you should commit your change.\r\n\r\nLooks like at least some of the proxy files are showing up with MS-DOS end-of-line characters. The property svn:eol-style controls this behavior. Most of the other aries files are set to native. You should set up your svn client (e.g. ~/.subversion/config) to configure default properties (e.g. auto-props svn:mime-type, svn:eol-style, svn:keywords, etc).  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"created":"2011-06-27T13:13:59.568+0000","updated":"2011-06-27T13:13:59.568+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-690/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0stpb:"}}