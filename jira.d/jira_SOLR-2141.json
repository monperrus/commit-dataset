{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12475830","self":"https://issues.apache.org/jira/rest/api/latest/issue/12475830","key":"SOLR-2141","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321141","id":"12321141","description":"Major release after 4.0","name":"4.1","archived":false,"released":true,"releaseDate":"2013-01-22"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321664","id":"12321664","description":"Current trunk","name":"Trunk","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-10-30 05:57:06.665","customfield_12312323":null,"customfield_12310420":"5367","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_9005130798_*|*_5_*:*_2_*:*_57493609418_*|*_4_*:*_1_*:*_1293690683","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2012-11-27T16:51:27.251+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-2141/watchers","watchCount":3,"isWatching":false},"created":"2010-10-05T01:37:36.382+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"11.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315096","id":"12315096","description":"Bug fix release for users of 1.4","name":"1.4.1","archived":false,"released":true,"releaseDate":"2010-06-25"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12322551","id":"12322551","description":"First major release from the 4.x branch: http://svn.apache.org/viewvc/lucene/dev/branches/branch_4x/","name":"4.0","archived":false,"released":true,"releaseDate":"2012-10-12"}],"issuelinks":[{"id":"12360768","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12360768","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12607638","key":"SOLR-3842","self":"https://issues.apache.org/jira/rest/api/2/issue/12607638","fields":{"summary":"DataImportHandler: When attempting to use column values as field names, multivalued fields only retain the first result","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12360345","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12360345","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12615169","key":"SOLR-4047","self":"https://issues.apache.org/jira/rest/api/2/issue/12615169","fields":{"summary":"dataimporter.functions.encodeUrl throughs Unable to encode expression: field.name with value: null","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.png","name":"Critical","id":"2"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-03-22T16:13:36.803+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312438","id":"12312438","name":"contrib - DataImportHandler","description":"http://wiki.apache.org/solr/DataImportHandler"}],"timeoriginalestimate":null,"description":"I have two entities defined, nested in each other..\r\n\r\n<entity name=\"article\" query=\"select category, subcategory from articles\">\r\n   <entity name=\"other\" query=\"select other from othertable where category='${dataimporter.functions.escapeSql(article.category)}'\r\n              AND subcategory='${dataimporter.functions.escapeSql(article.subcategory)}'\">  \r\n   </entity>\r\n</entity>\r\n\r\nNow, when I run that it bombs on any article where subcategory = '' (it's a NOT NULL column so empty string is there)  If i do where subcategory!='' in the article query it works fine (aside from not pulling in all of the articles).\r\n\r\norg.apache.solr.handler.dataimport.DataImportHandlerException: java.lang.NullPointerException\r\n        at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:424)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:383)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.doFullDump(DocBuilder.java:242)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:180)\r\n        at org.apache.solr.handler.dataimport.DataImporter.doFullImport(DataImporter.java:331)\r\n        at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:389)\r\n        at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:370)\r\nCaused by: java.lang.NullPointerException\r\n        at org.apache.solr.handler.dataimport.EvaluatorBag$1.evaluate(EvaluatorBag.java:75)\r\n        at org.apache.solr.handler.dataimport.EvaluatorBag$5.get(EvaluatorBag.java:216)\r\n        at org.apache.solr.handler.dataimport.EvaluatorBag$5.get(EvaluatorBag.java:204)\r\n        at org.apache.solr.handler.dataimport.VariableResolverImpl.resolve(VariableResolverImpl.java:107)\r\n        at org.apache.solr.handler.dataimport.TemplateString.fillTokens(TemplateString.java:81)\r\n        at org.apache.solr.handler.dataimport.TemplateString.replaceTokens(TemplateString.java:75)\r\n        at org.apache.solr.handler.dataimport.VariableResolverImpl.replaceTokens(VariableResolverImpl.java:87)\r\n        at org.apache.solr.handler.dataimport.SqlEntityProcessor.nextRow(SqlEntityProcessor.java:71)\r\n        at org.apache.solr.handler.dataimport.EntityProcessorWrapper.nextRow(EntityProcessorWrapper.java:237)\r\n        at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:357)\r\n        ... 6 more","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"19089","summary":"NullPointerException when using escapeSql function","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=urkle","name":"urkle","emailAddress":"urkle at outoforder dot cc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Rudd","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=urkle","name":"urkle","emailAddress":"urkle at outoforder dot cc","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Edward Rudd","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"openjdk 1.6.0 b12","customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":30,"total":30,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/12926543","id":"12926543","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=koji","name":"koji","emailAddress":"koji dot sekiguchi at rondhuit dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=koji&avatarId=17548","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=koji&avatarId=17548","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=koji&avatarId=17548","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=koji&avatarId=17548"},"displayName":"Koji Sekiguchi","active":true},"body":"Edward,\r\n\r\nMaybe I'm missing something, but I couldn't reproduce the problem you mentioned using attached short sample.\r\nPlease modify the attached file and reproduce it to share your problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=koji","name":"koji","emailAddress":"koji dot sekiguchi at rondhuit dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=koji&avatarId=17548","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=koji&avatarId=17548","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=koji&avatarId=17548","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=koji&avatarId=17548"},"displayName":"Koji Sekiguchi","active":true},"created":"2010-10-30T05:57:06.665+0000","updated":"2010-10-30T05:57:06.665+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/12982501","id":"12982501","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=koji","name":"koji","emailAddress":"koji dot sekiguchi at rondhuit dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=koji&avatarId=17548","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=koji&avatarId=17548","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=koji&avatarId=17548","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=koji&avatarId=17548"},"displayName":"Koji Sekiguchi","active":true},"body":"Don't hesitate to reopen when you reproduce the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=koji","name":"koji","emailAddress":"koji dot sekiguchi at rondhuit dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=koji&avatarId=17548","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=koji&avatarId=17548","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=koji&avatarId=17548","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=koji&avatarId=17548"},"displayName":"Koji Sekiguchi","active":true},"created":"2011-01-17T07:03:07.113+0000","updated":"2011-01-17T07:03:07.113+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13153821","id":"13153821","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep2852","name":"sandeep2852","emailAddress":"sandeep2852 at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Parmar","active":true},"body":"I am also getting same error. \r\n\r\nThanks,\r\nSand","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sandeep2852","name":"sandeep2852","emailAddress":"sandeep2852 at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sandeep Parmar","active":true},"created":"2011-11-20T16:02:59.528+0000","updated":"2011-11-20T16:02:59.528+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13495281","id":"13495281","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vkirilchuk","name":"vkirilchuk","emailAddress":"kirilchukvadim at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vkirilchuk&avatarId=16044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vkirilchuk&avatarId=16044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vkirilchuk&avatarId=16044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vkirilchuk&avatarId=16044"},"displayName":"Vadim Kirilchuk","active":true},"body":"Hi, \r\n\r\nI am facing this error too and it seems that something is broken in 4.x branch.\r\n\r\nI am attaching two files which can help to reproduce the problem:\r\n1) dih-config.xml\r\ncontains dih configuration which uses escapeSql function with outer entity parameter\r\n2) dih-file.xml \r\nTo create outer entity without any db related stuff i need to create it from file.\r\nNote: YOU MUST CHANGE ABSOLUTE PATH TO THIS FILE IN dih-config.xml to correct one.\r\n\r\n--------------------\r\nOk, i can also shay the light on what happens under the hood:\r\n\r\nThe problem is in instances of VariableResolverImpl which are created every time anyone calls DocBuilder#getVariableResolver();\r\n\r\nFirst, it is called to create function namespaces which are cached in DocBuilder instance.\r\n\r\nThen it is created when DocBuilder#doFullDump() is called.\r\n\r\nThen subEntity tries to resolve its 'query' parameter which has escapeSql function, and escapeSql function tries to resolve its param with the first VariableResolver which know nothing about current context and outer entity values.\r\n\r\nHowever all fails a little bit later, when EvaluatorBag#evaluate() is called:\r\nList l = parseParams(expression, context.getVariableResolver());\r\n        if (l.size() != 1) {\r\n          throw new DataImportHandlerException(SEVERE, \"'escapeSql' must have at least one parameter \");\r\n        }\r\n        String s = l.get(0).toString();\r\n        return s.replaceAll\r\n\r\nHere parseParams returns list with single VariableWrapper, but wrapper.toString returns null because variable cant be resolved. And finally (ta-dam!) replaceAll method is called on null value.\r\n\r\nP.s.\r\ndon`t be confused with FileDataSource for first entity mixed up with Sql query for second entity. Absense of sql datasource has no effect on this bug.\r\n\r\nThanks, it would be great if this bug will be fixed ASAP.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vkirilchuk","name":"vkirilchuk","emailAddress":"kirilchukvadim at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vkirilchuk&avatarId=16044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vkirilchuk&avatarId=16044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vkirilchuk&avatarId=16044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vkirilchuk&avatarId=16044"},"displayName":"Vadim Kirilchuk","active":true},"created":"2012-11-12T14:23:01.088+0000","updated":"2012-11-12T14:23:01.088+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13495410","id":"13495410","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"I am having the exact same issue since upgrading from 4.0.0 nightly (aprox. November 2011) to 4.0.0 stable (and previously also 4.0.0 BETA).\r\n\r\nI already tried to resolve it with the help of the Solr User's mailinglist:\r\nhttp://mail-archives.apache.org/mod_mbox/lucene-solr-user/201210.mbox/%3CCAAh4Jhuv86xbVa6=ZdxshUw3FeRuM+ORg4pDTkqAdGagEFbsDg@mail.gmail.com%3E","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-12T16:54:21.341+0000","updated":"2012-11-12T17:07:24.762+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13495421","id":"13495421","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"Sadly there's no way for me to reopen this issue like [~koji] suggested.\r\nMaybe [~urkle] can?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-12T17:06:42.587+0000","updated":"2012-11-12T17:06:42.587+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13495438","id":"13495438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"I re-opened the issue as it sounds like an actual problem.\r\n\r\nVadim/Sand, can either of you create a failing unit test?  This would make it a lot easier to fix.  Perhaps you can start with something like TestFileListWithLineEntityProcessor .  Also, can you point to an svn revision number when this functionality worked for you?  This would help track down what broke it.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-12T17:29:56.594+0000","updated":"2012-11-12T17:29:56.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13495635","id":"13495635","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"If it helps:\r\nI just checked for the nightly build I had in use (with DIH working fine) until I started upgrading to 4.0.0 (beta) a few weeks ago:\r\n\r\napache-solr-4.0-2011-09-16_08-37-32.war\r\n\r\nwith\r\n\r\napache-solr-dataimporthandler-4.0-2011-09-16_08-37-32.jar\r\napache-solr-dataimporthandler-extras-4.0-2011-09-16_08-37-32.jar","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-12T21:06:59.576+0000","updated":"2012-11-12T21:06:59.576+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13495701","id":"13495701","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"We really need a failing unit test for this, or at least simplify the config info Vadim supplied with the bare essentials (and maybe a step-by-step how-to) for reproducing this failure.\r\n\r\nGoing through the commits since Sept 2011, there isn't any one that seems like it definitely would have caused this.  These 3 seem most suspicious but this is just a guess:\r\n\r\nr1201659 - SOLR-2382, pluggable caches\r\nr1231367 - SOLR-2542, fix for context variables\r\nr1332292 - SOLR-3422, refactor configuration load","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-12T22:31:44.182+0000","updated":"2012-11-12T22:31:44.182+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13496033","id":"13496033","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vkirilchuk","name":"vkirilchuk","emailAddress":"kirilchukvadim at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vkirilchuk&avatarId=16044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vkirilchuk&avatarId=16044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vkirilchuk&avatarId=16044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vkirilchuk&avatarId=16044"},"displayName":"Vadim Kirilchuk","active":true},"body":"Hi,\r\n\r\nI am attaching the patch ([SOLR-2141-test.patch|https://issues.apache.org/jira/secure/attachment/12553286/SOLR-2141-test.patch]) to existing test that will help to reproduce the issue. (I`d like someone to write another test instead of modifying existing one)\r\n\r\nIf you execute this test you will see already mentioned stacktrace in console output:\r\n\r\nCaused by: java.lang.RuntimeException: org.apache.solr.handler.dataimport.DataImportHandlerException: java.lang.NullPointerException\r\n\t\tat org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:413)\r\n\t\tat org.apache.solr.handler.dataimport.DocBuilder.doFullDump(DocBuilder.java:326)\r\n\t\tat org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:234)\r\n\t\t... 47 more\r\n\tCaused by: org.apache.solr.handler.dataimport.DataImportHandlerException: java.lang.NullPointerException\r\n\t\tat org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:556)\r\n\t\tat org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:411)\r\n\t\t... 49 more\r\n\tCaused by: java.lang.NullPointerException\r\n\t\tat org.apache.solr.client.solrj.util.ClientUtils.escapeQueryChars(ClientUtils.java:206)\r\n\t\tat org.apache.solr.handler.dataimport.EvaluatorBag$3.evaluate(EvaluatorBag.java:101)\r\n\t\tat org.apache.solr.handler.dataimport.EvaluatorBag$6.get(EvaluatorBag.java:223)\r\n\t\tat org.apache.solr.handler.dataimport.EvaluatorBag$6.get(EvaluatorBag.java:1)\r\n\t\tat org.apache.solr.handler.dataimport.VariableResolverImpl.resolve(VariableResolverImpl.java:113)\r\n\t\tat org.apache.solr.handler.dataimport.TemplateString.fillTokens(TemplateString.java:81)\r\n\t\tat org.apache.solr.handler.dataimport.TemplateString.replaceTokens(TemplateString.java:75)\r\n\t\tat org.apache.solr.handler.dataimport.VariableResolverImpl.replaceTokens(VariableResolverImpl.java:91)\r\n\t\tat org.apache.solr.handler.dataimport.ContextImpl.getResolvedEntityAttribute(ContextImpl.java:81)\r\n\t\tat org.apache.solr.handler.dataimport.LineEntityProcessor.init(LineEntityProcessor.java:84)\r\n\t\tat org.apache.solr.handler.dataimport.EntityProcessorWrapper.init(EntityProcessorWrapper.java:74)\r\n\t\tat org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:430)\r\n\t\tat org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:511)\r\n\r\nP.s my solr is branch_4x 7da8d768b8b08923b274fcf32ca28edd1a78e8eb","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vkirilchuk","name":"vkirilchuk","emailAddress":"kirilchukvadim at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vkirilchuk&avatarId=16044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vkirilchuk&avatarId=16044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vkirilchuk&avatarId=16044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vkirilchuk&avatarId=16044"},"displayName":"Vadim Kirilchuk","active":true},"created":"2012-11-13T08:06:37.822+0000","updated":"2012-11-13T08:28:56.616+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13496160","id":"13496160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"I just added the patch SOLR-2141.b341f5b.patch for commit b341f5b (github mirror of branch_4x).\r\nMight this have caused the error?\r\nThe way I see it the EvaluatorBag looses the current context when used in a nested entity.\r\nThe commit was executed in connection with SOLR-2542 as git log shows:\r\n\r\nb341f5b - SOLR-2542: Fixed DIH Context variables which were broken for all scopes other then SCOPE_ENTITY (10 months ago) <Chris M. Hostetter>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-13T12:55:41.242+0000","updated":"2012-11-13T12:56:05.012+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13497207","id":"13497207","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"Hi guys,\r\n\r\nI think I might have found the root of evil:\r\nSOLR-3262 (removing \"threads\" from DIH). Problem is that in nested entites the used VariableResolverImpl differs from the one used by the EvaluatorBag (since everytime the getVariableResolver method is called a new one gets created) in the functions namespace (since that one get's initialized in the DocBuilder constructor).\r\nAnyway: I removed the private functionsNamespace cache property from the docBuilder and moved the call EvaluatorBag.getFunctionsNamespace() into DocBuilder.getVariableResolver(). That fixes all of my problems.\r\n\r\n[~vkirilchuk], [~sandeep2852] please find attached patch and let me know if this fixes your errors, too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-14T16:34:36.198+0000","updated":"2012-11-14T16:34:36.198+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13497209","id":"13497209","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"Patch to fix loading of functions namespace at runtime to use the correct (the newly created) VariableResolverImpl","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-14T16:35:39.282+0000","updated":"2012-11-14T16:35:39.282+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13500132","id":"13500132","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"/push [~vkirilchuk], [~sandeep2852], [~jdyer]","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-19T10:31:01.984+0000","updated":"2012-11-19T10:31:01.984+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13500198","id":"13500198","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vkirilchuk","name":"vkirilchuk","emailAddress":"kirilchukvadim at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vkirilchuk&avatarId=16044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vkirilchuk&avatarId=16044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vkirilchuk&avatarId=16044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vkirilchuk&avatarId=16044"},"displayName":"Vadim Kirilchuk","active":true},"body":"[~dsiebel] sorry, but i am very busy this week. I looked through your patch and i think it will fix my issue, however currently i have no time to check it. Thanks for the patch anyway!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vkirilchuk","name":"vkirilchuk","emailAddress":"kirilchukvadim at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=vkirilchuk&avatarId=16044","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=vkirilchuk&avatarId=16044","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=vkirilchuk&avatarId=16044","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=vkirilchuk&avatarId=16044"},"displayName":"Vadim Kirilchuk","active":true},"created":"2012-11-19T12:32:33.893+0000","updated":"2012-11-19T12:33:00.824+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13502319","id":"13502319","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"Could you try importing again with the latest revision from Trunk/5.x or branch_4x ?  Based on my limited understanding of this problem, I think it might have been solved with SOLR-4086.\r\n\r\nIn either case, we probably should write a good unit test for this so that it doesn't break again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-21T21:19:02.732+0000","updated":"2012-11-21T21:19:02.732+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13502751","id":"13502751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"[~jdyer] Thanks, this seems to have fixed my problem. I'm currently doing a full import with a build from branch_4x, no NPEs, yet (at ~10% now).\r\nSorry for the (maybe) dumb question, but: is there a gonna be a \"stable\" bugfix release or tag in the near future (not only for this issue, of course)?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-22T12:57:45.803+0000","updated":"2012-11-22T12:57:45.803+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13503763","id":"13503763","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"[~jdyer]\r\nAfter I finally had some time to check whether the indexed results (after the update) are as I expect them to be I had to find out that the importer did not throw any NPE's now, instead the fields are just missing.\r\nI have 7 fields defined in my nested entity that use escapeSql. Those are the exact fields that don't get indexed now :-/\r\nAny other suggestions? ;)\r\n\r\nI will have a look at the changed DIH code, maybe i can figure out where this is coming from.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-26T12:47:14.122+0000","updated":"2012-11-26T12:47:14.122+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13503815","id":"13503815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"Hi [~jdyer],\r\nI just worked through the changes in the DIH. Turns out my fields were null, because I used the 'dih.functions.' namespace since the 'dataimporter.functions.' was marked *_deprecated_* before the change. Did you change that back on purpose, because it might cause some confusion (like in my case).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-26T14:51:57.641+0000","updated":"2012-11-26T14:51:57.641+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13503828","id":"13503828","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"Dominik,\r\n\r\nCan you confirm for me that with the current Trunk that the functionality is working so long you use the \"dataimporter.functions.\" namespace?\r\n\r\nRemoving support for the \"dih.functions.\" namespace was indeed a mistake.  I can fix that too (and its a simple change).  But I really want to know for sure if your bigger problem is solved first??","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-26T15:11:58.362+0000","updated":"2012-11-26T15:11:58.362+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13503879","id":"13503879","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"Checked with\r\n\r\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1413079 13f79535-47bb-0310-9956-ffa450edef68\r\n\r\nfrom github trunk.\r\nEverything seems to be running, at least the fields are present. \r\nOn optimize I get a \"_SEVERE: null:java.lang.NoSuchMethodError: org.apache.lucene.document.Document.add(Lorg/apache/lucene/index/IndexableField;)V_\" from the SpellChecker component, though. But this might be related to some other issue.\r\n\r\nI could not verify with the whole dataset yet since indexing, commit and optimize (required for spellcheckers) take around 5h. I'll get back to you once the import finished on our staging system.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-26T16:37:34.785+0000","updated":"2012-11-26T16:37:34.785+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13504104","id":"13504104","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"I've attached a patch which fixes the functions namespace issue.  More importantly, it tests for the problem described here, in SOLR-4047 & SOLR-3842.  \r\n\r\nMy plan is to commit this tomorrow and if you do not have any more problems, I will close this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-26T21:15:53.000+0000","updated":"2012-11-26T21:15:53.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13504184","id":"13504184","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"better patch.  fixes problem for SOLR-3842 also.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-26T22:23:16.317+0000","updated":"2012-11-26T22:23:16.317+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13504189","id":"13504189","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"this 3rd patch version contains a test that won't begin to fail on Jan 1 :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-26T22:31:23.449+0000","updated":"2012-11-26T22:31:23.449+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13504443","id":"13504443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"Hi [~jdyer],\r\nIndex with the whole dataset looks good. So things seem to be fixed now. Thanks for that!\r\n\r\nJust another dumb question:\r\nWhat do I use the patch for? Aren't those the changes that are already in the branch_4x & trunk?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-27T08:19:18.880+0000","updated":"2012-11-27T08:19:18.880+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13504714","id":"13504714","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"final patch to commit, fixes a locale problem in the unit test.\r\n\r\nDominik, this patch solves the absence of the dih.functions. namespace, so you can use either \"dih.\" or \"dataimport.\" as before.  Also, it solves the related problem on SOLR-3842.  Finally it has a pretty good unit test that demonstrates this issue, SOLR-3842 and SOLR-4047 (this last one doesn't appear to actually be broken).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-27T16:09:45.612+0000","updated":"2012-11-27T16:09:45.612+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13504752","id":"13504752","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"body":"committed.\r\n\r\nTrunk: r1414242\r\n4x: r1414250","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jdyer","name":"jdyer","emailAddress":"james dot dyer at ingrambook dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Dyer","active":true},"created":"2012-11-27T16:51:27.278+0000","updated":"2012-11-27T16:51:27.278+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13505337","id":"13505337","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"body":"Hi, James, sorry I already forgot about that. Thanks for the good work!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dsiebel","name":"dsiebel","emailAddress":"code+apache at dsiebel dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dominik Siebel","active":true},"created":"2012-11-28T09:53:36.295+0000","updated":"2012-11-28T09:53:36.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13610495","id":"13610495","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=commit-tag-bot","name":"commit-tag-bot","emailAddress":"root-jira-commit_tag_bot at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=commit-tag-bot&avatarId=16176","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=commit-tag-bot&avatarId=16176","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=commit-tag-bot&avatarId=16176","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=commit-tag-bot&avatarId=16176"},"displayName":"Commit Tag Bot","active":true},"body":"[branch_4x commit] James Dyer\r\nhttp://svn.apache.org/viewvc?view=revision&revision=1414260\r\n\r\nSOLR-2141  / SOLR-4047 / SOLR-3842 - remove tabs\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=commit-tag-bot","name":"commit-tag-bot","emailAddress":"root-jira-commit_tag_bot at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=commit-tag-bot&avatarId=16176","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=commit-tag-bot&avatarId=16176","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=commit-tag-bot&avatarId=16176","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=commit-tag-bot&avatarId=16176"},"displayName":"Commit Tag Bot","active":true},"created":"2013-03-22T16:13:28.244+0000","updated":"2013-03-22T16:13:28.244+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12475830/comment/13610498","id":"13610498","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=commit-tag-bot","name":"commit-tag-bot","emailAddress":"root-jira-commit_tag_bot at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=commit-tag-bot&avatarId=16176","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=commit-tag-bot&avatarId=16176","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=commit-tag-bot&avatarId=16176","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=commit-tag-bot&avatarId=16176"},"displayName":"Commit Tag Bot","active":true},"body":"[branch_4x commit] James Dyer\r\nhttp://svn.apache.org/viewvc?view=revision&revision=1414250\r\n\r\nSOLR-2141  / SOLR-4047 / SOLR-3842 - fix problems with VariableResolver, better test coverage\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=commit-tag-bot","name":"commit-tag-bot","emailAddress":"root-jira-commit_tag_bot at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=commit-tag-bot&avatarId=16176","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=commit-tag-bot&avatarId=16176","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=commit-tag-bot&avatarId=16176","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=commit-tag-bot&avatarId=16176"},"displayName":"Commit Tag Bot","active":true},"created":"2013-03-22T16:13:36.803+0000","updated":"2013-03-22T16:13:36.803+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-2141/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i03mkf:"}}