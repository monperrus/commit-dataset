{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"32131","self":"https://issues.apache.org/jira/rest/api/latest/issue/32131","key":"DERBY-250","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-05-03 14:41:05.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21861","customfield_12310222":"3_*:*_1_*:*_1249716000_*|*_1_*:*_1_*:*_642000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_1839506000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2005-05-14T08:41:18.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-250/watchers","watchCount":0,"isWatching":false},"created":"2005-04-29T21:22:00.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2005-06-04T15:39:44.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"Trying to insert a  BigDecimal value with unscaled value longer than 31 digits using \npublic void setObject(int parameterIndex,\n                      Object x,\n                      int targetSqlType)\n               throws SQLException\nor \npublic void setObject(int parameterIndex,\n                      Object x,\n                      int targetSqlType,\n                      int scale)\n               throws SQLException\n\nfails with Network client.\n\nps.setObject(1,1000000000000000000000000000000000000000000000000\n0000000000000000000000000000000000000000000000000000000000000000\n0000000000000,java.sql.Types.DOUBLE)\norg.apache.derby.client.am.ConversionException: [converters] \nThe numeric literal \n\"100000000000000000000000000000000000000000000000000000000000000\n0000000000000000000000000000000000000000000000000000000\n00000000\" is not valid because its value is out of range.\n        at \norg.apache.derby.client.am.Decimal.bigDecimalToPackedDecimalByte\ns(Decimal.java:391)\n        at \norg.apache.derby.client.net.Request.writeBigDecimal(Request.java\n:1632)\n        at \norg.apache.derby.client.net.NetStatementRequest.buildFDODTA(NetS\ntatementRequest.java:692)\n        at \norg.apache.derby.client.net.NetStatementRequest.buildSQLDTAcomma\nndData(NetStatementRequest.java:514)\n        at \norg.apache.derby.client.net.NetStatementRequest.writeExecute(Net\nStatementRequest.java:137)\n        at \norg.apache.derby.client.net.NetPreparedStatement.writeExecute_(N\netPreparedStatement.java:124)\n        at \norg.apache.derby.client.am.PreparedStatement.writeExecute(Prepar\nedStatement.java:956)\n        at \norg.apache.derby.client.am.PreparedStatement.flowExecute(Prepare\ndStatement.java:1173)\n        at \norg.apache.derby.client.am.PreparedStatement.executeUpdateX(Prep\naredStatement.java:324)\n        at \norg.apache.derby.client.am.PreparedStatement.executeUpdate(Prepa\nredStatement.java:315)\n\nSee attached patch with modified prepStmt.java test for reproduction.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40993","summary":"With client setObject( parameterIndex, x, java.sql.DOUBLE) throws conversion exception if the object passed is a BigDecimal with more than 31 digits","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/32131/comment/64053","id":"64053","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"For these calls the API doc says:\r\n\r\nThe given Java object will be converted to the given targetSqlType before being sent to the database\r\n\r\nConverting the values on the client prior to sending them to the server eliminates the error.  I will post a patch with this change.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-04-29T21:42:42.000+0000","updated":"2005-04-29T21:42:42.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/32131/comment/64340","id":"64340","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jboynes","name":"jboynes","emailAddress":"jboynes at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Boynes","active":true},"body":"Applied Kathey's patch\r\n\r\nSending        java\\client\\org\\apache\\derby\\client\\am\\CrossConverters.java\r\nSending        java\\client\\org\\apache\\derby\\client\\am\\PreparedStatement.java\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\DerbyNet\\jdk15\\prepStmt.out\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\DerbyNetClient\\jdk15\\prepStmt.out\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\prepStmt.out\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\derbynet\\prepStmt.java\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\jdbcapi\\testRelative.java\r\nTransmitting file data .......\r\nCommitted revision 167863.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jboynes","name":"jboynes","emailAddress":"jboynes at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Boynes","active":true},"created":"2005-05-03T14:41:05.000+0000","updated":"2005-05-03T14:41:05.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/32131/comment/65378","id":"65378","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"This issue was fixed with svn r167863\r\n\r\nBelow are the patch comments.\r\n\r\nThis is a patch for Derby-250 to eliminate the conversion error when a\r\nBigDecimal with more than 31 digits is  passed to setObject  with a targetSqlType.\r\npublic void setObject(int parameterIndex,\r\n                      Object x,\r\n                      int targetSqlType)\r\n               throws SQLException\r\nor\r\npublic void setObject(int parameterIndex,\r\n                      Object x,\r\n                      int targetSqlType,\r\n                      int scale)\r\n               throws SQLException\r\n\r\nThe approach of the patch is to have setObject calls with a targetSqlType  to always convert before sending to the value to the server for all types.\r\n\r\nTaking this approach exposed other issues with  the client's conversion mechanism for Date, Time and Timestamp, which were customized valueOf  methods to support ISO format.   Since the extended format is not needed for Derby, I replaced these with the\r\nstandard <Date|Time|TimeStamp>.valueOf calls.\r\n\r\nThe patch also fixes issues with scale getting set properly when specified for these calls.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-05-14T08:41:18.000+0000","updated":"2005-05-14T08:41:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/32131/comment/12312628","id":"12312628","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Fixed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-06-04T15:39:44.000+0000","updated":"2005-06-04T15:39:44.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-250/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07dqv:"}}