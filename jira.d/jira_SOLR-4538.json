{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12635942","self":"https://issues.apache.org/jira/rest/api/latest/issue/12635942","key":"SOLR-4538","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324128","id":"12324128","description":"Major release after 4.2","name":"4.3","archived":false,"released":true,"releaseDate":"2013-05-05"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-03-08 03:46:23.957","customfield_12312323":null,"customfield_12310420":"316434","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_331108022_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-03-11T21:55:11.361+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-4538/watchers","watchCount":2,"isWatching":false},"created":"2013-03-08T01:56:43.367+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12321141","id":"12321141","description":"Major release after 4.0","name":"4.1","archived":false,"released":true,"releaseDate":"2013-01-22"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-10T10:32:52.251+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310674","id":"12310674","name":"search","description":"Query the search collection"}],"timeoriginalestimate":null,"description":"When using the \"lucene\" QParser, term queries on date fields cause the field value portion of the query clause to be truncated at 32 characters. This can cause visible errors about invalid date math expressions, or may result in silently returning incorrect results if the truncation results in a valid (but incomplete) date math expression.\r\n\r\nFor example...\r\n\r\n{noformat}\r\nExample...\r\n\r\nlast_modified:\"2013-03-08T00:46:15Z/DAY+6MONTHS+3DAYS\"\r\n...truncates to...\r\nlast_modified:\"2013-03-08T00:46:15Z/DAY+6MONTHS\"\r\n(silently incorrect)\r\n\r\nfoo_tdt:\"2013-03-10T08:00:00.1Z/MINUTE+6MONTHS\"\r\n...truncates to...\r\nfoo_tdt:2013-03-10T08:00:00.1Z/MINUTE+6M\r\n(\"Invalid Date Math String\" error msg)\r\n{noformat}\r\n\r\nThis problem does not affect range queries, or queries using either the term or field qparsers...\r\n\r\n{noformat}\r\nExamples that work fine even though the math is longer then 32 chars...\r\n\r\nfoo_tdt:[2013-03-10T08:00:00.1Z/MINUTE+6MONTHS TO 2013-03-10T08:00:00.1Z/MINUTE+6MONTHS]\r\n\r\n{!term f=bday}1976-07-04T12:08:56.45Z/SECOND+235MILLIS\r\nfoo_tdt:\"2013-03-10T08:00:00.1Z/MINUTE+6MONTHS\"\r\n{noformat}\r\n\r\n{panel:title=Original problem report}\r\nDateMathParser doesn't work correctly.\r\nhttp://lucene.apache.org/solr/4_1_0/solr-core/org/apache/solr/util/DateMathParser.html\r\n\r\nfq=last_modified:\"2013-03-08T00:46:15Z/DAY+6MONTHS+3DAYS\"\r\n\r\nexpected; last_modified:2013-09-11T00:00:00Z\r\nactual; last_modified:2013-09-08T00:00:00Z\r\n{panel}","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"316777","summary":"DateMath strings truncated to 32 chars by lucene qparser in simple term queries","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minoru","name":"minoru","emailAddress":"minoru at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=minoru&avatarId=16454","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=minoru&avatarId=16454","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=minoru&avatarId=16454","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=minoru&avatarId=16454"},"displayName":"Minoru Osuka","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=minoru","name":"minoru","emailAddress":"minoru at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=minoru&avatarId=16454","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=minoru&avatarId=16454","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=minoru&avatarId=16454","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=minoru&avatarId=16454"},"displayName":"Minoru Osuka","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":14,"total":14,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13596773","id":"13596773","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"Weird.  \r\n\r\nThis appears to be a query parsing issue, not a DateMathParser issue.\r\n\r\nWorks...\r\n\r\n{noformat}\r\nhttp://localhost:8983/solr/select?q={!field%20f=foo_dt}2013-03-08T00:46:15Z/DAY%2B6MONTHS%2B3DAYS&debug=query\r\n--> <str name=\"parsedquery\">foo_dt:2013-09-11T00:00:00Z</str>\r\n\r\nhttp://localhost:8983/solr/select?q={!term%20f=foo_dt}2013-03-08T00:46:15Z/DAY%2B6MONTHS%2B3DAYS&debug=query\r\n--> <str name=\"parsedquery\">foo_dt:2013-09-11T00:00:00Z</str>\r\n\r\n\r\nhttp://localhost:8983/solr/select?q=*:*&rows=0&debug=query&facet=true&facet.range=foo_dt&facet.range.start=2013-03-08T00:46:15Z/DAY%2B6MONTHS%2B3DAYS&facet.range.end=2013-03-08T00:46:15Z/DAY%2B6MONTHS%2B3DAYS&facet.range.gap=%2B1DAY\r\n--> <date name=\"start\">2013-09-11T00:00:00Z</date>\r\n--> <date name=\"end\">2013-09-11T00:00:00Z</date>\r\n{noformat}\r\n\r\nFails...\r\n\r\n{noformat}\r\nhttp://localhost:8983/solr/select?q=foo_dt:2013-03-08T00\\:46\\:15Z/DAY%2B6MONTHS%2B3DAYS&debug=query\r\n--> <str name=\"parsedquery\">foo_dt:2013-09-08T00:00:00Z</str>\r\n\r\nhttp://localhost:8983/solr/select?q=foo_dt:%222013-03-08T00:46:15Z/DAY%2B6MONTHS%2B3DAYS%22&debug=query\r\n--> <str name=\"parsedquery\">foo_dt:2013-09-08T00:00:00Z</str>\r\n{noformat}\r\n\r\n(all URLs using Solr 4.1.0 with example configs)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-03-08T03:46:23.957+0000","updated":"2013-03-08T03:46:23.957+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13597513","id":"13597513","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"This is so weird.  Somehow the query parser is deciding to ignore the last N chars of the string, where N can vary depending on the string.  in the examples posted to this issue so far, it just so happens that N winds up being the exact length of the last clause in the math, but in other cases you'll get an invalid date math expression which causes an error..\r\n\r\n{noformat}\r\nhttp://localhost:8983/solr/select?q=foo_tdt:%222013-03-10T08:00:00Z/MONTH%2B6MONTHS%22\r\nInvalid Date Math String:'2013-03-10T08:00:00Z/MONTH+6MONT'\r\n\r\nhttp://localhost:8983/solr/select?q=foooooo_tdt:%222013-03-10T08:00:00Z/MONTH%2B6MONTHS%22\r\nInvalid Date Math String:'2013-03-10T08:00:00Z/MONTH+6MONT'\r\n\r\nhttp://localhost:8983/solr/select?debug=query&q=foo_tdt:2013-03-10T08\\:00\\:00.1Z/MONTH%2B6MONTHS%2B1DAY\r\nInvalid Date Math String:'2013-03-10T08:00:00.1Z/MONTH+6MO'\r\n\r\nhttp://localhost:8983/solr/select?debug=query&q=foo_tdt:2013-03-10T08\\:00\\:00.123Z/MONTH%2B6MONTHS%2B1DAY\r\nInvalid Date Math String:'2013-03-10T08:00:00.123Z/MONTH+6'\r\n\r\nhttp://localhost:8983/solr/select?debug=query&q=foo_tdt:%222013-03-10T08:00:00Z/MINUTE%2B6MONTHS%22\r\nInvalid Date Math String:'2013-03-10T08:00:00Z/MINUTE+6MON'\r\n\r\nhttp://localhost:8983/solr/select?debug=query&q=foo_tdt:%222013-03-10T08:00:00.1Z/MINUTE%2B6MONTHS%22\r\nInvalid Date Math String:'2013-03-10T08:00:00.1Z/MINUTE+6M'\r\n{noformat}\r\n\r\n(all URLs using Solr 4.1.0 with example configs)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-03-08T20:19:30.610+0000","updated":"2013-03-08T20:19:30.610+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13597534","id":"13597534","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"still no idea where the problem is, but here's a patch with tests showing off some of hte various problems","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-03-08T20:41:53.675+0000","updated":"2013-03-08T20:41:53.675+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13597546","id":"13597546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"I do know at this point that the difference is due to the query parser electing to use newFieldQuery() (which goes through the analyzer) rather than FieldType.getFieldQuery().\r\nNot yet sure what's the issue with the analyzer though.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2013-03-08T20:50:16.663+0000","updated":"2013-03-08T20:50:16.663+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13597603","id":"13597603","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"Here's a patch that should fix the issue.  The TrieTokenizer previously assumed a max buffer length of 32 chars.  I just changed it to 128 for date fields.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2013-03-08T21:47:55.727+0000","updated":"2013-03-08T21:47:55.727+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13597794","id":"13597794","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"bq. I just changed it to 128 for date fields.\r\n\r\nI don't like the idea of kicking the can from 32 chars to 128 chars ... particularly since we've already seen from the original report of this issue how simple truncation can lead to silently incorrect results instead of any clear and obvious error message.\r\n\r\nit seems simple enough to just grow the buffer if the input is long then expected -- it doesn't add any overhead to the common case of \"normal\" date (math) strings.\r\n\r\nNew patch includes:\r\n\r\n* my previous tests\r\n* yonik's test\r\n* yonik's change to default the buffer size to 128 if it's a DATE field\r\n* a change to grow the buffer if it's not long enough\r\n* a test demonstrating date math strings longer then 128 chars","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-03-09T01:53:43.087+0000","updated":"2013-03-09T01:53:43.087+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13597810","id":"13597810","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"updated summary & description know that hte scope & root issue is known.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-03-09T02:16:15.584+0000","updated":"2013-03-09T02:16:15.584+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13599066","id":"13599066","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thetaphi","name":"thetaphi","emailAddress":"uwe at thetaphi dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thetaphi&avatarId=18956","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thetaphi&avatarId=18956","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thetaphi&avatarId=18956","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thetaphi&avatarId=18956"},"displayName":"Uwe Schindler","active":true},"body":"-Hoss: The term attribute is misused in the patch (as it is populated in ctor/reset()). It is also shared with the inner NumericTokenStream, which makes me nervous in combination with your changes. I just want to be sure, that the termattribute's contents are not used after thee ctor finishes, so incrementToken() can do what it wants with the attribute.-\r\n\r\nYou should maybe add a comment or use a separate growable instance like StringBuilder to get the chars and not misuse the term attribute.\r\n\r\n*EDIT:* The patch is fine, it uses a completely private term attribute instance, just to have a growable \"charsref-like\" instance. I would still prefer to use a StringBuilder for that, which can also be reset to zero length :-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thetaphi","name":"thetaphi","emailAddress":"uwe at thetaphi dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thetaphi&avatarId=18956","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thetaphi&avatarId=18956","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thetaphi&avatarId=18956","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thetaphi&avatarId=18956"},"displayName":"Uwe Schindler","active":true},"created":"2013-03-11T18:03:54.521+0000","updated":"2013-03-11T18:07:29.852+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13599083","id":"13599083","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=commit-tag-bot","name":"commit-tag-bot","emailAddress":"root-jira-commit_tag_bot at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=commit-tag-bot&avatarId=16176","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=commit-tag-bot&avatarId=16176","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=commit-tag-bot&avatarId=16176","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=commit-tag-bot&avatarId=16176"},"displayName":"Commit Tag Bot","active":true},"body":"[trunk commit] Chris M. Hostetter\r\nhttp://svn.apache.org/viewvc?view=revision&revision=1455269\r\n\r\nSOLR-4538: Date Math expressions were being truncated to 32 characters when used in field:value queries in the lucene QParser\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=commit-tag-bot","name":"commit-tag-bot","emailAddress":"root-jira-commit_tag_bot at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=commit-tag-bot&avatarId=16176","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=commit-tag-bot&avatarId=16176","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=commit-tag-bot&avatarId=16176","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=commit-tag-bot&avatarId=16176"},"displayName":"Commit Tag Bot","active":true},"created":"2013-03-11T18:16:31.814+0000","updated":"2013-03-11T18:16:31.814+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13599370","id":"13599370","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"Committed revision 1455269.\r\nCommitted revision 1455348.\r\nh","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-03-11T21:55:11.380+0000","updated":"2013-03-11T21:55:11.380+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13599375","id":"13599375","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thetaphi","name":"thetaphi","emailAddress":"uwe at thetaphi dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thetaphi&avatarId=18956","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thetaphi&avatarId=18956","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thetaphi&avatarId=18956","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thetaphi&avatarId=18956"},"displayName":"Uwe Schindler","active":true},"body":"Thanks, all is fine! Although I don't like the pattern-misuse of CharTermAttribute, I am fine with the fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thetaphi","name":"thetaphi","emailAddress":"uwe at thetaphi dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thetaphi&avatarId=18956","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thetaphi&avatarId=18956","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thetaphi&avatarId=18956","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thetaphi&avatarId=18956"},"displayName":"Uwe Schindler","active":true},"created":"2013-03-11T21:58:46.839+0000","updated":"2013-03-11T21:58:46.839+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13599384","id":"13599384","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=commit-tag-bot","name":"commit-tag-bot","emailAddress":"root-jira-commit_tag_bot at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=commit-tag-bot&avatarId=16176","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=commit-tag-bot&avatarId=16176","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=commit-tag-bot&avatarId=16176","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=commit-tag-bot&avatarId=16176"},"displayName":"Commit Tag Bot","active":true},"body":"[branch_4x commit] Chris M. Hostetter\r\nhttp://svn.apache.org/viewvc?view=revision&revision=1455348\r\n\r\nSOLR-4538: Date Math expressions were being truncated to 32 characters when used in field:value queries in the lucene QParser (merge r1455269)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=commit-tag-bot","name":"commit-tag-bot","emailAddress":"root-jira-commit_tag_bot at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=commit-tag-bot&avatarId=16176","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=commit-tag-bot&avatarId=16176","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=commit-tag-bot&avatarId=16176","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=commit-tag-bot&avatarId=16176"},"displayName":"Commit Tag Bot","active":true},"created":"2013-03-11T22:04:22.141+0000","updated":"2013-03-11T22:04:22.141+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13599389","id":"13599389","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"bq. Although I don't like the pattern-misuse of CharTermAttribute\r\n\r\nas mentioned in IRC: the patch initially started trying to be consistent with how KeywordTokenizer works, but since NumericTokenStream doesn't support CharTermAttribute i made it private instead of using addAttribute().\r\n\r\nIf anyone feels strongly about changing the implementation to not using CharTermAttributeImpl (and replace with StringBuilder, io-utils reader2String, whatever..) feel free, but i just choose to leave CharTermAttributeImpl in here because: a) i'd already written the code & committed it to trunk before i even saw uwe's comment; b) it keeps the buffer resizing abstracted away out of the tokenizer and consistent with the behaviour of other tokenizers.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-03-11T22:09:24.210+0000","updated":"2013-03-11T22:09:24.210+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12635942/comment/13653750","id":"13653750","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thetaphi","name":"thetaphi","emailAddress":"uwe at thetaphi dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thetaphi&avatarId=18956","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thetaphi&avatarId=18956","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thetaphi&avatarId=18956","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thetaphi&avatarId=18956"},"displayName":"Uwe Schindler","active":true},"body":"Closed after release.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=thetaphi","name":"thetaphi","emailAddress":"uwe at thetaphi dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=thetaphi&avatarId=18956","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=thetaphi&avatarId=18956","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=thetaphi&avatarId=18956","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=thetaphi&avatarId=18956"},"displayName":"Uwe Schindler","active":true},"created":"2013-05-10T10:32:52.248+0000","updated":"2013-05-10T10:32:52.248+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-4538/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1ilpj:"}}