{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12328847","self":"https://issues.apache.org/jira/rest/api/latest/issue/12328847","key":"DERBY-956","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-02-14 11:01:06.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22217","customfield_12310222":"1_*:*_1_*:*_2421418000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_32353067455","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-03-11T10:04:29.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-956/watchers","watchCount":0,"isWatching":false},"created":"2006-02-11T09:27:31.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.png","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-06-29T22:57:45.848+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"}],"timeoriginalestimate":null,"description":"Diff: \n*** Start: stress jdk1.5.0_03 encryption:multi 2006-02-09 23:37:11 ***\n3a4\n> Exception in thread \"Thread-1\" java.lang.OutOfMemoryError: Java heap space\n6 del\n< TEST CASE SUMMARY: normal termination\n7 del\n< ...running last checks via final.sql\n7 add\n> TEST CASE SUMMARY: abnormal termination due to error(s) -- see test log (./stress/stress.log) for details \nTest Failed.\n*** End:   stress jdk1.5.0_03 encryption:multi 2006-02-09 23:41:28 ***\n\nFirst seen in\nhttp://www.multinet.no/~solberg/public/Apache/TinderBox_Derby/testlog/SunOS-5.10_i86pc-i386/370061-encryption_diff.txt\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10369","value":"Regression Test Failure","id":"10369"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38984","summary":"OutOfMemoryError: Java heap space in stress.multi","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Red Hat Enterprise Linux AS release 3 (Taroon Update 4) - Linux 2.4.21-27.ELsmp #1 SMP Wed Dec 1 21:50:31 EST 2004 GNU/Linux, JVM: Sun Microsystems Inc. 1.5.0_03\nSolaris 10 3/05 s10_74L2a X86 - SunOS 5.10 Generic, JVM: Sun Microsystems Inc. 1.5.0_04\nSolaris 10 3/05 s10_74L2a SPARC - SunOS 5.10 Generic, JVM: Sun Microsystems Inc. 1.5.0_03\nSolaris 9 9/04 s9s_u7wos_09 SPARC - SunOS 5.9 Generic_118558-11, JVM: Sun Microsystems Inc. 1.5.0_03","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":16,"total":16,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12366281","id":"12366281","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Hi Ole, \r\n\r\nWhere can I get the derby.log and other files from this testrun. Can you point me to them or upload them to jira. I would like to take a look.  \r\n\r\nThanks. \r\nSunitha.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-02-14T11:01:06.000+0000","updated":"2006-02-14T11:01:06.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12366292","id":"12366292","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I am changing this to Blocker.  \r\n\r\n-  stress/multi showing OutOfMemoryError has traditionally been an indication of a serious leak memory leak in the product.\r\n-  wisconsin.sql has been acting up recently and choosing an alternate plan is also typically memory related.\r\n\r\nI think until the problem is understood, we should be very careful about what we let in the trunk.\r\n\r\nCan stress/multi  be changed to use jvmFlags to reduce the heap to compare the 10.1 and 10.2 heap needed for this test ?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-02-14T12:49:19.000+0000","updated":"2006-02-14T12:49:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12366314","id":"12366314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"body":"Hi Sunitha,\r\n\r\nThis is the zip from the first(?) occurence of the failure.\r\n(http://www.multinet.no/~solberg/public/Apache/TinderBox_Derby/Limited/testSummary-370061.html)\r\n\r\nI will also attache a newer one.\r\n\r\n\r\n-- Ole\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"created":"2006-02-14T17:29:42.000+0000","updated":"2006-02-14T17:29:42.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12366395","id":"12366395","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Thanks Ole for posting the files. \r\n\r\nI looked at the 377554.zip and stress.multi didnt fail as part of derbyall run but it failed as part of the individual encryption suite run. \r\n\r\nWhen I look further into the encryption suite directory (.\\encryption\\encryption\\multi\\stress\\), I usually check the derby.log to see what errors are .. but I see that the derby.log is empty. \r\n\r\nAnyone know what could be happening ?  Thanks. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-02-15T07:45:02.000+0000","updated":"2006-02-15T07:45:02.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12367402","id":"12367402","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"body":"I am starting to think if this failure is caused due to some kernel issue.  I used one of the recent builds 10.2.0.0 alpha - (379197) to investigate this failure.\r\n\r\nBut any number of runs on:\r\n\r\n   - Linux  2.6.5-7.244-smp #1 SMP Mon Dec 12 18:32:25 UTC 2005 i686 i686 i386 GNU/Linux\r\n    (with JVMs ibm142, ibm15, jdk142  and jdk15 (build 1.5.0_06-b05) )\r\n\r\n   - SunOS 5.10 Generic_118822-25 sun4u sparc SUNW,Ultra-4 Solaris and jdk 15 (build 1.5.0_06-b05)\r\n\r\ndid not yield the OutofMemory exception for this test.\r\n\r\nOn the contrary,  with the following Linux:\r\n\r\nLinux 2.4.21-27.ELsmp #1 SMP Wed Dec 1 21:59:02 EST 2004 i686 i686 i386 GNU/Linux\r\n(This seems to be the same version,  where the failure was initially observed)\r\n\r\nfor all the same JVMs mentioned above the test fails with OOM  exception each and every time it is run.\r\n\r\nThe kernel version in the latter  is  an older one and does seem to be the issue (since the JVMs used are the same). \r\n\r\nHaving said that, if someone else can also confirm the above, we can downgrade this issue from being a Blocker.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"created":"2006-02-23T05:32:56.000+0000","updated":"2006-02-23T05:32:56.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12367988","id":"12367988","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"body":"I tried the encryptionAll suite multiple times  with latest v10.1 jars and this issue is not seen on any of the above OSes.  It is quite strange\r\nwhy on specific systems this test fails for 10.2 therefore merits further investigation.\r\n\r\nI agree with leaving this issue a Blocker till we have discussed a resolution.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"created":"2006-02-28T02:08:29.000+0000","updated":"2006-02-28T02:08:29.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12368571","id":"12368571","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"when you ran the test on 10.1 did you use the 10.1 tests or the 10.2 tests?  I think there may be changes in 10.2 in what tests we run.  DERBY-238 seems one such instance.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2006-03-03T04:05:44.000+0000","updated":"2006-03-03T04:05:44.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369354","id":"12369354","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"This test failed in one of the nighlty runs (2006/03/06) on platform \r\nOS name:         Linux\r\nOS architecture: i386\r\nOS version:      2.6.5-7.201-bigsmp\r\nJava Version:    1.5.0_06\r\nJava Vendor:     Sun Microsystems Inc.\r\ninsane jars with version10.2.0.0 alpha - (383748)\r\ndiff: \r\n3a4\r\n> Exception in thread \"Thread-8\" java.lang.OutOfMemoryError: Java heap space\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-03-08T09:53:33.000+0000","updated":"2006-03-08T09:53:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369534","id":"12369534","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I did some analysis using the sun test regression histories, I didn't realize how long they had that\r\naround.  We probably should automatically be doing this as a first step to analysing any bug\r\nthat reproduces 100% on any platform.  The analysis is below.  I just looked at the change\r\ndiff for 370059 and noticed it had a change to ij in the area of multi-threaded -- it looked very\r\ninnocuous, but given that the problem seems to have started with one of the 3 changes \r\nin the report - and I looked at the other 2 which seemed only test related in other areas I would\r\nguess it is related to 370059.  \r\n\r\n I suggest building\r\na trunk version at 369956 just before the change, and then at 370059 and see if that verifies\r\nmy guess.\r\n\r\nHere is the history analysis I did by hand doing binary search on the sun test histories:\r\n\r\nFor instance I was trying to do some analysis on the stress memory\r\nheap issue, and found:\r\n\r\ntest failed on linux platform 100% time (actually I didn't check\r\nevery run, just did a few probes), first encountered in \r\n\r\nhttp://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-370210.html\r\n\r\n3 changes happened in that test run:\r\nhttp://www.multinet.no/~solberg/public/Apache/Derby/UpdateInfo/370210.txt\r\n\r\nOf which I would look at 370059 as it makes an ij change with respect to \r\nmuti-threaded ij.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2006-03-09T03:17:00.000+0000","updated":"2006-03-09T03:17:00.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369705","id":"12369705","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"body":"As Mike suggested, I synced up to the 369956 trunk version and tried the test encryptionAll suite on the same Linux -  2.4.21-27.ELsmp (with the \r\nconsistent OutOf Memory failures) with  the following scenarios.\r\n\r\n1) derby jars(10.2.0.0 alpha - (369956)) and derbyTesting.jar (369956) no exceptions\r\n2) derby jars(10.2.0.0 alpha - (369956)) and derbyTesting.jar (379197)  ** OutOfMemory exception ** \r\n3) derby jars (10.2.0.0 alpha - (379197)) and derbyTesting.jar (369956) no exceptions\r\n4) derby jars (10.2.0.0 alpha - (379197)) and derbyTesting.jar (379197) ** OutOfMemory exception ** \r\n\r\nThe (379197)  is one of the  last week's jars, and from the above  seems evident that the harness change ( after 369956 (370059 ?) ) \r\nis causing some sort of leak.  \r\n\r\nWe need more investigation to look into what effect the usage of datasources is having on this test.   \r\n\r\nI am glad we are closing in on the real issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"created":"2006-03-10T02:37:33.000+0000","updated":"2006-03-10T02:37:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369910","id":"12369910","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Attaching a patch 'derby-956-draft1.diff' which I think will resolve the test failure. Attaching as draft (not to be committed) since this still needs to be tested on linux or other platform where this failure was seen.\r\n\r\nPatch changes mtTestCase.java to use the url in \"ij.database\" property instead of \"database\" property. This way the test can continue to work in j2me environment too.\r\n\r\nI have run derbyall with this patch on Windows with Sun JDK 1.4.2. No failures other than lang/wisconsin.java. I am testing it out on a linux machine but I am facing some other setup problem which I need to solve. I would appreciate if anyone who has an environment where this test fails can try this patch to see if it solves the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-03-11T03:17:18.000+0000","updated":"2006-03-11T03:17:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369931","id":"12369931","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Hi Deepa, I got access to an environment where this is failing. (Thanks Rajesh!) \r\n\r\nThe patch does indeed solve the problem, and unless anyone objects, I'm planning on committing it, although it would be nice if someone else with an environment where this is failing could confirm it as well. But I'm left wondering why this made such a difference, and why only in certain environments. We should probably file a JIRA to followup on that.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-03-11T06:01:57.000+0000","updated":"2006-03-11T06:01:57.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369940","id":"12369940","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Thanks Andrew for verifying. I have also verified this test passes with the patch (in an environment where it fails without the patch).\r\n\r\nI have not figured out from where the OutOfMemoryError comes from. Here is what I found so far. Before this patch, when stress.multi gets run as part of encryption suite, the encryption attributes were not getting added to the database URL. This was because mtTestCase.java looks for \"database\" property whereas I had changed the properties file to use \"ij.database\" instead. This was a routine thing I was doing to enable tests for j2me and never imagined it had this side-effect for the multi test till Mike tracked it down. \r\n\r\nSo, the connect to the database fails and the output of running the sql files would be something like this:\r\n\r\n--------------init.sql-----------------\r\nERROR 08001: No suitable driver\r\nij version 10.2\r\nij> drop function PADSTRING;\r\nIJ ERROR: Unable to establish connection\r\n\r\nThe tester threads were not doing anything in this situation because they fail to get a connection itself. So we were not testing anything here. Now, it is more confuing how we can get an OutOfMemoryError in such situation. As Andrew suggested, I'll open a jira issue to track what is causing the memory error.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-03-11T07:07:52.000+0000","updated":"2006-03-11T07:07:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369941","id":"12369941","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Committed patch to mtTestCase with revision 384946. Deepa, I'll leave it to you to file the followup JIRA. I'm leaving this open until we verify that it is fixed in the tinderbox run.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-03-11T07:13:13.000+0000","updated":"2006-03-11T07:13:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369942","id":"12369942","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I've seen this failure continually with windows and ibm142 and with the patch the test passes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-03-11T07:13:32.000+0000","updated":"2006-03-11T07:13:32.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328847/comment/12369953","id":"12369953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Thanks Andrew for committing this change. I checked the tinderbox run with this change and derbyall has run cleanly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-03-11T10:04:29.000+0000","updated":"2006-03-11T10:04:29.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-956/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i071cf:"}}