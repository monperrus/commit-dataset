{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12479360","self":"https://issues.apache.org/jira/rest/api/latest/issue/12479360","key":"ARIES-485","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310981","id":"12310981","key":"ARIES","name":"Aries","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310981&avatarId=10065","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310981&avatarId=10065","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310981&avatarId=10065","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310981&avatarId=10065"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10520","id":"10520","description":"Apache Aries","name":"Aries"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315310","id":"12315310","description":"","name":"0.3","archived":true,"released":true,"releaseDate":"2011-02-08"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-11-10 14:23:31.019","customfield_12312323":null,"customfield_12310420":"94094","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1854570631_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-11-29T20:44:31.160+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-485/watchers","watchCount":0,"isWatching":false},"created":"2010-11-08T09:35:00.529+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315310","id":"12315310","description":"","name":"0.3","archived":true,"released":true,"releaseDate":"2011-02-08"}],"issuelinks":[{"id":"12337381","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12337381","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12477121","key":"ARIES-449","self":"https://issues.apache.org/jira/rest/api/2/issue/12477121","fields":{"summary":"Upgrade to latest geronimo transaction manager","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-02-07T12:36:22.925+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313081","id":"12313081","name":"Transaction"}],"timeoriginalestimate":null,"description":"With Geronimo transaction manager 2.2, on the J9 JVM we see consistent hangs in the JpaBlogSampleWithEbaTest, which is just the first itest to use the real transaction manager. Moving back to 2.1.3 fixes the problem, so almost certainly it is in some form related to the new level.\r\n\r\nConcretely this has been seen when building the trunk with:\r\n\r\nmvn -fae -e -B clean install","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"168112","summary":"On IBM J9 JVM Blog itests hang","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"IBM J9","customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":8,"total":8,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479360/comment/12929522","id":"12929522","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"body":"The javacore of the paxexam process that \"hangs\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"created":"2010-11-08T09:35:55.129+0000","updated":"2010-11-08T09:35:55.129+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479360/comment/12930602","id":"12930602","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"body":"Anybody know how to determine non-daemon threads? Oracle JVM's dump daemon indicators in their thread information. Looks like IBM doesn't. Without that, I don't know how we can tell why the java process isn't stopping...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"created":"2010-11-10T14:23:31.019+0000","updated":"2010-11-10T14:23:31.019+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479360/comment/12930637","id":"12930637","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"body":"On closer investigation it does not seem like it is actually the TransactionTimer thread that is the problem. I have tried to terminate various suspicious threads at the end of the JpaBlogSampleWithEbaTest as follows:\r\n\r\n    for (Map.Entry<Thread,StackTraceElement[]> e : Thread.getAllStackTraces().entrySet()) {\r\n        boolean found = false;\r\n        for (StackTraceElement st : e.getValue()) {\r\n            if (st.getClassName().contains(\"java.util.Timer\")) found = true;\r\n\t}\r\n\r\n        if (found) e.getKey().stop();\r\n    }\r\n\r\nStopping all java.util.Timer threads solves the hang whereas removing the TransactionTimer thread does not solve it. So maybe there are new timers introduced in geronimo-transaction 2.2 or there is some subtle interaction that is different ???","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"created":"2010-11-10T16:14:23.660+0000","updated":"2010-11-10T16:14:23.660+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479360/comment/12930651","id":"12930651","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"body":"Hi Valentin, thanks. There are some Timer's went are marked as daemon. Not sure why this is only showing up on an IBM runtime, though. Anyway, I've created GERONIMO-5684","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"created":"2010-11-10T16:59:28.150+0000","updated":"2010-11-10T16:59:28.150+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479360/comment/12930673","id":"12930673","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"body":"Could someone run a test with the following snapshot?\r\n\r\n<geronimo-transaction-version>2.2.2-SNAPSHOT</geronimo-transaction-version>","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"created":"2010-11-10T17:42:33.752+0000","updated":"2010-11-10T17:42:33.752+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479360/comment/12931151","id":"12931151","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"body":"Thanks for putting this up Kevan.\r\n\r\nThe tests no longer hang with the 2.2.2 snapshot version on my test installation. I have run it a couple of times with both 2.2 (always hangs) and 2.2.2-SNAPSHOT (never hangs) just to make sure.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"created":"2010-11-11T19:23:38.468+0000","updated":"2010-11-11T19:23:38.468+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479360/comment/12931153","id":"12931153","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"body":"Great. Thanks Valentin. Geronimo is respinning the 2.2.1 release of geronimo-transaction. So, once the vote is completed, we can pick up 2.2.1. Until then, 2.2.2-SNAPSHOT should work...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"created":"2010-11-11T19:28:38.535+0000","updated":"2010-11-11T19:28:38.535+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479360/comment/12964933","id":"12964933","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"body":"geronimo-transaction 2.2.1 has been released and won't generate and should no longer generate user threads which prevent the test from ending.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kevan","name":"kevan","emailAddress":"kevan dot miller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kevan Miller","active":true},"created":"2010-11-29T20:44:31.105+0000","updated":"2010-11-29T20:44:31.105+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-485/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0t4yf:"}}