{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12368289","self":"https://issues.apache.org/jira/rest/api/latest/issue/12368289","key":"LUCENE-871","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310110","id":"12310110","key":"LUCENE","name":"Lucene - Core","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310110&avatarId=10061","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310110&avatarId=10061","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310110&avatarId=10061","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310110&avatarId=10061"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312531","id":"12312531","description":"","name":"2.3","archived":false,"released":true,"releaseDate":"2008-01-23"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2007-04-29 15:51:03.217","customfield_12312323":null,"customfield_12310420":"12871","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_9395932786_*|*_6_*:*_1_*:*_0_*|*_5_*:*_2_*:*_13880176316_*|*_4_*:*_1_*:*_95292735","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-08-17T16:58:50.097+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LUCENE-871/watchers","watchCount":1,"isWatching":false},"created":"2007-04-29T15:20:35.427+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12310334","id":"12310334","description":"last 1.x release, has new 2.x APIs","name":"1.9","archived":false,"released":true,"releaseDate":"2006-02-27"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12310853","id":"12310853","description":"mostly 1.9 with deprecated items removed","name":"2.0.0","archived":false,"released":true,"releaseDate":"2006-05-26"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12310854","id":"12310854","description":"","name":"2.1","archived":false,"released":true,"releaseDate":"2007-02-17"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312328","id":"12312328","description":"","name":"2.2","archived":false,"released":true,"releaseDate":"2007-06-19"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-01-25T03:23:56.818+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310230","id":"12310230","name":"modules/analysis","description":"issues related to analysis module"}],"timeoriginalestimate":null,"description":"The ISOLatin1AccentFilter is a bit slow giving 300+ ms responses when used in a highligher for output responses.\n\nPatch to follow","customfield_10010":null,"timetracking":{},"customfield_12310120":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10121","value":"New","id":"10121"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10120","value":"Patch Available","id":"10120"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"27176","summary":"ISOLatin1AccentFilter a bit slow","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ianeboston","name":"ianeboston","emailAddress":"ieb at tfd dot co dot uk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ian Boston","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ianeboston","name":"ianeboston","emailAddress":"ieb at tfd dot co dot uk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ian Boston","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":27,"total":27,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12492577","id":"12492577","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ianeboston","name":"ianeboston","emailAddress":"ieb at tfd dot co dot uk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ian Boston","active":true},"body":"Patch to improve performance,\r\n\r\nThis was re-created form the improved source, and although I dont think I have made any transcription mistakes, I might have, please check that it builds and works. Ok.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ianeboston","name":"ianeboston","emailAddress":"ieb at tfd dot co dot uk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ian Boston","active":true},"created":"2007-04-29T15:41:08.133+0000","updated":"2007-04-29T15:41:08.133+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12492578","id":"12492578","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"Patch looks fine after a quick review.\r\n\r\nTo speed things up a bit more in the case that there are few accented chars in a large field, one could start the second loop at the place where the first loop found a char in the range of accented chars.  The first part could be efficiently copied via String.getChars()","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2007-04-29T15:51:03.217+0000","updated":"2007-04-29T15:51:03.217+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12515032","id":"12515032","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"body":"It would be a nice courtesy to document that this thing is over 2 times faster if you use a StringBuilder rather than a StringBuffer. Up to 2.8 times faster in my measurements.\r\n\r\n- Mark","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"created":"2007-07-24T17:12:12.959+0000","updated":"2007-07-24T17:12:12.959+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12515053","id":"12515053","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"Right, but StringBuilder is 1.5.  Sigh...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2007-07-24T18:11:17.099+0000","updated":"2007-07-24T18:11:17.099+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12515060","id":"12515060","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"body":"Yes, I feel that sigh. So perhaps the point is moot. I was just thinking that a lot of code runs on 1.5 or > and while its obviously crazy to point out every class that could be changed to a StringBuilder, i thought it might be nice to warn somehow that this thing is like twice as fast if you can use StringBuilder. Even this sped up version takes more than its fair share in my filter chain.\r\n\r\n- Mark","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"created":"2007-07-24T18:38:43.109+0000","updated":"2007-07-24T18:38:43.109+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12515077","id":"12515077","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"I think we can likely get a sizable speedup here by using the char[] termBuffer in Token plus the new \"re-use single Token\" API being discussed here:\r\n\r\n    http://www.gossamer-threads.com/lists/lucene/java-dev/51283","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2007-07-24T19:51:16.997+0000","updated":"2007-07-24T19:51:16.997+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12515101","id":"12515101","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"body":"Here is a 1.4 solution using a char array. Doesn't yet use termbuffer or create only a single token.\r\n\r\nAlmost twice as fast.\r\n\r\n- Mark","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"created":"2007-07-24T22:00:29.358+0000","updated":"2007-07-24T22:00:29.358+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12515103","id":"12515103","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"body":"Woah! I thought I was seeing this patch on the trunk already. Should have looked more closely at the patch file. I basically just duplicated the patch. Belay all previous.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"created":"2007-07-24T22:05:08.313+0000","updated":"2007-07-24T22:05:08.313+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12515111","id":"12515111","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"body":"Since I prefer my char array handling to the current, I have taken the fail fast pre-scan loop and yoniks suggestion and incorporated them into my patch. Two choices now.\r\n\r\n- Mark","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"created":"2007-07-24T22:50:36.162+0000","updated":"2007-07-24T22:51:36.720+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12516403","id":"12516403","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"OK, for LUCENE-969 I made yet a 3rd option for optimizing\r\nISOLatin1AccentFilter.\r\n\r\nIn that patch I reuse the Token instance, using the char[] API for the\r\nToken's text instead of String, and I also re-use a single TokenStream\r\ninstance (I did this for all core tokenizers).\r\n\r\nI just tested total time to tokenize all wikipedia content with\r\ncurrent trunk (1116 sec) vs with LUCENE-969 (500 sec), with a\r\nWhitespaceTokenizer -> ISOLatin1AccentFilter chain.\r\n\r\nI separately timed just creating the documents at 112 sec, to subtract\r\nit off from the above times (so I can measure only cost of\r\ntokenization).\r\n\r\nThis gives net speedup of this filter is 2.97X faster (1004 sec -> 388\r\nsec).\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2007-07-30T14:39:49.169+0000","updated":"2007-07-30T14:39:49.169+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12520182","id":"12520182","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"I think the changes that were part of LUCENE-969 (giving 2.97X speedup of ISOLatin1AccentFilter) has resolved this issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2007-08-16T09:19:27.755+0000","updated":"2007-08-16T09:19:27.755+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12520234","id":"12520234","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"body":"Pretty sure you still want this guys patch. It avoids a slow StringBuffer and has a fail fast check before switching each char against a rather large list. In the case that there are not that many accents it is much faster, and in either case the replacement of StringBuffer is much faster. Probably complements 969.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=markrmiller%40gmail.com","name":"markrmiller@gmail.com","emailAddress":"markrmiller at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=markrmiller%40gmail.com&avatarId=17267","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=markrmiller%40gmail.com&avatarId=17267","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=markrmiller%40gmail.com&avatarId=17267","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=markrmiller%40gmail.com&avatarId=17267"},"displayName":"Mark Miller","active":true},"created":"2007-08-16T13:09:49.714+0000","updated":"2007-08-16T13:09:49.714+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12520262","id":"12520262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"Ahh, OK, thanks.  I will re-open and merge in the fail-fast part; I've already replaced StringBuffer with char[] as part of LUCENE-969.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2007-08-16T14:30:26.051+0000","updated":"2007-08-16T14:30:26.051+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12520386","id":"12520386","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"OK I merged the original patch with my commit from LUCENE-969.  I\r\nplan to commit tomorrow.  Thanks Ian!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2007-08-16T21:57:43.183+0000","updated":"2007-08-16T21:57:43.183+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12520499","id":"12520499","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ianeboston","name":"ianeboston","emailAddress":"ieb at tfd dot co dot uk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ian Boston","active":true},"body":"My pleasure, for once to give something back to Lucene :)\r\nFYI, this is used for searching the texts of Charles Darwins letters at \r\nhttp://www.darwinproject.ac.uk/darwin/search/advanced , once again \r\nLucene saved us 1000's of hours of work.\r\nThank you.\r\nIan\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ianeboston","name":"ianeboston","emailAddress":"ieb at tfd dot co dot uk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ian Boston","active":true},"created":"2007-08-17T09:10:32.236+0000","updated":"2007-08-17T09:10:32.236+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12520605","id":"12520605","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"I just committed this.  Thanks Ian!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2007-08-17T16:58:50.016+0000","updated":"2007-08-17T16:58:50.016+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521089","id":"12521089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stanislaw.osinski","name":"stanislaw.osinski","emailAddress":"stanislaw dot osinski at carrot-search dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stanislaw Osinski","active":true},"body":"One possible (and probably large) speed up for this code would be replacing the switch / case structure (which for most characters needs to be evaluated down to the \"default\", which is _lots_ of comparisons) with a plain static char[65536][] table. The cost for this is roughly 130kB of memory, but the speed-up should be pretty good. If lots of people are using this filter and the memory cost is acceptable, later this week I can try to prepare another patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stanislaw.osinski","name":"stanislaw.osinski","emailAddress":"stanislaw dot osinski at carrot-search dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stanislaw Osinski","active":true},"created":"2007-08-20T13:45:42.768+0000","updated":"2007-08-20T13:45:42.768+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521191","id":"12521191","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=klaasm","name":"klaasm","emailAddress":"mike dot klaas at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Klaas","active":true},"body":"The switch statement is not equivalent to a list of sequential ifelses--it is implemented as a O(1) branch already.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=klaasm","name":"klaasm","emailAddress":"mike dot klaas at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Klaas","active":true},"created":"2007-08-20T18:51:49.132+0000","updated":"2007-08-20T18:51:49.132+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521201","id":"12521201","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"body":"Not exactly true, Mike. Switch statements are implemented as table lookups (tableswitch opcode) or binary sort switches (lookupswitch) -- depending on the sparseness of keys used in the case clauses I'm sure, don't have the time to dig out my copy of the JVM spec right now.\r\n\r\nIn any case, I'm pretty sure what Staszek says is correct and will be more efficient -- I've had that in practice and doing manual lookup instead of a switch (with multiple branches, wide spectrum) was _much_ faster (an order of magnitude in my case).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"created":"2007-08-20T19:17:19.562+0000","updated":"2007-08-20T19:17:19.562+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521211","id":"12521211","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"It seems that any table based approach would need to take up 256 slots at most... one could get away with 64 too (0xff-0xc0+1).\r\nIn any case, with normal latin1 text with an average amount of accents and a normal analyzer, does the current version really slow things down anymore?\r\n\r\nDawid: a lookupswitch is O(1), no?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2007-08-20T19:40:56.331+0000","updated":"2007-08-20T19:40:56.331+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521340","id":"12521340","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"body":"I guess it's a matter of just writing down two versions and comparing them against each other. :)\r\n\r\nYonik: I don't think lookupswitch is O(1) -- my belief is that lookupswitch is a binary search through the key set http://java.sun.com/docs/books/jvms/second_edition/html/Compiling.doc.html#14942. I guess you could _make_ it O(1) with perfect hashing, for example, but if I were to guess it's not the reality. It's a good question though -- I'll have a look at SUN's JVM sources in a spare moment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"created":"2007-08-21T07:22:43.806+0000","updated":"2007-08-21T07:22:43.806+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521344","id":"12521344","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stanislaw.osinski","name":"stanislaw.osinski","emailAddress":"stanislaw dot osinski at carrot-search dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stanislaw Osinski","active":true},"body":"I've just quickly decompiled the ISOLatin1AccentFilter.class from lucene 2.2.0 distribution -- the switch statement got compiled into a tableswitch -- the faster of the two options (but with larger code size).\r\n\r\nYonik: from what I understand from the JVM spec, it is the tableswitch that is O(1) and lookupswitch should be at least O(log(N)) (binary search through N case values).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stanislaw.osinski","name":"stanislaw.osinski","emailAddress":"stanislaw dot osinski at carrot-search dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stanislaw Osinski","active":true},"created":"2007-08-21T07:31:01.657+0000","updated":"2007-08-21T07:31:01.657+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521350","id":"12521350","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"body":"Funny -- I just did the same, but my compiler (Eclipse JDT) generated a lookupswitch from head -- \r\n\r\n    //*  52   93:iload           7\r\n                {\r\n    //*  53   95:lookupswitch    65: default 1275\r\n    //                   192: 624\r\n    //                   193: 624\r\n    //                   194: 624\r\n\r\nI also peeked at JVM's sources. Lookupswitches can be compiled (in hotspot mode) into two internal JVM instructions -- fast_linearswitch or fast_binaryswitch. Depending on the selection you either get the O(1) acceleration or not. I still think it could be worthwhile to try to boost the performance of this method, although the gain might be minimal.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"created":"2007-08-21T07:51:48.142+0000","updated":"2007-08-21T07:51:48.142+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521353","id":"12521353","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"body":"To clarify: depending on the compiler/ hotspot you may get linear time (tableswitch), O(log(N)) (binarysearch) or O(N) (linearsearch). The exact checks which route is followed is beyond me, but the JVM sources are out there, so I guess it's possible to check.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"created":"2007-08-21T08:01:05.496+0000","updated":"2007-08-21T08:01:05.496+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521361","id":"12521361","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"body":"I was a bit curious about it, so I decided to write a table-lookup version. It does come out faster, but only by a small margin (especially on \"server\", hotspot JVMs). \r\n\r\nTimings are in milliseconds, the round consisted of 100000 repetitions of parsing the test string \"Des mot clés À LA CHAÎNE À Á Â Ã Ä Å Æ Ç È É Ê Ë Ì Í Î Ï Ð Ñ Ò Ó Ô Õ Ö Ø Œ Þ Ù Ú Û Ü Ý Ÿ à á â ã ä å æ ç è é ê ë ì í î ï ð ñ ò ó ô õ ö ø œ ß þ ù ú û ü ý ÿ\". Note it is biased since most characters do have accents, which will not be the case in real life I gues... but still:\r\n\r\n// SUN JVM build 1.6.0-b105, -server mode\r\nRound (old): 1922\r\nRound (old): 1688\r\nRound (old): 1656\r\nRound (old): 1687\r\nRound (old): 1641\r\nRound (old): 1703\r\nRound (old): 1672\r\nRound (old): 1672\r\nRound (old): 1687\r\nRound (old): 1719\r\nRound (new): 1719\r\nRound (new): 1609\r\nRound (new): 1609\r\nRound (new): 1594\r\nRound (new): 1625\r\nRound (new): 1578\r\nRound (new): 1625\r\nRound (new): 1594\r\nRound (new): 1625\r\nRound (new): 1656\r\n\r\n// SUN JVM, 1.6.0, interpreted (-client)\r\n\r\nRound (old): 2391\r\nRound (old): 2453\r\nRound (old): 2359\r\nRound (old): 2375\r\nRound (old): 2391\r\nRound (old): 2359\r\nRound (old): 2156\r\nRound (old): 2532\r\nRound (old): 2422\r\nRound (old): 2359\r\nRound (new): 1969\r\nRound (new): 1906\r\nRound (new): 1922\r\nRound (new): 1937\r\nRound (new): 1985\r\nRound (new): 1922\r\nRound (new): 1906\r\nRound (new): 1937\r\nRound (new): 1985\r\nRound (new): 1922\r\n\r\n// IBM JVM 1.5.0 (don't know why it's so sluggish, really).\r\n\r\nRound (old): 7906\r\nRound (old): 7188\r\nRound (old): 7625\r\nRound (old): 7312\r\nRound (old): 7266\r\nRound (old): 7141\r\nRound (old): 7015\r\nRound (old): 5641\r\nRound (old): 5578\r\nRound (old): 5672\r\nRound (new): 4656\r\nRound (new): 4406\r\nRound (new): 4516\r\nRound (new): 4516\r\nRound (new): 4375\r\nRound (new): 4375\r\nRound (new): 4343\r\nRound (new): 4297\r\nRound (new): 4344\r\nRound (new): 4266\r\n\r\n// IBM 1.5.0, -server (note the speed improvement when the old version is hotspot-optimized).\r\n\r\nRound (old): 5922\r\nRound (old): 5078\r\nRound (old): 5078\r\nRound (old): 5062\r\nRound (old): 4985\r\nRound (old): 4875\r\nRound (old): 4953\r\nRound (old): 4641\r\nRound (old): 3640\r\nRound (old): 3735\r\nRound (new): 3750\r\nRound (new): 3781\r\nRound (new): 3656\r\nRound (new): 3516\r\nRound (new): 3515\r\nRound (new): 3594\r\nRound (new): 3547\r\nRound (new): 3562\r\nRound (new): 3532\r\nRound (new): 3531\r\n\r\nSo... it does come out a bit faster. Whether it makes sense to waste 130 kb of memory for this improvement.... don't know, really. I'll upload the table-lookup version for your reference.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"created":"2007-08-21T08:50:12.629+0000","updated":"2007-08-21T08:50:12.629+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521362","id":"12521362","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"body":"A table-lookup version of ISO latin filter (this is not a patch, it's a renamed class so that you can compare the two).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dweiss","name":"dweiss","emailAddress":"dawid dot weiss at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dawid Weiss","active":true},"created":"2007-08-21T08:51:51.968+0000","updated":"2007-08-21T08:51:51.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12368289/comment/12521505","id":"12521505","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ijuma","name":"ijuma","emailAddress":"mlists at juma dot me dot uk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ismael Juma","active":true},"body":"I guess there's no better way than to verify the sources as Dawid did, but here's a post that also explains the behaviour of the -server HotSpot JIT when it comes to switch statements:\r\n\r\nhttp://forums.java.net/jive/message.jspa?messageID=204492#204492 ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ijuma","name":"ijuma","emailAddress":"mlists at juma dot me dot uk","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ismael Juma","active":true},"created":"2007-08-21T15:39:35.988+0000","updated":"2007-08-21T15:39:35.988+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LUCENE-871/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i050hj:"}}