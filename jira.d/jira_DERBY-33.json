{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"27664","self":"https://issues.apache.org/jira/rest/api/latest/issue/27664","key":"DERBY-33","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2004-11-18 14:18:19.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21732","customfield_12310222":"1_*:*_1_*:*_4522588000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_36440499000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2004-11-28T05:04:20.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-33/watchers","watchCount":0,"isWatching":false},"created":"2004-10-06T20:47:52.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10920","id":"10920","description":"initial source drop","name":"10.0.2.0","archived":false,"released":true,"releaseDate":"2004-08-30"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-07-08T10:04:31.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"}],"timeoriginalestimate":null,"description":"With some other unimplemented methods Derby accepts a default value or value that is in effect a no-op. In this case an empty map should be accepted. May want to apply the same logi to other JDBC methods that take a type map.\n\nOriginal bug discovered by Edward Rayl\n\nhttp://nagoya.apache.org/eyebrowse/ReadMsg?listName=derby-user@db.apache.org&msgNo=43\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40596","summary":"Connection.setTypeMap throws unimplemented exception with empty map","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/27664/comment/55614","id":"55614","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"I wrote a sample program using JdbcRowSet and found it to working perfectly with Derby. I am attaching the sample program here. \r\n\r\nIt *did not* throw up the error \r\n\r\nJdbcRowSet (setTypeMap) : null.\r\n\r\nThis error appears becaus eof the fix suggested in the link that causes a NPE if the map is null ( map.isEmpty()) causes a NPE that appears as this problem. \r\n\r\nMy suggested fix to handle this problem is :\r\n\r\nif((map != null)) {\r\n            if(!(map.isEmpty()))\r\n\t\tthrow Util.notImplemented();\r\n\t}\r\n\r\nI also did not get the error when the connection is actually closed. The right way to clean up things when using the JdbcRowSet is to call close() method in the JdbcRowSet and then call the close method on the connection. \r\n\r\nPlease have a look at this and let me know.\r\n\r\nthanks\r\nShreyas ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2004-11-18T14:18:19.000+0000","updated":"2004-11-18T14:18:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27664/comment/55615","id":"55615","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"I wrote a sample program using JdbcRowSet and found it to working perfectly with Derby. I am attaching the sample program here. \r\n\r\nIt *did not* throw up the error \r\n\r\nJdbcRowSet (setTypeMap) : null.\r\n\r\nThis error appears becaus eof the fix suggested in the link that causes a NPE if the map is null ( map.isEmpty()) causes a NPE that appears as this problem. \r\n\r\nMy suggested fix to handle this problem is :\r\n\r\nif((map != null)) {\r\n            if(!(map.isEmpty()))\r\n\t\tthrow Util.notImplemented();\r\n\t}\r\n\r\nI also did not get the error when the connection is actually closed. The right way to clean up things when using the JdbcRowSet is to call close() method in the JdbcRowSet and then call the close method on the connection. \r\n\r\nPlease have a look at this and let me know.\r\n\r\nPS: Please see below for the attached sample program\r\n\r\nthanks\r\nShreyas \r\n\r\n---------------------Sample Program begins----------------------------------\r\n\r\nimport java.sql.*;\r\nimport javax.sql.rowset.*;\r\nimport com.sun.rowset.*;\r\n\r\npublic class updateNull{\r\n\r\n   public static void main(String [] args) {\r\n   \r\n      String strUrl = \"jdbc:derby:;databaseName=testdb;create=true\";           \r\n      try {\r\n         Class.forName(\"org.apache.derby.jdbc.EmbeddedDriver\");\r\n         Connection con = DriverManager.getConnection(strUrl);\r\n         \r\n         Statement stmt = con.createStatement();\r\n         try {\r\n            stmt.executeUpdate(\"drop table test\");\r\n         } catch(SQLException ex) {\r\n            // Do nothing.\r\n         }\r\n         con.commit();\r\n         \r\n         Statement stmt1 = con.createStatement();\r\n         stmt1.executeUpdate(\"create table test(i_val integer, s_val varchar(10))\");\r\n         stmt1.executeUpdate(\"insert into test values(1,'shreyas')\");\r\n         con.commit();\r\n         \r\n\t JdbcRowSet jrs = new JdbcRowSetImpl(con);\r\n\t jrs.setCommand(\"select * from test\");\r\n\t jrs.execute();\t \r\n\t jrs.close();\r\n\t \r\n\t con.close();\r\n                  \r\n      } catch(ClassNotFoundException cnfe) {\r\n         System.out.println(\"Class not found: \"+cnfe.getMessage());\r\n      } catch(SQLException sqle) {\r\n         System.out.println(\"SQL:Caught: \"+sqle.getMessage());\r\n         sqle.printStackTrace();\r\n      } catch(Exception e) {\r\n          \r\n      }\r\n      \r\n   }\r\n}\r\n\r\n--------------------Sample Program Ends----------------------------------------\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2004-11-18T14:19:49.000+0000","updated":"2004-11-18T14:19:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27664/comment/55947","id":"55947","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Sending        java\\engine\\org\\apache\\derby\\iapi\\reference\\SQLState.java\r\nSending        java\\engine\\org\\apache\\derby\\impl\\jdbc\\EmbedCallableStatement20.java\r\nSending        java\\engine\\org\\apache\\derby\\impl\\jdbc\\EmbedConnection20.java\r\nSending        java\\engine\\org\\apache\\derby\\impl\\jdbc\\EmbedResultSet20.java\r\nSending        java\\engine\\org\\apache\\derby\\loc\\messages_en.properties\r\nTransmitting file data .....\r\nCommitted revision 106787.\r\n\r\nFix for Derby-33 - not implemented exception when passing in empty type map to JBDC calls.\r\n\r\nHandling the map conditions the following way\r\n\r\n  null Map      --> throw a SQLException\r\n  empty Map     --> no-op\r\n  non-empty Map --> throw notImplemented.\r\n\r\nPatch contributed by Shreyas Kaushik (Shreyas.Kaushik@Sun.COM)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2004-11-28T05:04:20.000+0000","updated":"2004-11-28T05:04:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27664/comment/12363674","id":"12363674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"Verified fix by quick code inspection and minimalistic JDBC testing.\r\nClosing the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2006-01-23T23:25:59.000+0000","updated":"2006-01-23T23:25:59.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-33/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07ban:"}}