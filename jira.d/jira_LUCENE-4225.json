{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12598960","self":"https://issues.apache.org/jira/rest/api/latest/issue/12598960","key":"LUCENE-4225","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310110","id":"12310110","key":"LUCENE","name":"Lucene - Core","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310110&avatarId=10061","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310110&avatarId=10061","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310110&avatarId=10061","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310110&avatarId=10061"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2012-07-16 13:54:58.392","customfield_12312323":null,"customfield_12310420":"243740","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_272964772_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2012-07-19T16:54:28.783+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LUCENE-4225/watchers","watchCount":5,"isWatching":false},"created":"2012-07-16T13:05:04.104+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"5.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[],"issuelinks":[{"id":"12355587","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12355587","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12547222","key":"LUCENE-3892","self":"https://issues.apache.org/jira/rest/api/2/issue/12547222","fields":{"summary":"Add a useful intblock postings format (eg, FOR, PFOR, PFORDelta, Simple9/16/64, etc.)","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}},{"id":"12355731","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12355731","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12601200","key":"LUCENE-4283","self":"https://issues.apache.org/jira/rest/api/2/issue/12601200","fields":{"summary":"Support more frequent skip with Block Postings Format","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-02T02:30:53.563+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[],"timeoriginalestimate":null,"description":"I've worked out the start at a new postings format that should have\r\nless overhead for fixed-int[] encoders (For,PFor)... using ideas from\r\nthe old bulk branch, and new ideas from Robert.\r\n\r\nIt's only a start: there's no payloads support yet, and I haven't run\r\nLucene's tests with it, except for one new test I added that tries to\r\nbe a thorough PostingsFormat tester (to make it easier to create new\r\npostings formats).  It does pass luceneutil's performance test, so\r\nit's at least able to run those queries correctly...\r\n\r\nLike Lucene40, it uses two files (though once we add payloads it may\r\nbe 3).  The .doc file interleaves doc delta and freq blocks, and .pos\r\nhas position delta blocks.  Unlike sep, blocks are NOT shared across\r\nterms; instead, it uses block encoding if there are enough ints to\r\nencode, else the same Lucene40 vInt format.  This means low-freq terms\r\n(< 128 = current default block size) are always vInts, and high-freq\r\nterms will have some number of blocks, with a vInt final block.\r\n\r\nSkip points are only recorded at block starts.\r\n\r\n","customfield_10010":null,"timetracking":{},"customfield_12310120":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10121","value":"New","id":"10121"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"23794","summary":"New FixedPostingsFormat for less overhead than SepPostingsFormat","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":21,"total":21,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13415079","id":"13415079","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"Initial patch, lots of nocommits ...\r\n\r\nPatch is against the LUCENE-3892 branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-16T13:06:31.139+0000","updated":"2012-07-16T13:06:31.139+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13415083","id":"13415083","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"Initial results are compelling!  On the 10M doc Wikipedia test,\r\nSep(For) vs Fixed(For):\r\n\r\n{noformat}\r\n                Task    QPS base StdDev base     QPS for  StdDev for      Pct diff\r\n              IntNRQ        8.40        0.83        8.33        0.38  -13% -   15%\r\n         TermGroup1M       46.67        1.51       48.95        0.21    1% -    8%\r\n        TermBGroup1M       79.97        1.96       85.05        0.52    3% -    9%\r\n             Prefix3       68.82        2.62       73.96        2.27    0% -   15%\r\n              Fuzzy2       69.54        2.69       75.55        2.29    1% -   16%\r\n      TermBGroup1M1P       42.67        1.07       46.38        0.86    4% -   13%\r\n              Fuzzy1       85.07        3.34       93.16        2.20    2% -   16%\r\n             Respell       67.30        2.20       74.69        3.87    1% -   20%\r\n                Term      156.81        8.62      180.38        6.83    4% -   26%\r\n            Wildcard       42.55        1.13       50.97        0.87   14% -   25%\r\n          OrHighHigh        8.66        0.77       10.46        0.59    4% -   40%\r\n           OrHighMed       15.62        1.54       18.93        1.05    4% -   41%\r\n          AndHighMed       45.80        1.69       57.18        0.80   18% -   31%\r\n            SpanNear        7.59        0.32        9.95        0.14   23% -   38%\r\n         AndHighHigh       11.09        0.32       14.68        0.15   27% -   37%\r\n            PKLookup      143.83        2.80      195.40        4.13   30% -   41%\r\n              Phrase       15.53        1.15       21.34        0.18   26% -   49%\r\n        SloppyPhrase        5.94        0.49        8.74        0.24   32% -   64%\r\n{noformat}\r\n\r\nAnd Fixed(For) vs Lucene40:\r\n\r\n{noformat}\r\n                Task    QPS base StdDev base     QPS for  StdDev for      Pct diff\r\n          AndHighMed       60.07        1.69       44.20        1.17  -30% -  -22%\r\n              Phrase       11.97        0.60        9.61        0.20  -25% -  -13%\r\n              IntNRQ        9.77        0.46        8.93        0.38  -16% -    0%\r\n              Fuzzy2       49.08        1.33       48.72        1.08   -5% -    4%\r\n             Respell       61.33        1.52       60.90        1.41   -5% -    4%\r\n            SpanNear        7.72        0.20        7.74        0.07   -3% -    3%\r\n            PKLookup      194.64        3.03      197.83        3.27   -1% -    4%\r\n        SloppyPhrase        4.76        0.19        4.93        0.11   -2% -   10%\r\n              Fuzzy1       63.49        1.07       66.57        1.53    0% -    9%\r\n         TermGroup1M       53.91        1.40       58.24        1.27    3% -   13%\r\n             Prefix3       61.02        1.72       66.14        2.11    2% -   15%\r\n            Wildcard       51.27        1.40       56.26        1.78    3% -   16%\r\n      TermBGroup1M1P       29.65        0.98       32.77        0.79    4% -   17%\r\n        TermBGroup1M       34.37        1.16       38.07        1.14    3% -   18%\r\n                Term       24.98        1.32       28.13        3.31   -5% -   32%\r\n         AndHighHigh       17.08        0.69       19.42        0.52    6% -   21%\r\n          OrHighHigh       10.68        0.40       12.52        0.94    4% -   30%\r\n           OrHighMed       13.66        0.52       16.65        1.34    7% -   36%\r\n{noformat}\r\n\r\nSo we are still slower than Lucene40 in some cases, but a lot closer\r\nthan with Sep!\r\n\r\nBut these are early results ... and the PF doesn't pass tests yet ... so!\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-16T13:09:05.251+0000","updated":"2012-07-16T13:09:05.251+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13415126","id":"13415126","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"Looks good Mike. I think the slower cases are all explained: the skip interval is crazy, and lazy-loading the freq blocks should fix IntNRQ. (Though, i dont know how you get away with AndHighHigh currently).\r\n\r\nStill the second benchmark could be confusing: we are mixing concerns benchmarking FOR vs Vint and also different index layouts :)\r\nMaybe we can we benchmark this layout with bulkvint vs Lucene40 to get a better idea of just how the index layout is doing?\r\n\r\nI like how clean it is without the payloads crap: I still think we probably need to know up-front if the consumer is going to consume a payload off the enum for positional queries, without that its going to make things like this really hairy and messy.\r\n\r\nDo you think its worth it that even for \"big terms\" we write the last partial block as vints the way we do? \r\nSince these terms are going to be biggish anyway (at least enough to fill a block), this seems not worth the trouble?\r\n\r\nInstead if we only did this for low-freq terms, the code might even be clearer/faster, but I guess there would be a downside of\r\nnot being able to reuse these enums as much that would hurt e.g. NIOFSDirectory?\r\n\r\nThanks for bringing all this back to life... and the new test looks awesome! I think it will really make our lives a lot easier...\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2012-07-16T13:54:58.392+0000","updated":"2012-07-16T13:54:58.392+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13415130","id":"13415130","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"By the way: I also really like how clean the code is. Lets see if we can keep that, its really nice!\r\n\r\nWe should seriously balance this against any little optimizations we can do.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2012-07-16T13:57:44.636+0000","updated":"2012-07-16T13:57:44.636+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13415142","id":"13415142","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"Some more ideas for payloads:\r\n\r\nI don't like how we double every position in the payloads case to record if there is one there, and we shouldnt also\r\nhave a condition to indicate if the length changed. I think practically its typically \"all or none\", e.g. the analysis\r\nprocess marks a payload like POS or it doesnt, and a fixed length across the whole term or not. So I don't think we \r\nshould waste time with this for block encoders, nor should we put this in skipdata. I think we should just do something\r\nsimpler, like if payloads are present, we have a block of lengths. Its a 0 if there is no payload. If all the payloads\r\nfor the entire term are the same, mark that length in the term dictionary and omit the lengths blocks.\r\n\r\nWe could consider the same approach for offset length.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2012-07-16T14:06:59.173+0000","updated":"2012-07-16T14:06:59.173+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13415810","id":"13415810","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"bq. I think the slower cases are all explained: the skip interval is crazy, and lazy-loading the freq blocks should fix IntNRQ. (Though, i dont know how you get away with AndHighHigh currently).\r\n\r\nMaybe AndHighHigh isn't doing much actual skipping... ie the distance\r\nb/w each doc is probably around the blockSize?\r\n\r\nI wonder even how much skipping AndMedHigh queries are really\r\ndoing... but I agree we need to have a smaller skipInterval since our\r\n\"base\" skipInterval is so high.\r\n\r\nAnd try a smaller block size...\r\n\r\n{quote}\r\nStill the second benchmark could be confusing: we are mixing concerns benchmarking FOR vs Vint and also different index layouts \r\n Maybe we can we benchmark this layout with bulkvint vs Lucene40 to get a better idea of just how the index layout is doing?\r\n{quote}\r\n\r\nOh yeah!  OK I cutover BulkVInt to fixed postings format and compared\r\nit (base) to FOR:\r\n\r\n{noformat}\r\n                Task    QPS base StdDev base     QPS for  StdDev for      Pct diff\r\n        SloppyPhrase        6.90        0.18        6.88        0.17   -5% -    4%\r\n            PKLookup      196.92        4.41      197.38        4.55   -4% -    4%\r\n             Respell       65.25        2.09       65.55        0.80   -3% -    5%\r\n         TermGroup1M       39.07        0.78       39.34        0.94   -3% -    5%\r\n            SpanNear        5.42        0.14        5.48        0.12   -3% -    6%\r\n        TermBGroup1M       44.91        0.44       45.45        0.51    0% -    3%\r\n      TermBGroup1M1P       40.42        0.68       40.95        0.76   -2% -    4%\r\n              Fuzzy2       63.85        1.14       65.01        0.66    0% -    4%\r\n              Phrase       10.23        0.27       10.46        0.33   -3% -    8%\r\n              Fuzzy1       61.89        1.06       63.60        0.61    0% -    5%\r\n              IntNRQ        8.77        0.23        9.02        0.36   -3% -    9%\r\n            Wildcard       29.22        0.40       30.18        0.84    0% -    7%\r\n         AndHighHigh        9.13        0.15        9.49        0.18    0% -    7%\r\n                Term      126.40        0.41      132.48        5.62    0% -    9%\r\n             Prefix3       30.54        0.69       32.21        1.06    0% -   11%\r\n          OrHighHigh        8.69        0.38        9.21        0.37   -2% -   15%\r\n           OrHighMed       28.00        1.15       29.67        1.05   -1% -   14%\r\n          AndHighMed       32.28        0.67       34.29        0.56    2% -   10%\r\n{noformat}\r\n\r\nLooks like some small gain over BulkVInt but not much...\r\n\r\nbq. I like how clean it is without the payloads crap: I still think we probably need to know up-front if the consumer is going to consume a payload off the enum for positional queries, without that its going to make things like this really hairy and messy.\r\n\r\nI agree!  Not looking forward to getting payloads working :)\r\n\r\n{quote}\r\nDo you think its worth it that even for \"big terms\" we write the last partial block as vints the way we do? \r\n Since these terms are going to be biggish anyway (at least enough to fill a block), this seems not worth the trouble?\r\n{quote}\r\n\r\nWe could try just leaving partial blocks at the end ... that made me\r\nnervous :)  I think there are a lot of terms in the 128 - 256 docFreq\r\nrange!  But we should try it.\r\n\r\n{quote}\r\nInstead if we only did this for low-freq terms, the code might even be clearer/faster, but I guess there would be a downside of\r\n not being able to reuse these enums as much that would hurt e.g. NIOFSDirectory?\r\n{quote}\r\n\r\nHmm true.  We'd need to pair up low and high freq enums?  (Like Pulsing).\r\n\r\nbq. Thanks for bringing all this back to life... and the new test looks awesome! I think it will really make our lives a lot easier...\r\n\r\nI really want this test to be thorough, so that if it passes on your\r\nnew PF, all other tests should too!  I know that's overly ambitious\r\n... but when it misses something we should go back and add it.\r\nBecause debugging a PF bug when you're in a deep scary stack trace\r\ninvolving Span*Query is a slow process ... it's too hard to make a new\r\nPF now.\r\n\r\n{quote}\r\nI don't like how we double every position in the payloads case to record if there is one there, and we shouldnt also\r\nhave a condition to indicate if the length changed. I think practically its typically \"all or none\", e.g. the analysis\r\nprocess marks a payload like POS or it doesnt, and a fixed length across the whole term or not. So I don't think we \r\nshould waste time with this for block encoders, nor should we put this in skipdata. I think we should just do something\r\nsimpler, like if payloads are present, we have a block of lengths. Its a 0 if there is no payload. If all the payloads\r\nfor the entire term are the same, mark that length in the term dictionary and omit the lengths blocks.\r\n\r\nWe could consider the same approach for offset length.\r\n{quote}\r\n\r\nThat sounds good!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-17T00:17:08.778+0000","updated":"2012-07-17T00:17:08.778+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13416049","id":"13416049","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"{quote}\r\nLooks like some small gain over BulkVInt but not much...\r\n{quote}\r\n\r\nWell, thats good enough to see which one is faster. Now lets nuke the abstraction and just\r\nmake this FORPostingsFormat that uses PackedInts?\r\n\r\nI think its finally clear that its the abstractions here in the codec, not in the search API, that\r\nare slowing down bulk decompression :)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2012-07-17T09:57:04.950+0000","updated":"2012-07-17T09:57:04.950+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13416113","id":"13416113","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"body":"The initial patch doesn't pass compilation  on branch codes, after svn up -r 1362013.\r\n\r\nSo I made some change to pass ant compile, however, still some test fails: http://pastebin.com/jdFecZm5","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"created":"2012-07-17T11:50:45.013+0000","updated":"2012-07-17T11:50:45.013+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13416136","id":"13416136","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"body":"Oh...OK, those fails are all related to payload. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"created":"2012-07-17T12:28:38.651+0000","updated":"2012-07-17T12:28:38.651+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13416308","id":"13416308","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"Woops, thanks Billy, I'll merge w/ my patch.\r\n\r\nSorry, test failures are expected until I get payloads working ... I'll do that next but will take some time.  Payloads always get tricky :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-17T15:45:07.919+0000","updated":"2012-07-17T15:45:07.919+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13416314","id":"13416314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"{quote}\r\nWell, thats good enough to see which one is faster. Now lets nuke the abstraction and just\r\nmake this FORPostingsFormat that uses PackedInts?\r\n{quote}\r\n\r\nOK I'll do that!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-17T15:49:38.932+0000","updated":"2012-07-17T15:49:38.932+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13416617","id":"13416617","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"New patch, moving fixed -> block and hardwiring it to For int block encoding.\r\n\r\nStill need to do payloads...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-17T21:22:17.855+0000","updated":"2012-07-17T21:22:17.855+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13416702","id":"13416702","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"New patch, adding Block PF to META-INF services, and fixing a bug in skipping.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-17T23:15:23.533+0000","updated":"2012-07-17T23:15:23.533+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13417262","id":"13417262","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"body":"Quite curious why index size is reduced in Block PF. Here is a comparison base on the 1M wikipedia data: \r\n{noformat}\r\n                  SepPF+For  BlockPF     \r\nskip_data_size    36M        n/a\r\ntotal_index_size  598M       540M\r\n{noformat}\r\n\r\nSince in BlockPF, skip data is inlined into .doc files, it is interesting that considering this part of size, BlockPF will still get better compression rate.\r\n\r\nAlso, as BlockPF uses different formats to store information for each term, we try to see how the data is actually stored. Here, we sum docFreq%128 for all terms to get the vInt encoded ints, and remaining ints will all be encoded as Block Format.\r\n\r\n{noformat}\r\nBlock encoded 88,326,528 ints \r\nVInt encoded  39,929,349 ints\r\n{noformat}\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"created":"2012-07-18T17:14:58.721+0000","updated":"2012-07-18T17:14:58.721+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13418198","id":"13418198","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"New patch w/ payloads & offsets working ... I think it's ready!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-19T10:14:07.678+0000","updated":"2012-07-19T10:14:07.678+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13418257","id":"13418257","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"Those are interesting numbers: I'm surprised so many postings end up block encoded.\r\n\r\nBlock PF has far far less skip data (skipInterval=128 vs 16 for Sep), and since it only skips to doc/freq block starts it saves two bytes per skip point.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-19T12:47:52.921+0000","updated":"2012-07-19T12:47:52.921+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13418438","id":"13418438","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"OK I committed this ... it has lots of nocommits still but we can iterate on the branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-07-19T16:54:28.843+0000","updated":"2012-07-19T16:54:28.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13427304","id":"13427304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"body":"Just hit an error on BlockPostingsFormat, this should reproduce in latest branch\r\n\r\n{noformat}\r\nant test-core -Dtestcase=TestGraphTokenizers -Dtests.method=testDoubleMockGraphTokenFilterRandom -Dtests.seed=1FD78436D5E26B9A -Dtests.postingsformat=Block\r\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"created":"2012-08-02T13:22:20.482+0000","updated":"2012-08-02T13:22:20.482+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13427413","id":"13427413","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"Thanks Billy, I'll dig...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-08-02T16:15:37.858+0000","updated":"2012-08-02T16:15:37.858+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13427562","id":"13427562","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"OK I committed the fix: Block/PackedPF was incorrectly encoding offsets as startOffset - lastEndOffset.  It must instead be startOffset - lastStartOffset because it is possible (though rare) for startOffset - lastEndOffset to be negative.\r\n\r\nI also separately committed a fix for NPEs that tests were hitting when the index didn't index payloads nor offsets.  Tests should now pass for BlockPF and BlockPackedPF...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2012-08-02T20:00:04.438+0000","updated":"2012-08-02T20:00:04.438+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12598960/comment/13427811","id":"13427811","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"body":"OK, thanks Mike!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=billy","name":"billy","emailAddress":"jianghan08 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=billy&avatarId=14231","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=billy&avatarId=14231","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=billy&avatarId=14231","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=billy&avatarId=14231"},"displayName":"Han Jiang","active":true},"created":"2012-08-03T02:34:20.544+0000","updated":"2012-08-03T02:34:20.544+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LUCENE-4225/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i04flz:"}}