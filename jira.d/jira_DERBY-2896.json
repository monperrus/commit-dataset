{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12372948","self":"https://issues.apache.org/jira/rest/api/latest/issue/12372948","key":"DERBY-2896","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2007-07-11 04:11:26.23","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"23307","customfield_12310222":"1_*:*_1_*:*_1376288291_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_15610739455","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-07-19T20:43:25.502+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2896/watchers","watchCount":0,"isWatching":false},"created":"2007-07-03T22:25:17.211+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.png","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12316676","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12316676","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12372934","key":"DERBY-2894","self":"https://issues.apache.org/jira/rest/api/2/issue/12372934","fields":{"summary":"calling DatabaseMetaData.getColumns() with % for matching column character in a territory based collated db does not work in 1.4.2 jvms","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-01-16T13:02:24.949+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"}],"timeoriginalestimate":null,"description":"I tried adding DatabaseMetaDataTest.suite() to be run within CollationTest so that it would test DatabaseMetaData within a collated database.\nI had to fix one item in JDBC.dropSchema() where a string constant was being compared to a system column while not in a system schema,\nbut with that fixed the next error hit was executing DatabaseMetaData.getTables().\n\nI will add the code to collation test with the use of DatabaseMetaDataTest commented out with this bug number.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39610","summary":"DatabaseMetaData.getTables() fails in TERRORITY_BASED collation database with SQLState 42818: Comparisions between CHAR and CHAR not allowed.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":20,"total":20,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12511644","id":"12511644","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"body":"Performed a basic test on a database (toursdb) created with territory=territory=es_MX - a simple progam that lists tables, exported keys and columns works fine  (DbMD.getTables then getExportedKeys then getColumns).  This could be a test issue or under a specific configuration.  Since basic functionality is not impaired I think the priority of this issue can be lowered.  Attached is a zipfile with the simple test program and toursDB created with es_MX territory for any one who might find this helpful.\r\n\r\nDb build:\r\nij> connect 'jdbc:derby:work\\dbs\\toursMx;create=true;territory=es_MX';\r\nij> run 'ToursDB_schema.sql';\r\nij> run 'loadCOUNTRIES.sql';\r\nij>  exit;\r\n\r\n%% java  DBMetaData2\r\nLoaded the derby JDBC driver.\r\nGet Tables Results Loop\r\nGot a TABLE named: AIRLINES\r\n . . Getting Exported Keys\r\n . . . Getting Columns\r\n . . . .  Col: AIRLINE - Type: 1 Size: 2\r\n . . . .  Col: AIRLINE_FULL - Type: 12 Size: 24\r\n . . . .  Col: BASIC_RATE - Type: 8 Size: 52\r\n . . . .  Col: DISTANCE_DISCOUNT - Type: 8 Size: 52\r\n . . . .  Col: BUSINESS_LEVEL_FACTOR - Type: 8 Size: 52\r\n . . . .  Col: FIRSTCLASS_LEVEL_FACTOR - Type: 8 Size: 52\r\n . . . .  Col: ECONOMY_SEATS - Type: 4 Size: 10\r\n . . . .  Col: BUSINESS_SEATS - Type: 4 Size: 10\r\n . . . .  Col: FIRSTCLASS_SEATS - Type: 4 Size: 10\r\nGot a TABLE named: CITIES\r\n . . Getting Exported Keys\r\n . . . Getting Columns\r\n . . . .  Col: CITY_ID - Type: 4 Size: 10\r\n . . . .  Col: CITY_NAME - Type: 12 Size: 24\r\n . . . .  Col: COUNTRY - Type: 12 Size: 26\r\n . . . .  Col: AIRPORT - Type: 12 Size: 3\r\n . . . .  Col: LANGUAGE - Type: 12 Size: 16\r\n . . . .  Col: COUNTRY_ISO_CODE - Type: 1 Size: 2\r\nGot a TABLE named: CIUDAD_DE_MEXICO\r\n . . Getting Exported Keys\r\n . . . Getting Columns\r\n . . . .  Col: NOMBRE - Type: 12 Size: 24\r\n . . . .  Col: ESTADO - Type: 12 Size: 24\r\n . . . .  Col: EXCEPCI?N - Type: 4 Size: 10\r\nGot a TABLE named: CIUDAD_DE_MEXICO2\r\n . . Getting Exported Keys\r\n . . . Getting Columns\r\n . . . .  Col: NOMBRE - Type: 12 Size: 24\r\n . . . .  Col: ESTADO - Type: 12 Size: 24\r\n . . . .  Col: EXCEPCI?N - Type: 4 Size: 10\r\n\r\n == REST of OUTPUT not included\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"created":"2007-07-11T04:11:26.230+0000","updated":"2007-07-11T04:11:26.230+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12511645","id":"12511645","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"body":"Simplistic test case using DatabaseMetaData","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"created":"2007-07-11T04:12:16.062+0000","updated":"2007-07-11T04:12:16.062+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12511646","id":"12511646","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"body":"Simplistic test case with proper license / rights assignment","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"created":"2007-07-11T04:13:40.222+0000","updated":"2007-07-11T04:13:40.222+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12511815","id":"12511815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I have started looking at this Jira entry since yesterday. Need to do more research before I can say what it takes to fix it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-11T18:23:14.761+0000","updated":"2007-07-11T18:23:14.761+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12511847","id":"12511847","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"looks like you're actually working on this mamta, thx.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-07-11T20:12:40.045+0000","updated":"2007-07-11T20:12:40.045+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12511891","id":"12511891","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Stan, the database you created does not have the collation=TERRITORY_BASED attribute and that is why you couldn't reproduce the problem. Once I create the database with that attribute, the very useful program provided by you gives the same exception that Dan is running into. But I do appreciate your eg since it isolates the problem and will make it easier for debugging.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-11T22:12:21.823+0000","updated":"2007-07-11T22:12:21.823+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12511976","id":"12511976","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"The metadata query for getTables in trunk is as follows\r\n\tSELECT CAST ('' AS VARCHAR(128)) AS TABLE_CAT, \\\r\n\t\tSCHEMANAME AS TABLE_SCHEM,  \\\r\n\t\tTABLENAME AS TABLE_NAME, \\\r\n\t\t(CAST (RTRIM(TABLE_TYPE) AS VARCHAR(12))) \\\r\n\t\tAS TABLE_TYPE, CAST ('' AS VARCHAR(128)) AS REMARKS, \\\r\n                CAST (NULL AS VARCHAR(128)) AS TYPE_CAT, \\\r\n                CAST (NULL AS VARCHAR(128)) AS TYPE_SCHEM, \\\r\n                CAST (NULL AS VARCHAR(128)) AS TYPE_NAME, \\\r\n                CAST (NULL AS VARCHAR(128)) AS SELF_REFERENCING_COL_NAME, \\\r\n                CAST (NULL AS VARCHAR(128)) AS REF_GENERATION \\\r\n\tFROM \\\r\n\t\t SYS.SYSTABLES, \\\r\n\t     SYS.SYSSCHEMAS, \\\r\n\t     (VALUES ('T','TABLE'), ('S','SYSTEM TABLE'), \\\r\n\t\t\t('V', 'VIEW'), ('A', 'SYNONYM')) T(TTABBREV,TABLE_TYPE) \\\r\n\tWHERE (TTABBREV=TABLETYPE \t\\\r\n\t  AND (SYS.SYSTABLES.SCHEMAID = SYS.SYSSCHEMAS.SCHEMAID) \\\r\n\t  AND ((1=1) OR ? IS NOT NULL) \\\r\n\t  AND (SYS.SYSSCHEMAS.SCHEMANAME LIKE ?) \\\r\n\t  AND (TABLENAME LIKE ?))\r\n\r\n\r\nThe problem occurs because of VALUES clause which uses character string constants. These character string constants in Derby take their collation from the current compilation schema and this happens in CharConstantNode.bindExpression. I put some printlns in that method and found that the current compilation schema is whatever the current schema is when this metadata query gets run. So, if the getTables is run in user schema, the current compilation schema ends up being user schema and hence the collation type of character string constants in the query end up being territory based. When such character string constants are later compared against character string columns from SYS schema in the getTable query (TTABBREV=TABLETYPE), it results in an exception because of collation mismatch. If getTables is run from SYS schema, the collations of character string constants and character string columns match and hence no exception is thrown.\r\n\r\nSYSSTATEMENTS table has a column called COMPILATION SCHEMAID but that column is not used at all in the logic above. On a brand new database, this column has schemaid for SYS for getTables.\r\n\r\nI have to admit I don't understand why this metadata query may have worked earlier (DERBY-2656) if it was run from a user schema.\r\n\r\nI tried debugging in 10.2 codeline where we do not have collation support but I wanted to check what is the current compilation schema for metadata queries that get recompiled and found the current compilation schema behavior there to be same as the one in main codeline.\r\n\r\nI am at lost at this point as to what paths I should take in fixing the problem. Couple I can think of are as follows\r\n1)Have Derby somehow use the COMPILATION SCHEMAID from SYSSTATEMENTS table while recompiling the metadata queries. This might take some time to implement. At this point, I don't know how long.\r\n2)For the short term, fix the metadata queries to use CAST so that we are not dependent on what schema the queries are run from. I have this change made in my codeline for all the metadata queries that use character string constants for comparison. Specifically, for getTables, the ugly query above can be made uglier by using CAST but it will fix the problem.\r\n\tSELECT CAST ('' AS VARCHAR(128)) AS TABLE_CAT, \\\r\n\t\tSCHEMANAME AS TABLE_SCHEM,  \\\r\n\t\tTABLENAME AS TABLE_NAME, \\\r\n\t\t(CAST (RTRIM(TABLE_TYPE) AS VARCHAR(12))) \\\r\n\t\tAS TABLE_TYPE, CAST ('' AS VARCHAR(128)) AS REMARKS, \\\r\n                CAST (NULL AS VARCHAR(128)) AS TYPE_CAT, \\\r\n                CAST (NULL AS VARCHAR(128)) AS TYPE_SCHEM, \\\r\n                CAST (NULL AS VARCHAR(128)) AS TYPE_NAME, \\\r\n                CAST (NULL AS VARCHAR(128)) AS SELF_REFERENCING_COL_NAME, \\\r\n                CAST (NULL AS VARCHAR(128)) AS REF_GENERATION \\\r\n\tFROM \\\r\n\t\t SYS.SYSTABLES, \\\r\n\t     SYS.SYSSCHEMAS, \\\r\n\t     (VALUES ('T','TABLE'), ('S','SYSTEM TABLE'), \\\r\n\t\t\t('V', 'VIEW'), ('A', 'SYNONYM')) T(TTABBREV,TABLE_TYPE) \\\r\n\tWHERE (TTABBREV=CAST(TABLETYPE AS CHAR(1)) \t-- NOTICE THE CAST ON THIS LINE \\\r\n\t  AND (SYS.SYSTABLES.SCHEMAID = SYS.SYSSCHEMAS.SCHEMAID) \\\r\n\t  AND ((1=1) OR ? IS NOT NULL) \\\r\n\t  AND (SYS.SYSSCHEMAS.SCHEMANAME LIKE ?) \\\r\n\t  AND (TABLENAME LIKE ?))\r\n\r\nComments?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-12T05:57:47.222+0000","updated":"2007-07-12T05:57:47.222+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12512132","id":"12512132","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I don't think the second option leads to the correct behaviour. Won't it use the schema of the current database which can be territory based which will be incorrect for meta-data queries.\r\n\r\nI thought the compilation schema was required for stored prepared statements (plans), which are also used to trigger actions statements. The compilation schema must be correct so that any unqualified names in the statement resolves to the intended objects, and is not dependent on the current schema where the trigger is fired.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-07-12T15:04:09.639+0000","updated":"2007-07-12T15:04:09.639+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12512159","id":"12512159","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I am starting to derbug to see what is happening with compilation schema not being SYS. \r\n\r\nIt looks like getTables is treated differently than other stored prepared statements in EmbedDatabaseMetaData. For instance, for getTablePrivileges, we try to get the already prepared query(EmbedDatabaseMetaData.getTablePrivileges) from system tables as shown below.\r\n\tPreparedStatement s = getPreparedQuery(\"getTablePrivileges\");\r\n\r\nFor getTables, we are bypassing the system table and instead it appears that we are trying to compile getTables's metadata query like we would any other query\r\n\tPreparedStatement s =getEmbedConnection().prepareMetaDataStatement(whereClauseTail.toString());\r\nThat might be the cause of the problem that getTables's metadata query does not get compiled in SYS schema. Note that getTables does try to modify the metadata query text by appending an optional additional condition to WHERE clause and it appends an ORDER BY. Maybe that's why it can't use the system table. I am not sure. I will continue debugging. If anyone knows about this part of the code, will like to hear to their input.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-12T16:19:37.095+0000","updated":"2007-07-12T16:19:37.095+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12512168","id":"12512168","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"getUDTs is implemented the same way as getTables, ie we bypass going to the system table SYSSTATEMENTS for both of them. The strange thing is it appears that we do not modify the metadata query associated with getUDTs in any ways but we still do not go to SYSSTATEMENTS, Just thought would share this piece of info.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-12T16:43:21.280+0000","updated":"2007-07-12T16:43:21.280+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12512216","id":"12512216","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Well some more progress on this Jira entry. Here are my findings\r\n\r\nI am pretty confident that the problem exists only for getTables and getUDTs metadata calls because those 2 calls don't go through SYSSTATEMENTS. I tried getProcedures which does character string literal comparison with system character columns and it works fine because getProcedures goes through SYSSTATMENTS and compiles in SYS schema even though the current schema may be a user schema.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-12T18:57:20.844+0000","updated":"2007-07-12T18:57:20.844+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12513309","id":"12513309","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I spent more time on this problem and following is how I plan to fix it. Any feedback/suggestion highly appreciated.\r\n\r\nEmbedMetaData.getTables is implemented differently than other metadata calls (getUDTs is also implemented in same manner as getTable but I will talk about getUDTs later). The reason for different implementation of getTables is \"it is altering the metadata query that is stored in metadata.properties\". A user may ask to get specific types of tables when calling getTables. In that case, EmbedMetaData.getTables adds additional clause to the WHERE clause and that additional clause is \"AND TABLETYPE IN (all the passed table types in getTables)\". Because of this alteration of metadata query, getTables can't look for the saved metadata plan. This causes the metadata query to be compiled in the current schema rather than in the SYS schema. For other metadata queries, when we go through SYSSTATEMENTS, we do the work of setting the current compilation schema as SYS schema and hence those metadata queries do not fail for collation type mismatch.\r\n\r\nTo fix getTables problem, I am planning on modifying the metadata query for it to have the additional clause in it's WHERE clause and the ORDER BY clause (the reason for ORDER BY is current implementation of getTables adds a ORDER BY in EmbedMetaData.getTables) as follows\r\n\r\nAND TABLESTYPE IN (?s for all different types supported by Derby as of today) ORDER BY TABLE_TYPE, TABLE_SCHEM, TABLE_NAME\r\n\r\nEmbedMetaData.getTables will use setString to set the ? to the table types requested by the user in the metadata call and if there are any unused ?s, they will be set to NULL. Also, if user has not requested for any specific types, then all the ? will be set to the types supported by Derby as of today. This approach will not require us to change the metadata query on the fly in EmbedMetaData.getTables and because of that, we can follow the same path followed by rest of the metadata call implementations in EmbedMetaData.\r\n\r\nAs for getUDTs, I think it is a coding error that we do not follow the same logic as rest of the metadata calls. This is because I don't see us altering the query for getUDTs in EmbedMetaData,getUDTs. So, I will try to simply have getUDTs have the same code as rest of the other code to see if it works.\r\n\r\nComments?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-17T18:06:19.164+0000","updated":"2007-07-17T18:06:19.164+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12513395","id":"12513395","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"body":"Database metadata calls are used a lot to provide database independence and without this problem fixed TERRITORY_BASED collation (other than the default) will not be able to be used in these systems.  This preoblem is certainly a Blocker for this feature but should the release be blocked?  There is  a proposed fix for the problem and I would like to see this implemented ASAP.  \r\n\r\nI propose that the 10.3.1.2 release go forward with this problem well documented and that an official release (10.3.2.x) be created within 4-6 weeks that corrects this and any other serious problems that are reported during this 'shake-down' period.\r\n\r\nWhat say you?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stan","name":"stan","emailAddress":"Stan dot Bradbury at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stan Bradbury","active":true},"created":"2007-07-17T23:48:59.252+0000","updated":"2007-07-17T23:48:59.252+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12513405","id":"12513405","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Stan, I just wanted to mention that broken metadata calls are getTables and getUDTs and not all the metadata calls. This fact certainly does not make this bug less critical but I just wanted the community to know what is broken in metadata calls. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-18T00:33:53.573+0000","updated":"2007-07-18T00:33:53.573+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12513643","id":"12513643","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Checked in fix for this bug in main with revision 557334. The commit changes were as follows (Myrna, can I migrate this change to 10.3 codeline?)\r\n\r\n\r\nDERBY-2896\r\n\r\nMetadata calls getTables and getUDTs were failing when run from a user schema in a territory based collated database.\r\nThe reason for it is that these metadata calls were not getting compiled in SYS schema when they were executed from\r\na user schema. Metadata calls should always compile in SYS schema no matter what the current schema might be. The\r\nreason getTables was not getting compiled in SYS schema was because we were trying to modify it's metadata sql on\r\nthe fly and then were compiling that modified sql in whatever the current schema might be. I have changed the \r\nmetadata sql for getTables in metadata.properties so that we do not need to modify it on the fly anymore. This will\r\nallow getTables to follow the same codepath as other metadata queries which will also ensure that the sql gets\r\ncompiled in SYS schema.\r\n\r\nAs for getUDTs, it was merely a coding bug that we didn't follow the same logic as other metadata queries for it.\r\nI have changed getUDTs implementation to follow the same codepath as other metadata queries.\r\n\r\n--This line, and those below, will be ignored--\r\n\r\nM    java/engine/org/apache/derby/impl/jdbc/metadata.properties\r\nM    java/engine/org/apache/derby/impl/jdbc/EmbedDatabaseMetaData.java\r\nM    java/testing/org/apache/derbyTesting/functionTests/tests/lang/CollationTest.java\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-18T17:06:25.985+0000","updated":"2007-07-18T17:06:25.985+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12513678","id":"12513678","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I haven't followed this discussion closely, but I'd just mention that before you port the fix to 10.3, you might want to have a look at http://wiki.apache.org/db-derby/MetadataUpgrade, the section about Maintenance and Point Releases in particular. The changes in metadata.properties will not be picked up when you upgrade from 10.3.1.x to 10.3.2.x. I don't know if that's a problem, but you may have to do something more exotic to make it work in that scenario.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2007-07-18T18:36:15.490+0000","updated":"2007-07-18T18:36:15.490+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12513688","id":"12513688","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":">The changes in metadata.properties will not be picked up when you upgrade from 10.3.1.x to 10.3.2.x.\r\n\r\nThis filed as DERBY-1107 and I think is a good reason to have a new release candidate.  I think other critical issues such as DERBY-2437 and the regression DERBY-2892 might be worth waiting for too if they can be fixed in short order.  I wouldn't veto a release at this point but would probably vote -0.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-07-18T19:21:33.351+0000","updated":"2007-07-18T19:21:33.351+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12513729","id":"12513729","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Ported the changes from main into 10.3 codeline (revision 557405) Will look into metadata upgrade issue if it turns out that my changes didn't make into 10.3.1.x codeline.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2007-07-18T21:46:45.144+0000","updated":"2007-07-18T21:46:45.144+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12513775","id":"12513775","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Kathey said\r\n>When synching up to the latest 10.4, and running FullCollationTests, I am still seeing some >(but not as many)  of this error. See full report attached to DERBY-2656\r\n\r\nThis was a false alarm.  getTables() seems to be ok. New output is attached to DERBY-2656:FullCollationTests_out.txt\r\n\r\nKathey\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-07-19T00:43:54.527+0000","updated":"2007-07-19T03:36:49.171+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12372948/comment/12559484","id":"12559484","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dyret","name":"dyret","emailAddress":"Dyre dot Tjeldvoll at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dyre Tjeldvoll","active":true},"body":"Blocker issues that have been 'Resolved' for a long time (6 months+)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dyret","name":"dyret","emailAddress":"Dyre dot Tjeldvoll at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Dyre Tjeldvoll","active":true},"created":"2008-01-16T13:02:24.920+0000","updated":"2008-01-16T13:02:24.920+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2896/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0757j:"}}