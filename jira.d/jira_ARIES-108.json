{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12445015","self":"https://issues.apache.org/jira/rest/api/latest/issue/12445015","key":"ARIES-108","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310981","id":"12310981","key":"ARIES","name":"Aries","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310981&avatarId=10065","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310981&avatarId=10065","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310981&avatarId=10065","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310981&avatarId=10065"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10520","id":"10520","description":"Apache Aries","name":"Aries"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314792","id":"12314792","description":"","name":"0.1","archived":true,"released":true,"releaseDate":"2010-05-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-01-08 12:58:53.377","customfield_12312323":null,"customfield_12310420":"93722","customfield_12312320":null,"customfield_12310222":"3_*:*_1_*:*_5109089_*|*_1_*:*_1_*:*_33993738_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-01-08T21:24:16.430+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-108/watchers","watchCount":1,"isWatching":false},"created":"2010-01-08T10:32:33.603+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/2","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/critical.png","name":"Critical","id":"2"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-02-17T20:20:50.743+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313100","id":"12313100","name":"JMX"}],"timeoriginalestimate":null,"description":"Within FrameworkUtils when extracting imported packages or dependencies\r\nthis is done by looking up all bundles via the Bundle's BundleContext. \r\nUnfortunately  bundle.getBundleContext() returns null for non-resolved bundles.\r\n\r\nOne can workaround this by checking for null, but this will nevertheless miss\r\nBundles in certain states.\r\n\r\nBTW, I agree that the dependency resolution via iteration for each \r\nJMX call is ugly (and expensive!). There must be a better way ....","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"167424","summary":"bundle.getBundleContext().getBundles() throws NPE on INSTALLED Bundles","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":8,"total":8,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12445015/comment/12797969","id":"12797969","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"body":"Patch for avoiding NPEs (but still missing bundles)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"created":"2010-01-08T10:34:40.163+0000","updated":"2010-01-08T10:34:40.163+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12445015/comment/12798002","id":"12798002","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"body":"The JMX Core BundleContext can be passed and used for the getBundles() call which should resolve the problem.\r\nThanks for the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"created":"2010-01-08T12:58:53.377+0000","updated":"2010-01-08T12:58:53.377+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12445015/comment/12798185","id":"12798185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"body":"I've raised the question on the dev list in relation to the dependency resolution.\r\nWill raise another issue to introduce if there is a more efficient way of resolving.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"created":"2010-01-08T21:24:16.427+0000","updated":"2010-01-08T21:24:16.427+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12445015/comment/12798404","id":"12798404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"body":"Thanks for the fast fix, works fine for me. \r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"created":"2010-01-09T21:03:14.014+0000","updated":"2010-01-09T21:03:14.014+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12445015/comment/12798480","id":"12798480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"body":"FYI, I did a quick Benchmark on osgi.core:type=bundleState,version=1.5  operation 'listBundles' on a 'naked' Felix installation \r\na fully crowded Glassfish v3 (MBP 2.4 GHz, 4 GB)\r\n\r\nGlassfish v3, 248 Bundles --> Execution time: 6664ms (26.8 ms per Bundle)\r\nFelix, 10 Bundles --> Execution time: 133 ms (13.3 ms per Bundle)\r\n\r\nAs expected, the average time per bundle increases with the number of bundles with\r\nthe current implementation.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"created":"2010-01-10T12:50:42.674+0000","updated":"2010-01-10T12:50:42.674+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12445015/comment/12798834","id":"12798834","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"body":"Hi Roland,\r\n\r\nI've made an update for #getImportedPackages and #getRequiredBundles that will parse the corresponding manfiest headers and then use \r\nthose values to query PackageAdmin.\r\nWhen Dynamic Imports are used however, the full iteration will still be performed.\r\nIf you get a chance sometime, I would be interested to know if there is any significant improvement on listBundles() for above\r\n\r\nThanks,\r\nAlan","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"created":"2010-01-11T20:00:40.364+0000","updated":"2010-01-11T20:00:40.364+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12445015/comment/12798848","id":"12798848","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"body":"In fact, listBundles works much faster (10 times for Glassfish) now with the same setup:\r\n\r\nGlassfish v3, 223 Bundles (not 248 as stated above,sorry) --> Execution time: 534ms \r\nFelix, 10 Bundles -> Execution time: 115ms\r\n\r\nA second invocation on Glassfish v3 works even faster: 316ms (though I don't know why, maybe \r\nsome internal caching ?)\r\n\r\nAll numbers where taken via System.currentTimeMillis() (nearly) before and after the (local) JMX call.\r\nThere is probably some constant overhead involved, but it seems that the \r\nexecution times scale nearly linearly with the number of bundles installed.\r\n\r\nThanks for the excellent work, I really appreciate it!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=roland.huss","name":"roland.huss","emailAddress":"apache at tichny dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Roland Huss","active":true},"created":"2010-01-11T20:30:57.551+0000","updated":"2010-01-11T20:30:57.551+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12445015/comment/12798882","id":"12798882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"body":"Thanks for checking and the quick response!\r\n\r\n(No caching added to JMX Core, there may be a slight gain at the framework level on the second invocation)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keano","name":"keano","emailAddress":"alantkeane at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alan Keane","active":true},"created":"2010-01-11T22:11:38.044+0000","updated":"2010-01-11T22:11:38.044+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-108/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0t0pj:"}}