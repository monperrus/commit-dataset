{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12387403","self":"https://issues.apache.org/jira/rest/api/latest/issue/12387403","key":"DERBY-3362","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313142","id":"12313142","description":"","name":"10.3.3.0","archived":false,"released":true,"releaseDate":"2008-05-12"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2008-01-30 18:35:13.597","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"23596","customfield_12310222":"1_*:*_1_*:*_3540756247_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2008-03-10T19:55:26.126+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-3362/watchers","watchCount":3,"isWatching":false},"created":"2008-01-29T20:22:49.879+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312876","id":"12312876","description":"","name":"10.3.2.1","archived":false,"released":true,"releaseDate":"2007-12-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-01-21T17:51:24.678+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11412","id":"11412","name":"Store"}],"timeoriginalestimate":null,"description":"I have a NPE in Derby 10.3.2.1 (10.3.1.4 does not show this behaviour) that is probably the same one discussed in DERBY-3216\n\nFATAL 38406 [Main] (Start.java:153) - Start FAILED\norg.springframework.transaction.TransactionSystemException: Could not commit JDBC transaction; nested exception is java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\nCaused by:\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\n        at org.apache.derby.impl.jdbc.Util.javaException(Unknown Source)\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\n        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\n        at org.apache.derby.impl.jdbc.EmbedConnection.commit(Unknown Source)\n        at org.apache.commons.dbcp.DelegatingConnection.commit(DelegatingConnection.java:238)\n        at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.commit(PoolingDataSource.java:199)\n        at org.springframework.jdbc.datasource.DataSourceTransactionManager.doCommit(DataSourceTransactionManager.java:245)\n        at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:651)\n        at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:621)\n        at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:146)\n        at com.aaa.bbb.cccFactory$ddd.add(cccFactory.java:324)\n        at com.aaa.eee.fff.ggg.reload(ggg.java:44)\n        at com.aaa.eee.fff.ggg.startup(ggg.java:57)\n        at com.aaa.eee.fff.Start.startupEee(Start.java:170)\n        at com.aaa.eee.fff.Start.startup(Start.java:146)\n        at com.aaa.start.Starter.startup(Starter.java:264)\n        at com.aaa.start.Main.startup(Main.java:270)\n        at com.aaa.start.Main.main(Main.java:199)\nCaused by: java.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\n        ... 21 more\nCaused by: java.lang.NullPointerException\n        at org.apache.derby.impl.store.access.btree.ControlRow.getControlRowForPage(Unknown Source)\n        at org.apache.derby.impl.store.access.btree.ControlRow.get(Unknown Source)\n        at org.apache.derby.impl.store.access.btree.ControlRow.get(Unknown Source)\n        at org.apache.derby.impl.store.access.btree.BTreePostCommit.purgeRowLevelCommittedDeletes(Unknown Source)\n        at org.apache.derby.impl.store.access.btree.BTreePostCommit.performWork(Unknown Source)\n        at org.apache.derby.impl.store.raw.xact.Xact.postTermination(Unknown Source)\n        at org.apache.derby.impl.store.raw.xact.Xact.completeCommit(Unknown Source)\n        at org.apache.derby.impl.store.raw.xact.Xact.commit(Unknown Source)\n        at org.apache.derby.impl.store.raw.xact.Xact.commit(Unknown Source)\n        at org.apache.derby.impl.store.access.RAMTransaction.commit(Unknown Source)\n        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.doCommit(Unknown Source)\n        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.userCommit(Unknown Source)\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.commit(Unknown Source)\n        ... 15 more\n\nand derby.log:\n\n2008-01-28 08:26:36.148 GMT Thread[Main,5,main] (XID = 1888), (SESSIONID = 2), (DATABASE = directory:myDB), (DRDAID = null), Executing prepared statement: SELECT COUNT(*) FROM ZZZ WHERE nID IS NULL :End prepared statement\n2008-01-28 08:26:36.150 GMT Thread[Main,5,main] (XID = 1888), (SESSIONID = 2), (DATABASE = directory:myDB), (DRDAID = null), Committing\n2008-01-28 08:26:36.188 GMT Thread[Main,5,main] (XID = 1888), (SESSIONID = 2), (DATABASE = directory:myDB), (DRDAID = null), Cleanup action starting\n2008-01-28 08:26:36.188 GMT Thread[Main,5,main] (XID = 1888), (SESSIONID = 2), (DATABASE = directory:myDB), (DRDAID = null), Failed Statement is: null with 2 parameters begin parameter #1: 1 :end parameter begin parameter #2: 1 :end param\neter\njava.lang.NullPointerException\n        at org.apache.derby.impl.store.access.btree.ControlRow.getControlRowForPage(Unknown Source)\n        at org.apache.derby.impl.store.access.btree.ControlRow.get(Unknown Source)\n        at org.apache.derby.impl.store.access.btree.ControlRow.get(Unknown Source)\n        at org.apache.derby.impl.store.access.btree.BTreePostCommit.purgeRowLevelCommittedDeletes(Unknown Source)\n        at org.apache.derby.impl.store.access.btree.BTreePostCommit.performWork(Unknown Source)\n        at org.apache.derby.impl.store.raw.xact.Xact.postTermination(Unknown Source)\n        at org.apache.derby.impl.store.raw.xact.Xact.completeCommit(Unknown Source)\n        at org.apache.derby.impl.store.raw.xact.Xact.commit(Unknown Source)\n        at org.apache.derby.impl.store.raw.xact.Xact.commit(Unknown Source)\n        at org.apache.derby.impl.store.access.RAMTransaction.commit(Unknown Source)\n        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.doCommit(Unknown Source)\n        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.userCommit(Unknown Source)\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.commit(Unknown Source)\n        at org.apache.derby.impl.jdbc.EmbedConnection.commit(Unknown Source)\n        at org.apache.commons.dbcp.DelegatingConnection.commit(DelegatingConnection.java:238)\n        at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.commit(PoolingDataSource.java:199)\n        at org.springframework.jdbc.datasource.DataSourceTransactionManager.doCommit(DataSourceTransactionManager.java:245)\n        at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:651)\n        at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:621)\n        at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:146)\n        at com.aaa.bbb.cccFactory$ddd.add(cccFactory.java:324)\n        at com.aaa.eee.fff.ggg.reload(ggg.java:44)\n        at com.aaa.eee.fff.ggg.startup(ggg.java:57)\n        at com.aaa.eee.fff.Start.startupEee(Start.java:170)\n        at com.aaa.eee.fff.Start.startup(Start.java:146)\n        at com.aaa.start.Starter.startup(Starter.java:264)\n        at com.aaa.start.Main.startup(Main.java:270)\n        at com.aaa.start.Main.main(Main.java:199)\nCleanup action completed\n\n\nThis is a long transaction that has suddenly started throwing a NPE.\nNothing strange happens during the transaction, but on closing I get\nthe NPE.\n\nIf I reorder some of the statements in the transaction (keeping\nfunctional equivalence) the NPE is sometimes not thrown.\n\nI have already moved any table/index create statements to a different (previously committed) transaction. (I have had a few NPE before and locking issues that led me to this practice).\n\nFor a while I thought that shutting down derby after creating tables solved the problem, but this has been proven false.\n\nI have tried to run with a sane version, but then I am blocked by too many DERBY-3360.\n\nAlso:\n\nOn occasion the transaction DOES commit. Or seems to, but then Derby becomes unresponsive, the db files do not grow, but CPU rises and new connections can connect but get no response to commands. I don't know if this is really connected or not, but I thought I would mention it, as this unresponsive problem is what I am supposed to be diagnosing. When I say seems to commit, I mean that sometimes commit returns, sometimes it doesn't. Not very helpful, I know.\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10420","value":"Regression","id":"10420"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"37341","summary":"ControlRow NPE","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=northshorefiend","name":"northshorefiend","emailAddress":"spam123 at JamesAshepherd dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Alan Shepherd","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=northshorefiend","name":"northshorefiend","emailAddress":"spam123 at JamesAshepherd dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Alan Shepherd","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":19,"total":19,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12564121","id":"12564121","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"if possible could you post the whole derby.log.  I am trying to figure out what in the transaction may be causing the null pointer.\r\nKinds of things I am looking for is huge numbers of deletes in the transaction, ddl in the transaction like alter table, compress\r\ntable, drop/create index.  All of these are of course supposed to be supported but just trying to guess at how to reproduce this.\r\n\r\nMaybe you could try with JIT disabled to try and get a line number for the Nullpointer?\r\n\r\nof course if you could post a standalone repro that would be most help.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2008-01-30T18:35:13.597+0000","updated":"2008-01-30T18:35:13.597+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12564216","id":"12564216","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=northshorefiend","name":"northshorefiend","emailAddress":"spam123 at JamesAshepherd dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Alan Shepherd","active":true},"body":"Can't publish the derby log I'm afraid.\r\n\r\nOnly a few deletes in the transaction, it's a data import script. Almost all of the deletes are in stored procs/ triggers that will delete no rows. No ddl/indexes changed.\r\n\r\nI tried -Djava.compiler=NONE but I still didn't get any line numbers. Is there another/better way to disable JIT?\r\n\r\nI tried the 32bit HotSpot instead of 64bit same thing happened.\r\n\r\nIncreasing the heap doesn't seem to make any difference.\r\n\r\nJava(TM) SE Runtime Environment (build 1.6.0_03-b05)\r\nJava HotSpot(TM) Server VM (build 1.6.0_03-b05, mixed mode)\r\n\r\nI'll try to test on a 1.5 JVM  later in the week, just in case.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=northshorefiend","name":"northshorefiend","emailAddress":"spam123 at JamesAshepherd dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Alan Shepherd","active":true},"created":"2008-01-30T23:22:37.488+0000","updated":"2008-01-30T23:22:37.488+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12564236","id":"12564236","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"To get the line numbers you should run with a debug build. Download db-derby-10.3.2.1-lib-debug.zip  from http://db.apache.org/derby/releases/release-10.3.2.1.cgi","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-01-31T00:11:01.335+0000","updated":"2008-01-31T00:11:01.335+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12564430","id":"12564430","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=northshorefiend","name":"northshorefiend","emailAddress":"spam123 at JamesAshepherd dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Alan Shepherd","active":true},"body":"lib-debug appears to be a sane build, which as I mentioned above has problems before we even get to this one.\r\n\r\nI rolled my own 10.3.2.1 with:\r\n\r\ndebug=true\r\noptimize=false\r\nsane=false\r\n\r\neverything else as in BUILDING.txt\r\n\r\nthis gets me the line numbers in the log below.\r\n\r\nWith these settings it seems that I always get the NPE if I create the db in one tran, then import in another.\r\n\r\nRestarting the JVM and skipping the create db, importing into the (now) exising db, always seems to succeed.\r\n\r\nThe only other difference is that I'm running with a bit more XXMaxPermSpace.\r\n\r\n\r\n2008-01-31 15:37:59.134 GMT Thread[Main,5,main] (XID = 1967), (SESSIONID = 2), (DATABASE = directory:myDB), (DRDAID = null), Committing\r\n2008-01-31 15:37:59.172 GMT Thread[Main,5,main] (XID = 1967), (SESSIONID = 2), (DATABASE = directory:myDB), (DRDAID = null), Cleanup action starting\r\n2008-01-31 15:37:59.172 GMT Thread[Main,5,main] (XID = 1967), (SESSIONID = 2), (DATABASE = directory:myDB), (DRDAID = null), Failed Statement is: null\r\njava.lang.NullPointerException\r\n        at org.apache.derby.impl.store.access.btree.ControlRow.getControlRowForPage(ControlRow.java:878)\r\n        at org.apache.derby.impl.store.access.btree.ControlRow.get(ControlRow.java:844)\r\n        at org.apache.derby.impl.store.access.btree.ControlRow.get(ControlRow.java:820)\r\n        at org.apache.derby.impl.store.access.btree.BTreePostCommit.purgeRowLevelCommittedDeletes(BTreePostCommit.java:462)\r\n        at org.apache.derby.impl.store.access.btree.BTreePostCommit.performWork(BTreePostCommit.java:278)\r\n        at org.apache.derby.impl.store.raw.xact.Xact.postTermination(Xact.java:2059)\r\n        at org.apache.derby.impl.store.raw.xact.Xact.completeCommit(Xact.java:832)\r\n        at org.apache.derby.impl.store.raw.xact.Xact.commit(Xact.java:868)\r\n        at org.apache.derby.impl.store.raw.xact.Xact.commit(Xact.java:663)\r\n        at org.apache.derby.impl.store.access.RAMTransaction.commit(RAMTransaction.java:1980)\r\n        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.doCommit(GenericLanguageConnectionContext.java:1161)\r\n        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.userCommit(GenericLanguageConnectionContext.java:981)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.commit(TransactionResourceImpl.java:237)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.commit(EmbedConnection.java:1109)\r\n        at org.apache.commons.dbcp.DelegatingConnection.commit(DelegatingConnection.java:238)\r\n        at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.commit(PoolingDataSource.java:199)\r\n        at org.springframework.jdbc.datasource.DataSourceTransactionManager.doCommit(DataSourceTransactionManager.java:245)\r\n        at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:651)\r\n        at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:621)\r\n        at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:146)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=northshorefiend","name":"northshorefiend","emailAddress":"spam123 at JamesAshepherd dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Alan Shepherd","active":true},"created":"2008-01-31T18:01:05.477+0000","updated":"2008-01-31T18:01:05.477+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12573933","id":"12573933","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"With IBM 1.6 on linux I saw a similar trace to this in the log of a failed stress/stress.muilti \r\nrun.  It may be the same bug.\r\n\r\n2008-02-29 12:53:15.995 GMT Thread[derby.rawStoreDaemon,5,derby.daemons] Cleanup action starting\r\njava.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.access.btree.ControlRow.getControlRowForPage(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.btree.ControlRow.get(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.btree.ControlRow.get(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.btree.BTreePostCommit.purgeRowLevelCommittedDeletes(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.btree.BTreePostCommit.performWork(Unknown Source)\r\n\tat org.apache.derby.impl.services.daemon.BasicDaemon.serviceClient(Unknown Source)\r\n\tat org.apache.derby.impl.services.daemon.BasicDaemon.work(Unknown Source)\r\n\tat org.apache.derby.impl.services.daemon.BasicDaemon.run(Unknown Source)\r\n\tat java.lang.Thread.run(Thread.java:735)\r\nCleanup action completed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-02-29T20:19:11.534+0000","updated":"2008-02-29T20:19:11.534+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12573936","id":"12573936","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Also so the same trace with encryption/multi on Windows XP with IBM 1.5 on the same day 2/28/2008\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-02-29T20:25:33.678+0000","updated":"2008-02-29T20:25:33.678+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12573937","id":"12573937","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Marking this as a regression since the user reports it does not occur with 10.3.1.4\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-02-29T20:27:35.499+0000","updated":"2008-02-29T20:27:35.499+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12573978","id":"12573978","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Attached is the derby.log from the stress.multi run. I have the database and other test output files, but all of that is too big for Jira.   Please let me know if they are needed and I will put them somewhere else.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-02-29T21:54:42.947+0000","updated":"2008-02-29T21:54:42.947+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12574021","id":"12574021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I put the full zipped test directory at:\r\nhttp://people.apache.org/~kmarsden/DERBY-3362/\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-01T00:12:49.670+0000","updated":"2008-03-01T00:12:49.670+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12574991","id":"12574991","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The method BTreePostCommit.purgeRowLevelCommittedDeletes() was added\r\nin 10.3.2.1 (DERBY-3216), which explains why this is not seen on\r\n10.3.1.4.\r\n\r\nIn that issue, I posted the following question after reviewing the\r\ncode (no answer from the submitter, though):\r\n\r\n> In the same method, I see this piece of code:\r\n> + if ((controlRow = ControlRow.get(open_btree, page_number)) == null)\r\n> + return;\r\n>\r\n> As far as I can see, it is impossible that ControlRow.get() returns\r\n> null, so by returning successfully when controlRow is null, we might\r\n> be hiding future bugs. Wouldn't it be better to skip the null\r\n> checking and just let the method fail with an NPE when controlRow is\r\n> dereferenced?\r\n\r\nLooking at it again, I'm wondering if the check is actually there to\r\nensure that purgeRowLevelCommittedDeletes() is a no-op if the page\r\ndoesn't exist. However, it is wrong since ControlRow.get() will fail\r\ninstead of returning null if the page cannot be found.\r\n\r\nWould it work if we changed the above mentioned code like this?\r\n\r\nPage p = open_btree.container.getPage(page_number);\r\nif (p == null) {\r\n    // page doesn't exist, no rows to reclaim\r\n    return;\r\n}\r\ncontrolRow = ControlRow.getControlRowForPage();\r\n\r\nIn that case, the null check would make sense, and I think the NPE\r\nwould go away.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2008-03-04T13:56:52.268+0000","updated":"2008-03-04T13:56:52.268+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12575435","id":"12575435","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jkuhnert","name":"jkuhnert","emailAddress":"jkuhnert at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jkuhnert&avatarId=18098","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jkuhnert&avatarId=18098","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jkuhnert&avatarId=18098","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jkuhnert&avatarId=18098"},"displayName":"Jesse Kuhnert","active":true},"body":"If someone attaches a jar with the diff applied I can test it in my app where I'm consistently able to re-produce it,  though that probably doesn't help unit tests. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jkuhnert","name":"jkuhnert","emailAddress":"jkuhnert at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jkuhnert&avatarId=18098","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jkuhnert&avatarId=18098","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jkuhnert&avatarId=18098","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jkuhnert&avatarId=18098"},"displayName":"Jesse Kuhnert","active":true},"created":"2008-03-05T17:55:20.292+0000","updated":"2008-03-05T17:55:20.292+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12575437","id":"12575437","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"previous diff file was wrong file.\r\n\r\nnot ready for commit, have not run full tests. Am having trouble reproducing in my environment but pretty sure this will fix the issue. It fixed it when I by hand caused the code down the path that is being reported by the submitted stack traces.\r\n\r\nIf it passes full set of tests and I can't come up with a repro test case, will likely commit soon.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2008-03-05T17:59:00.071+0000","updated":"2008-03-05T17:59:00.071+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12575439","id":"12575439","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Is this likely to fix DERBY-3487 with a sane build. That I got 17 times out of \r\n50 repeated runs on my linux machine.  I can try with the patch there if you \r\nthink it is the same issue.\r\n\r\nKathey\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-05T18:01:14.025+0000","updated":"2008-03-05T18:01:14.025+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12575454","id":"12575454","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"kicked off repeated runs. I'll let you know how its going in a few hours.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-05T18:50:34.351+0000","updated":"2008-03-05T18:50:34.351+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12575498","id":"12575498","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Ten runs and the ASSERT has not hit.  \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-03-05T21:16:59.335+0000","updated":"2008-03-05T21:16:59.335+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12575520","id":"12575520","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I applied the fix to the trunk, and after seeing if any new reports come in will look at backporting to 10.3.\r\nI was never able to reproduce the problem in my environments using the stress test, only by hacking the code temporarily to force it into the patch described by the posted test cases.  It passed all the \r\nregular tests for me.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2008-03-06T01:09:04.417+0000","updated":"2008-03-06T01:09:04.417+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12577143","id":"12577143","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"fixed in trunk and backported to 10.3 branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2008-03-10T19:55:26.090+0000","updated":"2008-03-10T19:55:26.090+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12599395","id":"12599395","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=atyyeung","name":"atyyeung","emailAddress":"atyyeung at ca dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alice Yeung","active":true},"body":"Is this bug fixed in 10.3.2.2?\r\n\r\nI'm using org.apache.derby.core_10.3.2.2-616146, and I got the same problem.\r\n\r\njava.sql.SQLException: Java exception: ': java.lang.NullPointerException'.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.javaException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.commit(Unknown Source)\r\n\tat org.apache.commons.dbcp.DelegatingConnection.commit(DelegatingConnection.java:238)\r\n\tat org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.commit(PoolingDataSource.java:199)\r\n\t... 32 more\r\nCaused by: \r\njava.lang.NullPointerException\r\n\tat org.apache.derby.impl.store.access.btree.ControlRow.getControlRowForPage(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.btree.ControlRow.get(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.btree.ControlRow.get(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.btree.BTreePostCommit.purgeRowLevelCommittedDeletes(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.btree.BTreePostCommit.performWork(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.postTermination(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.completeCommit(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.commit(Unknown Source)\r\n\tat org.apache.derby.impl.store.raw.xact.Xact.commit(Unknown Source)\r\n\tat org.apache.derby.impl.store.access.RAMTransaction.commit(Unknown Source)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.doCommit(Unknown Source)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.userCommit(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.commit(Unknown Source)\r\n\t... 36 more\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=atyyeung","name":"atyyeung","emailAddress":"atyyeung at ca dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Alice Yeung","active":true},"created":"2008-05-23T15:02:53.095+0000","updated":"2008-05-23T15:02:53.095+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12387403/comment/12599418","id":"12599418","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"The first \"released\" version in the 10.3 branch  that includes this fix is 10.3.3.0, this just got announced a few days ago - see:\r\nhttp://mail-archives.apache.org/mod_mbox/db-derby-user/200805.mbox/%3c54ac72d70805211242y29d4a0bcyf6ae518a7a8f1767@mail.gmail.com%3e\r\n\r\nIf you are building your own releases, it was fixed in the 10.2.2 branch with change number 634101.   If JIRA has an \"unreleased\" version marked as the fix in, it means it was fixed in the branch but at least at the time of the fix a release had not been made.  Sometimes the comments will say which JIRA version fixes it, otherwise the svn tab can be used to see when the fix went in.\r\n\r\nThe version you are running is an earlier version of 10.2.2 - ie. 616146.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2008-05-23T16:26:39.835+0000","updated":"2008-05-23T16:26:39.835+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-3362/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06r7b:"}}