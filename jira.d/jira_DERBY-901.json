{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12328365","self":"https://issues.apache.org/jira/rest/api/latest/issue/12328365","key":"DERBY-901","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-04-15 00:27:57.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22198","customfield_12310222":"1_*:*_1_*:*_7163870000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_28496357680","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-04-25T03:54:19.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-901/watchers","watchCount":0,"isWatching":false},"created":"2006-02-01T05:56:29.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"9.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12312223","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12312223","type":{"id":"12310000","name":"Duplicate","inward":"is duplicated by","outward":"duplicates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"},"outwardIssue":{"id":"12328366","key":"DERBY-902","self":"https://issues.apache.org/jira/rest/api/2/issue/12328366","fields":{"summary":"Remove use of String(byte[]) and String(byte[], int, int) constructors in engine leading to non-portable behaviour","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-03-20T23:33:36.678+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11410","id":"11410","name":"Network Server"}],"timeoriginalestimate":null,"description":"These constructors use the Java default platform encoding to convert the bytes to a String, this typically leads to bugs on platforms with different encodings.\n\nReplace with code using fixed conversion, or alternative mechanisms. \nIf the call is required its use should be commented as to why it is required.\n\norg.apache.derby.impl.drda.DRDAConnThread\n\nI generated this list using the Java search in eclipse for references to the constructors\nString(byte[])\nString(byte[],int,int) - no occurences found in java/drda","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40104","summary":"Remove use of String(byte[]) constructors in network server leading to non-portable behaviour","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":13,"total":13,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374542","id":"12374542","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"This fix (Derby901.p1.diff.txt and Derby901.p1.stat.txt ) fixes the usage of default String encoding in NetworkServer error message delimiters. SQLERRMC_TOKEN_DELIMITER and SQLERRMC_MESSAGE_DELIMITER\r\n\r\nOverview:\r\n--The server sends the sqlerrmc which includes the following for each message if there are multiple messages in the exception:\r\nmessage arguments for the error + SQLERRMC_TOKEN_DELIMITER + messageId. see DRDAConnThread.buildTokenizedSqlerrmc. \r\n\r\n--Server sends the sqlerrmc using UTF8 encoding to the client.To get the message, client sends back information to the server calling SYSIBM.SQLCAMESSAGE (see Sqlca.getMessage).  Several parameters are sent to this procedure including the locale, the sqlerrmc that the client received from the server. \r\n\r\nOn server side, the procedure SQLCAMESSAGE in SystemProcedures then calls the MessageService.getLocalizedMessage to retrieve the localized error message. \r\n\r\nIn MessageService.getLocalizedMessage the sqlerrmc that is passed in, is parsed to retrieve the message id. The value it uses to parse the MessageId is char value of 20, otherwise it uses the entire sqlerrmc as the message id. \r\n\r\nProblem:\r\nBecause the SQLERRMC_TOKEN_DELIMITER in DRDAConnThread was not portable, the bytes would be converted to string using native encoding. Therefore localized error messages would not be obtained correctly from the server and thus error messages on client would be displaying the sqlerrmc values.\r\n\r\nE.g of the problems caused by SQLERRMC_TOKEN_DELIMITER \r\n\tString SQLERRMC_TOKEN_DELIMITER = new String(new byte[] {20});\r\n\r\nI wrote a small program to see what the value would map to in different encoding's.\r\nCp1047 is encoding on Z/os.\r\n*************************\r\nENCODING USED Cp1047\r\n=====================\r\n[0]?=157\r\n*************************\r\nENCODING USED UTF-16\r\n=====================\r\n[0]?=65533\r\n*************************\r\nENCODING USED UTF-8\r\n=====================\r\n[0]=20\r\n*************************\r\nENCODING USED US-ASCII\r\n=====================\r\n[0]=20\r\n\r\n\r\nThis fixes \r\n- SQLERRMC_TOKEN_DELIMITER, SQLERRMC_MESSAGE_DELIMITER and the corresponding usage of it in SystemProcedures to not use the default string constructors that are non portable. \r\n\r\nTesting:\r\n- derbyall ran ok on ibm142/linux. \r\n- derbynetclientmats and derbynetmats were run on Z/os platform and the error message garbled diffs have all been resolved there. There are still failures on z/os that will need to be resolved. \r\n\r\nSimulate Testing on Windows:\r\n- Sun JVM1.5, Start server with UTF-16 encoding as\r\njava -cp \"C:/workghm/svnclient/trunk2/classes\" -Dfile.encoding=UTF-16 -Dconsole.encoding=Cp1252 org.apache.derby.drda.NetworkServerControl start\r\n\r\n- Run the standalone repro.\r\njava -cp \".;C:/workghm/svnclient/trunk2/classes;.\" -Dfile.encoding=UTF8 -DConsole.encoding=Cp1252 TestEnc\r\n\r\n\r\nWITHOUT FIX\r\n==========================================================================\r\n\r\n$java -cp \".;C:/workghm/svnclient/trunk2/classes;.\" -Dfile.encoding=UTF8 -DConsole.encoding=Cp1252 TestEnc\r\nInitializing connection type: derbynetclient\r\ndriver: org.apache.derby.jdbc.ClientDriver\r\nurl: jdbc:derby://localhost:1527/wombatderbynetclient;create=true;traceFile=derbynetclient.trace\r\nObtaining the connection\r\nDatabase: Apache Derby 10.2.0.0 alpha\r\nlnDriver: Apache Derby Network Client JDBC Driver 10.2.0.0 alphae=Encountered \"<EOF>\" at line 1, column 10???42X01 \r\n\r\nNote: the message is Encountered \"<EOF>\" at line 1, column 10???42X01 \r\n\r\n==========================================================================\r\n\r\nWITH FIX\r\n$java -cp \".;C:/workghm/svnclient/trunk2/classes;.\" -Dfile.encoding=UTF8 -DConsole.encoding=Cp1252 TestEnc\r\nInitializing connection type: derbynetclient\r\ndriver: org.apache.derby.jdbc.ClientDriver\r\nurl: jdbc:derby://localhost:1527/wombatderbynetclient;create=true;traceFile=derbynetclient.trace\r\nObtaining the connection\r\nDatabase: Apache Derby 10.2.0.0 alpha\r\nlnDriver: Apache Derby Network Client JDBC Driver 10.2.0.0 alphae=Syntax error: Encountered \"<EOF>\" at line 1, column 10.\r\n\r\nNote: The error message is correctly retrived as \r\nSyntax error: Encountered \"<EOF>\" at line 1, column 10.\r\n\r\n=======================\r\n\r\nCan someone please review/commit this change if it looks ok.  Thanks. \r\n\r\nIt might be nice to add some tests with server running with different encoding. I'll see if we can do that.   ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-15T00:27:57.000+0000","updated":"2006-04-15T00:27:57.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374546","id":"12374546","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"I'll post another patch to resolve this issue fully.   The Derby901.p1.diff.txt is the partial ( first phase )patch.  Thanks.  \r\n\r\ncheckin comment for the Derby901.p1.diff.txt.\r\n\r\n----------------------------------------------------------------------------------------------------\r\nDERBY-901 (partial)    \r\nRemove use of String(byte[]) constructors in network server leading to non-portable behaviour\r\n\r\nThis fixes\r\n- SQLERRMC_TOKEN_DELIMITER, SQLERRMC_MESSAGE_DELIMITER and the corresponding usage of it in SystemProcedures to not use the default string constructors that are non portable. \r\n\r\n--------------------------------------------------------------------------------------------------","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-15T00:39:25.000+0000","updated":"2006-04-15T00:39:25.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374571","id":"12374571","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"There is one place in DRDAConnThread.readAndSetParams  where this non portable constructor is used.\r\nln \r\n\t\t\t\tcase  DRDAConstants.DRDA_TYPE_NFIXBYTE:\r\n\t\t\t{\r\n\t\t\t\tbyte[] paramVal = reader.readBytes();\r\n\t\t\t\tif (SanityManager.DEBUG) \r\n\t\t\t\t\ttrace(\"fix bytes parameter value is: \"+new String(paramVal));\r\n\t\t\t\tps.setBytes(i+1, paramVal);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\nI can see two ways of fixing this,.\r\n1) to change the trace message to say uses native encoding and leave it at that . \r\n2) change String to use \"UTF-8\"  encoding and add code to catch the unsupported encoding exception. \r\n\r\nDoes anyone have any opinions here ? \r\n\r\nThanks. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-15T04:05:33.000+0000","updated":"2006-04-15T04:05:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374572","id":"12374572","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Hi Sunitha,\r\n\r\nThank you for looking at the issue:\r\nI am having a bit of trouble with the repro. I am seeing i pass with and without the change.\r\n\r\nOn the code changes.\r\n- I really like all the comments you added.\r\n- I am not sure if I understand the encoding implications of switching from the byte array to \r\nprivate static String SQLERRMC_TOKEN_DELIMITER = new String(new char[] {(char)20}); and what that means when it is converted to UTF-8\r\n\r\nI am wondering if there is not some ascii delimter we could use, e.g. ^^ or somesuch.  Whatever it is it can't be in the message strings themselves.\r\n\r\n-   I still see one occurance of the byte[] in writeSQLDIAGCI(SQLException nextException)\r\nbyte[] sep = {20};\t// use it as separator of sqlerrmc tokens\r\nString separator = new String(sep);\r\n\t\t\t\t\r\n- Could we avoid the duplicate definitions of SQLERRMC_TOKEN_DELIMITER by having network server refer to the value in  SystemProcedures?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-04-15T04:05:39.000+0000","updated":"2006-04-15T04:05:39.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374573","id":"12374573","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Thanks Kathey for looking at the patch. \r\n\r\nAre you running the server with -Dfile.encoding=UTF16 ?  The problem will reproduce only when server is running with a native encoding where the value 20 is mapped  to a different value as in UTF16.\r\n\r\nI have a phase2  patch that fixes the remaining occurrences of the default string contructor in DRDAConnThread - ie writeSQLDIAGCI and the trace method. in readAndSetParams. \r\n\r\nThe char value of 20 is same in UTF-8 and US-ASCII.    \r\n\r\nThe SQLERRMC_MESSAGE_DELIMITER is used in SystemProcedures. I'll see we can use that in DRDAConnThread. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-15T04:21:07.000+0000","updated":"2006-04-15T04:21:07.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374576","id":"12374576","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thanks Sunitha,  \r\n\r\nI got the repro working and committed the patch.  This is a big improvement.\r\nFor the trace issue I think we should print a hex representation of the byte[] I don't think what prints now is useful with any encoding.\r\n\r\nI think I believe that (char) 20 gets converted properly since I saw it work with my own eyes but I never cease to be confused by the control character delimeters.\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-04-15T04:53:10.000+0000","updated":"2006-04-15T04:53:10.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374578","id":"12374578","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Thanks Kathey for commiting my phase 1 patch.   I am attaching  following files for_10.1_derby901.p1.diff.txt and for_10.1_derby901.p1.stat.txt.  for 10.1 codeline. \r\n\r\nThe changes are the same as the Derby901.p1.diff.txt attached earlier. \r\n\r\n-------------------\r\nDERBY-901 (partial)    \r\nRemove use of String(byte[]) constructors in network server leading to non-portable behaviour\r\n\r\nThis fixes\r\n- SQLERRMC_TOKEN_DELIMITER, SQLERRMC_MESSAGE_DELIMITER and the corresponding usage of it in SystemProcedures to not use the default string constructors that are non portable. \r\n-----------------------\r\n\r\nI ran derbyall on linux/ibm142 and no new failures. \r\n\r\nIf this looks ok, can this be committed. Thanks. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-15T05:22:20.000+0000","updated":"2006-04-15T05:22:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374658","id":"12374658","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"I am attaching the patch ( derby901.p2.diff.txt, derby901.p2.stat.txt)  to fix the remaining places that the String(byte[]) constructor is used in Network Server. \r\n\r\nremove use of default String(byte[]) constructor in \r\n--  trace method in DRDAConnThread.readAndSetParams to print out the hex string of the bytes .\r\n--  use SQLERRMC_TOKEN_DELIMITER in SQLDIAGCI .\r\n\r\nsome cleanup \r\n -- define the SQLERRMC_MESSAGE_DELIMITER in SystemProcedures and use that in DRDAConnThread.\r\n\r\nTesting:\r\nderbyall on linux /ibm142 ran OK with no new failures. \r\n\r\nCan someone please look at this patch.  Thanks. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-16T05:53:16.000+0000","updated":"2006-04-16T05:53:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12374975","id":"12374975","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Please note, there is one patch waiting for review/commit - derby901.p2.diff.txt.  Thanks. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-19T00:59:38.000+0000","updated":"2006-04-19T00:59:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12375182","id":"12375182","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Sunitha. I am sorry I just got to this commit and it is out of date with the DERBY-822 changes. Can you sync up and resubmit?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-04-20T01:38:57.000+0000","updated":"2006-04-20T01:38:57.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12375218","id":"12375218","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Thanks Kathey for committing the derby901.p2.diff.txt patch on trunk.\r\n\r\n I am attaching a p2 patch for  10.1 codeline ( for_10.1_derby901.p2.diff.txt).\r\nThe changes in this patch are similar to changes in derby901.p2.diff.txt.\r\n\r\n----------------------------------------------------------------------------\r\nDERBY901. Remove use of String(byte[]) constructors in network server leading to non-portable behaviour\r\n\r\nremove use of default String(byte[]) constructor in \r\n--  trace method in DRDAConnThread.readAndSetParams to print out the hex string of the bytes .\r\n--  use SQLERRMC_TOKEN_DELIMITER in SQLDIAGCI .\r\n\r\nsome cleanup \r\n -- define the SQLERRMC_MESSAGE_DELIMITER in SystemProcedures and use that in DRDAConnThread.\r\n\r\nTesting:\r\nderbyall on linux /ibm142 ran OK with no new failures. \r\n\r\nCan someone please look at this patch.  Thanks. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-20T06:43:55.000+0000","updated":"2006-04-20T06:43:55.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12376108","id":"12376108","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"Fix checked in both 10.1 as well as 10.2 codelines.\r\nin 10.1 branch - #395687,#394223\r\nin 10.2 branch - #395416, #394205\r\n\r\nNo occurences of non portable constructors in String class  present in network server code.  \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-04-25T03:54:18.000+0000","updated":"2006-04-25T03:54:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12328365/comment/12482601","id":"12482601","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"confirmed no use of String(byte[]) in drda code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-03-20T23:33:36.552+0000","updated":"2007-03-20T23:33:36.552+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-901/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0789b:"}}