{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12332420","self":"https://issues.apache.org/jira/rest/api/latest/issue/12332420","key":"DERBY-1229","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-04-22 07:26:51.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22386","customfield_12310222":"1_*:*_1_*:*_1420477000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_381939000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-05-07T03:38:36.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1229/watchers","watchCount":0,"isWatching":false},"created":"2006-04-20T17:03:59.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-01T00:09:08.564+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"},{"self":"https://issues.apache.org/jira/rest/api/2/component/11414","id":"11414","name":"Tools"}],"timeoriginalestimate":null,"description":"The problem I've been seeing is that if I run:\n\njava -Dframework=DerbyNetClient org.apache.derbyTesting.functionTests.harness.RunTest derbynet/sysinfo.java\n\nin a configuration where my db2jcc.jar is located in the same directory as all the other derby-jars, then the test fails with a diff caused by a RuntimeException. If I change nothing else then moving that db2jcc.jar out of that directory (and making the appropriate classpath change) then the test succeeds.\n\nThe reason is that the test fails to get the permission for doing getProtectionDomain().getCodeSource() on class com.ibm.db2.jcc.DB2Driver. Below follows relevant output from my system that might be useful to debug this:\n\n---\n\nvo136787@khepri32:~/tmp/test> env |grep CLAS CLASSPATH=/home/vo136787/derby/tmp/testbuild/lib/derby.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyTesting.jar:/home/vo136787/derby/tmp/testbuild/lib/derbytools.jar:/home/vo136787/derby/tmp/testbuild/lib/derbynet.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyclient.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyrun.jar:/home/vo136787/derby/tmp/testbuild/lib/junit.jar:/home/vo136787/derby/tmp/testbuild/lib/db2jcc.jar:/home/vo136787/derby/tmp/testbuild/lib/db2jcc_license_c.jar:/home/vo136787/derby/tmp/testbuild/lib/jakarta-oro-2.0.8.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_de_DE.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_es.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_fr.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_it.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_ja_JP.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_ko_KR.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_pt_BR.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_zh_CN.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_zh_TW.jar\nvo136787@khepri32:~/tmp/test> java -Dframework=DerbyNetClient org.apache.derbyTesting.functionTests.harness.RunTest derbynet/sysinfo.java\n*** Start: sysinfo jdk1.5.0_06 DerbyNetClient 2006-04-19 13:00:33 ***\nInitialize for framework: DerbyNetClient\njava -Dderby.system.home=/home/vo136787/tmp/test/DerbyNetClient/sysinfo -Djava.security.manager -Djava.security.policy=/home/vo136787/tmp/test/derby_tests.policy -DderbyTesting.codejar=file:/home/vo136787/derby/tmp/testbuild/lib/ -DderbyTesting.codedir=/home/vo136787/derby/tmp/testbuild/lib -DderbyTesting.serverhost=localhost -DderbyTesting.clienthost=localhost -DderbyTesting.codeclasses=file://unused/ org.apache.derby.drda.NetworkServerControl start\n-- SecurityManager not installed --\nAttempt to shutdown framework: DerbyNetClient\n14a15\n> [Unable to access Protection Domain or Code Source for class class com.ibm.db2.jcc.DB2Driver: access denied (java.lang.RuntimePermission getProtectionDomain)] 2.4 - (17)\n41a43\n> [Unable to access Protection Domain or Code Source for class class com.ibm.db2.jcc.DB2Driver: access denied (java.lang.RuntimePermission getProtectionDomain)] 2.4 - (17)\n69a72\n> [Unable to access Protection Domain or Code Source for class class com.ibm.db2.jcc.DB2Driver: access denied (java.lang.RuntimePermission getProtectionDomain)] 2.4 - (17)\nTest Failed.\n*** End:   sysinfo jdk1.5.0_06 DerbyNetClient 2006-04-19 13:00:40 ***\nvo136787@khepri32:~/tmp/test> java org.apache.derby.tools.sysinfo\n------------------ Java Information ------------------\nJava Version:    1.5.0_06\nJava Vendor:     Sun Microsystems Inc.\nJava home:       /usr/jdk/instances/jdk1.5.0/jre\nJava classpath:  /home/vo136787/derby/tmp/testbuild/lib/derby.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyTesting.jar:/home/vo136787/derby/tmp/testbuild/lib/derbytools.jar:/home/vo136787/derby/tmp/testbuild/lib/derbynet.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyclient.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyrun.jar:/home/vo136787/derby/tmp/testbuild/lib/junit.jar:/home/vo136787/derby/tmp/testbuild/lib/db2jcc.jar:/home/vo136787/derby/tmp/testbuild/lib/db2jcc_license_c.jar:/home/vo136787/derby/tmp/testbuild/lib/jakarta-oro-2.0.8.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_de_DE.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_es.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_fr.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_it.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_ja_JP.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_ko_KR.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_pt_BR.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_zh_CN.jar:/home/vo136787/derby/tmp/testbuild/lib/derbyLocale_zh_TW.jar\nOS name:         SunOS\nOS architecture: x86\nOS version:      5.10\nJava user name:  vo136787\nJava user home:  /home/vo136787\nJava user dir:   /home/vo136787/tmp/test\njava.specification.name: Java Platform API Specification\njava.specification.version: 1.5\n--------- Derby Information --------\nJRE - JDBC: J2SE 5.0 - JDBC 3.0\n[/home/vo136787/derby/tmp/testbuild/lib/derby.jar] 10.2.0.0 alpha - (394991)\n[/home/vo136787/derby/tmp/testbuild/lib/derbytools.jar] 10.2.0.0 alpha - (394991)\n[/home/vo136787/derby/tmp/testbuild/lib/derbynet.jar] 10.2.0.0 alpha - (394991)\n[/home/vo136787/derby/tmp/testbuild/lib/derbyclient.jar] 10.2.0.0 alpha - (394991)\n[/home/vo136787/derby/tmp/testbuild/lib/db2jcc.jar] 2.4 - (17)\n[/home/vo136787/derby/tmp/testbuild/lib/db2jcc_license_c.jar] 2.4 - (17)\n------------------------------------------------------\n----------------- Locale Information -----------------\nCurrent Locale :  [English/United States [en_US]]\nFound support for locale: [de_DE]\n        version: 10.2.0.0 alpha - (394991)\nFound support for locale: [es]\n        version: 10.2.0.0 alpha - (394991)\nFound support for locale: [fr]\n        version: 10.2.0.0 alpha - (394991)\nFound support for locale: [it]\n        version: 10.2.0.0 alpha - (394991)\nFound support for locale: [ja_JP]\n        version: 10.2.0.0 alpha - (394991)\nFound support for locale: [ko_KR]\n        version: 10.2.0.0 alpha - (394991)\nFound support for locale: [pt_BR]\n        version: 10.2.0.0 alpha - (394991)\nFound support for locale: [zh_CN]\n        version: 10.2.0.0 alpha - (394991)\nFound support for locale: [zh_TW]\n        version: 10.2.0.0 alpha - (394991)\n------------------------------------------------------\nvo136787@khepri32:~/tmp/test> java org.apache.derby.tools.sysinfo -cp\nTesting for presence of all Derby-related libraries; typically, only some are needed.\nFor a list of possible arguments, type java org.apache.derby.tools.sysinfo -cp args\nFOUND IN CLASS PATH:\n\n  Derby embedded engine library (derby.jar)\n  /home/vo136787/derby/tmp/testbuild/lib/derby.jar\n\n\n  Derby embedded engine library (derby.jar)\n  /home/vo136787/derby/tmp/testbuild/lib/derby.jar\n\n\n  Derby Network Server library (derbynet.jar)\n  /home/vo136787/derby/tmp/testbuild/lib/derbynet.jar\n\n\n  Derby Client libraries (db2jcc.jar)\n  /home/vo136787/derby/tmp/testbuild/lib/db2jcc.jar\n\n\n  Derby Client libraries (derbyclient.jar)\n  /home/vo136787/derby/tmp/testbuild/lib/derbyclient.jar\n\n\n\nNOT FOUND IN CLASS PATH:\n\n  Derby tools library (derbytools.jar)\n   (org.apache.derby.tools.ij not found.)\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10361","value":"Security","id":"10361"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38612","summary":"sysinfo and sysinfo_withproperties.java fail with java.lang.RuntimePermission getProtectionDomain when db2jcc.jar is in same dir as the derby-jars","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vemund","name":"vemund","emailAddress":"vemund at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vemund Østgaard","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vemund","name":"vemund","emailAddress":"vemund at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vemund Østgaard","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Solaris 10 x86\nSun JDK \njava version \"1.5.0_06\"\nJava(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_06-b05)\nJava HotSpot(TM) Client VM (build 1.5.0_06-b05, mixed mode, sharing)\n","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":16,"total":16,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12375657","id":"12375657","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Can you confirm that if you add the following line to derby_tests.policy, the problem goes away? The line should be added to all three of the derby.jar, derbynet.jar, and derbytools.jar sections, which is easiest to do if you just search for \"DERBY-622\" and then add this line right after it:\r\n\r\npermission java.lang.RuntimePermission \"getProtectionDomain\";\r\n\r\nIn some ways, what's confusing about this bug is not that you have to add this line, it's that nobody else has had to add this line. From what I can tell by reading the Sun javadocs, everybody should have needed the getProtectionDomain permission, and certainly when I wrote a simple standalone test program, the program failed unless I gave it the getProtectionDomain permission. So I don't understand why the rest of us have been getting away without having this permission in place.\r\n\r\nIf you could please try adding the permission to the derby_tests.policy file, and verify that the sysinfo and sysinfo_withproperties tests then pass, that would be nice. Thanks!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-04-22T07:26:51.000+0000","updated":"2006-04-22T07:26:51.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377039","id":"12377039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I am concerned about  adding this line to the test policy file.\r\nDoes this mean that\r\n\r\npermission java.lang.RuntimePermission \"getProtectionDomain\"; \r\n\r\nis now required for the product or  is it just for sysinfo?\r\n\r\nI have three concerns.\r\n1) This is a fairly dangerous permission.\r\n2) Policy files are often site specific and difficult to modify  in a product roll out scenario to require new permissions .\r\n3) Such a change  breaks backward compatibility in my view as this permission has not been required before.\r\n4) Even if the permission is just for sysinfo, if you add it to the derby_tests.policy file it means that a new change could make the product require it and we would catch it.\r\n\r\nEven for sysinfo  I didn't like this,  but since right now it is only really suitable as a command-line tool,  I thought maybe it was ok.   I  am starting to think that maybe sysinfo\r\nshould at least print abbreviated information and  a warning if it could not do whatever it is trying to do with getProtectionDomain instead of giving this error. \r\n\r\nKathey\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-04-29T07:05:45.000+0000","updated":"2006-04-29T07:05:45.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377042","id":"12377042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"> maybe sysinfo should at least print abbreviated information and a warning if it could not do whatever it is trying to do with getProtectionDomain instead of giving this error.\r\n\r\nGood point. I believe that Sysinfo actually already has the behavior you desire. The \"error\" that the bug reporter is experiencing is in fact just the warning message that sysinfo prints when it is refused information about the underlying jar file's locaion due to the lack of getProtectionDomain permission.\r\n\r\nThe issue is that our current sysinfo test script master files are written assuming that you have this permission. So, the alternate fix is that we could change our master files to assume that you do *not* have this permission when you run. \r\nThe curious thing is, sometimes you don't seem to need this permission, and I can't currently explain this behavior. I don't understand why most of the people on derby-dev (including myself) do not see this problem, and yet 2 or 3 people see it reliably.\r\n\r\nSince I can't make it happen in any of the environments I have access to, I'm sort of confused.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-04-29T07:19:48.000+0000","updated":"2006-04-29T07:19:48.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377045","id":"12377045","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thanks for explaining the issue.  Whatever   solution we go with,  I don't think it should be to  grant getProtectionDomain permission for all the jars  for every test we run.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-04-29T07:41:57.000+0000","updated":"2006-04-29T07:41:57.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377046","id":"12377046","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"I got a little tongue-tied in my previous comment. Let me try again:\r\n\r\nMy preferred fix would be to:\r\n - leave derby_tests.policy alone, *without* the getProtectionDomain permission\r\n - change the sysinfo test master files to match the behavior that we (should) get without the permission. That is, to have the warning message in them.\r\n\r\nHowever, in my environment at least, my derby_tests.policy file does *not* have the permission, and yet I *don't* get the warning. So I'm confused.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-04-29T07:44:13.000+0000","updated":"2006-04-29T07:44:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377054","id":"12377054","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"OK, I think I am starting to understand this problem. I think that the try {} block in Main.getAllInfo() is too broad in scope. Once a security problem occurs with *any* element on the classpath, the try block skips the rest of the classpath and just prints a very terse message.\r\n\r\nLet me work on this one for a while; I think I've got some clues about why it works better for some people than others, depending on the details of their classpath.\r\n\r\nKathey, thanks for encouraging me not to take the easy way out. It is nice to work with people who are so dedicated to doing it right!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-04-29T08:48:17.000+0000","updated":"2006-04-29T08:48:17.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377058","id":"12377058","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"This and a couple of other similar permissions issues (like DERBY-622) are leading me to believe that what we really need most for these issues are test-specific policy files. That issue is already filed as DERBY-892. I had already investigated that issue earlier and I have a solution brewing. This would allow us to add the permissions this test needs for this test only, which should resolve Kathey's primary concern. I'll try to have something ready for DERBY-892 early next week.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-04-29T09:49:05.000+0000","updated":"2006-04-29T09:49:05.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377098","id":"12377098","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Attached is a proposed patch (derby-1229.diff) and a discussion of the patch (notes.html). Please read the notes.html (it's a quick read), and let me know what you think.\r\n\r\nIf it sounds reasonable, I'd love to hear from a few reviewers whether this patch works successfully in their environment, since we all seem to have radically different classpath configurations.\r\n\r\nthanks,\r\n\r\nbryan\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-04-29T23:32:29.000+0000","updated":"2006-04-29T23:32:29.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377111","id":"12377111","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Bryan, thanks again for the detailed analysis. I agree that the correct thing to do in this case is to properly report the exception (and then sed it out), not add the getProtectionDomain permission to the test. I'd say go ahead and commit this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-04-30T01:17:33.000+0000","updated":"2006-04-30T01:17:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377114","id":"12377114","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"One minor comment after rereading the patch, i'm pretty sure that the message SIF03.C was only used in the one location where you've replaced it with SIF03.D, so it might make sense to just reuse the old SIF03.C message id.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-04-30T01:43:32.000+0000","updated":"2006-04-30T01:43:32.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377176","id":"12377176","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Thank you Bryan for the excellent explanation and preserving testing for  product compatibility with documented  policy file permissions.   Preservation of  this testing  is  something you will never hear requested on derby-user, nor will  you'll ever  hear a cheer  from the installed user base that you made an effort to make sure we don't regress in this area, but  we  certainly would  hear something if suddenly on upgrade existing policy files worked no more.   So,   thank you so much Bryan  for the extra effort.\r\n\r\nPerhaps a follow up task could be filed  to improve the sysinfo warnings if this permission is not granted  so that they are not so alarming.\r\n For Network Server we stress the importance of  running under security manager  and we provide NetworkServerControl sysinfo to show version and other diagnostic info, so the assumption  is that really anyone running NetworkServerControl sysinfo  is going  to see  these  getProtectionDomain Exceptions.  It seems a little odd as the expected default output.  I am concerned that that will confuse people in a diagnostic situation to think  that they need to add this  permission to get useful sysinfo output or worse yet think it is the root cause of whatever problem they are diagnosing.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-05-01T01:47:57.000+0000","updated":"2006-05-01T01:47:57.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12377975","id":"12377975","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Hi Bryan, if you have some time, please take a look at the patch I attached to DERBY-1273, the derby-1273-v2.diff patch. With that patch I attempted to get around the need to have the getProtectionDomain permission at all. I still think that your patch for this issue, which improves the output of the security exceptions on items in the classpath to which access has been restricted, is valuable and should be committed. But my patch attached to DERBY-1273 handles the getProtectionDomain issue in a different way.\r\n\r\nI was prompted to investigate removing the need for the getProtectionDomain permission due to Kathey's concerns. I'm not sure I've tested all of the many scenarios of classloader/environment/securitymanager/sysinfo-argument execution paths that are possible, and I'm hoping that with a couple more eyes on it we can ensure that we get the maximum useful information out of sysinfo with the fewest possible permissions granted to it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-05-05T14:44:13.000+0000","updated":"2006-05-05T14:44:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12378088","id":"12378088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Attached is \"fix-with-reused-message.diff\", an updated patch proposal which re-uses message SIF03.C rather than creating a new message SIF03.D.\r\n\r\nAndrew and I were not able to think of any cases in which re-using the same message and adding a parameter to it would cause any compatibility problems. The message is only used in this one sysinfo file.\r\n\r\nI intend to commit this fix in the next few days.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-05-06T01:13:51.000+0000","updated":"2006-05-06T01:13:51.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12378248","id":"12378248","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Patch fix-with-reused-message committed to subversion as revision 400366:\r\nhttp://svn.apache.org/viewcvs?rev=400366&view=rev\r\n\r\nVemund, if you could please verify that this change fixes the problem for you,\r\nand then close the bug, that would be nice.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-05-07T03:38:36.000+0000","updated":"2006-05-07T03:38:36.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12378606","id":"12378606","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vemund","name":"vemund","emailAddress":"vemund at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vemund Østgaard","active":true},"body":"The problem has disappeared in my environment now. Thanks again, Bryan.\r\n\r\nI don't seem to have access to close the report, though.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vemund","name":"vemund","emailAddress":"vemund at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vemund Østgaard","active":true},"created":"2006-05-09T18:26:43.000+0000","updated":"2006-05-09T18:26:43.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12332420/comment/12379013","id":"12379013","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vemund","name":"vemund","emailAddress":"vemund at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vemund Østgaard","active":true},"body":"Problem fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=vemund","name":"vemund","emailAddress":"vemund at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Vemund Østgaard","active":true},"created":"2006-05-11T13:44:15.000+0000","updated":"2006-05-11T13:44:15.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1229/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06z1r:"}}