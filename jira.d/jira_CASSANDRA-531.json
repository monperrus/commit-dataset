{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12440043","self":"https://issues.apache.org/jira/rest/api/latest/issue/12440043","key":"CASSANDRA-531","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/2","id":"2","description":"A new feature of the product, which has yet to be developed.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png","name":"New Feature","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310865","id":"12310865","key":"CASSANDRA","name":"Cassandra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310865&avatarId=12034","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310865&avatarId=12034","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310865&avatarId=12034","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310865&avatarId=12034"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11961","id":"11961","description":"Apache Cassandra related projects","name":"Cassandra"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314533","id":"12314533","description":"","name":"0.7 beta 1","archived":false,"released":true,"releaseDate":"2010-08-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-04-28 08:56:53.836","customfield_12312322":null,"customfield_12312323":null,"customfield_12310222":"10002_*:*_1_*:*_704900819_*|*_1_*:*_1_*:*_15276885635_*|*_5_*:*_1_*:*_0","customfield_12310420":"27609","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-05-10T16:27:05.939+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-531/watchers","watchCount":9,"isWatching":false},"created":"2009-11-06T17:03:59.485+0000","customfield_10022":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12311124":null,"customfield_12312334":null,"customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-05-10T16:27:05.928+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312978","id":"12312978","name":"Core"}],"timeoriginalestimate":null,"description":"Sometimes you want to delete an entire columnfamily.  If there is a lot of data, it's much faster to just insert something to the commitlog saying \"truncated,\" and drop the memtable and data files.\r\n\r\nProbably should require this to block for all replicas to ack to avoid unpleasant surprises.  Or make it local-only and have ops manage making sure it gets to all replicas.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12425975","id":"12425975","filename":"ASF.LICENSE.NOT.GRANTED--0001-CASSANDRA-531-add-truncate-truncateBefore.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-11-24T15:53:03.966+0000","size":7500,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12425975/ASF.LICENSE.NOT.GRANTED--0001-CASSANDRA-531-add-truncate-truncateBefore.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12425976","id":"12425976","filename":"ASF.LICENSE.NOT.GRANTED--0002-add-unimplemented-truncate-to-thrift-API.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-11-24T15:53:04.004+0000","size":25951,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12425976/ASF.LICENSE.NOT.GRANTED--0002-add-unimplemented-truncate-to-thrift-API.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12444053","id":"12444053","filename":"CASSANDRA-531.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-09T08:09:30.988+0000","size":70400,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12444053/CASSANDRA-531.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12443630","id":"12443630","filename":"CASSANDRA-531.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-04T20:39:32.775+0000","size":66609,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12443630/CASSANDRA-531.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12443593","id":"12443593","filename":"CASSANDRA-531.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-04T16:41:46.274+0000","size":38451,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12443593/CASSANDRA-531.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12443552","id":"12443552","filename":"CASSANDRA-531.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-04T07:23:19.160+0000","size":65759,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12443552/CASSANDRA-531.patch"}],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"91350","summary":"truncate support","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"customfield_12311420":null,"customfield_12311421":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":24,"total":24,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12781553","id":"12781553","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"This will support taking a timestamp (drop all sstables older than X).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-11-23T19:12:33.219+0000","updated":"2009-11-23T19:12:33.219+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12781993","id":"12781993","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"progress so far:\r\n\r\n02\r\n    add (unimplemented) truncate to thrift API\r\n\r\n01\r\n    CASSANDRA-531 add truncate, truncateBefore\r\n\r\nIf someone wants to wire up the thrift api to CFS.truncate, that would be awesome.\r\n\r\nLet's use negative timestamp to indicate \"truncate all\".\r\n\r\nThe StorageProxy method should throw UnavailableException if any replica is down, or if there is any node movement going on (any pending ranges in metadata).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-11-24T15:55:20.836+0000","updated":"2009-11-24T15:55:20.836+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12790323","id":"12790323","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"because of how compaction works (see CASSANDRA-604 for how this can get tricky) we will want to add an option to disable compactions on a per-CF basis if we're going to allow time-based truncation (and i think we should, the efficiency win is enormous for models that need it)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2009-12-14T20:07:30.418+0000","updated":"2009-12-14T20:07:30.418+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12849822","id":"12849822","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"CASSANDRA-699 is probably a better approach for \"I want to delete data older than X,\" so IMO truncate should focus on the \"wipe everything clean,\" i.e., let's drop the \"truncateBefore\" stuff at least initially.\r\n\r\nIt would be nice to add a Truncation \"super-tombstone\" to the commitlog so that we can replay and repair the Truncate in the face of node failure but I think the biggest use case here is for testing and/or playing, so I'm fine with punting on that until someone actually needs it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-03-25T18:31:43.755+0000","updated":"2010-03-25T18:31:43.755+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12861733","id":"12861733","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Make code up to date with recent trunk (0.7.0 trunk)\r\nThis patch includes: thrift and ColumnFamilyStore code (and test).\r\nTODO: \r\n1. wire up the thrift call from CassandraServer to here\r\n2. Do I need to also delete actual files? Have I covered all scenarios?\r\n3. Send the truncate operation to all nodes; make sure they are all up before doing so\r\n4. Add truncate to the JMX interface\r\n5. Add truncate to nodetool\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-04-28T08:56:53.836+0000","updated":"2010-04-28T08:56:53.836+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863051","id":"12863051","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"In this patch I think I completed all the thrift wiring work, including internal messaging to all hosts in the cluster.\r\nThe patch includes all previous changes, no need to use the previous patches.\r\nI've also removed the timestamp from the truncation signature since it's not used.\r\n\r\nTODO:\r\nDelete the actual files???... not sure what I should do... What's the effect of marking all sstables as compacted? \r\nAdd truncate to the JMX interface\r\nAdd truncate to nodetool\r\nAdd system tests to test nodetool + JMX\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-01T20:45:04.664+0000","updated":"2010-05-01T20:45:04.664+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863055","id":"12863055","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"In this patch I think I completed all the thrift wiring work, including internal messaging to all hosts in the cluster.\r\nThe patch includes all previous changes, no need to use the previous patches.\r\nI've also removed the timestamp from the truncation signature since it's not used.\r\n\r\nTODO:\r\nAdd truncate to the JMX interface\r\nAdd truncate to nodetool\r\nAdd system tests to test nodetool + JMX\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-01T21:01:39.660+0000","updated":"2010-05-01T21:01:39.660+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863095","id":"12863095","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Update patch to latest svn version (There was a change in login check methods)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-02T06:57:12.009+0000","updated":"2010-05-02T06:57:12.009+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863096","id":"12863096","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Remove cassandra.yaml. It wasn't intended to be here","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-02T07:05:24.283+0000","updated":"2010-05-02T07:05:24.283+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863098","id":"12863098","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Fix system tests.\r\nSee,s that login was removed from API or something, now there's set_keyspace...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-02T07:19:30.538+0000","updated":"2010-05-02T07:19:30.538+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863100","id":"12863100","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Added all the missing JMX parts.\r\nNow it's done, ready for review","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-02T07:58:20.945+0000","updated":"2010-05-02T07:58:20.945+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863372","id":"12863372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"getting 8 or 9 patch failures, can you rebase to latest trunk?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-03T15:14:18.691+0000","updated":"2010-05-03T15:14:18.691+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863401","id":"12863401","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Update patch to revision 940507","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-03T16:46:29.510+0000","updated":"2010-05-03T16:46:29.510+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863403","id":"12863403","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"I rebased, but that was stranges that you got so many failures. that's all the updates I got from trunk:\r\n\r\n~/dev/cassandra/trunk $ svn up\r\nU    build.xml\r\nUpdated to revision 940507.\r\n\r\nTry now?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-03T16:47:59.271+0000","updated":"2010-05-03T16:47:59.271+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863513","id":"12863513","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"Patch applies cleanly now.\r\n\r\nSorry to throw this back again, but can you submit a patch that doesn't mess with whitespace on otherwise-unedited lines?\r\n\r\n(cleaning up whitespace in a separate patch is good, but mixing it in with \"real\" changes pollutes the patch.)\r\n\r\nalso, if you can conform to http://wiki.apache.org/cassandra/CodeStyle even where it's idiosyncratic, it helps keep the code base uniform.  in particular, argument alignment, use of public final fields, and throwing RuntimeException instead of logging an error in catch statements.\r\n\r\nThanks!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-03T21:05:21.009+0000","updated":"2010-05-03T21:05:46.494+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863702","id":"12863702","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Code cleanup to confirm to the coding guidelines. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-04T07:23:19.256+0000","updated":"2010-05-04T07:23:19.256+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863704","id":"12863704","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"sorry for the mess, code is cleaned up and all whitespace changes are removed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-04T07:24:35.764+0000","updated":"2010-05-04T07:24:35.764+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863874","id":"12863874","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"Attached is a version with a few changes.  The major one from a functionality perspective is, we rely on the markCompacted to delete the files eventually.  Manually deleting them ahead of that can cause errors on concurrent reads.\r\n\r\nTwo things still need work.  One is, we don't want to delete data that we didn't snapshot; that could be a nasty surprise.  I sketched out what I think that could look like; SSTableReader.newSince is left as a TODO.\r\n\r\nThe other is minor -- truncate from cmdline should go in clustertool, not nodetool.  (Nodetool is for per-node ops.)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-04T16:41:46.366+0000","updated":"2010-05-04T16:41:46.366+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863877","id":"12863877","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"Oh, also the commitlog context stuff is redundant since snapshot flushes, and flush already marks the commitlog \"don't bother replaying stuff before this\" and cleans up obsolete segments.  I removed the CommitLog method calls, but I didn't r/m the ctx creation, so that can go too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-04T16:44:06.112+0000","updated":"2010-05-04T16:44:06.112+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863981","id":"12863981","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Moving the truncate operation from nodetool to cluster tool was easy enough. \r\nI remove the unused ctx as well.\r\n\r\nI don't know how to implement the SSTableReader.newSince (or SSTable.newSince). need help here...\r\n\r\nI'll upload the patch with my recent changes as mentioned above.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-04T20:37:53.112+0000","updated":"2010-05-04T20:37:53.112+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12863982","id":"12863982","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Move truncate from nodetool to clustertool\r\nremove unused ctx variable","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-04T20:39:33.003+0000","updated":"2010-05-04T20:39:33.003+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12865201","id":"12865201","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"in my mind newsince looks like this:\r\n\r\nSSTable gets a new field to tell us \"i don't have any data newer than this this epoch.\"  maxDataAge maybe?\r\n\r\nwhen flushing, this gets set to CurrentTimeMillis.  When compacting, it gets set to max(maxDataAge) of any of the compaction sources.\r\n\r\nFor truncate's purposes, this field doesn't need to be serialized to disk -- take the file's time on disk as maxDataAge when loading.\r\n\r\nso newSince would just return maxDataAge >= truncateBegan.\r\n\r\ndoes that make sense?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-07T15:25:27.975+0000","updated":"2010-05-07T15:25:27.975+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12865575","id":"12865575","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"body":"Added the maxDataAge and newSince in SSTableReader, so it's ready for another review","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rantav","name":"rantav","emailAddress":"rantav at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ran Tavory","active":true},"created":"2010-05-09T08:09:31.086+0000","updated":"2010-05-09T08:09:31.086+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12440043/comment/12865814","id":"12865814","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"committed, with some changes to make maxDataAge final, and the addition of a 2nd flush to truncate().  so the start of truncate now looks like\r\n\r\n{code}\r\n        // snapshot will also flush, but we want to truncate the most possible, and anything in a flush written\r\n        // after truncateAt won't be truncated.\r\n        try\r\n        {\r\n            forceBlockingFlush();\r\n        }\r\n        catch (Exception e)\r\n        {\r\n            throw new RuntimeException(e);\r\n        }\r\n\r\n        final long truncatedAt = System.currentTimeMillis();\r\n        snapshot(Table.getTimestampedSnapshotName(\"before-truncate\"));\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-10T16:27:05.907+0000","updated":"2010-05-10T16:27:05.907+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-531/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0fzi7:"}}