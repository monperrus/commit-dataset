{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12464863","self":"https://issues.apache.org/jira/rest/api/latest/issue/12464863","key":"CASSANDRA-1105","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310865","id":"12310865","key":"CASSANDRA","name":"Cassandra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310865&avatarId=12034","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310865&avatarId=12034","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310865&avatarId=12034","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310865&avatarId=12034"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11961","id":"11961","description":"Apache Cassandra related projects","name":"Cassandra"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314533","id":"12314533","description":"","name":"0.7 beta 1","archived":false,"released":true,"releaseDate":"2010-08-13"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-05-19 08:59:55.38","customfield_12312322":null,"customfield_12312323":null,"customfield_12310222":"10002_*:*_2_*:*_621359125_*|*_1_*:*_2_*:*_98423807_*|*_5_*:*_1_*:*_0","customfield_12310420":"27924","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-05-27T13:31:01.025+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-1105/watchers","watchCount":1,"isWatching":false},"created":"2010-05-19T05:34:38.093+0000","customfield_10022":null,"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12311124":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-05-28T12:45:22.890+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312978","id":"12312978","name":"Core"}],"timeoriginalestimate":null,"description":"PropertyFileSnitch allows reloading changes from its config file manually.  DatacenterShardStrategy doesn't allow reloading at all [after I ripped out the reload-for-each-getNaturalEndpoints call code, in CASSANDRA-1103].\r\n\r\nLet's check each of these for changes (modification time on the fs is sufficient) every minute and reload automatically if changes are seen.  The manual-reload code from PFS can then be dropped.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12444995","id":"12444995","filename":"CASSANDRA-1105.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-19T22:44:27.923+0000","size":11042,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12444995/CASSANDRA-1105.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12445098","id":"12445098","filename":"CASSANDRA-1105-2.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-20T20:22:45.144+0000","size":12703,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12445098/CASSANDRA-1105-2.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12445512","id":"12445512","filename":"CASSANDRA-1105-3.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-26T00:21:05.529+0000","size":11988,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12445512/CASSANDRA-1105-3.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12445514","id":"12445514","filename":"CASSANDRA-1105-4.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-26T00:36:12.051+0000","size":12003,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12445514/CASSANDRA-1105-4.patch"}],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"91921","summary":"Create timers to reload cassandra-rack.properties and datacenters.properties","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"customfield_12311420":null,"customfield_12311421":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":16,"total":16,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869063","id":"12869063","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeromatron","name":"jeromatron","emailAddress":"jeremy dot hanna1234 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Hanna","active":true},"body":"Might be related to what I'm trying to do with CASSANDRA-1066 - going to hopefully put the datacenters.properties configuration into an API call so that it can be set dynamically.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeromatron","name":"jeromatron","emailAddress":"jeremy dot hanna1234 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeremy Hanna","active":true},"created":"2010-05-19T08:59:55.380+0000","updated":"2010-05-19T08:59:55.380+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869117","id":"12869117","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"I didn't see anything about setting configuration by api call there -- that doesn't sound like a direction we want to go.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-19T12:54:19.503+0000","updated":"2010-05-19T12:54:19.503+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869330","id":"12869330","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"body":"Would it be better to reload based purely on modified time instead of a minute timer?\r\nAt the top of the getters, say if modified, reload()?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-19T20:48:53.342+0000","updated":"2010-05-19T20:48:53.342+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869342","id":"12869342","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"body":"Also, the manual-reload code is required by the interface PropertyFileSnitchMBean.\r\nDo we need to change the interface or just leave the option to manual-reload?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-19T21:02:46.880+0000","updated":"2010-05-19T21:02:46.880+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869370","id":"12869370","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"> Would it be better to reload based purely on modified time instead of a minute timer?\r\n\r\nNo.  We want to avoid doing the reload check during any performance-critical code, and all the methods here that get called often enough to be useful for a check, are performance-critical.\r\n\r\n> Do we need to change the interface or just leave the option to manual-reload? \r\n\r\nDelete PFSMBean and the methods it defines.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-19T21:48:45.965+0000","updated":"2010-05-19T21:48:45.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869389","id":"12869389","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"body":"Timers added to PFS and DSS.\r\nEach class calls re/loadConfiguration() during construction, then set up a Timer to call reloadConfiguration() every minute.\r\n--\r\nPFSMBeans deleted along with displayConfiguration() that it required.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-19T22:43:40.860+0000","updated":"2010-05-19T22:43:40.860+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869393","id":"12869393","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"Can you break out the check-for-file-changes-and-maybe-call-reload logic somehow so it's not duplicated in 2 places?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-19T22:52:16.960+0000","updated":"2010-05-19T22:52:16.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869472","id":"12869472","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"body":"Yeah, I should be able to do that by tomorrow.\r\nThe reloadConf calls can pass the X.properties name up to a bigger class, and it can pass back the real filename after it's done the lookup and checked modification for the non-common code to use.\r\nMight be able to unduplicate the TimerTasks in the same way.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-20T04:35:02.190+0000","updated":"2010-05-20T04:35:02.190+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12869758","id":"12869758","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"body":"Status after second patch:\r\nM      src/java/org/apache/cassandra/locator/DatacenterShardStrategy.java\r\nD      src/java/org/apache/cassandra/locator/PropertyFileSnitchMBean.java\r\nM      src/java/org/apache/cassandra/locator/PropertyFileSnitch.java\r\nA      src/java/org/apache/cassandra/locator/util\r\nA      src/java/org/apache/cassandra/locator/util/PropertyConfigurationLoadable.java\r\nA      src/java/org/apache/cassandra/locator/util/PropertyConfigurationTimerTask.java\r\n\r\nAdded a util directory for locator. \r\nPCLoadable is an interface for both PFS and DSS.\r\nPCTimerTask covers both the extension of TimerTask and removes duplicate code.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-20T20:22:45.219+0000","updated":"2010-05-20T20:22:45.219+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12871152","id":"12871152","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"This is pretty good.  I'd make one more change: instead of PropertyConfigurationTimerTask being tied to PropertyConfigurationLoadable, make it a more generic FileWatcher class that takes a Runnable to execute when changes are detected.  (Then PCL isn't needed at all.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-25T13:59:27.052+0000","updated":"2010-05-25T13:59:27.052+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12871382","id":"12871382","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"body":"Should getting the file handle from a resource name be done once at creation (file never expected to disappear, only change), or every time it checks for modification (file can go away and we should explode when it does)?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-25T21:54:30.031+0000","updated":"2010-05-25T21:54:30.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12871414","id":"12871414","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"A File object in Java is just a glorified String.  You don't want to be opening it here, just checking the mtime.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-25T23:11:50.266+0000","updated":"2010-05-25T23:11:50.266+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12871454","id":"12871454","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"body":"Changing PCTimerTask to a FileWatcher (in this case it would be a ResourceWatcher in io/util), then making PFS/DSS implement Runnable by changing loadConfiguration() to run() doesn't immediately work.\r\n\r\nCurrently there's only one translation from resource to file, then the file is passed to PFS/DSS, thus loadConfiguration() is actually loadConfiguration(File x). \r\nIf it's to be a non-parameterized run() method, then run() would have to duplicate the resource-to-file code.\r\nThe ResourceWatcher would call its resource-to-file code to check for modification time, then the run() in PFS/DSS would call its own version of resource-to-file code to extract the data.\r\n\r\nMoving the resource-to-file code to PFS would remove the duplication, but it would still be getting called twice when its only being called once now.\r\nI've attached a patch implementing this.\r\n\r\nStatus:\r\nM      src/java/org/apache/cassandra/locator/DatacenterShardStrategy.java\r\nD      src/java/org/apache/cassandra/locator/PropertyFileSnitchMBean.java\r\nM      src/java/org/apache/cassandra/locator/PropertyFileSnitch.java\r\nA      src/java/org/apache/cassandra/io/util/ResourceWatcher.java","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-26T00:20:42.225+0000","updated":"2010-05-26T00:20:42.225+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12871460","id":"12871460","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"body":"Attaching quick patch. Changed\r\n{noformat}\r\nlogger.error(\"{}\", data, throwable);\r\n{noformat}\r\n\r\nto\r\n{noformat}\r\nlogger.error(String.format(\"%s\",data), throwable);\r\n{noformat}\r\n\r\nI don't think the first one does what it's supposed to do.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jhermes","name":"jhermes","emailAddress":"hermes at datastax dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jon Hermes","active":true},"created":"2010-05-26T00:36:12.114+0000","updated":"2010-05-26T00:36:12.114+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12872213","id":"12872213","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"committed with some final tweaks.  thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-05-27T13:31:01.003+0000","updated":"2010-05-27T13:31:01.003+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12464863/comment/12872953","id":"12872953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"body":"Integrated in Cassandra #448 (See [http://hudson.zones.apache.org/hudson/job/Cassandra/448/])\r\n    Add ResourceWatcher to generalize reloading Strategy configurations.  patch by Jon Hermes and jbellis for CASSANDRA-1105\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hudson","name":"hudson","emailAddress":"jira at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Hudson","active":true},"created":"2010-05-28T12:45:22.877+0000","updated":"2010-05-28T12:45:22.877+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-1105/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0g313:"}}