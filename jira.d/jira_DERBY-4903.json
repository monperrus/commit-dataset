{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12479944","self":"https://issues.apache.org/jira/rest/api/latest/issue/12479944","key":"DERBY-4903","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315564","id":"12315564","description":"First release on the 10.7 branch.","name":"10.7.1.1","archived":false,"released":true,"releaseDate":"2010-12-14"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316362","id":"12316362","description":"First release on the 10.8 branch","name":"10.8.1.2","archived":false,"released":true,"releaseDate":"2011-04-29"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-11-15 11:51:32.272","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24519","customfield_12310222":"3_*:*_1_*:*_271019204_*|*_1_*:*_1_*:*_669394701_*|*_6_*:*_1_*:*_5776569847_*|*_5_*:*_1_*:*_0_*|*_4_*:*_1_*:*_15161","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-02-01T05:24:13.602+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4903/watchers","watchCount":0,"isWatching":false},"created":"2010-11-15T11:34:14.702+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315564","id":"12315564","description":"First release on the 10.7 branch.","name":"10.7.1.1","archived":false,"released":true,"releaseDate":"2010-12-14"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12334922","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12334922","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12480934","key":"DERBY-4919","self":"https://issues.apache.org/jira/rest/api/2/issue/12480934","fields":{"summary":"Use the built-in XML libraries for generating XML in PlanExporter","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-04-19T12:39:31.544+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11414","id":"11414","name":"Tools"}],"timeoriginalestimate":null,"description":"The plan exporter tool fails to produce well-formed output for the following query:\r\n\r\nij> select * from sysibm.sysdummy1 where ibmreqd < 'Z';\r\n\r\nThe generation of XML doesn't fail, but when I open the file in Firefox, I see this message:\r\n\r\nXML Parsing Error: not well-formed\r\nLocation: file:///tmp/plan.xml\r\nLine Number 9, Column 11:\r\n\r\nOperator: <\r\n----------^\r\n\r\nHTML generation prints the following error, and produces an empty file:\r\n\r\nERROR:  'The value of attribute \"scan_qualifiers\" associated with an element type \"null\" must not contain the '<' character.'","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36478","summary":"Plan exporter tool produces broken output if query contains less-than operator","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":23,"total":23,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12932029","id":"12932029","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Hi Knut,\r\n\r\nI guess I handled this inside \"AccessDatabase.Statement()\" method. But not sure what went wrong here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-15T11:51:32.272+0000","updated":"2010-11-15T11:51:32.272+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12932033","id":"12932033","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Hi Knut,\r\n\r\nI didn't notice the latter part of the description (i.e. ERROR: 'The value of attribute \"scan_qualifiers\" associated with an element type \"null\" must not contain the '<' character.'), earlier. Sorry about that.\r\n\r\nSo, it seems like there's a bug here.\r\n\r\nI'll look into this if you're not going to take it. :)\r\n\r\nThanks for pointing this out!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-15T12:18:30.946+0000","updated":"2010-11-15T12:18:30.946+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12932042","id":"12932042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Hi Nirmal,\r\nThanks for taking a look at this bug. And for volunteering to fix it. :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-15T12:33:44.999+0000","updated":"2010-11-15T12:33:44.999+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12932044","id":"12932044","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Note that the problem is not limited to the character '<'. You'll see similar problems if the queries run against a table with '\"' in its name, for example with these queries:\r\n\r\nij> create table \"A \"\"quoted\"\" table name\" (x int);\r\n0 rows inserted/updated/deleted\r\nij> select * from \"A \"\"quoted\"\" table name\";\r\nX          \r\n-----------\r\n\r\n0 rows selected\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-15T12:44:46.612+0000","updated":"2010-11-15T12:44:46.612+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12934734","id":"12934734","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Hi,\r\n\r\nI'm attaching a patch which addresses the occurrences of special XML characters such as >(&gt;), <(&lt;), '(&apos;) and \"(&quot;), in both <statement> nodes and attribute nodes. \r\n\r\nI've attached few test cases as well.\r\n\r\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-23T05:30:01.005+0000","updated":"2010-11-23T05:30:01.005+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935205","id":"12935205","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"This seems like a pretty reasonable approach, and the test cases look appropriate, too.\r\n\r\nIt seems like it would be nice to perform the special character encoding of the\r\nXML attribute strings *prior* to composing them into quoted substrings in the XML tag string,\r\nsince then replaceInAttribute() wouldn't have to go searching for the start and end of\r\nthe attribute string to find it.\r\n\r\nBut this diff is small and focused on the problem at hand, and that's always good.\r\n\r\n   ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2010-11-24T04:50:08.301+0000","updated":"2010-11-24T04:50:08.301+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935320","id":"12935320","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"It may also be worthwhile to factor out the code that encodes the special characters, and put it in a helper method instead of repeating the code.\r\n\r\nI think we also need to escape & -> &amp; in these strings. The query below results in XML that's not well-formed, and the HTML generation fails with a NullPointerException:\r\n\r\n    select * from sysibm.sysdummy1 where ibmreqd = 'a, b & c'","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-24T13:35:13.353+0000","updated":"2010-11-24T13:35:13.353+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935323","id":"12935323","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"By the way, it looks like the HTML generation uses javax.xml.* classes in order to transform XML to HTML. Is there a reason why we couldn't use those classes to generate the XML in the first place? I suppose they would escape the strings automatically (and correctly).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-24T13:44:34.812+0000","updated":"2010-11-24T13:44:34.812+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935386","id":"12935386","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Kunt: As I remember we had few issues on doing this;\r\n\r\n1) A way to add a pointer to the XSL style sheet\r\n2) Difficulty of finding all classes needed, in all JREs.\r\n\r\nAre these making sense? If you think otherwise please let us know.\r\n\r\nBryan: Hi Bryan! Since we're composing XML attribute strings into quoted substrings, from the query it self, I can't see away, where we can avoid doing this. Please forgive me if I misunderstood your question.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-24T16:24:59.541+0000","updated":"2010-11-24T16:24:59.541+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935413","id":"12935413","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"> 1) A way to add a pointer to the XSL style sheet\r\n\r\nI think the org.w3c.dom.Document.createProcessingInstruction() method\r\ncould do that. The following code fragment seems to create a pointer\r\nto the style sheet for me, and it automatically escapes the '<', '>'\r\nand '&' characters in the query text:\r\n\r\n        Document doc =\r\n                DocumentBuilderFactory.newInstance().\r\n                newDocumentBuilder().newDocument();\r\n\r\n        doc.appendChild(\r\n                doc.createProcessingInstruction(\r\n                        \"xml-stylesheet\",\r\n                        \"type=\\\"text/xsl\\\" href=\\\"...\\\"\"));\r\n\r\n        Element plan = doc.createElement(\"plan\");\r\n        doc.appendChild(plan);\r\n\r\n        Element statement = doc.createElement(\"statement\");\r\n        statement.setTextContent(\"SELECT * FROM T WHERE X <> 'a & b'\");\r\n        plan.appendChild(statement);\r\n\r\n        Element time = doc.createElement(\"time\");\r\n        time.setTextContent(\"2010-11-24 18:27:14.466\");\r\n        plan.appendChild(time);\r\n\r\n        Source source = new DOMSource(doc);\r\n        Result result = new StreamResult(System.out);\r\n\r\n        Transformer trans = TransformerFactory.newInstance().newTransformer();\r\n        trans.transform(source, result);\r\n\r\n\r\n> 2) Difficulty of finding all classes needed, in all JREs. \r\n\r\nThat's what I thought too, and that's why I was surprised to see that\r\nthe generation of HTML files used those classes. But since the tool\r\nnow appears to depend on these classes being available, wouldn't it\r\nmake sense to use them for generating the XML too?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-24T17:40:46.133+0000","updated":"2010-11-24T17:40:46.133+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935631","id":"12935631","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Hi Knut,\r\n\r\nThanks for the ideas! \r\n\r\nCan you please consider following.\r\n\r\nFew negative/tricky points on doing this:\r\n1) This way XML document becomes hard to read: It was a requirement, so that the user can go through a generated XML file and build up his own Style sheet.\r\n\r\neg: \r\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><?xml-stylesheet type=\"text/xsl\" href=\"...\"?>\r\n<plan><statement>SELECT * FROM T WHERE X &lt;&gt; 'a &amp; b'</statement><time>2010-11-24 18:27:14.466</time></plan>\r\n\r\n2) This need some re-factoring of the design approach:\r\n\r\n* Now we are getting the name of the attribute from the query, we might need to change it.\r\n* Now I am building the whole query plan tree and then only write the whole string to the file, we need to alter this approach.\r\netc.\r\n\r\n3) Given the time constraint at that time, I was unable to find any other approach of creating the HTML file. Since creating the HTML file involves parsing the style sheet as well. I think we need some extra classes when creating the XML document. So, I am not quite sure about the presence of those extra classes in all JREs.\r\n\r\n4) Element.setTextContent() method is not there in J2SE 1.4.2, and it gave rubbish when I used setNodeValue().\r\n\r\nAfter considering all these facts I think it's better to keep XML generation in this way and just handle those special character occurrences.\r\n\r\nI'm not reluctant to change the code if you have other ideas, I just wanted to say what I feel :).\r\n\r\nThanks.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-25T04:01:23.628+0000","updated":"2010-11-25T04:01:23.628+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935775","id":"12935775","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Hi Nirmal,\r\n\r\nThanks for writing up the challenges with such a rewrite. Some more\r\ncomments below...\r\n\r\n> Few negative/tricky points on doing this:\r\n> 1) This way XML document becomes hard to read: It was a requirement,\r\n> so that the user can go through a generated XML file and build up\r\n> his own Style sheet.\r\n\r\nI think the Transformer can be tuned to pretty print the document. For\r\nexample, this code makes it output XML that looks more or less\r\nidentical to the manually formatted XML generated by the exporter:\r\n\r\n    trans.setOutputProperty(OutputKeys.INDENT, \"yes\");\r\n    trans.setOutputProperty(\"{http://xml.apache.org/xslt}indent-amount\", \"4\");\r\n\r\n(I'm not sure exactly how portable the above code is, but I'm sure we\r\ncan work out something that'll do the trick.)\r\n\r\nI've also noticed that, no matter how badly formatted the XML document\r\nis, it looks nice and tidy when I open it in Firefox. I assume other\r\nXML tools will behave similarly.\r\n\r\n> 2) This need some re-factoring of the design approach:\r\n\r\nI agree. It will be a chunk of work that someone must volunteer to do.\r\n\r\n> 3) Given the time constraint at that time, I was unable to find any\r\n> other approach of creating the HTML file. Since creating the HTML\r\n> file involves parsing the style sheet as well. I think we need some\r\n> extra classes when creating the XML document. So, I am not quite\r\n> sure about the presence of those extra classes in all JREs.\r\n\r\nI'm assuming the JREs in question are the Java ME ones. Those JREs\r\ndon't even have the classes used in the generation of HTML files, so\r\nthey'd need the Xalan jars on the classpath to be able to run the plan\r\nexporter in any case. I believe the Xalan jars contain all the classes\r\nand interfaces needed, also to generate the XML file, but I may be\r\nmistaken.\r\n\r\n> 4) Element.setTextContent() method is not there in J2SE 1.4.2, and\r\n> it gave rubbish when I used setNodeValue().\r\n\r\nRight, to make it work in 1.4.2, I think we need to replace\r\nsetTextContent(text) with appendChild(doc.createTextNode(text)).\r\n\r\n> After considering all these facts I think it's better to keep XML\r\n> generation in this way and just handle those special character\r\n> occurrences.\r\n\r\nWell, I lean towards the opposite conclusion... :)\r\n\r\nIf we had used the XML libraries to generate the XML, we wouldn't have\r\nhad this bug or DERBY-4902, and perhaps other bugs that we haven't\r\ndiscovered yet.\r\n\r\nBut I think the current patch would be a good incremental\r\nimprovement. I'll check it in and back-port it to the 10.7 branch so\r\nthat it makes it into the next release candidate. If we want to change\r\nhow the XML is generated, we can file a new JIRA issue to track that\r\nwork.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-25T15:18:21.822+0000","updated":"2010-11-25T15:18:21.822+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935777","id":"12935777","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"+1 to not worrying too much about the human-readability of the generated XML.\r\nI think there are plenty of other reformatting tools that an XML-savvy user will\r\nhave access to. \r\n\r\nRegarding the selection of which classes to use, I'd like to see us using\r\nthe built-in system classes for XML  handling wherever possible. As Nirmal\r\nnotes, we were struggling with the availability of these classes, see for\r\nexample the discussion of xml-apis.jar in DERBY-4781.\r\n\r\nOver time, the core platform Java environments become more sophisticated and\r\nprovide more complete XML support, and as that occurs, if we can shift\r\nwork away from our own custom code and into system-provided code that\r\nseems like a clear win, so I think it would be great if Knut could preserve\r\nthese suggestions for how to do that as part of a JIRA issue somewhere.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2010-11-25T15:35:13.107+0000","updated":"2010-11-25T15:35:13.107+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935784","id":"12935784","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Committed derby-4903-a to trunk with revision 1039084.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-25T16:26:23.094+0000","updated":"2010-11-25T16:26:23.094+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935785","id":"12935785","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Hi Knut & Bryan,\r\n\r\nThanks for the responds.\r\n\r\nI really like to try this out, but due to academic constraints that I have till the 3rd week of January 2011, \r\nI am not quite sure that I will be able to look at re-factoring the code before that. If there's no rush I'll definitely\r\ntake it after January 2011. :)\r\n\r\nFor now I'll attach a patch soon, on comments received for patch (a).\r\n\r\nThanks.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-25T16:26:43.037+0000","updated":"2010-11-25T16:26:43.037+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935791","id":"12935791","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks, Bryan. I'll file a new JIRA issue for making use of the XML libraries.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-25T16:39:21.634+0000","updated":"2010-11-25T16:39:21.634+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935796","id":"12935796","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Here's a patch that extends the test case with testing more special characters, and by adding a less-than operator as mentioned in the original bug description.\r\n\r\nThe test fails because the special character '&' wasn't handled by the patch. I tried to add a case for '&' in AccessDatabase, but the replace methods go into an infinite loop when trying to replace '&' with \"&amp;\" because the replacement text includes the character to be replaced. I'll try to come up with a different solution.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-25T17:03:00.192+0000","updated":"2010-11-25T17:03:00.192+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935797","id":"12935797","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Hi Bryan,\r\n\r\n>It seems like it would be nice to perform the special character encoding of the\r\n>XML attribute strings *prior* to composing them into quoted substrings in the XML tag string,\r\n>since then replaceInAttribute() wouldn't have to go searching for the start and end of\r\n>the attribute string to find it.\r\n\r\nSince we're getting the attributes as quoted substrings from the database query it self,\r\nI'm not quite clear whether this is possible.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-25T17:03:16.250+0000","updated":"2010-11-25T17:03:16.250+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935800","id":"12935800","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Hi Knut,\r\n\r\nWhat about something like this for replacing '&' ?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-25T17:07:04.568+0000","updated":"2010-11-25T17:07:04.568+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935807","id":"12935807","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks Nirmal, but that was the code I tried which went into an infinite loop. The reason is that the replace() method will continue until the resulting string contains no '&' characters, and even if it replaces a '&' with \"&amp;\", it will still find an '&' in the result string.\r\n\r\nThe attached patch (derby-4903-c.diff) uses a different approach, which also works for '&'.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-25T17:28:29.327+0000","updated":"2010-11-25T17:28:29.327+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935811","id":"12935811","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"body":"Oh, yeah! Your approach looks fine to me!\r\n\r\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=nirmal","name":"nirmal","emailAddress":"nirmal070125 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=nirmal&avatarId=17689","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=nirmal&avatarId=17689","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=nirmal&avatarId=17689","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=nirmal&avatarId=17689"},"displayName":"Nirmal Fernando","active":true},"created":"2010-11-25T17:40:44.420+0000","updated":"2010-11-25T17:40:44.420+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935951","id":"12935951","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks, Nirmal. Committed revision 1039268.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-26T08:34:07.981+0000","updated":"2010-11-26T08:34:07.981+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12479944/comment/12935956","id":"12935956","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Merged to 10.7 and committed 1039272. Closing the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-11-26T08:47:48.520+0000","updated":"2010-11-26T08:47:48.520+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4903/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06lvj:"}}