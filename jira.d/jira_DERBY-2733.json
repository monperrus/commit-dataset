{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12370565","self":"https://issues.apache.org/jira/rest/api/latest/issue/12370565","key":"DERBY-2733","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2007-06-12 03:31:43.982","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"23207","customfield_12310222":"1_*:*_1_*:*_1201153261_*|*_6_*:*_2_*:*_141991844_*|*_4_*:*_1_*:*_18156386884","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2008-01-11T19:54:22.214+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2733/watchers","watchCount":1,"isWatching":false},"created":"2007-05-31T03:22:10.225+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"12.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12310615","id":"12310615","description":"","name":"10.1.2.1","archived":false,"released":true,"releaseDate":"2005-11-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-01-11T19:54:22.174+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11414","id":"11414","name":"Tools"}],"timeoriginalestimate":null,"description":"When starting ij - with, or without any derby.properties, ij first shows this:\n-------------------------------------------------------\njava.lang.reflect.InvocationTargetException\n        at java.lang.reflect.AccessibleObject.invokeL(AccessibleObject.java:215)\n        at java.lang.reflect.Method.invoke(Method.java:272)\n        at org.apache.derby.impl.tools.ij.util.getDataSourceConnection(util.java:426)\n        at org.apache.derby.impl.tools.ij.util.startJBMS(util.java:516)\n        at org.apache.derby.impl.tools.ij.util.startJBMS(util.java:585)\n        at org.apache.derby.impl.tools.ij.ConnectionEnv.init(ConnectionEnv.java:64)\n        at org.apache.derby.impl.tools.ij.utilMain.initFromEnvironment(utilMain.java:179)\n        at org.apache.derby.impl.tools.ij.Main.<init>(Main.java:230)\n        at org.apache.derby.impl.tools.ij.Main.getMain(Main.java:193)\n        at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:178)\n        at org.apache.derby.impl.tools.ij.Main.main(Main.java:73)\n        at org.apache.derby.tools.ij.main(ij.java:67)\nCaused by: java.lang.NullPointerException\n        at org.apache.derby.jdbc.InternalDriver.embeddedDriverAcceptsURL(InternalDriver.java:116)\n        at org.apache.derby.jdbc.InternalDriver.acceptsURL(InternalDriver.java:107)\n        at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:126)\n        at org.apache.derby.jdbc.EmbeddedSimpleDataSource.getConnection(EmbeddedSimpleDataSource.java:406)\n        at org.apache.derby.jdbc.EmbeddedSimpleDataSource.getConnection(EmbeddedSimpleDataSource.java:373)\n        at java.lang.reflect.AccessibleObject.invokeL(AccessibleObject.java:213)\n        ... 11 more\nij version 10.3\nij>\n\nAfter that, ij does appear to start normal operations.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39612","summary":"ij rolls through NullPointerException (NPE) with J2ME/JSR169/WEME 6.1.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"windows xp; j9 -jcl:foun11 -version:\n\njava version \"J2ME Foundation Specification v1.1\"\nIBM J9 2.3 Windows XP x86-32  (JIT enabled)\nJ9VM - 20061023_08962_lHdSMR\nJIT  - 20060629_1804ifx1_r8\nGC   - 200609_15\nJCL  - 20061020_1321,foun11\n\nLicensed Materials - Property of IBM\n\nJ9 - VM for the Java(TM) platform, Version 2.3\n(c) Copyright IBM Corp. 1991, 2006  All Rights Reserved\nTarget: 20061023_08962_lHdSMR (Windows XP 5.1 build 2600 Service Pack 2 x86)\nJIT  - 20060629_1804ifx1_r8","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":27,"total":27,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12503252","id":"12503252","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"well, I could've sworn things worked normal after the NPE, i.e. I was able to connect with 'jdbc:derby:abcdb;create=true';, but now I consistently get 'JAVA ERROR: java.lang.NoClassDefFoundError: java.sql.Driver', when I try to connect.\r\n\r\nAlso, when I attempt to connect with correct properties I get this error, after a different stack trace; after which the jvm just shuts down.\r\n\r\nI *know* I've been able to create databases with ij before with JSR169, not sure what is going on...\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-06-11T00:50:32.367+0000","updated":"2007-06-11T00:50:32.367+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12503412","id":"12503412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I remembered how I got to working after the NPE - if you omit the protocol on the connect things work; i.e.: connect 'abcdb;create=true';\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-06-11T14:12:14.252+0000","updated":"2007-06-11T14:12:14.252+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12503684","id":"12503684","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I made a small change to EmbeddedSimpleDataSource, but would appreciate someone reviewing it.\r\n\r\nAlso I added an example to the ij.dataSource documentation to indicate you don't need the protocol with a datasource and that it is in fact hurting when you're using a jvm supporting JSR169.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-06-11T23:47:56.562+0000","updated":"2007-06-11T23:47:56.562+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12503712","id":"12503712","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I looked at the change for EmbeddedSimpleDataSource and I don't believe it is ok.\r\nIt changes getConnection() for the data source to return null, however null is not a valid return from getConnection.\r\njavax.sql.DataSource.getConnection() either returns a valid Connection object or throws an exception.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2007-06-12T03:31:43.982+0000","updated":"2007-06-12T03:31:43.982+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12504305","id":"12504305","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I believe this is the right thing to do...\r\nDerbyall and suites.all pass without any issues.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-06-13T16:15:25.180+0000","updated":"2007-06-13T16:15:25.180+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12504391","id":"12504391","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Shouldn't startJBMS() throw an exception if it does not connect?  I guess the thing I don't understand is why ij is trying to make a connection (calling startJBMS()) just because it was started.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-06-13T20:03:22.766+0000","updated":"2007-06-13T20:03:22.766+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12504440","id":"12504440","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"IRC transcript between Kathey & me, ca 1.20 pm PDT\r\n\r\nmyrna>\thi kathey?\r\n\t<kmarsden>\thi myrna\r\n\t<myrna>\tI saw your reply re DERBY-2733...\r\n\t<kmarsden>\tSo why does startJBMS() get called, when all we are doing is starting ij?\r\n\t<myrna>\tI could be wrong, but it seems to me a number of defaults are set up in startJBMS(), defaults that we'd want.\r\n\t<myrna>\tSuch as, we default to use EmbeddedSimpleDataSource.\r\n\t<kmarsden>\twhy does the bug not occur for other jvms?\r\n\t<myrna>\tbecause they don't *require* a datasource; they are happy with loading the default driver.\r\n\t<myrna>\tWith j2ME, there is no default driver, so it rolls on with no info.\r\n\t<kmarsden>\tdo they return null from startJBMS() if ij.database is not set?\r\n\t<myrna>\tWith other jvms it tries to make the connection, (using drivermanager), and the connection comes out as null, and then yes, startJBMS returns null.\r\n\t<kmarsden>\tit wouldn't be null. it would throw an exception no?\r\n\t<myrna>\tno\r\n\t<myrna>\tthere's no need to start ij with a database!\r\n\t<myrna>\tI'm not at this point interested in fixing the entire logic of ij...\r\n\t<myrna>\tI just want this little bit to work, and a follow up bit that prevents ij from attempting to load a driver if we have a datasource & we're using j2me.\r\n\t<myrna>\t(cause in that case ij never even starts).\r\n\t<kmarsden>\thmmm... Well I can't say I understand the fix. At least the javadoc should be changed to say under what conditions startJBMS() returns null.\r\n\t<kmarsden>\tMaybe Dan could take another peek.\r\n\t<kmarsden>\tSorry I wasn't so helpful on review.\r\n\t<myrna>\t:-) you need to do what you think is right.\r\n\t<myrna>\tAt the same time, I need to go do other stuff...and an overhaul of ij is not on my list at this point.\r\n\t<myrna>\tEven a full analysis of what situations startJBMS returns null wasn't on my list of things... :-)\r\n\t<myrna>\tthx kathey\r\n\t<kmarsden>\tok myrna. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-06-13T21:42:20.960+0000","updated":"2007-06-13T21:42:20.960+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12504490","id":"12504490","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I looked at the code some more, and I really think the change is ok.\r\nI committed the code change with revision 547069, and the doc change with revision 547071.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-06-14T01:01:23.164+0000","updated":"2007-06-14T01:01:23.164+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12505296","id":"12505296","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I don't know how I could let this happen, but the change actually caused all sql tests with weme6.1 to fail!\r\nBacking out in a hurry.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-06-15T16:27:55.312+0000","updated":"2007-06-15T16:27:55.312+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12545847","id":"12545847","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"body":"For what it's worth, I also see this with the phoneME Advanced VM (cvm), i.e. I'm getting \r\njava.lang.reflect.InvocationTargetException\r\nCaused by: java.lang.NullPointerException\r\nif I try to start IJ without setting the ij.dataSource.databaseName property.\r\n\r\nI too think we should be able to start IJ without having to specify a database, or at least not connect to one! (I'm sorry I don't have enough cycles available to look into the code changes at this time.)\r\n\r\nThe documentation is inconsistent at this point. tools/rtoolsijproprefdatasource.html first says that:\r\n\r\n\"To establish a connection using ij.dataSource, you need to set the ij.dataSource.databaseName property.\"\r\n(which matches the current implementation)\r\n\r\nBut in Example 2 (added as part of this Jira issue), only ij.dataSource is specified, and IJ seems to start successfully (which in reality it will not do at this point). I think this should be corrected, in the 10.3 docs at least.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"created":"2007-11-27T14:12:24.701+0000","updated":"2007-11-27T14:12:24.701+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12546363","id":"12546363","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I plan to look at this again for 10.4, didn't anticipate doing anything for  10.3...\r\nI couldn't remember the details of the behavior documented, so I went back and did some experimenting...\r\n\r\nIt looks like all in all, currently, both with jdk15 and the java ME I have available(j9/weme6.1) the behavior is similar; if you don't specify ij.dataSource.databaseName it doesn't connect (of course)  to any database, but it does start ij after an error. \r\nIf you specify ij.dataSource.databaseName ij correctly connects to the intended database if it exists, if you it doesn't exists, it reports 'ERROR XJ004: database '...' not found'. If you add the create it'll automatically create.\r\n\r\nSo the only differences between jdk15 and j9 that I see are:\r\n - if you don't specify ij.dataSource.databaseName, with ij java ME encounters the inelegant NPE documented in this JIRA\r\n- if you happen to also have -Dij.protocol=jdbc:derby: floating around, ij won't start at all with j9 complaining about NoClassDefFound java.sql.Driver. I believe this is documented elsewhere (not to specify the protocol with dataSources) although I can't find it right now.\r\n\r\nSo, I'm a bit lost trying to fix the docs for 10.3...\r\nThe only thing I can see basically wrong is the indication that you *must* specify the databaseName property. If we added something like: \"If you do not specify the databaseName property, you will get an error. You can then still connect to the database if you omit the protocol.\"\r\n\r\nSuggestions?\r\n ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-11-28T19:37:41.218+0000","updated":"2007-11-28T19:37:41.218+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12546626","id":"12546626","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"body":"From what I can see, the fact that ij runs into the NullPointerException when only ij.dataSource is set (to EmbeddedSimpleDataSource) is true for both Java ME and Java SE VMs. The only difference is, as you mention, that with Java ME ij fails to start if ij.protocol is also set.\r\n\r\nThe only issue I have with the current documentation in this regard is that the second example (Example 2) does not show the real behavior of ij. If you do what the example in the docs say, you will run into the combined InvocationTargetException/NullPointerException before you can continue to use ij as if no error occurred (at least that is our perception at this point).\r\n\r\nI think it would be better to:\r\n\r\n a) Specify that you should not specify ij.protocol when using Java ME (EmbeddedSimpleDataSource) in the \"Function\" or \"Syntax\" section of the doc topic. (If you can't find where this is documented elsewhere, a user probably won't find it either.)\r\n\r\n b) Let the examples show actual Derby behavior and recommended usage. If ij, as this piece of documentation says, does not currently support setting ij.dataSource without also setting ij.dataSource.databaseName, then all ij.dataSource examples should set the latter property as well.\r\n\r\nSo perhaps the easiest temporary solution would be to do a) above, and remove Example 2 from the docs until we have a solution in the code letting us do what Example 2 does without errors.\r\n\r\nIt's no big deal, though - 10.3.2 will probably be released without such a change anyway, and for future releases we still have some time to fix the NPE (which would make example 2 valid).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"created":"2007-11-29T09:22:15.445+0000","updated":"2007-11-29T09:22:15.445+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557107","id":"12557107","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I think the trouble is with the no-args constructor.\r\nThe newest patch (DERBY-2733_3.diff) calls update() in the no-args constructor which then sets the jdbcurl to jdbc:derby and then there is no NPE anymore.\r\n\r\nThis mimics what happens in ReferenceableDataSource. \r\n\r\nI did wonder about the meaning of the comment in EmbeddedDataSource (which extends ReferenceableDataSource) :\r\n....\r\n// needed by Object Factory\r\n// don't put anything in here or in any of the set method because this\r\n// object may be materialized in a remote machine and then sent thru\r\n// the net to the machine where it will be used.\r\n...\r\n\r\nI think this comment is not (no longer?) applicable, possibly not even to EmbeddedDataSource, because stuff is put in various set methods...So I think it's OK to add the call as in the _3 patch.\r\n\r\nStarting ij without any properties now works exactly the same with my j2ME as with jdk15; both cases just give an XJ004 error and start ij without any connection. \r\nsuites.All ran fine with j9 and jdk15, and derbyall ran fine with j9. (I'm still running derbyall with jdk15 for good measure, but I doubt that gives any trouble, I don't think any of the tests exercise EmbeddedSimpleDataSource.)\r\n\r\nI intend to commit this change tomorrow If there are no more comments.\r\nThen I'll take another look at the docs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-01-09T01:41:11.423+0000","updated":"2008-01-09T01:41:11.423+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557133","id":"12557133","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Running the tests showed no trouble with the latest patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-01-09T04:44:48.968+0000","updated":"2008-01-09T04:44:48.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557366","id":"12557366","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"committed code change with revision 610484 (http://svn.apache.org/viewvc?view=rev&revision=610484)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-01-09T18:11:55.486+0000","updated":"2008-01-09T18:11:55.486+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557399","id":"12557399","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"attaching another attempt at documentation update for ij.dataSource. Again, I intend to commit tomorrow if there are no objections.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-01-09T19:48:14.967+0000","updated":"2008-01-09T19:48:14.967+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557404","id":"12557404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"In the documentation the first line has:\r\n  \"When specifying a datasource, Derby does not use the DriverManager mechanism to establish connections.\"\r\n\r\nI think to be clearer it should be \"ij\" and not \"Derby\" in \"Derby does not use ...\".\r\n\r\nIn the syntax section it never actually states what the property needs to be set to, ie. what its value represents.\r\nThe section does have this:\r\n    ij.dataSource=dataSourcename\r\n\r\nbut I think that's misleading. A data source does have a name (java bean property dataSourceName) and that's not what is required here.\r\nInstead the value is the class name of the data source.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2008-01-09T19:57:58.384+0000","updated":"2008-01-09T19:57:58.384+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557436","id":"12557436","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaase3","name":"chaase3","emailAddress":"camilla dot haase at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kim Haase","active":true},"body":"In addition to Dan's more substantive corrections, here are some suggestions about language and format.\r\n\r\nThere's a run-on sentence here as well as some stray single quotation marks:\r\n\r\n\"To establish a connection using ij.dataSource, you should set the ij.dataSource.databaseName property, otherwise ij will start with an error indicating database '' was not found.\"\r\n\r\nI'd suggest the following --\r\n\r\n\"To establish a connection using ij.dataSource, set the ij.dataSource.databaseName property. If you do not set this property, ij will start with an error indicating that the database was not found.\"\r\n\r\nIt might be clearer if the last sentence of the revised paragraph came after the three property syntax lines, and if you changed the passive voice to active. Also, should \"databaseName\" be in code font?\r\n\r\n\"If you do not specify ij.dataSource.databaseName, you can still connect to a database after the error indicating that no database was found, but you should not specify the protocol, just the databaseName, in the connect statement.\"\r\n\r\nIn example 2, you need to add a line break in the java command, similar to the one in example 1. Otherwise the code line is too long in the output.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaase3","name":"chaase3","emailAddress":"camilla dot haase at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kim Haase","active":true},"created":"2008-01-09T21:24:14.862+0000","updated":"2008-01-09T21:24:14.862+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557508","id":"12557508","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching another version, incorporating Dan and Kim's comments.\r\n\r\nHow's this look?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-01-10T01:15:40.327+0000","updated":"2008-01-10T01:15:40.327+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557587","id":"12557587","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"body":"Thank you for doing this Myrna, it is a great improvement!\r\n\r\nThe code change works fine with my Java ME VM (phoneME Advanced).\r\n\r\nI will comment on the doc changes below, but first I'd like to present my view of how this should ideally work:\r\n\r\n - I think it would be easier to use IJ with a datasource (and to document it) if IJ tries to connect automatically to a database ONLY IF ij.dataSource.databaseName is set. It makes no sense doing it otherwise.\r\n - If ij.dataSource.databaseName is set, and IJ successfully connects to the database automatically on startup, this should be indicated to the user, e.g. \"Connected to database [databaseName]\".\r\n\r\nGiven the current implementation, I have the following comments regarding the doc changes:\r\n\r\nFirst, I think it would be useful to explicitly say that ij will try to connect to your database automatically when you specify ij.dataSource. E.g.\r\n\r\n\"When you set the ij.dataSource property ij will automatically try to connect to a database. To establish a connection to a specific database using ij.dataSource, set the ij.dataSource.databaseName property. If you do not set this property, ij will start with an error...\"\r\n\r\nIt's awkward, but I think it is needed given the current implementation.\r\n\r\nSecond, I think the sentence\r\n\r\n\"If you do not specify ij.dataSource.databaseName, you can still connect to a database after the error indicating that no database was found, but you should not specify the protocol, just the databasename, in the connect statement.\"\r\n\r\nis a bit long and complex (I almost lose my breath reading it). Besides, I think \"just the databasename\" may be misleading (because you may include connection attributes as well), and that we should say \"connect command\" instead of \"connect statement\" (because that is how it is described in the Tools guide). I suggest the following:\r\n\r\n\"If you do not specify ij.dataSource.databaseName and get an error indicating that no database was found, you can still connect to a database manually by using ij's connect command. You should not specify the protocol (for example jdbc:derby:) in the connect command when using ij.dataSource.\"\r\n\r\nActually, I think Example 2 as it is in the current doc trunk is useful to show this \"feature\", but it should include the error message:\r\n\r\njava -Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource org.apache.derby.tools.ij\r\nERROR XJ004: Database '' not found.\r\nij version 10.4\r\nij> connect 'smalldb;create=true';\r\nij>\r\n\r\nThe doc page should include a reference to the documentation for the connect command.\r\n\r\nFinally, the documentation for the connect command ( http://db.apache.org/derby/docs/dev/tools/rtoolsijcomref22318.html ) says:\r\n\r\n\"Connects to the database indicated by the ConnectionURLString. Specifically, takes the value of the string database connection URL and issues a java.sql.DriverManager.getConnection request to set the current connection to that database connection URL.\"\r\n\r\nwhich is incorrect if you specify ij.dataSource (and do not include the protocol in the URL - sigh...). Something like this is more correct, I guess:\r\n\r\n\"Connects to the database indicated by the ConnectionURLString. Specifically, ij takes the value of the string (the database connection URL) and issues a getConnection request using java.sql.DriverManager or a javax.sql.DataSource implementation (see the ij.dataSource property) to set the current connection to that database connection URL.\"\r\n\r\n(If the connect command docs should be handled in a separate Jira, feel free to create one, or let me know so I can do it myself).\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"created":"2008-01-10T10:16:43.516+0000","updated":"2008-01-10T10:16:43.516+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557668","id":"12557668","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaase3","name":"chaase3","emailAddress":"camilla dot haase at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kim Haase","active":true},"body":"Thanks for the fixes, Myrna!\r\n\r\nI think John's suggestions are excellent too. I was puzzling over that long sentence but could not think of a way to improve it. I was also thinking it would be good to have an example showing how to connect without specifying the protocol, but I thought if you got a stack trace that might not be practical. If it's just the one-line error I think the example is very helpful -- and even if there is a stack trace you could just have a line with an ellipsis (...) to indicate that.\r\n\r\nI'll leave it to you to decide whether to file a separate issue for the related fix to the connect command doc or to include it here. I think there would be no harm fixing it as part of this issue, since it's related.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaase3","name":"chaase3","emailAddress":"camilla dot haase at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kim Haase","active":true},"created":"2008-01-10T15:19:40.584+0000","updated":"2008-01-10T15:19:40.584+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557693","id":"12557693","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"John> - I think it would be easier to use IJ with a datasource (and to document it) if IJ tries to connect automatically to a database ONLY IF ij.dataSource.databaseName is set. It makes no sense doing it otherwise. \r\n\r\nThat's true with Derby but technically may not be true for all data source implementations.\r\ndatabaseName is a standard property for a data source but is not mandatory, so if ij remains a generic JDBC tool then there should not be a requirement for  ij.dataSource.databaseName to be set.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2008-01-10T16:49:51.574+0000","updated":"2008-01-10T16:49:51.574+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557794","id":"12557794","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"body":"Dan,\r\n\r\nYou make a good point, but is there a requirement that ij MUST connect automatically to a database when ij.dataSource is set? If there is a DataSource which does not support the databaseName property, or if an ij user for some reason does not want to set it (must be an edge case...), I don't see why IJ should try to connect automatically to some (undefined) database (apart from backwards compatibility reasons). My proposal was to not connect automatically if the database name is not set - the user can always run the connect command in ij to connect to any given database using the specified datasource.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"created":"2008-01-10T20:58:22.193+0000","updated":"2008-01-10T20:58:22.193+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557845","id":"12557845","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Another attempt at making the documentation reflect the current behavior.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-01-10T23:28:29.735+0000","updated":"2008-01-10T23:28:29.735+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557848","id":"12557848","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I think further changes to the behavior  of ij/ij.dataSource can be addressed in a separate JIRA; this one specifically addresses the NPE when using EmbeddedSimpleDataSource...\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-01-10T23:31:54.645+0000","updated":"2008-01-10T23:31:54.645+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12557930","id":"12557930","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"body":"The output from the latest patch revision looks very good - thanks!\r\n\r\nI will consider opening another Jira issue for changing the behavior.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=johnemb","name":"johnemb","emailAddress":"johnemb at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John H. Embretsen","active":true},"created":"2008-01-11T08:13:09.451+0000","updated":"2008-01-11T08:13:09.451+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12370565/comment/12558089","id":"12558089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Committed doc changes as per patch _doc_5 with revision 611279.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2008-01-11T19:54:22.160+0000","updated":"2008-01-11T19:54:22.160+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2733/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0757z:"}}