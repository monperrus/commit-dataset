{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12373105","self":"https://issues.apache.org/jira/rest/api/latest/issue/12373105","key":"DERBY-2903","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312876","id":"12312876","description":"","name":"10.3.2.1","archived":false,"released":true,"releaseDate":"2007-12-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2007-07-11 06:35:54.131","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"23312","customfield_12310222":"1_*:*_1_*:*_10973340259_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-11-09T21:05:40.920+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2903/watchers","watchCount":0,"isWatching":false},"created":"2007-07-05T20:56:40.661+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12317987","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12317987","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12381217","key":"DERBY-3152","self":"https://issues.apache.org/jira/rest/api/2/issue/12381217","fields":{"summary":"'ComparisonFailure' in 'testClassPathChecker(org.apache.derbyTesting.functionTests.tests.tools.SysinfoCPCheckTest)'","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-01-21T17:50:32.752+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"}],"timeoriginalestimate":null,"description":"Got the following diff because of access vs. Access in error message.  probably a master update needed.\n\n********* Diff file derbyall/demo/demo/RunClassPathTester.diff\n*** Start: RunClassPathTester jdk1.4.2 demo:demo 2007-06-20 14:32:54 ***\n3 del\n<    Unable to access Protection Domain or Code Source for class interface org.apache.derby.database.Database: \naccess denied (java.lang.RuntimePermission getProtectionDomain)\n3a3\n>    Unable to access Protection Domain or Code Source for class interface org.apache.derby.database.Database: \nAccess denied (java.lang.RuntimePermission getProtectionDomain)\n5 del\n<    Unable to access Protection Domain or Code Source for class class SimpleApp: \naccess denied (java.lang.RuntimePermission getProtectionDomain)\n5a5\n>    Unable to access Protection Domain or Code Source for class class SimpleApp: \nAccess denied (java.lang.RuntimePermission getProtectionDomain)\nTest Failed.\n*** End:   RunClassPathTester jdk1.4.2 demo:demo 2007-06-20 14:32:56 ***","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10369","value":"Regression Test Failure","id":"10369"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"37414","summary":"RunClassPathTester regression test gets diff because of error message difference","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Generating report for RunSuite derbyall  null null null true \n------------------ Java Information ------------------\nJava Version:    1.4.2\nJava Vendor:     IBM Corporation\nJava home:       c:\\10.3_Testing\\ibm142\\jre\nJava classpath:  c:\\10.3_Testing\\jars\\lib\\derby.jar;c:\\10.3_Testing\\jars\\lib\\derbytools.jar;\nc:\\10.3_Testing\\jars\\lib\\derbynet.jar;c:\\10.3_Testing\\jars\\lib\\derbyclient.jar;c:\\10.3_Testing\\jars\\lib\\derbyrun.jar;\nc:\\10.3_Testing\\jars\\test\\derbyTesting.jar;c:\\10.3_Testing\\jars\\tools\\junit.jar;c:\\10.3_Testing\\jars\\tools\\jakarta-oro-2.0.8.jar\nOS name:         Windows Server 2003\nOS architecture: amd64\nOS version:      5.2 build 3790 Service Pack 1\nJava user name:  cloudtest\nJava user home:  C:\\Documents and Settings\\cloudtest\nJava user dir:   C:\\10.3_Testing\\platformtesting\\ibm142_derbyall\njava.specification.name: Java Platform API Specification\njava.specification.version: 1.4\n--------- Derby Information --------\nJRE - JDBC: J2SE 1.4.2 - JDBC 3.0\n[C:\\10.3_Testing\\jars\\lib\\derby.jar] 10.3.1.0 beta - (548006)\n[C:\\10.3_Testing\\jars\\lib\\derbytools.jar] 10.3.1.0 beta - (548006)\n[C:\\10.3_Testing\\jars\\lib\\derbynet.jar] 10.3.1.0 beta - (548006)\n[C:\\10.3_Testing\\jars\\lib\\derbyclient.jar] 10.3.1.0 beta - (548006)\n------------------------------------------------------","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":6,"total":6,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373105/comment/12511674","id":"12511674","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"This is a jvm issue - some versions of IBM JVM have that 'Access' instead of 'access'.\r\nI'll see if I can mask it, or convert the test to junit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-07-11T06:35:54.131+0000","updated":"2007-07-11T06:35:54.131+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373105/comment/12536089","id":"12536089","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching 2 patches that represent approaches to convert this test to junit\r\n1 (modapi.diff) modifies the API slightly so you can run the ClasspathTesting as an API, so the test can look similar to the (currently not running) sysinfoAPITest.\r\n2. (nonapimod.diff) only adds a test, does not modify the api. This took me some time because for some reason I could not get reassignments of sysinfo.main output to System.out to work iteratively. This patch has better comments also.\r\n\r\nTest not yet added to any suite in the patch.\r\n\r\nIf I don't hear any nays I will commit patch DERBY-2903_noapimod.diff and add it to the tools suite.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-10-19T01:27:49.528+0000","updated":"2007-10-19T01:27:49.528+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373105/comment/12536324","id":"12536324","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Unfortunately, when running the test as per the nomodapi patch in ...functionTests.tests.tools._Suite, the output goes to System.out after all. \r\nBack to the drawing board; switching off patch available.\r\n\r\nNote, I also added some carriage returns in the description and env - just cosmetically, so this bug hopefully needs less horizontal space..\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-10-19T19:40:06.391+0000","updated":"2007-10-19T19:40:06.391+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373105/comment/12537120","id":"12537120","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"Attaching another attempt at this patch - I redid the assignments of System.out, basically copying the approach of org.apache.derbyTesting.functionTests.util.HarnessJavaTest, but it gives the same troubles.\r\n\r\nI think the trouble is not with either of the nomodapi approaches, but with the top two tests in the tools._Suite, or, more specifically, with the two tests that run BaseJDBCTestCase.runSQLCommands. Unless my searches have been off, there are only two tests in the suites.All that use this method...\r\nIf I the new SysinfoCPCheckTest which redirects System.out is run after either IJRunScriptTest or ImportExportTest, the output never is redirected. I've tried closing various streams in the test framework code, all to no avail. I think there is possibly something about ij is run that affects this.\r\n \r\nSo, I'll place the new test above those two offending tests. \r\n\r\nIf this approach is not acceptable, please speak up; otherwise, I'll commit. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-10-23T20:07:31.626+0000","updated":"2007-10-23T20:07:31.626+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373105/comment/12537935","id":"12537935","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Two small nits:\r\n\r\n  1) outputEncoding is both an (unused) instance variable and a local variable in testClassPathChecker. I think one of them should be removed (if the instance variable is kept, it would probably be better to make it static final)\r\n\r\n  2) rawBytes is only needed in the test method, so I think it could be a local variable instead of an instance variable. Then we could also get rid of the tearDown() method\r\n\r\nI don't understand the System.out problems, so I can't help you there. You may also consider putting the final setSystemOut() into a finally clause (or perhaps tearDown()) so that we don't end up redirecting System.out for all subsequent tests if sysinfo.main() fails.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2007-10-26T12:07:18.961+0000","updated":"2007-10-26T12:07:18.961+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373105/comment/12541443","id":"12541443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"With revision 593635 I reinstated the test.\r\nI found that if I changed the call in sysinfo.Main to LocalizedResource from\r\nLocalizedResource.getInstance() to LocalizedResource.getInstance().init() the problems I saw with reassigning system.out went away.\r\n\r\nI think, that anytime sysinfo was run after a previous call to LocalizedResource.getInstance().init(), for instance through a call to ij.runScript, it didn't actually go to System.out anymore but to wherever the LocalizedResource was pointing.\r\nI think forcing init() makes more sense for sysinfo, than tagging on to whatever LocalizedResource happens to be pointing.\r\n\r\nAfter the change to sysinfo.Main, the output now can be controlled using calls to System.setOut(), and I modified the test to no longer use the awkward mechanism of separating and unraveling the output for each test case (command) using System.out.println of a character. Also, now it no longer matters where the test runs, so I removed the comments in tools._Suite.java.\r\n\r\nWith revision 593643 I addressed the 2 nits from Knut Anders' review (thx). I did not put the last reset of System.setOut in a finalize...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-11-09T21:05:40.855+0000","updated":"2007-11-09T21:05:40.855+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2903/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06rnj:"}}