{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12344754","self":"https://issues.apache.org/jira/rest/api/latest/issue/12344754","key":"DERBY-1434","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-06-22 10:21:02.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22504","customfield_12310222":"3_*:*_1_*:*_781470000_*|*_1_*:*_1_*:*_12641712000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_8798818734","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-11-24T13:33:49.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1434/watchers","watchCount":0,"isWatching":false},"created":"2006-06-22T04:54:07.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"9.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-03-06T09:40:47.732+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"I have a simple program that connects to a database using the Derby Client, executes a simple query, then connects to a different database using a different Connection object and executes another simple query on that second connection.  The queries both execute without error, so it appears that the connections are correct--i.e. each query will only work on one of the databases, and both queries work, therefore each must be getting executed against the correct database.\n\nBut in looking at the client and server traces, I noticed that for the query on the second database, the client is actually sending the name of the *first* database as RDBNAM, which (I think?) is wrong--it should be sending the name of the second database, since the query is being executed on the second Connection object.\n\nThis behavior does not appear to occur for JCC.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40171","summary":"Client can send incorrect database name to server after having made multiple connections to different databases.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":24,"total":24,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12417203","id":"12417203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching a simple repro of the problem.  To run, start the server with tracing on:\r\n\r\n> java -Dderby.drda.traceAll=true org.apache.derby.drda.NetworkServerControl start -p 1527 &\r\n\r\nThen run the repro:\r\n\r\n> java d1434\r\n\r\nA look at the client trace in _driver_1 shows that the client is sending \"SECONDDB_2\" for the authentication phase--i.e. for the EXCSAT, ACCSEC, SECCHK, and ACCRDB codepoints--but then it's sending \"FIRSTDB_1\" for the EXCSQLIMM codepoint.  However, a look at the the actual Connection object name shows that it is (correctly) the connection object for SECONDDB_2--so the connection is correct, but the database name is wrong.\r\n\r\nAnd a look at the server trace (Server2.trace) shows that the server is in fact receiving the wrong database name.\r\n\r\nI've attached the server and client traces for the repro when run against 10.1.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2006-06-22T05:02:41.000+0000","updated":"2006-06-22T05:02:41.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12417238","id":"12417238","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"A USER SYMPTOM\r\n\r\nI see that if our table in the first database has more data than can be retrieved in one QRYDTA  this can cause a  ResultSet to close prematurely if a query is executed against the second database before  all results are fetched from the server.\r\n\r\nTRIGGERING SCENARIO\r\n\r\nI am working with a user database, and  don't have the case incorporated into Army's repro , but  below is the general  code flow.\r\n\r\n PreparedStatement ps = conn1.prepareStatement(sql);\r\n\t\r\n\t  rs = ps.executeQuery();  // execute a query from db 1 that returns a lot of  data\r\n\t  // get some data\r\n\t  rs.next();\r\n\t  // now interject another statement.\r\n\t  // This will reuse the statement id (pkgnamcsn) from our old db and close it.\r\n\t  PreparedStatement ps2 = conn2.prepareStatement(\"Select count(*) from sys.systables\");\r\n\t  ResultSet rs2 = ps.executeQuery();\r\n\t  rs2.next();\r\n\t  // now lets try to get the rest of the data from our first query.\r\n\t\tint rownum = 1;\r\n\t\twhile(rs.next()){\r\n               ....\r\n\t\t}\r\n\r\n\r\nTHE EXCEPTION\r\n\r\nSQLException: org.apache.derby.client.am.SqlException: Invalid operation: result set closed\r\norg.apache.derby.client.am.SqlException: Invalid operation: result set closed\r\n        at org.apache.derby.client.am.ResultSet.checkForClosedResultSet(ResultSet.java:3287)\r\n        at org.apache.derby.client.am.ResultSet.nextX(ResultSet.java:250)\r\n        at org.apache.derby.client.am.ResultSet.next(ResultSet.java:240)\r\n\r\n\r\nThis occurs because  Network Server keys statements off of the PKGNAMCSCN which will be duplicated by the client incorrectly  in this case.  \r\nThe relevant server side code is in: org.apache.derby.impl.drda.Database:\r\nprotected DRDAStatement newDRDAStatement(Pkgnamcsn pkgnamcsn)\r\n\tthrows SQLException\r\n\t{\r\n\t\tDRDAStatement stmt = getDRDAStatement(pkgnamcsn);\r\n\t\tif (stmt != null) {\r\n\t\t\tstmt.close();\r\n\t\t\tstmt.reset();\r\n\t\t}\r\nIt closes the statement as soon as it gets the duplicate pkgnamcsn in.   Of course the problem is that the client code sends a dup, not that the server closes when it sees a dup, but I don't  know where that code is off the top of my head #:)\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-06-22T10:21:02.000+0000","updated":"2006-06-22T10:21:02.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12417240","id":"12417240","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Raising this to major as it can cause premature closing of the result set. and statement.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-06-22T10:30:33.000+0000","updated":"2006-06-22T10:30:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12417352","id":"12417352","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Well, I guess I have a little to say about the client code.\r\nIt looks like our client SectionManager logic is fatally flawed when it comes to two databases. It has these two static variables  for hold and non-hold  package names and consistency tokens.  \r\n\r\n// noHoldPKGNAMCBytes stores PKGNAMCBytes when holdability is no hold\r\n    public static byte[] holdPKGNAMCBytes = null;\r\n    public static byte[] noHoldPKGNAMCBytes = null;\r\n\r\nThere seems to be a databaseName parameter for each SectionManager, so I don't understand why these  are static.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-06-23T02:26:29.000+0000","updated":"2006-06-23T02:26:29.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12417392","id":"12417392","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Wish I could delete the comment but the early closed result set with is issue is not a valid symptom.  This wrong line caused the test to fail.  Should have been ps2.\r\n\r\nResultSet rs2 = ps.executeQuery(); ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-06-23T06:35:38.000+0000","updated":"2006-06-23T06:35:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12435827","id":"12435827","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Moving to 10.2.2.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-09-19T14:49:28.000+0000","updated":"2006-09-19T14:49:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12441150","id":"12441150","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"Just posting the message below to the right place:\r\n---\r\n\r\nWhen client creates multiple connections to different databases (through the JDBC driver), the DRDA protocol 'always' (I'm not sure if always but i have not found any situation when it does not) sends the same PKGNAMCSN block as the one used for a first created connection.\r\n\r\nThe reason of this behaviour is in a creation of the Section object in SectionManager using it's method 'getDynamicSection'. It creates the section by calling the\r\n\r\ngetSection(freeSections[Non]Hold_, packageNameWith[No]Hold__, cursorNamePrefixWith[No]Hold__, resultSetHoldability)\r\n\r\nwhich later calls the init method of the Section class with the parameter isGenerated = false. Due to this the buffer which is used to store the PKGNAMCSN is initialized to the value stored in Agent.SectionManager.holdPKGNAMCBytes - this field is declared static so the value is shared among all created connections. The reusing of the value from the buffer is probably only a performance improvement and if the value in a Section object (created with isGenerated = false) is not initialized it is generated on demand and also stored to SectionManager.holdPKGNAMCBytes.\r\n\r\nI would suggest removing the static modifier from the fields noHoldPKGNAMCBytes and holdPKGNAMCBytes of the org.apache.derby.client.am.SectionManager class. Each Connection objects holds its own Agent object which holds its own SectionManager object. Thus, the PKGNAMCSN blocks will be generated once for each Connection object. Is this right?\r\n\r\nHowever, the description of DRDA protocol looks like a PKGNAMCSN block is important to identify the correct server's sql executional package (I'm not an expert, it's only my opinion). How it is possible that sending a wrong PKGNAMCSN does not affect the database behavior? In the demonstration program on JIRA both connections connect to the same server instance. Might connecting these connections to different machines (or only server instances) lead to improper behavior? Why requests with the wrong PKGNAMCSN still work? I'll try two different machines tomorrow (approx. in 16 hours) and let you know.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-10-10T14:30:44.000+0000","updated":"2006-10-10T14:30:44.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12441210","id":"12441210","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"Two machines works fine. It seems that this behaviour does not have any influence on functionality.\r\n\r\nThe databaseName parameter from the PKGNAMCBytes is never used by the server. The database is assigned to DRDAConnThread instance only in these functions on the server:\r\n\r\norg.apache.derby.impl.drda.DRDAConnThread.parseACCRDB()\r\norg.apache.derby.impl.drda.DRDAConnThread.parseACCSEC()\r\norg.apache.derby.impl.drda.DRDAConnThread.parseSECCHK()\r\n\r\nThus, this behaviour should not cause using a wrong database (unless multiple databases are used in one session - which is  AFAIK not possible). The PKGNAMCSN is used in OPNQRY (used by PreparedStatement) to identify a statement in a org.apache.derby.impl.drda.Database.stmTable (by hashcode). However, the statement was even created with wrong PKGNAMCSN, so the hashes and even PKGNAMCSN of stored statement match.\r\n\r\nI observed a strange behaviour, when I changed the d1434.java (attached as d1434_v2.java) to insert multiple records in a database. The code in go method looks like (and behaves as described in comment).\r\n\r\nst.execute(\"create table FIRSTDB_T1 (i int, j int, k int)\"); // generates new PKGNAMCSN (but the same as before)\r\nst.execute(\"insert into FIRSTDB_T1 values (21, 22, 23)\");    // uses already generated PKGNAMCSN\r\nst.execute(\"insert into FIRSTDB_T1 values (22, 23, 24)\");    // generates new PKGNAMCSN (but the same as before)\r\nst.execute(\"insert into FIRSTDB_T1 values (23, 24, 25)\");    // uses already generated PKGNAMCSN\r\nst.execute(\"insert into FIRSTDB_T1 values (24, 25, 26)\");    // generates new PKGNAMCSN (but the same as before)\r\n\r\nst2.execute(\"create table SECONDDB_T1 (i int, j int, k int)\"); // uses already generated PKGNAMCSN\r\nst2.execute(\"insert into SECONDDB_T1 values (11, 12, 13)\");    // uses already generated PKGNAMCSN\r\nst2.execute(\"insert into SECONDDB_T1 values (12, 13, 14)\");    // uses already generated PKGNAMCSN\r\nst2.execute(\"insert into SECONDDB_T1 values (13, 14, 15)\");    // uses already generated PKGNAMCSN\r\nst2.execute(\"insert into SECONDDB_T1 values (14, 15, 16)\");    // uses already generated PKGNAMCSN\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-10-10T17:10:58.000+0000","updated":"2006-10-10T17:10:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12441455","id":"12441455","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"Sumarization of behaviour:\r\n\r\n1.) For each connection to a database a Session object is created on a server. It is processed by a separate DRDAConnThread instance thread.\r\n\r\n2.) The database is assigned to DRDAConnThread object from the RDBNAM codepoint from terms ACCRDB, ACCSEC or SECCHK, which works correctly.\r\n\r\n3.) The Section Number in PKGNAMCSN code point is sent always correctly. This causes no problem with processing terms like CNTQRY or CLSQRY. The corresponding DRDAStatement object is found by looking for the whole PKGNAMCSN content. Because the wrong PKGNAMCSN is sent all the time and processed by the same instance of DRDAConnThread - it works also fine. The corresponding statements are managed locally by DRDAConnThread instance and the right statement is identified by the section number which is sent correctly.\r\n\r\n3.) In case of these terms PRPSQLSTT, EXCSQLIMM, OPNQRY, CNTQRY, CLSQRY, PRPSQLSTT, DSCSQLSTT, EXCSQLSTT, the codepoint PKGNAMCSN is optional in DRDA DDM but is mandatory for Derby's implementation. Instead of sending PKGNAMCSN the PKGSN code point is sufficient. This might increase a performance a bit. Derby has also some optimalizations parsing the pkgnamcsn assuming that PKGNAMCSN is the same most of the time (I cannot see any case when it should differ).\r\n\r\nSmall note:\r\nCode point PKGNAMCSN is optional in EXCSQLSET (even not described by DRDA DDM, but sent only by jcc1.2 driver), but according the comments in parseEXCSQLSET it is also required (changing the comment is sufficient).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-10-11T13:26:21.000+0000","updated":"2006-10-11T13:26:21.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12441470","id":"12441470","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"The database is also choosed from RDBNAM code point also in these terms: \r\nOPNQRY, CNTQRY, PRPSQLSTT, DSCSQLSTT, EXCSQLSTT, EXCSQLIMM, EXCSQLSET, CLSQRY\r\n\r\nHowever, it have to be present in terms ACCRDB, ACCSEC or SECCHK in the connection before. If it is not, the error \"RDBNAM Mismatch\" is produced.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-10-11T14:43:14.000+0000","updated":"2006-10-11T14:43:14.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12444318","id":"12444318","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"Patch available.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-10-24T14:08:19.000+0000","updated":"2006-10-24T14:08:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12445055","id":"12445055","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"There was some discussion of this issue, and the possible fixes, on the developer list:\r\nhttp://www.nabble.com/DERBY-1434---Client-can-send-incorrect-database-name-to-server-after-having-made-multiple-connections-to-different-databases.-tf2389323.html#a6705919","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-10-27T01:04:08.000+0000","updated":"2006-10-27T01:04:08.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12450088","id":"12450088","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"I have to modify also a protocolTest.java because it was sending a wrong database name in PKGNAMCSN in all cases. I added two more tests.\r\n\r\n1.) drda protocol test to protocol.tests which ensures that the error of wrong RDBNAM field sent in PKGNAMCSN is handled correctly\r\n\r\n2.) junit test derbynet/DRDAProtocolTest.java which checks that on an application level the connections to different databases are handled correctly. The database files are not deleted yet after running a test. I have created a  \t DERBY-2087 to handle this.\r\n\r\nPlease review","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-11-15T16:19:33.000+0000","updated":"2006-11-15T16:19:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12450091","id":"12450091","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"I have to modify also a protocolTest.java because it was sending a wrong database name in PKGNAMCSN in all cases. I added two more tests.\r\n\r\n1.) drda protocol test to protocol.tests which ensures that the error of wrong RDBNAM field sent in PKGNAMCSN is handled correctly\r\n\r\n2.) junit test derbynet/DRDAProtocolTest.java which checks that on an application level the connections to different databases are handled correctly. The database files are not deleted yet after running a test. I have created a DERBY-2087 to handle this.\r\n\r\nPlease review my change.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-11-15T16:21:11.000+0000","updated":"2006-11-15T16:21:11.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12450097","id":"12450097","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"Sorry for a mess in uploaded files, my connection got broken during first upload.\r\n\r\nThese file describes my change:\r\n\r\nderby1434-try2.diff (attached multiple times, should have the same content)\r\nderby1434-try2.stat\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-11-15T16:24:18.000+0000","updated":"2006-11-15T16:24:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12450102","id":"12450102","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"Just want to add that I ran all the junit tests and derbyall harness suit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-11-15T16:31:09.000+0000","updated":"2006-11-15T16:31:09.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12452082","id":"12452082","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Hi Julo,\r\n\r\nI haven't followed the discussion about this bug closely enough to say\r\nwhether the fix is correct, but it looks like it follows the approach\r\nwhich was suggested in the discussion. The changes to the protocol\r\ntest also seem to be correct.\r\n\r\nA couple of questions/comments:\r\n\r\n - DRDAConnThread checks the version of the client. Is the check\r\n   correct? Shouldn't the condition be\r\n     (appRequester.getClientType() == AppRequester.DNC_CLIENT\r\n       && appRequester.greaterThanOrEqualTo(10,3,0)) ?\r\n\r\n - The class name in the copyright header in DRDAProtocolTest is wrong\r\n   (\"lang\" should be \"derbynet\").\r\n\r\n - I think it would be good if the test case in DRDAProtocolTest had a\r\n   comment which described what it is testing. Is it supposed to fail\r\n   without the fix? In my environment it runs successfully even when\r\n   the fix is not applied.\r\n\r\n - It seems like your editor is set up with tab stops at eight\r\n   characters. The Derby code uses tab stops at four characters, so\r\n   the indentation does not match the indentation of the surrounding\r\n   code. It would be good if you changed your tab settings and fixed\r\n   the indentation.\r\n\r\nThanks.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-11-22T23:46:18.000+0000","updated":"2006-11-22T23:46:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12452204","id":"12452204","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"Thanks for your comments. Sending a new version of a patch (*-try3.diff).\r\n\r\n- The condition is correct but the explanation in a comment was a bit different than the condition. The check should not be performed only for the DNC_CLIENT version less then 10.3.0. I updated the comment.\r\n\r\n- fixed\r\n\r\n- I described a bit. However the test does not test much. The test should succeed without a fix. It should fail only if you apply a fix without changes in SectionManager.\r\n\r\n- fixed\r\n\r\nI changed only comments and indentation so I only compiled the sources and run suites.All, no harness derbyall suite.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-11-23T11:08:24.000+0000","updated":"2006-11-23T11:08:24.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12452247","id":"12452247","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks for the explanations, Julo. They all make sense. So DRDAConnThread is supposed to check that the database name is correct if the DB2 client is used as well? Have you tested that it works with the DB2 client?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-11-23T14:00:54.000+0000","updated":"2006-11-23T14:00:54.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12452406","id":"12452406","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"The last sentense in the description of the issue states that the JCC driver works fine, so I have not tested this before.\r\n\r\nI tried to run the test program manually for DB2JCC and it works fine.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-11-24T10:14:45.000+0000","updated":"2006-11-24T10:14:45.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12452452","id":"12452452","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thank you. I ran derbyall and the JUnit tests with no failures. Committed revision 478877.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-11-24T13:33:49.000+0000","updated":"2006-11-24T13:33:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12455757","id":"12455757","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"body":"I think this will be a useful fix for the 10.2 branch also, can one of the committers look into porting the fix.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"created":"2006-12-05T21:14:21.000+0000","updated":"2006-12-05T21:14:21.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12455931","id":"12455931","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"This fix cannot be merged to 10.2 automatically because it depends on some changes to the JUnit framework that have not been back-ported. It also contains a version check which should be changed if we port the fix (this check should also be changed on trunk if we back-port the fix).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2006-12-06T09:14:48.000+0000","updated":"2006-12-06T09:14:48.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12344754/comment/12456741","id":"12456741","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"body":"Could we just remove the static modifier from the fields noHoldPKGNAMCBytes and holdPKGNAMCBytes of the org.apache.derby.client.am.SectionManager class in 10.2 branch and update the version check in trunk? So porting no tests for 10.2 branch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=julo","name":"julo","emailAddress":"julo at stroffek dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Julius Stroffek","active":true},"created":"2006-12-08T09:12:46.000+0000","updated":"2006-12-08T09:12:46.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1434/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i078o7:"}}