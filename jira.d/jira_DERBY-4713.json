{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12467879","self":"https://issues.apache.org/jira/rest/api/latest/issue/12467879","key":"DERBY-4713","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316362","id":"12316362","description":"First release on the 10.8 branch","name":"10.8.1.2","archived":false,"released":true,"releaseDate":"2011-04-29"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-06-26 17:31:44.827","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24424","customfield_12310222":"3_*:*_1_*:*_16884054199_*|*_1_*:*_1_*:*_67830_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-01-06T18:44:48.930+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4713/watchers","watchCount":1,"isWatching":false},"created":"2010-06-25T08:42:46.901+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"7.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12332883","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12332883","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"outwardIssue":{"id":"12401144","key":"DERBY-3801","self":"https://issues.apache.org/jira/rest/api/2/issue/12401144","fields":{"summary":"Convert \"org.apache.derbyTesting.functionTests.tests.lang.holdCursorIJ.sql\" to junit. ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-06-17T09:19:31.298+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"}],"timeoriginalestimate":null,"description":"If the default locale is not English, many subclasses of ScriptTestCase will fail. \r\n\r\nFor example, run NetIjTest (a subclass of ScriptTestcase)  in a Chinese OS, the test case will fail:\r\n\r\nD:\\derby\\test>java junit.textui.TestRunner org.apache.derbyTesting.functionTests\r\n.tests.derbynet.NetIjTest\r\n.F\r\nTime: 5.422\r\nThere was 1 failure:\r\n1) testclientij(org.apache.derbyTesting.functionTests.tests.derbynet.NetIjTest)j\r\nunit.framework.ComparisonFailure: Output at line 34 expected:<[ERROR 42X05: Tabl\r\ne/View 'APP.NOTTHERE' does not exist.]> but was:<[?? 42X05??????APP.NOTTHERE????\r\n?]>\r\n        at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon\r\n(CanonTestCase.java:106)\r\n        at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(Scr\r\niptTestCase.java:198)\r\n        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:\r\n109)\r\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:23)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:27)\r\n        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57\r\n)\r\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:23)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:27)\r\n        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57\r\n)\r\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:23)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:27)\r\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\r\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:23)\r\n        at junit.extensions.TestSetup.run(TestSetup.java:27)\r\n\r\nFAILURES!!!\r\nTests run: 1, Failures: 1, Errors: 0 \r\n\r\nWhile, it succeed running with a English-language lcoale.\r\n\r\nD:\\derby\\test>java -Duser.language=en junit.textui.TestRunner org.apache.derbyTe\r\nsting.functionTests.tests.derbynet.NetIjTest\r\n.\r\nTime: 6.187\r\n\r\nOK (1 test)","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36547","summary":"Subclasses of ScriptTestCase can not run correctly with the non-English default locale","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":12,"total":12,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12882868","id":"12882868","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Sounds like a good idea, since the script tests won't pass in any locale for which we have translations. Perhaps the LocaleTestSetup decorator could be used for this?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-06-26T17:31:44.827+0000","updated":"2010-06-26T17:31:44.827+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12883042","id":"12883042","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"body":"Thanks Knut. What you suggested works indeed!\r\n\r\nThere are two ways to resolve this issue. One is to do change directly in ScriptTeseCase, the other is to change all the affected subclasses. I chose the second one. As I think, maybe some future test cases will do testing baseing on non-English Locale, if we do change directly in ScriptTeseCase, we will lose expandability.\r\n\r\nPlease check the patch, thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"created":"2010-06-28T06:28:36.600+0000","updated":"2010-06-28T06:28:36.600+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12883092","id":"12883092","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks for the patch, Yun.\r\n\r\nI don't think we lose expandability by doing this directly in ScriptTestCase (or perhaps better: in its super-class CanonTestCase?), since we can always add a locale parameter to one of the constructors if we need support for non-English locales later. That's the approach that was taken for the input and output encoding. The advantage of doing it in ScriptTestCase is that it will automatically be done correctly for tests we add later, even if the person who writes the test forgets to wrap it in a LocaleTestSetup.\r\n\r\nI'm curious to know why the new constructor in LocaleTestSetup was needed. Couldn't the existing constructor be used with Locale.US as argument? I was thinking that preserving country and variant of the default locale could mean that things like dates and numbers are formatted differently, and that it would be more robust if we set all the components of the locale to known values.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-06-28T10:00:27.270+0000","updated":"2010-06-28T10:00:27.270+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12883160","id":"12883160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I agree it is better to change in ScriptTestCase and then if someone wanted some Locale specific test they could override the behavior.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-06-28T14:26:46.997+0000","updated":"2010-06-28T14:26:46.997+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12883443","id":"12883443","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"body":"I agree with both of your advice. It's a good to doing change in ScriptTestCase directly with a defined Locale.US. I will realize it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"created":"2010-06-29T07:14:29.521+0000","updated":"2010-06-29T07:14:29.521+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12884254","id":"12884254","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"body":"Ask for help！\r\n\r\nI have tried to do changing in ScriptTestSetup directly, just in the derby-4713-1.patch. However, it doesn't work as expected. Some  subclasses of ScriptTestSetupLangScripts, such as ImportExportIJTest, LangScripts, SURijTest and NistScripts (also a subclass of ScriptTestSetup) can not pass with a lot of '?' in the test result. I also attached bit.out (the output of bit test in LangScripts), in which you can see a lot of '?' in it.\r\n\r\nI have spent a lot of time on debugging this problem, but could not resolve it. I have also tried to do changing in CanonTestCase, the situation was also bad.  In my debugging, I'm sure , the default Locale has changed indeed and the runTest() method of ScriptTestCase was running in a US Locale. I have also tried to use some other Locale, such as \"en_CN\", but they all failed in the same situation.\r\n\r\nI have to ask for help to resolve this problem. As to my patch attcahed last time, it can works well for every test. It seems in the patch attached this time, ij has still run in a Locale not as expected. \r\n\r\nPlease give some advice, thanks very much!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"created":"2010-07-01T11:47:38.398+0000","updated":"2010-07-01T11:47:38.398+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12885238","id":"12885238","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Perhaps this happens because the default locale for a database is determined when the database is created, and the test harness reuses databases across tests. If that's the problem, we may get around it by creating a fresh database for these tests. See for example TestConfiguration.singleUseDatabaseDecorator().","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-07-05T13:55:04.932+0000","updated":"2010-07-05T13:55:04.932+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12885934","id":"12885934","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"body":"Knut, I have also test the TestConfiguration.singleUseDatabaseDecorator() just by your advice, it still failed. \r\n\r\nI have checked my last test result( not using TestConfiguration.singleUseDatabaseDecorator()), it seems, the default locale has been changed to US already. In CN locale, when the canon line is '0 rows inserted/updated/deleted', the output is '????????? 0 ?'. After do changing in ScriptTestSetup directly, this line is OK, and the test fails on this canon line 'ERROR 42X14: 'NCLOB' is not a column in table or VTI 'APP.B'.' with the output line 'ERROR 42X14: ?NCLOB????? VTI?APP.B?????'. In other words, it fails only on error prompt, and pass on common sql result. Anyone can tell us which situation will cause this problem, please?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"created":"2010-07-07T13:09:09.328+0000","updated":"2010-07-07T13:09:09.328+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12893830","id":"12893830","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I've played with this a bit. \r\nOf course, I have en_US for my locale. So I tried to change this by running the tests (junit.textui.TestRunner) with -Duser.language=zh_CN.\r\n\r\nThe second patch (patch1) didn't compile; I had to make an additional change to functionTests/util/IjTestCase - commenting out the 'throws Exception' in the setUp() method. As this IjTestCase is not currently used, I guess it doesn't matter so much.\r\n\r\nBoth the first (patch) and second (patch1) patches pass with English locale, and both have multiple failures with -Duser.language=zh_CN.\r\nAny suggestions on how to test the patches when in US/English locale?\r\n\r\nWhere did you try to put in Testconfiguration.singleUseDatabaseDecorator() when it failed? And in which way did that fail?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2010-07-29T21:19:39.359+0000","updated":"2010-07-29T21:19:39.359+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12898099","id":"12898099","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"body":"Hi,Myrna. I have been being puzzled about this issue for a long time. For the first patch, I did get it pass on my PC, but it failed in your environment. For the second patch, it should work accordingly with the first patch, but it still failed.\r\n\r\nAfter running applying the patch test time and time again, I think I have caught it, the two patch can work well --- while the second patch need remove the 'throws Exception' in the IJScriptTest.setUp() method. \r\n\r\nWhen run the test, it's best to clean and rebuild the project, clean the 'fail' document for test database. I've gotten all the subclasses of ScriptTestcase pass. \r\n\r\nIn derby-4732-2.patch, I removed  the 'throws Exception' in the IJScriptTest.setUp() method, the remaining parts are the same with derby-4732-1.patch.  Please verify it, thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yunlee","name":"yunlee","emailAddress":"yun dot lee dot bj at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yun Lee","active":true},"created":"2010-08-13T06:11:12.714+0000","updated":"2010-08-13T06:11:12.714+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/12978448","id":"12978448","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I've committed patch derby-4713-2 with revision 1055998.\r\n\r\nWith this patch, I did not see any unexpected test failures in a run of suites.All (sane build, classes - ibm 1.6 - I saw one intermittent server ping issue in testSetPortPriority and testPing failed for me).\r\n\r\nLooking at the code of the patch, it seemed ike it would be an improvement.\r\nRunning suites.All with -Duser.language=zh_CN I still saw a lot of failures, including some of the scriptTestCase tests, but I'm assuming that it's a problem with that setup, as Yun Lee said tests passed for him with the patch where before they failed.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2011-01-06T18:44:48.801+0000","updated":"2011-01-06T18:44:48.801+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12467879/comment/13685267","id":"13685267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"[bulk update] Close all resolved issues that haven't been updated for more than one year.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-06-17T09:19:31.289+0000","updated":"2013-06-17T09:19:31.289+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4713/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06mav:"}}