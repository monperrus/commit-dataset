{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12459154","self":"https://issues.apache.org/jira/rest/api/latest/issue/12459154","key":"DERBY-4582","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315343","id":"12315343","description":"Derby 10.6.2.1 Release","name":"10.6.2.1","archived":false,"released":true,"releaseDate":"2010-10-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315564","id":"12315564","description":"First release on the 10.7 branch.","name":"10.7.1.1","archived":false,"released":true,"releaseDate":"2010-12-14"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-03-15 16:15:40.45","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24350","customfield_12310222":"3_*:*_1_*:*_2248895531_*|*_1_*:*_1_*:*_1980429803_*|*_5_*:*_2_*:*_5126104047_*|*_4_*:*_1_*:*_1574864639","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-07-20T03:25:38.924+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4582/watchers","watchCount":1,"isWatching":false},"created":"2010-03-15T15:14:04.904+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_backport_reject_10_5","dst","gmt","settimestamp","timestamp"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"12.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314117","id":"12314117","description":"Next release after 10.5.2.0 release candidate #1","name":"10.5.3.0","archived":false,"released":true,"releaseDate":"2009-08-21"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12331435","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12331435","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"inwardIssue":{"id":"12462123","key":"DERBY-4615","self":"https://issues.apache.org/jira/rest/api/2/issue/12462123","fields":{"summary":"EmbedCallableStatement ignores Calendar in getDate, getTime and getTimestamp","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12331492","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12331492","type":{"id":"10032","name":"Blocker","inward":"is blocked by","outward":"blocks","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"},"inwardIssue":{"id":"12462540","key":"DERBY-4621","self":"https://issues.apache.org/jira/rest/api/2/issue/12462540","fields":{"summary":"Invalid conversion from Timestamp to String when calling setTimestamp() with Calendar","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12331617","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12331617","type":{"id":"12310010","name":"Incorporates","inward":"is part of","outward":"incorporates","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"},"outwardIssue":{"id":"12463127","key":"DERBY-4633","self":"https://issues.apache.org/jira/rest/api/2/issue/12463127","fields":{"summary":"Cache default calendar in result sets and statements on client driver","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}},{"id":"12332786","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12332786","type":{"id":"12310040","name":"Required","inward":"is required by","outward":"requires","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/12310040"},"inwardIssue":{"id":"12468384","key":"DERBY-4728","self":"https://issues.apache.org/jira/rest/api/2/issue/12468384","fields":{"summary":"10.5 backport effort tracking issue ","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/task.png","name":"Task","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-06-17T09:19:32.961+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"This issue only appears to happen in Network Server/Client mode.  Embedded mode does not have the issue.\r\n\r\nMy timezone is American/Chicago.  Saving timestamps with values for the 6 hours prior to DST start are being read back in as values 1 hour later than written.  (I believe the issue happens on the write because values written in Network Server/Client mode and read in Embedded mode are incorrect, while values written and read in Embedded mode are corect.)\r\n\r\nValues between 3/13/2010 - 20:00 CST and 3/14/2010 - 02:00 CST will return timstamps 1 hour off.  The \"setTimestamp\" method is being passed a GMT calendar with the timestamp:\r\n\r\nI have a complete test class I can attach, but here is a summary:\r\n\r\nprivate final TimeZone gmtTZ = TimeZone.getTimeZone(\"GMT\");\r\nprivate final Calendar gmtCal = Calendar.getInstance(gmtTZ);\r\n...\r\nString sql = \"INSERT INTO app.dst_test (id, gmt_timestamp, milli_time) VALUES(?,?,?)\";\r\nString sql2 = \"SELECT * from app.dst_test where id=?\";\r\n...\r\nps.setTimestamp(2, ts, gmtCal);\r\n...\r\nTimestamp tsRead = rs.getTimestamp(\"gmt_timestamp\", gmtCal);\r\n...\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10363","value":"Embedded/Client difference","id":"10363"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10366","value":"Wrong query result","id":"10366"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36636","summary":"Timestamps inserted with GMT calendar are 1 hour later when subsequently read with GMT calendar (Server Mode Only).","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keith13660","name":"keith13660","emailAddress":"keith dot kruse at helpsystems dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Kruse","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keith13660","name":"keith13660","emailAddress":"keith dot kruse at helpsystems dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Kruse","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Windows XP Professional Version 2002 Service Pack 3,  Central Standard Time Zone (America/Chicago)","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":36,"total":36,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12845358","id":"12845358","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keith13660","name":"keith13660","emailAddress":"keith dot kruse at helpsystems dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Kruse","active":true},"body":"Thanks for looking at this!\r\n\r\nThe test class has a \"dbmode\" enum variable that allows it to run in Client or Embedded mode.  The error only happend in Client mode.\r\n\r\nI run the test in the America/Chicago time zone.  The test timestamp data have to change to test in other timezones.\r\n\r\nI am including two sets of output from the test.  The first set shows failure in client mode (search for *FAILED).  The second set shows success in embedded mode.\r\n\r\nDatabase Mode:   CLIENT\r\nLocal Time Zone: Central Standard Time\r\nUsing Client Driver: org.apache.derby.jdbc.ClientDriver\r\nUsing Client URL: jdbc:derby://localhost:1527/C:\\temp\\dst_test_db;user=app;password=app;create=true\r\nDropping Table...\r\nCreating Table...\r\nMar 13, 2010 10:01:00 PM GMT\t(Mar 13, 2010 4:01:00 PM CST)\tok\t-> (Mar 13, 2010 10:01:00 PM GMT)\tWrote: 1268517660000\tRead: 1268517660000\r\nMar 13, 2010 11:01:00 PM GMT\t(Mar 13, 2010 5:01:00 PM CST)\tok\t-> (Mar 13, 2010 11:01:00 PM GMT)\tWrote: 1268521260000\tRead: 1268521260000\r\nMar 14, 2010 12:01:00 AM GMT\t(Mar 13, 2010 6:01:00 PM CST)\tok\t-> (Mar 14, 2010 12:01:00 AM GMT)\tWrote: 1268524860000\tRead: 1268524860000\r\nMar 14, 2010 1:01:00 AM GMT\t(Mar 13, 2010 7:01:00 PM CST)\tok\t-> (Mar 14, 2010 1:01:00 AM GMT)\tWrote: 1268528460000\tRead: 1268528460000\r\nMar 14, 2010 2:01:00 AM GMT\t(Mar 13, 2010 8:01:00 PM CST)\t*FAILED\t-> (Mar 14, 2010 3:01:00 AM GMT)\tWrote: 1268532060000\tRead: 1268535660000 Difference: 3600000\r\nMar 14, 2010 3:01:00 AM GMT\t(Mar 13, 2010 9:01:00 PM CST)\t*FAILED\t-> (Mar 14, 2010 4:01:00 AM GMT)\tWrote: 1268535660000\tRead: 1268539260000 Difference: 3600000\r\nMar 14, 2010 4:01:00 AM GMT\t(Mar 13, 2010 10:01:00 PM CST)\t*FAILED\t-> (Mar 14, 2010 5:01:00 AM GMT)\tWrote: 1268539260000\tRead: 1268542860000 Difference: 3600000\r\nMar 14, 2010 5:01:00 AM GMT\t(Mar 13, 2010 11:01:00 PM CST)\t*FAILED\t-> (Mar 14, 2010 6:01:00 AM GMT)\tWrote: 1268542860000\tRead: 1268546460000 Difference: 3600000\r\nMar 14, 2010 6:01:00 AM GMT\t(Mar 14, 2010 12:01:00 AM CST)\t*FAILED\t-> (Mar 14, 2010 7:01:00 AM GMT)\tWrote: 1268546460000\tRead: 1268550060000 Difference: 3600000\r\nMar 14, 2010 7:01:00 AM GMT\t(Mar 14, 2010 1:01:00 AM CST)\t*FAILED\t-> (Mar 14, 2010 8:01:00 AM GMT)\tWrote: 1268550060000\tRead: 1268553660000 Difference: 3600000\r\nMar 14, 2010 8:01:00 AM GMT\t(Mar 14, 2010 3:01:00 AM CDT)\tok\t-> (Mar 14, 2010 8:01:00 AM GMT)\tWrote: 1268553660000\tRead: 1268553660000\r\nMar 14, 2010 9:01:00 AM GMT\t(Mar 14, 2010 4:01:00 AM CDT)\tok\t-> (Mar 14, 2010 9:01:00 AM GMT)\tWrote: 1268557260000\tRead: 1268557260000\r\nMar 14, 2010 10:01:00 AM GMT\t(Mar 14, 2010 5:01:00 AM CDT)\tok\t-> (Mar 14, 2010 10:01:00 AM GMT)\tWrote: 1268560860000\tRead: 1268560860000\r\nDropping Table...\r\n\r\n\r\n\r\n\r\nDatabase Mode:   EMBEDDED\r\nLocal Time Zone: Central Standard Time\r\nUsing Embedded Driver: org.apache.derby.jdbc.EmbeddedDriver\r\nUsing Embedded URL: jdbc:derby:directory:C:\\temp\\dst_test_db;create=true\r\nDropping Table...\r\nCreating Table...\r\nMar 13, 2010 10:01:00 PM GMT\t(Mar 13, 2010 4:01:00 PM CST)\tok\t-> (Mar 13, 2010 10:01:00 PM GMT)\tWrote: 1268517660000\tRead: 1268517660000\r\nMar 13, 2010 11:01:00 PM GMT\t(Mar 13, 2010 5:01:00 PM CST)\tok\t-> (Mar 13, 2010 11:01:00 PM GMT)\tWrote: 1268521260000\tRead: 1268521260000\r\nMar 14, 2010 12:01:00 AM GMT\t(Mar 13, 2010 6:01:00 PM CST)\tok\t-> (Mar 14, 2010 12:01:00 AM GMT)\tWrote: 1268524860000\tRead: 1268524860000\r\nMar 14, 2010 1:01:00 AM GMT\t(Mar 13, 2010 7:01:00 PM CST)\tok\t-> (Mar 14, 2010 1:01:00 AM GMT)\tWrote: 1268528460000\tRead: 1268528460000\r\nMar 14, 2010 2:01:00 AM GMT\t(Mar 13, 2010 8:01:00 PM CST)\tok\t-> (Mar 14, 2010 2:01:00 AM GMT)\tWrote: 1268532060000\tRead: 1268532060000\r\nMar 14, 2010 3:01:00 AM GMT\t(Mar 13, 2010 9:01:00 PM CST)\tok\t-> (Mar 14, 2010 3:01:00 AM GMT)\tWrote: 1268535660000\tRead: 1268535660000\r\nMar 14, 2010 4:01:00 AM GMT\t(Mar 13, 2010 10:01:00 PM CST)\tok\t-> (Mar 14, 2010 4:01:00 AM GMT)\tWrote: 1268539260000\tRead: 1268539260000\r\nMar 14, 2010 5:01:00 AM GMT\t(Mar 13, 2010 11:01:00 PM CST)\tok\t-> (Mar 14, 2010 5:01:00 AM GMT)\tWrote: 1268542860000\tRead: 1268542860000\r\nMar 14, 2010 6:01:00 AM GMT\t(Mar 14, 2010 12:01:00 AM CST)\tok\t-> (Mar 14, 2010 6:01:00 AM GMT)\tWrote: 1268546460000\tRead: 1268546460000\r\nMar 14, 2010 7:01:00 AM GMT\t(Mar 14, 2010 1:01:00 AM CST)\tok\t-> (Mar 14, 2010 7:01:00 AM GMT)\tWrote: 1268550060000\tRead: 1268550060000\r\nMar 14, 2010 8:01:00 AM GMT\t(Mar 14, 2010 3:01:00 AM CDT)\tok\t-> (Mar 14, 2010 8:01:00 AM GMT)\tWrote: 1268553660000\tRead: 1268553660000\r\nMar 14, 2010 9:01:00 AM GMT\t(Mar 14, 2010 4:01:00 AM CDT)\tok\t-> (Mar 14, 2010 9:01:00 AM GMT)\tWrote: 1268557260000\tRead: 1268557260000\r\nMar 14, 2010 10:01:00 AM GMT\t(Mar 14, 2010 5:01:00 AM CDT)\tok\t-> (Mar 14, 2010 10:01:00 AM GMT)\tWrote: 1268560860000\tRead: 1268560860000\r\nDropping Table...\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keith13660","name":"keith13660","emailAddress":"keith dot kruse at helpsystems dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Kruse","active":true},"created":"2010-03-15T15:28:13.714+0000","updated":"2010-03-15T15:28:13.714+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12845392","id":"12845392","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Certain JDK implementations had out-of-date DST tables, with all the DST changes over the last few years.\r\n\r\nHave you verified that all of your JDK installations are fully patched?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2010-03-15T16:15:40.450+0000","updated":"2010-03-15T16:15:40.450+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12845406","id":"12845406","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keith13660","name":"keith13660","emailAddress":"keith dot kruse at helpsystems dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Kruse","active":true},"body":"I believe so:\r\n\r\nC:\\tzupdater-1.3.25-2009u>java -jar tzupdater.jar -u\r\n\r\nC:\\tzupdater-1.3.25-2009u>java -jar tzupdater.jar -t -v\r\njava.home: C:\\Program Files\\Java\\jre6\r\njava.vendor: Sun Microsystems Inc.\r\njava.version: 1.6.0_18\r\nJRE time zone data version: tzdata2009u\r\nEmbedded time zone data version: tzdata2009u\r\nValidating the time zone data\r\nValidation complete\r\n\r\n===   Starting Derby Server  ===\r\n\r\nC:\\db-derby-10.5.3\\bin>java -version\r\njava version \"1.6.0_18\"\r\nJava(TM) SE Runtime Environment (build 1.6.0_18-b07)\r\nJava HotSpot(TM) Client VM (build 16.0-b13, mixed mode, sharing)\r\n\r\nC:\\db-derby-10.5.3\\bin>startNetworkServer\r\n2010-03-15 16:49:22.094 GMT : Security manager installed using the Basic server security policy.\r\n2010-03-15 16:49:22.501 GMT : Apache Derby Network Server - 10.5.3.0 - (802917) started and ready to accept connections on port 1527\r\n\r\n===   Logging Java Runtime in test class===\r\n\r\nI added this to my test class:\r\n\r\n   log(\"Java Runtime Version: \" + System.getProperty(\"java.runtime.version\"));\r\n   log(\"Java Path: \" + System.getProperty(\"sun.boot.library.path\"));\r\n\r\nand I get:\r\n\r\n   Java Runtime Version: 1.6.0_18-b07\r\n   Java Path: C:\\Program Files\\Java\\jre6\\bin","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=keith13660","name":"keith13660","emailAddress":"keith dot kruse at helpsystems dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Keith Kruse","active":true},"created":"2010-03-15T16:58:53.480+0000","updated":"2010-03-15T16:58:53.480+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12854404","id":"12854404","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I see this too when I set the default timezone of my JVM to America/Chicago and run the test class. I also see the problem when I run with my local timezone (Central European time) and adjust the dates in the test to match the DST change in that timezone.\r\n\r\nIf I keep the table populated by the client/server test and run the embedded test against it, I also see the problem in the embedded test, so it seems that embedded and client actually end up writing different dates to the database.\r\n\r\nIf I do it the other way around, and run client/server tests against a table created by the embedded test, I still see the problem, but the number of discrepancies has been reduced from six to one. So it looks like we also have an issue with reading the values from the database.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-07T09:34:34.579+0000","updated":"2010-04-07T09:34:34.579+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12854866","id":"12854866","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I think I see what's going on now. The setTimestamp() method in the\r\nclient driver, and its siblings setTime() and setDate(), use the\r\nsupplied Calendar object to determine which timezone to convert the\r\ntimestamp to before storing it. The way it does this, is by adjusting\r\nthe timestamp by the same amount of time as the timezone difference\r\nbetween the supplied calendar and the default calendar.\r\n\r\nAlthough this adjustment will give the desired effect most of the\r\ntime, it is broken because it actually changes the timestamp to point\r\nto a different point in time. Therefore it will miss on the exact time\r\nof the DST changes with a couple of hours and we see these\r\ndiscrepancies. We should only use the calendar to change the\r\npresentation of timestamp, not to change its value.\r\n\r\nI did the following experiment with the client code:\r\n\r\n  1) removed the code that adjusts the timestamp value\r\n\r\n  2) passed the calendar object down to the code that writes the\r\n     timestamp to the network stream\r\n\r\n  3) used the calendar object to extract the timezone-adjusted date\r\n     and time out of the timezone\r\n\r\nSince in (3) we now have the unmodified timestamp value, there's no\r\nskew that confuses the conversion to the requested timezone, not even\r\naround time of the DST change.\r\n\r\nSo with these changes, the correct values were sent from the client to\r\nthe server. However, there was still one discrepancy between the\r\nvalues sent from the client and what's actually stored (this is an\r\nimprovement, though, since there were six discrepancies without the\r\nchange).\r\n\r\nThis last discrepancy was caused by the handling of the timestamp on\r\nthe server. The server does not use any Calendar object explicitly\r\nwhen parsing what it gets from the client or when storing the\r\ntimestamp in the database. The default timezone will therefore be used\r\nin the handling of the timestamp. So when the client sends the\r\ntimestamp 2010-03-14 02:01:00, which is a perfectly fine timestamp in\r\nthe GMT timezone and many other timezones, the server (or more\r\nprecisely, Timestamp.valueOf(String)) thinks the timestamp refers to a\r\npoint in time within the \"lost\" hour in the America/Chicago timezone,\r\nand it silently adjusts it to 03:01:00 so that it's valid in that\r\ntimezone too.\r\n\r\nSince we don't store the timezone together with the timestamp, it\r\ndoesn't matter much which timezone the server uses when handling it,\r\nas long as it's consistent. However, since timezones that observe DST\r\nlose one hour when switching to DST, calendars using that timezone\r\ncannot reliably be used to represent times in other timezones. If the\r\nserver instead had used a timezone that doesn't observe DST, like GMT,\r\nthe timestamp wouldn't change on its way from the wire to the database\r\neven if the timestamp on the wire is not a valid time in the local\r\ntimezone.\r\n\r\nWith this in mind, I extended my experiment with the following changes\r\nin the server code (DRDAConnThread):\r\n\r\n  4) when reading the (timezone-less) timestamp string sent from the\r\n     client, put the values into a Calendar object with timezone set\r\n     to GMT, and generate the timestamp from that Calendar\r\n\r\n  5) use setTimestamp(int,Timestamp,Calendar) instead of\r\n     setTimestamp(int,Timestamp) when passing the value to the\r\n     embedded driver, with the Calendar's timezone set to GMT\r\n\r\nThis took care of the last discrepancy and made the client/server\r\nsetup store the exact same values on disk as the embedded setup did.\r\n\r\nHowever, there's still one error when reading the values back to the\r\nclient, as noted in a previous comment about the incorrect reading of\r\nthe values generated by the embedded test. I haven't investigated this\r\nproblem yet, but I assume it's similar to the problems described\r\nabove.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-08T08:36:41.734+0000","updated":"2010-04-08T08:36:41.734+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12854868","id":"12854868","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attaching a patch that shows the experiment I ran (calendar.diff) where we let the Calendar objects do the conversion to the correct timezone instead of using our own homegrown algorithm. The patch is *not* intended for commit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-08T08:48:41.695+0000","updated":"2010-04-08T08:48:41.695+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12854916","id":"12854916","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attaching a patch with a JUnit regression test that exposes this bug. The test runs cleanly with the embedded driver and fails with the client driver. The patch also adds a new decorator that allows you to change the default timezone for a test suite (this decorator is used to force the test to use the America/Chicago timezone regardless of the local timezone).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-08T12:29:09.913+0000","updated":"2010-04-08T12:29:09.913+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12855745","id":"12855745","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attaching an updated patch for the JUnit test case. In the new patch, we also test that we get the expected results when setTimestamp() is used to set a DATE or TIME parameter, and when getDate() or getTime() is used to fetch a TIMESTAMP column. The test still runs cleanly with the embedded driver and fails with the client driver.\r\n\r\nI have committed the updated test case to trunk with revision 932930, but it's not yet enabled in any test suite.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-11T16:26:23.477+0000","updated":"2010-04-11T16:26:23.477+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12856436","id":"12856436","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attaching a new patch (upd-rs-test.diff) that makes DaylightSavingTest test yet another code path that's will be affected by the fix. The new test case uses an updatable result set to set the time values. The point of the test case is to verify that getDate/Time/Timestamp after updateDate/Time/Timestamp is able to do the timezone conversion correctly. The getters in the client result sets follow a different path to fetch the values from a separate data structure if the values have been updated locally.\r\n\r\nDaylightSavingTest is still not enabled in suites.All, as it only runs cleanly with the embedded driver.\r\n\r\nCommitted revision 933637.\r\n\r\nI'll hold off posting a fix for this issue until the fix for DERBY-2602 has been committed, as these two issues touch many of the same methods.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-13T14:34:25.271+0000","updated":"2010-04-13T14:34:25.271+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12856901","id":"12856901","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The fix for DERBY-2602 went in yesterday, so it should be OK to start working on the fix for this issue. It looks to me as if there are four bugs in the timestamp handling (and some of these also apply to date and time) that need to be solved:\r\n\r\n1) The time skew issue that makes the client miss on the exact time of the DST switch when converting from local tz to GMT\r\n\r\n2) Timestamps that are not valid in the local timezone are silently changed when the server reads them from the client\r\n\r\n3) Timestamps that are not valid in the local timezone are silently changed when the server reads them from the database\r\n\r\n4) Timestamps that are not valid in the local timezone are silently changed when the client reads them from the server\r\n\r\nFixing (1) will make the number of discrepancies in the original repro go down from six to one. But to get rid of the last discrepancy, we have to fix all of (2), (3) and (4).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-14T13:57:20.298+0000","updated":"2010-04-14T13:57:20.298+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12857249","id":"12857249","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"When I made some changes on the server to fix (3), I touched an area that was used to handle both CallableStatements and ResultSets. However, because of a bug (DERBY-4615) in the embedded implementation of CallableStatement.getTimestamp(int,Calendar) and friends, CallableStatements will only see half of the fix, and fixing the server code will therefore make the situation worse for CallableStatements until DERBY-4615. I think we should try to address DERBY-4615 before we attempt to fix (3), so that we don't introduce regressions for CallableStatements.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-15T09:51:03.838+0000","updated":"2010-04-15T09:51:03.838+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12858454","id":"12858454","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attached is a patch (derby-4582-1a-client-send.diff) that addresses\r\nissue (1) described above. That is, sending of date, time and\r\ntimestamp from the client.\r\n\r\nIt makes the following changes:\r\n\r\nA       java/client/org/apache/derby/client/am/DateTimeValue.java\r\n\r\nNew class that represents a Time, Date or Timestamp in a specified\r\ncalendar. This class preserves the representation of the time in the\r\nspecified calendar so that it's not affected by oddities in the local\r\ntimezone.\r\n\r\nM       java/client/org/apache/derby/client/am/PreparedStatement.java\r\n\r\nUse the new DateTimeValue class to represent values set by setDate(),\r\nsetTime() and setTimestamp().\r\n\r\nM       java/client/org/apache/derby/client/net/NetStatementRequest.java\r\n\r\nAccept that date, time and timestamp are also set as DateTimeValue,\r\nand convert values that still are represented by\r\njava.sql.{Date,Time,Timestamp} to DateTimeValue using the default\r\ncalendar.\r\n\r\nM       java/client/org/apache/derby/client/am/DateTime.java\r\nM       java/client/org/apache/derby/client/net/Request.java\r\n\r\nChange signatures for the methods that write dates and times to expect\r\nDateTimeValue instead of java.sql.{Date,Time,Timestamp}.\r\n\r\n\r\nAll the regression tests ran cleanly with the patch.\r\n\r\nThe patch reduces the number of failures from six to one in the\r\noriginal repro. It makes the client driver send the correct values to\r\nthe server for all the timestamps, but because of (2) one of them is\r\nstored incorrectly in the database.\r\n\r\nOne thing to note is that the patch now makes the client driver create\r\na new default calendar instance object each time one of the setters\r\nwith no calendar argument is called. We could easily cache a default\r\ncalendar instance in PreparedStatement to prevent this (like the\r\nembedded driver already does), but in order to keep the patches\r\nsmaller and easier to review, I'd like to postpone that optimization\r\nuntil after the bug has been fixed.\r\n\r\nOn the bright side, the methods that take calendar arguments used to\r\ncreate two calendar instances, but now they don't create any.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-19T11:02:27.713+0000","updated":"2010-04-19T11:02:27.713+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12858815","id":"12858815","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I committed the 1a patch, revision 935868.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-20T10:57:19.976+0000","updated":"2010-04-20T10:57:19.976+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12858882","id":"12858882","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I went on to working on issue (2). I had to make the server use the timestamp methods that take a Calendar argument. However, that exposed the bug DERBY-4621, which made ParameterMappingTest fail. So it seems there's yet another bug that needs to be addressed before we can make the final changes to this one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-20T13:39:50.419+0000","updated":"2010-04-20T13:39:50.419+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12858953","id":"12858953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Attached is a patch that addresses issue (2), when the server is receiving timestamps (or dates or times) from the client. The patch makes the server use the GMT timezone instead of the local timezone when it parses the timestamps, so that there are no holes in the range of valid values. With this patch, the repro still has one failure (because of issue 3 and 4), but now all the values are stored correctly in the database.\r\n\r\nWhen running the regression tests, ParameterMappingTest fails because the new code path in the server triggers DERBY-4621. The 2a patch should therefore not be committed before DERBY-4621 has been solved. I'm still attaching the patch here and setting the patch available flag.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-20T16:20:53.389+0000","updated":"2010-04-20T16:20:53.389+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12859265","id":"12859265","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Committed the 2a patch, revision 936218.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-21T09:17:50.788+0000","updated":"2010-04-21T09:17:50.788+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12859742","id":"12859742","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The attached patch derby-4582-3a-server-send.diff modifies DRDAConnThread to address issue (3). It makes the server use a GMT calendar when reading TIME, DATE or TIMESTAMP values out of the database, and uses the same GMT calendar to format the string representation that it sends to the client. This way, the value read from the database is not silently changed if it happens to represent a time that is not valid in the local time zone.\r\n\r\nWith this patch, the values are sent correctly from the client, stored correctly in the database and sent correctly back to the client. However, because of issue (4), there's still one value that's returned one hour off at the client.\r\n\r\nAll the regression tests ran cleanly with this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-22T08:34:07.950+0000","updated":"2010-04-22T08:34:07.950+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12860156","id":"12860156","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Committed the 3a patch with revision 937170.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-23T07:30:51.710+0000","updated":"2010-04-23T07:30:51.710+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12860907","id":"12860907","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Here's a patch to address issue (4), derby-4582-4a-client-receive.diff.\r\n\r\nThe patch makes the client driver use the specified calendar object\r\nwhen parsing the values received from the server. With this patch, the\r\noriginal repro runs cleanly, and so does all the test cases in\r\nDaylightSavingTest. I am currently running the rest of the regression\r\ntests.\r\n\r\nMore details about the changes:\r\n\r\nM       java/client/org/apache/derby/client/am/CrossConverters.java\r\n\r\n- Changed some method signatures to allow passing Calendar objects\r\n  further down.\r\n\r\n- Made date_valueOf(), time_valueOf() and timestamp_valueOf() use a\r\n  calendar when parsing the strings\r\n\r\nM       java/client/org/apache/derby/client/am/Cursor.java\r\n\r\n- Made the getters take a calendar and pass it to the parsing methods\r\n  in am.DateTime instead of passing an instance of the default\r\n  calendar\r\n\r\nM       java/client/org/apache/derby/client/am/ResultSet.java\r\nM       java/client/org/apache/derby/client/am/CallableStatement.java\r\n\r\n- Passed the calendar from getDate, getTime, getTimestamp to the\r\n  getters in am.Cursor\r\n\r\nM       java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/_Suite.java\r\n\r\n- Enabled DaylightSavingTest as part of suites.All","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-26T12:29:23.155+0000","updated":"2010-04-26T12:29:23.155+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12860959","id":"12860959","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"All the regression tests ran cleanly with the 4a patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-26T15:37:13.610+0000","updated":"2010-04-26T15:37:13.610+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12861452","id":"12861452","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Committed 4a to trunk with revision 938547.\r\n\r\nAll the patches up to 3a were committed before the 10.6 branch was created and are included in the 10.6.1.0 release candidate. The 4a patch is not on the 10.6 branch yet, but I intend to back-port it in a couple of days if the nightly regression tests don't show any problems.\r\n\r\nI think there still are some outstanding issues. I'll file separate JIRAs for those so that we can resolve this one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-27T16:58:30.220+0000","updated":"2010-04-27T16:58:30.220+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12861478","id":"12861478","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Some of the code added in the 4a patch wasn't exercised by any of the existing tests, so of course it contained a bug. I noticed that DaylightSavingTest failed if I changed it to insert the values into VARCHAR columns instead of TIMESTAMP, TIME and DATE. The problem was with the method in CrossConverters that parses the date portion of a DATE or a TIMESTAMP when converting from a VARCHAR value. It didn't take into account that java.util.Calendar counts months from 0.\r\n\r\nThe attached patch adds test cases that test conversion between VARCHAR and date/time values in DaylightSavingTest, and fixes the off-by-one-month bug.\r\n\r\nRunning the rest of the regression tests now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-27T18:07:28.737+0000","updated":"2010-04-27T18:07:28.737+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12861689","id":"12861689","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"All tests passed. Committed patch 5a with revision 938796.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-28T06:29:27.247+0000","updated":"2010-04-28T06:29:27.247+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12862130","id":"12862130","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The JUnit test case fails on the small device platforms because it uses some java.util.Date methods that are not part of the Foundation Profile 1.1 API. The attached patch (derby-4582-6a-javame.diff) makes the test use java.util.Calendar to extract fields from dates instead of the unsupported methods.\r\n\r\nCommitted revision 939231.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-04-29T08:48:27.430+0000","updated":"2010-04-29T08:48:27.430+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12863355","id":"12863355","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Merged the last three fixes to 10.6 and committed revision 940460.\r\nMarking as resolved.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-05-03T14:02:50.166+0000","updated":"2010-05-03T14:02:50.166+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12884444","id":"12884444","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"reopen for 10.5 back port","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-07-01T21:57:54.271+0000","updated":"2010-07-01T21:57:54.271+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12888168","id":"12888168","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Will work on backporting it to 10.5","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-07-14T03:28:11.195+0000","updated":"2010-07-14T03:28:11.195+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12888197","id":"12888197","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Sorry, didn't notice that Lily had already assigned this jira to herself for backporting. I have taken my name off of this jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2010-07-14T05:06:29.790+0000","updated":"2010-07-14T05:06:29.790+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12888203","id":"12888203","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Don't worry about it, Mamta. Yes, I will back port this to 10.5. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-07-14T05:35:18.418+0000","updated":"2010-07-14T05:35:18.418+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12889010","id":"12889010","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Wow! Porting to 10.5 for this issue is a little bit hairy. From reading all the comments, I figure I might only need to port changelist 940460.\r\nAfter executing 'svn merge -c940460 https://svn.apache.org/repos/asf/db/derby/code/branches/10.6/', I was able to compile 10.5 branch. Yeah! However, running DaylightSavingTest failed with the following message:\r\n1) testConversionToGMTAroundDSTChange(org.apache.derbyTesting.functionTests.test\r\ns.jdbcapi.DaylightSavingTest)junit.framework.AssertionFailedError: TS expected:<\r\n2010-03-13 20:01:00.0> but was:<2010-03-13 21:01:00.0>\r\n        at org.apache.derbyTesting.functionTests.tests.jdbcapi.DaylightSavingTes\r\nt.testConversionToGMTAroundDSTChange(DaylightSavingTest.java:129)\r\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\r\nI am thinking I will port more changes to try to fix this issue.\r\nI port changelist 936218 and 937170 with comment 'svn merge -c936218 https://svn.apache.org/repos/asf/db/derby/code/trunk/' and 'svn merge -c937170 https://svn.apache.org/repos/asf/db/derby/code/trunk/'. DaylightSavingTest is still giving me the same failure information and I am able to compile 10.5 branch. I am attaching the diff I have at this point with derby-4582-10.5.diff\r\n\r\nDue to the fact DaylightSavingTest is still failing, I then port changelist 935869. I was not able to compile 10.5 branch at this point.\r\nCompile failed at:\r\ncompile:\r\n    [javac] Compiling 141 source files to c:\\derby\\10.5\\classes\r\n    [javac] c:\\derby\\10.5\\java\\client\\org\\apache\\derby\\client\\net\\Request.java:1\r\n559: timestampToTimestampBytes(byte[],int,org.apache.derby.client.am.DateTimeVal\r\nue,boolean) in org.apache.derby.client.am.DateTime cannot be applied to (byte[],\r\nint,org.apache.derby.client.am.DateTimeValue)\r\n    [javac]             org.apache.derby.client.am.DateTime.timestampToTimestamp\r\nBytes(bytes_, offset_, timestamp);\r\n    [javac]                                                ^\r\nI notice my merge for Request.java at java/client/org/apache/derby/client/net/ is very different than the diff in JIRI DERBY-4582 http://svn.apache.org/viewvc/db/derby/code/trunk/java/client/org/apache/derby/client/net/Request.java?p2=%2Fdb%2Fderby%2Fcode%2Ftrunk%2Fjava%2Fclient%2Forg%2Fapache%2Fderby%2Fclient%2Fnet%2FRequest.java&p1=%2Fdb%2Fderby%2Fcode%2Ftrunk%2Fjava%2Fclient%2Forg%2Fapache%2Fderby%2Fclient%2Fnet%2FRequest.java&r1=935868&r2=935867&view=diff&pathrev=935868\r\nAt line 1553, I have diff as following:\r\n-    final void writeTimestamp(java.sql.Timestamp timestamp) throws SqlException\r\n {\r\n+    final void writeTimestamp(DateTimeValue timestamp) throws SqlException {\r\n         try{\r\n             ensureLength(offset_ + 26);\r\n             org.apache.derby.client.am.DateTime.timestampToTimestampBytes(bytes\r\n_, offset_, timestamp);\r\n\r\nI can try to manually change this. However, I have a feeling I might need to change Connection.java in order to have method serverSupportsTimestampNanoseconds\r\n\r\nShould I keep trying to port this issue to 10.5 branch? Any suggestion is welcome.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-07-16T05:02:21.571+0000","updated":"2010-07-16T05:02:21.571+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12889890","id":"12889890","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"I tried to use changelist 932930, 933637, 933726, 935868, 936218, 937170, 94046. changelist 933726 is a check-in for DERBY-2602 allows full JDBC nanosecond-precision in timestamps across the network. However, I am still having build problem and DaylightSavingTest still behave with DERBY-4582.\r\nIf there is no objection, I would recommend not back port to 10.5 branches for this issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-07-19T15:35:50.679+0000","updated":"2010-07-19T15:35:50.679+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12889913","id":"12889913","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I think that is fine Lily.  It doesn't sound like it is worth the effort for now.  Someday if someone really needs this fix they can work on the back port.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2010-07-19T16:47:03.799+0000","updated":"2010-07-19T16:47:03.799+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12889942","id":"12889942","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"This sounds great to me. Thank you so much, Kathey.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-07-19T17:48:04.163+0000","updated":"2010-07-19T17:48:04.163+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12890169","id":"12890169","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"This issue is not going to back port to 10.5. Reassign back to Knut.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-07-20T03:24:29.433+0000","updated":"2010-07-20T03:24:29.433+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/12890170","id":"12890170","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"body":"Change resolution back to fixed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=lilywei","name":"lilywei","emailAddress":"lilywei at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lily Wei","active":true},"created":"2010-07-20T03:25:38.864+0000","updated":"2010-07-20T03:25:38.864+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12459154/comment/13685276","id":"13685276","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"[bulk update] Close all resolved issues that haven't been updated for more than one year.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-06-17T09:19:32.959+0000","updated":"2013-06-17T09:19:32.959+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4582/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06mun:"}}