{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"31236","self":"https://issues.apache.org/jira/rest/api/latest/issue/31236","key":"DERBY-186","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-03-29 16:55:04.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21827","customfield_12310222":"1_*:*_1_*:*_679643000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_17000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2005-04-06T10:08:32.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-186/watchers","watchCount":0,"isWatching":false},"created":"2005-03-29T13:21:09.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10920","id":"10920","description":"initial source drop","name":"10.0.2.0","archived":false,"released":true,"releaseDate":"2004-08-30"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2005-04-06T10:08:49.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"}],"timeoriginalestimate":null,"description":"Bizarre error. Not sure if this is a JDBC, Derby, or Java issue.\n\nAn opened result set has 4 records. A call to relative(3) while on row 3 should result in isAfterLast=true, and isFirst, isBeforeFirst, and IsLast set to false. However, the result is isAfterLast=True and isFirst=True.\n\nij \nconnect 'IsAfter;create=true';\ncreate table x (a char(1)); \ninsert into x values '1','2','3','4';\nquit;\n\nimport java.sql.*; \n\npublic class ErrIsFirst {\n\n  public static void main(String argv[]) throws SQLException {\n\n    Connection conn = null;\n    Statement s = null;\n    ResultSet rs = null;\n    String DerbyDriver = \"org.apache.derby.jdbc.EmbeddedDriver\";\n    String returnValue;\n      \n    try {\n       Class.forName(DerbyDriver).newInstance();\n    }\n    catch (Exception NoDriver) {\n       System.out.println(\"Derby driver not found: \" + DerbyDriver);\n       NoDriver.printStackTrace();\n       System.exit(1);\n    }\n\n    try {\n      conn = DriverManager.getConnection(\"jdbc:derby:IsAfter\"); \n      s = conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_READ_ONLY); \n      rs = s.executeQuery( \"SELECT A FROM X\");\n\n      rs.next(); // First Record\n      returnValue = rs.getString(\"A\");     \n      System.out.println(\"Value=\"+returnValue); \n      \n      rs.relative(2);\n      System.out.println(\"isFirst=\" + rs.isFirst() + \" isLast=\" + rs.isLast() + \" isAfterLast=\" + rs.isAfterLast());\n      returnValue = rs.getString(\"A\");     \n      System.out.println(\"Value=\"+returnValue); \n\n      rs.relative(-2);\n      returnValue = rs.getString(\"A\");     \n      System.out.println(\"Value=\"+returnValue);\n      rs.relative(10);\n      System.out.println(\"isFirst=\" + rs.isFirst() + \" isLast=\" + rs.isLast() + \" isAfterLast=\" + rs.isAfterLast());\n      returnValue = rs.getString(\"A\");     \n      System.out.println(\"Value=\"+returnValue); \n      rs.close(); \n      s.close();\n    }\n    catch (SQLException se) {\n      String SQLState = se.getSQLState(); \n      String SQLMessage = se.getMessage();\n      System.out.println(\"Error = \"+SQLState);\n      System.out.println(SQLMessage);\n    }\n  }\n}\n\nThe results on my system are:\nValue=1\nisFirst=false isLast=false isAfterLast=false\nValue=3\nValue=1\nisFirst=true isLast=false isAfterLast=true\nError = 24000\nInvalid cursor state - no current row.\n\nIf you eliminate the first println call to isFirst() you get the following (correct) results.\n\nValue=1\nValue=3\nValue=1\nisFirst=false isLast=false isAfterLast=true\nError = 24000\nInvalid cursor state - no current row.\n\nOkay, so where did we go wrong?\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"41038","summary":"isFirst() returns true when relative(x) goes beyond result set","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=baklarz","name":"baklarz","emailAddress":"baklarz at ca dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Baklarz","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=baklarz","name":"baklarz","emailAddress":"baklarz at ca dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"George Baklarz","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Windows XP SP1 Professional","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":3,"total":3,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/31236/comment/61704","id":"61704","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"I guess the problem is not whether you make a call to isFirst() first or next. The way a call to relative() is behaving when the param passed to it is more than the number of rows, is what is causing the problem. \r\n\r\nI have small fix going for this which I am still testing. Will update when I get some results.\r\n\r\n~ Shreyas","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-03-29T16:55:04.000+0000","updated":"2005-03-29T16:55:04.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31236/comment/62232","id":"62232","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"Fix provided by Shreyas and committed to trunk version.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2005-04-06T10:08:32.000+0000","updated":"2005-04-06T10:08:32.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/31236/comment/62233","id":"62233","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"Fix checked in.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2005-04-06T10:08:49.000+0000","updated":"2005-04-06T10:08:49.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-186/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07e0v:"}}