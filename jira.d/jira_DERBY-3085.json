{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12378932","self":"https://issues.apache.org/jira/rest/api/latest/issue/12378932","key":"DERBY-3085","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312251","id":"12312251","description":"Head of 10.2 branch","name":"10.2.2.1","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312876","id":"12312876","description":"","name":"10.3.2.1","archived":false,"released":true,"releaseDate":"2007-12-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2007-09-24 16:07:06.994","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"23421","customfield_12310222":"1_*:*_1_*:*_791109416_*|*_6_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-10-01T23:31:55.541+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-3085/watchers","watchCount":0,"isWatching":false},"created":"2007-09-22T19:46:46.125+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"7.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-06-30T15:55:46.648+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"},{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"Java Version:    1.6.0_02\nJava Vendor:     Sun Microsystems Inc.\nJava home:       C:\\Program Files\\Java\\jre1.6.0_02\nJava classpath:  derbytools.jar\nOS name:         Windows XP\nOS architecture: x86\nOS version:      5.1\nJava user name:  Ma\nJava user home:  C:\\Documents and Settings\\ma\nJava user dir:   c:\\tools\\derby\\lib\njava.specification.name: Java Platform API Specification\njava.specification.version: 1.6\n--------- Derby Information --------\nJRE - JDBC: Java SE 6 - JDBC 4.0\n[C:\\tools\\derby\\lib\\derbytools.jar] 10.3.1.4 - (561794)\n\nThe following code fails:\n    // Data is a byte[] vector\n    ByteArrayInputStream is = new ByteArrayInputStream( data);    \n    String sql = \"UPDATE MyTable SET FContents=? WHERE FName='\" + name + \"'\";\n    PreparedStatement ps = conn.prepareStatement( sql);\n    ps.setBinaryStream( 1, is, data.length);\n    \n    if( ps.executeUpdate() == 0)\n    {\n        // it throws an exception here if the data array us larger then around 32750 bytes!!!\n    }\n\nIt look's like when the size of the data[] vector is > 32750 bytes or so it throws an exception like this:\njava.sql.SQLException: A network protocol error was encountered and the connection has been terminated: A PROTOCOL Data Stream Syntax Error was detected.  Reason: 0x0. Plaintext connection attempt to an SSL enabled server?\n        at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)\n        at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)\n        at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)\n\nThe table is defined as:\n    CREATE TABLE MyTable (FName varchar(300) NOT NULL,FContents BLOB(16M) NOT NULL)\n\nIt does loook like this only happens with the NetWork client driver, the embedded driver works fine.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10420","value":"Regression","id":"10420"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38820","summary":"Fails to handle BLOB fields with a PreparedStatement with size >32750 bytes","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikael_aronsson","name":"mikael_aronsson","emailAddress":"mikael-aronsson at telia dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mikael Aronsson","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10102","value":"Patch Available","id":"10102"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikael_aronsson","name":"mikael_aronsson","emailAddress":"mikael-aronsson at telia dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mikael Aronsson","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Windows XP SP2","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":10,"total":10,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12529904","id":"12529904","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Looks like this regressed with revision 438478 of DERBY-1559\r\nhttp://svn.apache.org/viewvc?view=rev&revision=438478\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-09-24T16:07:06.994+0000","updated":"2007-09-24T16:07:06.994+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12529913","id":"12529913","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"If there is a row that needs to be updated the update will succeed.  The issue seems to be in the handling of the warning: \"No row was found for FETCH, UPDATE or DELETE; or the result of a query is an empty table\"\r\n\r\n\r\nAttached are \r\nTestBlob.java  (small java repro)\r\ntrace.out.norows (client side trace when there are no rows in the table)\r\ntrace.out.withrow(client side trace when there is a row in the table and the program succeeds.)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-09-24T16:52:15.673+0000","updated":"2007-09-24T16:52:15.673+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12530492","id":"12530492","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I think the problem is not the warning itself.  I changed the embedded code to not add the warning and saw the same protocol error even though the warning was not sent. I tend to think the trouble is that in the even there are no matching rows, The entire stream is not consumed, since it is not needed to update the row. This leaves the DDMReader pointing to the middle of the parameter data when it is ready to read the next DSS.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-09-26T17:19:08.950+0000","updated":"2007-09-26T17:19:08.950+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12530547","id":"12530547","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Well, I guess the question now is whether the remaining data in the input stream should be read by embedded or by Network Server.  The javadoc for setBinaryStream says:\r\n\r\nSets the designated parameter to the given input stream, which will have the specified number of bytes. When a very large binary value is input to a LONGVARBINARY  parameter, it may be more practical to send it via a java.io.InputStream object. The data will be read from the stream as needed until end-of-file is reached.\r\n\r\n\r\nSo I think that it makes it clear that embedded is only obligated to read the stream \"as needed\", so I think I will pursue a solution where the Network Server tracks the parameter input streams and drains them after execution if they have not been drained by the execution of the statement.  Does that sound like the right approach?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-09-26T20:27:49.528+0000","updated":"2007-09-26T20:27:49.528+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12530851","id":"12530851","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Attached is a patch to resolve this issue.  My solution was to store a reference to the stream for the streamed parameter in the DRDAStatement.paramState and then drain the stream after statement execution if needed.  There is only one parameter ever streamed, so only one field needed to be added.  I added a test for both BLOB's and CLOB's to Blob4ClobTest.java.  Tests are running now.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-09-27T21:34:47.226+0000","updated":"2007-09-27T21:34:47.226+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12530910","id":"12530910","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Tests passed except for demo/checkToursDB which I don't think could be related as it is not network server related.\r\n\r\nPlease review patch derby-3085_diff.txt\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-09-28T04:33:52.991+0000","updated":"2007-09-28T04:33:52.991+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12531116","id":"12531116","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Hi Kathey,\r\n\r\nI don't have much experience in this area of code, but from what I could tell the patch looks good.  The changes are nicely contained and easy to understand, and I verified that the new regression test case fails without the patch and passes with it.\r\n\r\nSo +1 from me, inexperienced with LOBs though I am...\r\n\r\nI did have the following minor comments/suggestions, but none of these is worth blocking the commit of your changes:\r\n\r\n1 - Your comment above says \"There is only one parameter ever streamed\", and a similar comment in the patch says \"Only the last parameter with an EXTDTA will be streamed.\"  It might be nice to have more of a \"why\" in the code comment, or else a reference to another place that explains this more. As a reader of the patch, that was the first thing I found myself wondering, and I was not able to find an explanation in the (very) brief scanning that I did.\r\n\r\n2 - It looks like we drain the buffer 1000 bytes at a time; is that just a randomly chosen number? I'm guessing it is but just thought I'd ask.  If the number itself is not significant, a quick comment saying as much might make it easier for people to change it in the future if needed (for whatever reason).\r\n\r\n3 - Is it possible to add a test case where we have multiple stream parameters, just to make sure that things still work in that case, too? Ex. add a second lob column to \"testing\" table and then a second parameter to the UPDATE statement?\r\n\r\n3 - It looks like the regression test added for this issue only tests the case of a \"testing\" table with no rows.  Would it be worth it (as a sanity check) to also test the situation where there are rows in the table but the UPDATE predicate does not match any of the rows?  I assume that such an UPDATE will behave the same as when there are no rows, but it may be useful to verify.\r\n\r\n4 - Looks like there may be some slight spacing inconsistencies within the changed code for DRDAStatement.java.\r\n\r\nAs I said, all of these comments are minor.  The patch looks good overall.  Thank you for picking this issue up and for resolving it so quickly!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2007-09-28T18:47:03.321+0000","updated":"2007-09-28T18:47:03.321+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12531142","id":"12531142","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"I, too, don't immediately see why this situation only arises with at most a single parameter, so if it's easy to explain, that would help educate me. Thanks!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2007-09-28T20:09:44.013+0000","updated":"2007-09-28T20:09:44.013+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12531147","id":"12531147","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Attached is a revised patch with the changes suggested by Army.  \r\n1) Added commment to preexisting code which only streams last EXTDTA. I hope my understanding of this is correct. In readAndSetAllExtParams we now have.\r\n // Only the last EXTDTA is streamed.  This is because all of \r\n // the parameters have to be set before execution and are \r\n // consecutive in the network server stream, so only the last\r\n// one can be streamed.\r\nfinal boolean doStreamLOB = (streamLOB && i == numExt -1);\r\n\r\n- Added tests for multiple parameters, matched updates where the stream is consumed and situation where there is a row inserted but no match \r\n\r\n- Fixed tab/space differences (I think).\r\n\r\n- added comments that 1000 byte buffer for draining the stream is just a random selection that doesn't take up too much memory.\r\n\r\nI only ran BlobClob4BlobTest as all other changes were cosmetic.\r\n\r\nThanks Army and Bryan for looking at the patch.\r\n\r\nKathey\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-09-28T20:26:39.946+0000","updated":"2007-09-28T20:26:39.946+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12378932/comment/12531177","id":"12531177","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Thank you for the second patch, Kathey.  The whitespace issues in DRDAStatement are still hanging around near the \"do-while\" loop, but that's really not a big deal.  (For what it's worth, I usually run the \"cat\" command on a patch as that seems to show spacing issues pretty clearly: \"cat derby-3085_diff2.txt | more\").\r\n\r\nI have no further review comments to suggest. +1 to commit.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2007-09-28T22:04:00.348+0000","updated":"2007-09-28T22:04:00.348+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-3085/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i070bz:"}}