{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12343847","self":"https://issues.apache.org/jira/rest/api/latest/issue/12343847","key":"DERBY-1368","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-06-02 22:41:13.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22464","customfield_12310222":"1_*:*_1_*:*_566599000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_2_*:*_6654622683_*|*_4_*:*_1_*:*_47654370053","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2008-01-08T18:47:54.053+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1368/watchers","watchCount":0,"isWatching":false},"created":"2006-06-02T16:30:25.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12310615","id":"12310615","description":"","name":"10.1.2.1","archived":false,"released":true,"releaseDate":"2005-11-18"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-02-27T19:43:36.735+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"}],"timeoriginalestimate":null,"description":"reading the 'length()' of a blob reads a previously aquired binary stream.\n\ntest case:\n\n    public static void main(String[] argv) throws Exception {\n        String driver = \"org.apache.derby.jdbc.EmbeddedDriver\";\n        String url = \"jdbc:derby:derby/test;create=true\";\n        Class.forName(driver);\n        Connection con = DriverManager.getConnection(url, \"sa\", \"\");\n        con.setAutoCommit(true);\n\n        // create table\n        System.out.println(\"1) creating table...\");\n        Statement stmt = con.createStatement();\n        stmt.execute(\"create table T1 (ID char(32) PRIMARY KEY, DATA blob(2G) not null)\");\n        stmt.close();\n\n        // add row\n        System.out.println(\"2) adding row...\");\n        byte[] data = new byte[1024*1024*1];\n        data[0] = 1;\n        data[1] = 2;\n\n        PreparedStatement s = con.prepareStatement(\"insert into T1 (ID, DATA) values (?, ?)\");\n        s.setString(1, \"id\");\n        s.setBytes(2, data);\n        s.execute();\n        s.close();\n\n        // read row\n        System.out.println(\"3) reading row...\");\n        s = con.prepareStatement(\"select DATA from T1 where ID = ?\");\n        s.setString(1, \"id\");\n        s.execute();\n        ResultSet rs = s.getResultSet();\n        rs.next();\n        Blob b = rs.getBlob(1);\n\n        // test output\n        System.out.println(\"4) Length: \" + b.length());\n        InputStream in = b.getBinaryStream();\n        System.out.println(\"   First Byte: \" + in.read());\n        in.close();\n\n        in = b.getBinaryStream();\n        System.out.println(\"5) Length: \" + b.length());\n        System.out.println(\"   First Byte: \" + in.read());\n        in.close();\n\n        rs.close();\n        s.close();\n        con.close();\n    }\n\n\ngives:\n\n1) creating table...\n2) adding row...\n3) reading row...\n4) Length: 1048576\n   First Byte: 1\n5) Length: 1048576\n   First Byte: -1\n\nimo, 5) is wrong.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39536","summary":"EOFException when reading from blob's binary stream","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tripod","name":"tripod","emailAddress":"tripod at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tripod&avatarId=17636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tripod&avatarId=17636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tripod&avatarId=17636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tripod&avatarId=17636"},"displayName":"Tobias Bocanegra","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tripod","name":"tripod","emailAddress":"tripod at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tripod&avatarId=17636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tripod&avatarId=17636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tripod&avatarId=17636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tripod&avatarId=17636"},"displayName":"Tobias Bocanegra","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":15,"total":15,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12414446","id":"12414446","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I think this is fixed for most cases in the 10.2/trunk line. For any newly inserted value it will be. In some cases with an value from an upgraded database it will not be, though your test program will not show that case.  In most cases now the length is stored with the value, if not the first call to length() on the Blob will save the determined value.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-06-02T22:41:13.000+0000","updated":"2006-06-02T22:41:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12415444","id":"12415444","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"body":"I took the testcase code snippet  and ran the program  Derby1368 on 10.2.0.3 alpha classes ( 412194) and it works OK as Dan pointed out.   \r\n\r\nHere is the output:\r\nC:\\TESTING>java Derby1368\r\n1) creating table...\r\n2) adding row...\r\n3) reading row...\r\n4) Length: 1048576\r\n First Byte: 1\r\n5) Length: 1048576\r\n First Byte: 1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skambha","name":"skambha","emailAddress":"ksunithaghm at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sunitha Kambhampati","active":true},"created":"2006-06-09T05:51:27.000+0000","updated":"2006-06-09T05:51:27.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12415445","id":"12415445","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"This test passed against the trunk  as Dan supposed, the problem is fixed there.  Marking\r\nit fixed against the trunk.  If it needs to get back ported, one will have to find the actual change - \r\nthere is no change associated with this jira.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2006-06-09T05:53:44.000+0000","updated":"2006-06-09T05:53:44.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12418747","id":"12418747","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"This issue was marked Fixed with no comments, but I verified the  program output on 10.2\r\n$ java Derby1368\r\n1) creating table...\r\n2) adding row...\r\n3) reading row...\r\n4) Length: 1048576\r\n First Byte: 1\r\n5) Length: 1048576\r\n First Byte: 1\r\n\r\nSo it does seem to be fixed but don't know exactly what fixed it.\r\nPerhaps Tobias can close if the fix is ok.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-07-01T08:00:07.000+0000","updated":"2006-07-01T08:00:07.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12419350","id":"12419350","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I think this will still be an issue if the binary value passed in does not have a length associated with it, e.g. with the new methods added in JDBC 4.0 by DERBY-1417","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-07-06T05:28:24.000+0000","updated":"2006-07-06T05:28:24.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12435833","id":"12435833","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Moving to 10.2.2.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2006-09-19T14:52:45.000+0000","updated":"2006-09-19T14:52:45.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12458247","id":"12458247","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"No one is working on it at the moment.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2006-12-13T19:43:02.000+0000","updated":"2006-12-13T19:43:02.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12477155","id":"12477155","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","emailAddress":"bayard at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true},"body":"http://jira.opensymphony.com/browse/QUARTZ-560 appears to be a similar problem. An empty blob (I think) goes in and when it comes out it sometimes fires an EOFException.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","emailAddress":"bayard at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true},"created":"2007-03-02T01:23:00.644+0000","updated":"2007-03-02T01:23:00.644+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12534928","id":"12534928","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"This looks fixed with 10.3\r\n\r\n[C:/kmarsden/repro/DERBY-1368] java TestDerby1368\r\n1) creating table...\r\n2) adding row...\r\n3) reading row...\r\n4) Length: 1048576\r\n First Byte: 1\r\n5) Length: 1048576\r\n First Byte: 1\r\n\r\nI will leave it open to add a test.\r\n\r\nKathey\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-10-15T18:21:13.991+0000","updated":"2007-10-15T18:21:13.991+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12551946","id":"12551946","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Attaching a test for this issue. I added it into the JDBC4 tests so that we could test with lengthless overrides, since Dan had indicated that that might be a problem, but all seems to work fine.\r\n\r\nIt also works fine calling getBinaryStream twice on the Blob as in the repro.  That also works fine with the patch for DERBY-2892.  \r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-12-14T21:34:06.868+0000","updated":"2007-12-14T21:34:06.868+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12553387","id":"12553387","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"I had a look at the test, and it looks good to me. I ran the test with and without the patch and observed that the test count changed (98 vs 100). The test succeeded.\r\n\r\nI have two questions:\r\n a) Is the test all about getting the stream and the length twice? If so, maybe the JavaDoc could say this.\r\n b) Would it add any value to the test if we drained the stream before getting the stream the second time?\r\n c) Would it make sense to also run this with the JDBC-method taking a length argument?\r\n\r\nFYI, I noticed there is now a dropTable method in BaseJDBCTestCase, but I'm not sure it adds value in this test.\r\n\r\n+1 to commit","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2007-12-19T15:55:47.765+0000","updated":"2007-12-19T15:55:47.765+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12556756","id":"12556756","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Kristian asked ..\r\n>a) Is the test all about getting the stream and the length twice? If so, maybe the JavaDoc could say this.\r\n\r\nI went back to 10.1 and tested the repro, it does in fact require you get the stream and length twice. Added this to the javadoc, but I am not actually sure if this is a legal operation.\r\n\r\n> b) Would it add any value to the test if >we drained the stream before getting >the stream the second time?\r\nI don't know if it adds value but I added the draining of the stream.\r\n\r\n c) Would it make sense to also run this with the JDBC-method taking a length argument?\r\n\r\nadded this.\r\n\r\nSee new patch derby-1368_diff2.txt\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-01-07T23:02:31.737+0000","updated":"2008-01-07T23:02:31.737+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12556974","id":"12556974","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Per Dan's comment this has been fixed since 10.2.  I added a test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-01-08T18:47:54.014+0000","updated":"2008-01-08T18:47:54.014+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12557188","id":"12557188","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"I see the test has been committed ('derby-1368_diff2.txt'). Thanks for working on it Kathey!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2008-01-09T09:08:57.701+0000","updated":"2008-01-09T09:08:57.701+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343847/comment/12573048","id":"12573048","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tripod","name":"tripod","emailAddress":"tripod at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tripod&avatarId=17636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tripod&avatarId=17636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tripod&avatarId=17636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tripod&avatarId=17636"},"displayName":"Tobias Bocanegra","active":true},"body":"thanks for fixing this.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tripod","name":"tripod","emailAddress":"tripod at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=tripod&avatarId=17636","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tripod&avatarId=17636","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tripod&avatarId=17636","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tripod&avatarId=17636"},"displayName":"Tobias Bocanegra","active":true},"created":"2008-02-27T19:43:36.728+0000","updated":"2008-02-27T19:43:36.728+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1368/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i074r3:"}}