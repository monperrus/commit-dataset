{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12349881","self":"https://issues.apache.org/jira/rest/api/latest/issue/12349881","key":"DERBY-1849","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-09-28 05:10:12.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22749","customfield_12310222":"1_*:*_1_*:*_5624611000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_44308000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-11-18T03:33:04.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1849/watchers","watchCount":0,"isWatching":false},"created":"2006-09-14T01:09:33.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-07-01T00:09:09.149+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11413","id":"11413","name":"Test"}],"timeoriginalestimate":null,"description":"The diff for grantRevokeDDL.sql is big, hence attaching. \n\nFor  lang/grantRevokeDDL2.sql  the diff is as follows:\n\n********* Diff file derbyall/derbylang/grantRevokeDDL2.diff\n*** Start: grantRevokeDDL2 jdkJ2ME Foundation Specification v1.0 derbyall:derbylang 2006-09-10 11:42:23 ***\n0a1\n> java.lang.reflect.InvocationTargetException: java.lang.NullPointerException\n99 del\n< ERROR: Failed with SQLSTATE 38001\n99a100\n> ERROR: Failed with SQLSTATE XJ001\n119 del\n< ERROR: Failed with SQLSTATE 38002\n119a120\n> ERROR: Failed with SQLSTATE XJ001\n139 del\n< ERROR: Failed with SQLSTATE 38002\n139a140\n> ERROR: Failed with SQLSTATE XJ001\n158 del\n< 1 row inserted/updated/deleted\n158a159,160\n> ERROR: Failed with SQLSTATE 38000\n> ERROR: Failed with SQLSTATE XJ001\n163 del\n< 0 rows selected\n163a165,166\n> 4          |XYZ            \n> 1 row selected\n168a172,182\n> ERROR: Failed with SQLSTATE 28508\n> ij(USER2)> set connection user1;\n> ij(USER1)> create trigger revoke_select_trig AFTER delete on t1 \n> \tfor each STATEMENT mode db2sql call revoke_select_proc1();\n> 0 rows inserted/updated/deleted\n> ij(USER1)> -- should fail\n> delete from t1 where i = 5;\n> ERROR: Failed with SQLSTATE 38000\n> ERROR: Failed with SQLSTATE XJ001\n> ij(USER1)> -- check delete failed\n> select * from t1 where i = 5;\n171,184d184\n< 1          |XYZ            \n< 1 row selected\n< ij(USER2)> set connection user1;\n< ij(USER1)> create trigger revoke_select_trig AFTER delete on t1 \n< \tfor each STATEMENT mode db2sql call revoke_select_proc1();\n< 0 rows inserted/updated/deleted\n< ij(USER1)> -- should fail\n< delete from t1 where i = 5;\n< ERROR: Failed with SQLSTATE 38000\n< ERROR: Failed with SQLSTATE 38001\n< ij(USER1)> -- check delete failed\n< select * from t1 where i = 5;\n< I          |B              \n< ---------------------------\n191a192,202\n> ERROR: Failed with SQLSTATE 28508\n> ij(USER2)> set connection user1;\n> ij(USER1)> create trigger revoke_select_trig AFTER delete on t1 \n> \tfor each STATEMENT mode db2sql call revoke_select_proc2();\n> 0 rows inserted/updated/deleted\n> ij(USER1)> -- should fail\n> delete from t1 where i = 6;\n> ERROR: Failed with SQLSTATE 38000\n> ERROR: Failed with SQLSTATE XJ001\n> ij(USER1)> -- check delete failed\n> select * from t1 where i = 6;\n194,207d204\n< 1          |XYZ            \n< 1 row selected\n< ij(USER2)> set connection user1;\n< ij(USER1)> create trigger revoke_select_trig AFTER delete on t1 \n< \tfor each STATEMENT mode db2sql call revoke_select_proc2();\n< 0 rows inserted/updated/deleted\n< ij(USER1)> -- should fail\n< delete from t1 where i = 6;\n< ERROR: Failed with SQLSTATE 38000\n< ERROR: Failed with SQLSTATE 38002\n< ij(USER1)> -- check delete failed\n< select * from t1 where i = 6;\n< I          |B              \n< ---------------------------\n214a212,222\n> ERROR: Failed with SQLSTATE 28508\n> ij(USER2)> set connection user1;\n> ij(USER1)> create trigger revoke_select_trig AFTER delete on t1 \n> \tfor each STATEMENT mode db2sql call revoke_select_proc3();\n> 0 rows inserted/updated/deleted\n> ij(USER1)> -- should fail\n> delete from t1 where i = 7;\n> ERROR: Failed with SQLSTATE 38000\n> ERROR: Failed with SQLSTATE XJ001\n> ij(USER1)> -- check delete failed\n> select * from t1 where i = 7;\n217,230d224\n< 1          |XYZ            \n< 1 row selected\n< ij(USER2)> set connection user1;\n< ij(USER1)> create trigger revoke_select_trig AFTER delete on t1 \n< \tfor each STATEMENT mode db2sql call revoke_select_proc3();\n< 0 rows inserted/updated/deleted\n< ij(USER1)> -- should fail\n< delete from t1 where i = 7;\n< ERROR: Failed with SQLSTATE 38000\n< ERROR: Failed with SQLSTATE 38002\n< ij(USER1)> -- check delete failed\n< select * from t1 where i = 7;\n< I          |B              \n< ---------------------------\n237a232,242\n> ERROR: Failed with SQLSTATE 28508\n> ij(USER2)> set connection user1;\n> ij(USER1)> create trigger revoke_select_trig AFTER delete on t1 \n> \tfor each STATEMENT mode db2sql call revoke_select_proc4();\n> 0 rows inserted/updated/deleted\n> ij(USER1)> -- ok\n> delete from t1 where i = 8;\n> ERROR: Failed with SQLSTATE 38000\n> ERROR: Failed with SQLSTATE XJ001\n> ij(USER1)> -- check delete \n> select * from t1 where i = 8;\n240 del\n< 1          |XYZ            \n240a245\n> 8          |XYZ            \n241a247,252\n> ij(USER1)> drop trigger revoke_select_trig;\n> 0 rows inserted/updated/deleted\n> ij(USER1)> set connection user2;\n> ij(USER2)> -- should fail\n> select * from user1.t1 where i = 1;\n> ERROR: Failed with SQLSTATE 28508\n243,260d253\n< ij(USER1)> create trigger revoke_select_trig AFTER delete on t1 \n< \tfor each STATEMENT mode db2sql call revoke_select_proc4();\n< 0 rows inserted/updated/deleted\n< ij(USER1)> -- ok\n< delete from t1 where i = 8;\n< 1 row inserted/updated/deleted\n< ij(USER1)> -- check delete \n< select * from t1 where i = 8;\n< I          |B              \n< ---------------------------\n< 0 rows selected\n< ij(USER1)> drop trigger revoke_select_trig;\n< 0 rows inserted/updated/deleted\n< ij(USER1)> set connection user2;\n< ij(USER2)> -- should fail\n< select * from user1.t1 where i = 1;\n< ERROR: Failed with SQLSTATE 28508\n< ij(USER2)> set connection user1;\nTest Failed.\n*** End:   grantRevokeDDL2 jdkJ2ME Foundation Specification v1.0 derbyall:derbylang 2006-09-10 11:42:33 ***","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"38609","summary":"Tests lang/grantRevokeDDL.sql and lang/grantRevokeDDL2.sql fails on IBM WCTME 5.7 Foundation (jdkJ2ME Foundation Specification v1.0)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Windows","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":12,"total":12,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12434574","id":"12434574","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"body":"Diff files for both tests attached","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kartha","name":"kartha","emailAddress":"kartha02 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rajesh Kartha","active":true},"created":"2006-09-14T01:10:47.000+0000","updated":"2006-09-14T01:10:47.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12438287","id":"12438287","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Rajesh, it looks like this is still an issue for the J2ME runs. Can you prepare a patch? It is easier to review/commit a patch for this issue than inspecting diff files.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-09-28T05:10:12.000+0000","updated":"2006-09-28T05:10:12.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12438340","id":"12438340","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I do not think this is a simple master update. There are some really odd diffs, for instance, the section in grantRevokeDDL.sql where a trigger tr31t31TriggerTest is created:\r\n-------------\r\nij(MAMTA3)> -- following should fail because not all the privileges are in place\r\ncreate trigger tr31t31TriggerTest after insert on t31TriggerTest for each statement mode db2sql\r\n\tinsert into t32TriggerTest values (select c111 from mamta2.v21ViewTest where c112=1);\r\n------------\r\nWith foundation results in: \r\n                  ERROR: Failed with SQLSTATE 28508\r\nBut it should just succeed.\r\n(this then of course causes more diffs because there is no trigger to get fired)\r\n\r\nThere may be some other genuine problem further down, it's hard to say because of the various inter-dependencies of objects in the test.\r\n\r\nI wonder if the same problems would show up with just DataSource testing (i.e. irrespective of j9_foundation)?\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-09-28T07:11:18.000+0000","updated":"2006-09-28T07:11:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12438341","id":"12438341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"The stack trace of that error:\r\n2006-09-28 06:47:03.307 GMT Thread[main,5,main] (XID = 872), (SESSIONID = 9), (DATABASE = grantRevokeDDL), (DRDAID = null), Failed Statement is: -- following should fail because not all the privileges are in place\r\ncreate trigger tr31t31TriggerTest after insert on t31TriggerTest for each statement mode db2sql\r\n\tinsert into t32TriggerTest values (select c111 from mamta2.v21ViewTest where c112=1)\r\nERROR 28508: User 'MAMTA3' does not have select permission on column 'C111' of table 'MAMTA2'.'V21VIEWTEST'.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:396)\r\n\tat org.apache.derby.iapi.sql.dictionary.StatementColumnPermission.check(StatementColumnPermission.java:127)\r\n\tat org.apache.derby.impl.sql.conn.GenericAuthorizer.authorize(GenericAuthorizer.java:159)\r\n\tat org.apache.derby.impl.sql.execute.GenericResultSetFactory.getDDLResultSet(GenericResultSetFactory.java:982)\r\n\tat org.apache.derby.impl.sql.execute.ConstantActionActivation.execute(ConstantActionActivation.java:54)\r\n\tat org.apache.derby.impl.sql.GenericActivationHolder.execute(GenericActivationHolder.java:327)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:356)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1182)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:585)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:517)\r\n\tat org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:321)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:517)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:370)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:268)\r\n\tat org.apache.derby.impl.tools.ij.Main.go(Main.java:204)\r\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:170)\r\n\tat org.apache.derby.impl.tools.ij.Main.main(Main.java:72)\r\n\tat org.apache.derby.tools.ij.main(ij.java:67)\r\nCleanup action completed\r\n---------------","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-09-28T07:15:40.000+0000","updated":"2006-09-28T07:15:40.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12438344","id":"12438344","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"And grantRevokeDDL2 starts with a NPE. That can't be OK?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-09-28T07:18:58.000+0000","updated":"2006-09-28T07:18:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12438349","id":"12438349","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"2006-09-28 06:47:03.307 GMT Thread[main,5,main] (XID = 872), (SESSIONID = 9), (DATABASE = grantRevokeDDL), (DRDAID = null), Failed Statement is: -- following should fail because not all the privileges are in place\r\ncreate trigger tr31t31TriggerTest after insert on t31TriggerTest for each statement mode db2sql\r\n\tinsert into t32TriggerTest values (select c111 from mamta2.v21ViewTest where c112=1)\r\nERROR 28508: User 'MAMTA3' does not have select permission on column 'C111' of table 'MAMTA2'.'V21VIEWTEST'.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:396)\r\n\tat org.apache.derby.iapi.sql.dictionary.StatementColumnPermission.check(StatementColumnPermission.java:127)\r\n\tat org.apache.derby.impl.sql.conn.GenericAuthorizer.authorize(GenericAuthorizer.java:159)\r\n\tat org.apache.derby.impl.sql.execute.GenericResultSetFactory.getDDLResultSet(GenericResultSetFactory.java:982)\r\n\tat org.apache.derby.impl.sql.execute.ConstantActionActivation.execute(ConstantActionActivation.java:54)\r\n\tat org.apache.derby.impl.sql.GenericActivationHolder.execute(GenericActivationHolder.java:327)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:356)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1182)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:585)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:517)\r\n\tat org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:321)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:517)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:370)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:268)\r\n\tat org.apache.derby.impl.tools.ij.Main.go(Main.java:204)\r\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:170)\r\n\tat org.apache.derby.impl.tools.ij.Main.main(Main.java:72)\r\n\tat org.apache.derby.tools.ij.main(ij.java:67)\r\nCleanup action completed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-09-28T07:23:59.000+0000","updated":"2006-09-28T07:23:59.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12438799","id":"12438799","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"I took a very quick look at couple postings from Myrna about create trigger tr31t31TriggerTest in grantRevokeDDL2.sql and as the comment (\"-- following should fail because not all the privileges are in place \") before the create trigger says in the stack trace, this particular create trigger should indeed fail because all the privileges are not in place to successfully create the trigger at this point in the test.\r\n\r\nThere might still be some genuine diffs (definitely including the NPE) that needs to be looked into for the 2 test files in question, but the particular stack trace printed by Myrna look like correct expected error.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2006-09-29T20:33:40.000+0000","updated":"2006-09-29T20:33:40.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12438805","id":"12438805","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I made a mistake - picked the first reference to that trigger from derby.log. Apologies for the confusion, and thx, for the actual stack trace makes more sense to cause a problem with the foundation classes, because it uses BigDecimal somewhere:\r\n\r\n2006-09-28 06:49:45.019 GMT Thread[main,5,main] (XID = 1673), (SESSIONID = 9), (DATABASE = grantRevokeDDL), (DRDAID = null), Failed Statement is: -- following will pass because all the required privileges are in place for mamta3\r\ncreate trigger tr31t31 after insert on t31TriggerTest for each statement mode db2sql\r\n        insert into mamta1.t13TriggerTest values (values mamta1.selectFromSpecificSchema(1))\r\njava.lang.NoClassDefFoundError: java.math.BigDecimal\r\n\tat java.lang.reflect.AccessibleObject.getParameterTypesImpl(Native Method)\r\n\tat java.lang.reflect.Method.getParameterTypes(Method.java:136)\r\n\tat org.apache.derby.iapi.services.loader.ClassInspector.resolveMethod(ClassInspector.java:601)\r\n\tat org.apache.derby.iapi.services.loader.ClassInspector.findPublicMethod(ClassInspector.java:316)\r\n\tat org.apache.derby.impl.sql.compile.MethodCallNode.resolveMethodCall(MethodCallNode.java:672)\r\n\tat org.apache.derby.impl.sql.compile.StaticMethodCallNode.bindExpression(StaticMethodCallNode.java:235)\r\n\tat org.apache.derby.impl.sql.compile.JavaToSQLValueNode.bindExpression(JavaToSQLValueNode.java:254)\r\n\tat org.apache.derby.impl.sql.compile.ResultColumn.bindExpression(ResultColumn.java:580)\r\n\tat org.apache.derby.impl.sql.compile.ResultColumnList.bindExpressions(ResultColumnList.java:638)\r\n\tat org.apache.derby.impl.sql.compile.RowResultSetNode.bindExpressions(RowResultSetNode.java:239)\r\n\tat org.apache.derby.impl.sql.compile.SubqueryNode.bindExpression(SubqueryNode.java:509)\r\n\tat org.apache.derby.impl.sql.compile.ResultColumn.bindExpression(ResultColumn.java:580)\r\n\tat org.apache.derby.impl.sql.compile.ResultColumnList.bindExpressions(ResultColumnList.java:638)\r\n\tat org.apache.derby.impl.sql.compile.RowResultSetNode.bindExpressions(RowResultSetNode.java:239)\r\n\tat org.apache.derby.impl.sql.compile.DMLStatementNode.bindExpressions(DMLStatementNode.java:249)\r\n\tat org.apache.derby.impl.sql.compile.InsertNode.bind(InsertNode.java:308)\r\n\tat org.apache.derby.impl.sql.compile.CreateTriggerNode.bind(CreateTriggerNode.java:283)\r\n\tat org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:345)\r\n\tat org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:119)\r\n\tat org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:745)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:568)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:517)\r\n\tat org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:321)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:517)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:370)\r\n\tat org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:268)\r\n\tat org.apache.derby.impl.tools.ij.Main.go(Main.java:204)\r\n\tat org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:170)\r\n\tat org.apache.derby.impl.tools.ij.Main.main(Main.java:72)\r\n\tat org.apache.derby.tools.ij.main(ij.java:67)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-09-29T20:58:50.000+0000","updated":"2006-09-29T20:58:50.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12439311","id":"12439311","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I'm not sure I was clear in my previous comment.\r\n\r\nI think currently there are 2 problems with these tests:\r\n- NullPointerException at the start of grantRevokeDDL2 when run with foundation\r\n      this may be a test setup issue - not sure - where some essential property is not\r\n      set when running with DataSource only.\r\n- create Trigger fails with foundation because something in the Derby source code accessed in this statement finds a call to BigDecimal, which we should not be doing to support JSR169. So this is a problem.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-10-02T20:48:16.000+0000","updated":"2006-10-02T20:48:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12439320","id":"12439320","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"body":"Myrna said \"create Trigger fails with foundation because something in the Derby source code accessed in this statement finds a call to BigDecimal, which we should not be doing to support JSR169. So this is a problem. \"\r\n\r\nReference manual states triggers are not supported with JSR169. See:\r\nhttp://db.apache.org/derby/docs/dev/ref/rrefjdbcjsr169.html\r\n\r\nSo this may be a known limitation.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=deepa","name":"deepa","emailAddress":"dremesh at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Deepa Remesh","active":true},"created":"2006-10-02T21:23:20.000+0000","updated":"2006-10-02T21:23:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12450965","id":"12450965","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"committed the following change:\r\n\r\nr476425 | myrnavl | 2006-11-17 19:26:40 -0800 (Fri, 17 Nov 2006) | 6 lines\r\n\r\nDERBY-1849 - grantRevokeDDL and grantRevokeDDL2.sql fail with ibm wctme5.7_found\r\nation (jdkJ2ME Spec v1.0)\r\n- accepting that triggers are not supported with this jvm\r\n- updated masters to latest syntax changes in .sql files\r\n- stopped NPE by adding ij.dataSource properties to grantRevokeDDL2_app.properties","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-11-18T03:33:04.000+0000","updated":"2006-11-18T03:33:04.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12349881/comment/12451032","id":"12451032","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"merged to 10.2 with http://svn.apache.org/viewvc?view=rev&revision=476541\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2006-11-18T15:50:05.000+0000","updated":"2006-11-18T15:50:05.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1849/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06z13:"}}