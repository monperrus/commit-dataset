{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12611514","self":"https://issues.apache.org/jira/rest/api/latest/issue/12611514","key":"SOLR-3936","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12324743","id":"12324743","description":"Major release after 4.4","name":"4.5","archived":false,"released":true,"releaseDate":"2013-10-05"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321664","id":"12321664","description":"Current trunk","name":"Trunk","archived":false,"released":false}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2013-07-17 18:00:44.258","customfield_12312323":null,"customfield_12310420":"247945","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_26633816996_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-08-16T18:34:01.729+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-3936/watchers","watchCount":7,"isWatching":false},"created":"2012-10-12T12:17:04.772+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12322551","id":"12322551","description":"First major release from the 4.x branch: http://svn.apache.org/viewvc/lucene/dev/branches/branch_4x/","name":"4.0","archived":false,"released":true,"releaseDate":"2012-10-12"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-10-05T10:19:05.040+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313214","id":"12313214","name":"SearchComponents - other","description":"Issues related to Search Components that aren't specifically called out elsewhere: TermsComponent, TermVector, etc."}],"timeoriginalestimate":null,"description":"When I use elevation together with grouping I got not the expected result order.\r\n\r\n\r\nI tried it with the standard solr example:\r\n\r\nhttp://localhost:8983/solr/elevate?enableElevation=true&fl=score%2C[elevated]%2Cid%2Cname&forceElevation=true&group.field=manu&group=on&indent=on&q=ipod&wt=json \r\n\r\n\r\nbut the results ignored the elevation: \r\n\r\n{ \r\n  \"responseHeader\":{ \r\n    \"status\":0, \r\n    \"QTime\":2, \r\n    \"params\":{ \r\n      \"enableElevation\":\"true\", \r\n      \"fl\":\"score,[elevated],id,name\", \r\n      \"indent\":\"on\", \r\n      \"q\":\"ipod\", \r\n      \"forceElevation\":\"true\", \r\n      \"group.field\":\"manu\", \r\n      \"group\":\"on\", \r\n      \"wt\":\"json\"}}, \r\n  \"grouped\":{ \r\n    \"manu\":{ \r\n      \"matches\":2, \r\n      \"groups\":[{ \r\n          \"groupValue\":\"belkin\", \r\n          \"doclist\":{\"numFound\":1,\"start\":0,\"maxScore\":0.7698604,\"docs\":[ \r\n              { \r\n                \"id\":\"F8V7067-APL-KIT\", \r\n                \"name\":\"Belkin Mobile Power Cord for iPod w/ Dock\", \r\n                \"score\":0.7698604, \r\n                \"[elevated]\":false}] \r\n          }}, \r\n        { \r\n          \"groupValue\":\"inc\", \r\n          \"doclist\":{\"numFound\":1,\"start\":0,\"maxScore\":0.28869766,\"docs\":[ \r\n              { \r\n                \"id\":\"MA147LL/A\", \r\n                \"name\":\"Apple 60 GB iPod with Video Playback Black\", \r\n                \"score\":0.28869766, \r\n                \"[elevated]\":true}] \r\n          }}]}}}\r\n\r\n\r\nthe elevate.xml defines the following rules :\r\n\r\n<query text=\"ipod\">\r\n   <doc id=\"MA147LL/A\" />  <!-- put the actual ipod at the top -->\r\n   <doc id=\"IW-02\" exclude=\"true\" /> <!-- exclude this cable -->\r\n </query>\r\n \r\n</elevate>","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"51374","summary":"QueryElevationComponent: Wrong order when result grouping is activated","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michael.berger","name":"michael.berger","emailAddress":"michael dot berger at ecube dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Berger","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michael.berger","name":"michael.berger","emailAddress":"michael dot berger at ecube dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Berger","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":8,"total":8,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12611514/comment/13489039","id":"13489039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michael.berger","name":"michael.berger","emailAddress":"michael dot berger at ecube dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Berger","active":true},"body":"I tried to fix by myself:\r\n\r\n\"debug\":{\r\n    \"queryBoosting\":{\r\n      \"q\":\"ipod\",\r\n      \"match\":[\"MA147LL/A\"]},\r\n    \"rawquerystring\":\"ipod\",\r\n    \"querystring\":\"ipod\",\r\n    \"parsedquery\":\"(text:ipod ((id:MA147LL/A)^10.0) -id:IW-02)/no_coord\",\r\n    \"parsedquery_toString\":\"text:ipod ((id:MA147LL/A)^0.0) -id:IW-02\",\r\n\r\nI found that the boost factor is too low. \r\n\r\nI set a higher boost factor for booster.include in QueryElevationComponent.java and I get the expected result from my query.\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=michael.berger","name":"michael.berger","emailAddress":"michael dot berger at ecube dot de","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael Berger","active":true},"created":"2012-11-01T21:13:46.257+0000","updated":"2012-11-01T21:13:46.257+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12611514/comment/13711366","id":"13711366","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mgarski","name":"mgarski","emailAddress":"mgarski at mac dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mgarski&avatarId=14848","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mgarski&avatarId=14848","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mgarski&avatarId=14848","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mgarski&avatarId=14848"},"displayName":"Michael Garski","active":true},"body":"The root issue is that the sorting for grouped queries comes from the GroupingSpecification, which is not modified by the QueryElevationComponent. Attached is a patch that adds support for using query elevations with grouped queries and a corresponding unit test.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mgarski","name":"mgarski","emailAddress":"mgarski at mac dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mgarski&avatarId=14848","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mgarski&avatarId=14848","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mgarski&avatarId=14848","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mgarski&avatarId=14848"},"displayName":"Michael Garski","active":true},"created":"2013-07-17T18:00:44.258+0000","updated":"2013-07-17T18:00:44.258+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12611514/comment/13741722","id":"13741722","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"[~mgarski]: Thanks for tracking this down and providing a patch, and esspecially thanks for including tests!\r\n\r\nEverything you have looks great -- i've just updated your patch to include additional permutations (forceElevate, group.sort, etc...)\r\n\r\nI'll try to commit this tomorrow (running it through full regression now to make sure it doesn't break any other tests unexpectedly)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-08-16T00:33:57.449+0000","updated":"2013-08-16T00:33:57.449+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12611514/comment/13741729","id":"13741729","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mgarski","name":"mgarski","emailAddress":"mgarski at mac dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mgarski&avatarId=14848","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mgarski&avatarId=14848","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mgarski&avatarId=14848","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mgarski&avatarId=14848"},"displayName":"Michael Garski","active":true},"body":"Great! Thanks [~hossman]!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mgarski","name":"mgarski","emailAddress":"mgarski at mac dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=mgarski&avatarId=14848","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=mgarski&avatarId=14848","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=mgarski&avatarId=14848","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=mgarski&avatarId=14848"},"displayName":"Michael Garski","active":true},"created":"2013-08-16T00:38:52.313+0000","updated":"2013-08-16T00:38:52.313+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12611514/comment/13742405","id":"13742405","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1514795 from hossman@apache.org in branch 'dev/trunk'\r\n[ https://svn.apache.org/r1514795 ]\r\n\r\nSOLR-3936: Fixed QueryElevationComponent sorting when used with Grouping","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-16T17:14:03.388+0000","updated":"2013-08-16T17:14:03.388+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12611514/comment/13742500","id":"13742500","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1514836 from hossman@apache.org in branch 'dev/branches/branch_4x'\r\n[ https://svn.apache.org/r1514836 ]\r\n\r\nSOLR-3936: Fixed QueryElevationComponent sorting when used with Grouping (merge r1514795)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-16T18:32:10.910+0000","updated":"2013-08-16T18:32:10.910+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12611514/comment/13742501","id":"13742501","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"Thanks again Michael!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2013-08-16T18:34:01.752+0000","updated":"2013-08-16T18:34:01.752+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12611514/comment/13787075","id":"13787075","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpountz","name":"jpountz","emailAddress":"jpountz at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jpountz&avatarId=16520","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jpountz&avatarId=16520","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jpountz&avatarId=16520","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jpountz&avatarId=16520"},"displayName":"Adrien Grand","active":true},"body":"4.5 release -> bulk close","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jpountz","name":"jpountz","emailAddress":"jpountz at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jpountz&avatarId=16520","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jpountz&avatarId=16520","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jpountz&avatarId=16520","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jpountz&avatarId=16520"},"displayName":"Adrien Grand","active":true},"created":"2013-10-05T10:19:05.021+0000","updated":"2013-10-05T10:19:05.021+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-3936/votes","votes":3,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i095tb:"}}