{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12465477","self":"https://issues.apache.org/jira/rest/api/latest/issue/12465477","key":"ARIES-322","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310981","id":"12310981","key":"ARIES","name":"Aries","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310981&avatarId=10065","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310981&avatarId=10065","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310981&avatarId=10065","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310981&avatarId=10065"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10520","id":"10520","description":"Apache Aries","name":"Aries"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314941","id":"12314941","description":"","name":"0.2","archived":true,"released":true,"releaseDate":"2010-09-06"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2010-05-26 16:04:01.601","customfield_12312323":null,"customfield_12310420":"93934","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_10199556652_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-09-21T16:27:17.876+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-322/watchers","watchCount":0,"isWatching":false},"created":"2010-05-26T15:14:41.224+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314792","id":"12314792","description":"","name":"0.1","archived":true,"released":true,"releaseDate":"2010-05-13"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-09-21T16:28:10.556+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313081","id":"12313081","name":"Transaction"}],"timeoriginalestimate":null,"description":"If I change the blueprint.xml for the JPA bundle of the blog sample to the following, \r\n\r\n <service  interface=\"com.ibm.ws.eba.example.blog.persistence.api.BlogPersistenceService\">\r\n   <bean class=\"com.ibm.ws.eba.example.blog.persistence.BlogPersistenceServiceImpl\">\r\n     <tx:transaction method=\"*\" value=\"Required\"/>\r\n   </bean>\r\n </service>\r\n\r\nthe samples fails with this error:\r\n\r\n[25/05/10 17:35:59:068 BST] 0000002c servlet       E com.ibm.ws.webcontainer.servlet.ServletWrapper service SRVE0068E: Uncaught exception created in one of the service methods of the servlet Edit Blog Author in application 55f218ea-219d-4ff1-af48-3b80c274765b.2. Exception created : javax.persistence.TransactionRequiredException: No transaction currently active\r\n\tat org.apache.aries.jpa.container.context.transaction.impl.JTAPersistenceContextRegistry.getCurrentPersistenceContext(JTAPersistenceContextRegistry.java:94)\r\n\tat org.apache.aries.jpa.container.context.transaction.impl.JTAEntityManager.getPersistenceContext (JTAEntityManager.java:73)\r\n       at org.apache.aries.jpa.container.context.transaction.impl.JTAEntityManager.persist(JTAEntityManager.java:220)\r\n\r\nThe problem seems to be the anonymous bean. This tripped me up pretty badly when I was trying to write a new application, and I expect other users would hit it as well. ","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"173023","summary":"Anonymous beans in blueprint incompatible with JPA integration","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cumminsh%40uk.ibm.com","name":"cumminsh@uk.ibm.com","emailAddress":"cumminsh at uk dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Holly Cummins","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cumminsh%40uk.ibm.com","name":"cumminsh@uk.ibm.com","emailAddress":"cumminsh at uk dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Holly Cummins","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":6,"total":6,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465477/comment/12871784","id":"12871784","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"body":"This actually looks like a problem with the declarative transactions runtime rather than the JPA container. I assume that the bean has a <jpa:context .../> injection annotation, and that the injected EntityManager is being accessed outside of a JTA transaction. The TransactionRequiredException is then the correct specified behaviour, but there should be a transaction set up by the <tx:transaction .../> element","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"created":"2010-05-26T16:04:01.601+0000","updated":"2010-05-26T16:04:01.601+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465477/comment/12871841","id":"12871841","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=linsun","name":"linsun","emailAddress":"linsun at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lin Sun","active":true},"body":"hi Holly,\r\n\r\nDo you have the blueprint XML configured the same as you pasted into the JIRA, or it is more like below (note the jpa:context line)-\r\n\r\n<service interface=\"com.ibm.ws.eba.example.blog.persistence.api.BlogPersistenceService\">\r\n   <bean class=\"com.ibm.ws.eba.example.blog.persistence.BlogPersistenceServiceImpl\">\r\n     <tx:transaction method=\"*\" value=\"Required\"/>\r\n     <jpa:context property=\"entityManager\" unitname=\"blogExample\" />\r\n   </bean>\r\n </service> \r\n\r\nIf you don't have the jpa:context injected, the TransactionRequiredException seems reasonable to me.\r\n\r\nLin","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=linsun","name":"linsun","emailAddress":"linsun at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Lin Sun","active":true},"created":"2010-05-26T17:35:49.191+0000","updated":"2010-05-26T17:35:49.191+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465477/comment/12872267","id":"12872267","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cumminsh%40uk.ibm.com","name":"cumminsh@uk.ibm.com","emailAddress":"cumminsh at uk dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Holly Cummins","active":true},"body":"Hi Lin, \r\n\r\nThat's my cut and paste error - in the example I cut and pasted the context had been injected by annotation scanning, but I did also see the same behaviour with unmodified Apache Aries and XML like yours above. Sorry for the confusion!\r\n\r\nBasically if the bean was declared inside the service element it didn't work but if I moved it to be a freestanding element and added an id attribute things started working.  \r\n\r\nHolly","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cumminsh%40uk.ibm.com","name":"cumminsh@uk.ibm.com","emailAddress":"cumminsh at uk dot ibm dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Holly Cummins","active":true},"created":"2010-05-27T16:10:24.095+0000","updated":"2010-05-27T16:10:24.095+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465477/comment/12877973","id":"12877973","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"body":"The problem here lies in that the transaction namespace handler registers the transaction interceptor against ComponentMetadata instances and that the BeanRecipe, which is responsible for adding those interceptors to newly created beans, looks up its BeanMetadata by name, see addInterceptors. Now looking up an anonymous inner component by name of course is not going to work :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"created":"2010-06-11T21:18:56.143+0000","updated":"2010-06-11T21:18:56.143+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465477/comment/12912950","id":"12912950","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"body":"Is this issue still unresolved, or can it be closed off?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=timothyjward","name":"timothyjward","emailAddress":"timothyjward at hotmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Timothy Ward","active":true},"created":"2010-09-21T12:50:16.978+0000","updated":"2010-09-21T12:50:16.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12465477/comment/12913060","id":"12913060","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"body":"Committed long ago :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mahrwald","name":"mahrwald","emailAddress":"vmahrwald at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Valentin Mahrwald","active":true},"created":"2010-09-21T16:27:17.763+0000","updated":"2010-09-21T16:27:17.763+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/ARIES-322/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0tz9r:"}}