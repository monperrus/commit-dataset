{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12363177","self":"https://issues.apache.org/jira/rest/api/latest/issue/12363177","key":"SOLR-166","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312235","id":"12312235","description":"","name":"1.2","archived":false,"released":true,"releaseDate":"2007-06-06"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2007-02-19 22:26:38.909","customfield_12312323":null,"customfield_12310420":"7419","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_12657946_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-02-20T01:42:58.946+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-166/watchers","watchCount":0,"isWatching":false},"created":"2007-02-19T22:12:01.403+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312235","id":"12312235","description":"","name":"1.2","archived":false,"released":true,"releaseDate":"2007-06-06"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-10T10:41:07.864+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[],"timeoriginalestimate":null,"description":"The current trunk requires the solr.solr.home property to be set - even if JNDI is configured properly.  \n\nI think this is because SolrServlet loads before SolrDispatchFilter and calls SolrCore.getSolrCore();\n\nis there a way to make sure SolrDispatchFilter gets initalized first?","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"21016","summary":"trunk requires solr.solr.home set even if JNDI is set","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":8,"total":8,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12363177/comment/12474296","id":"12474296","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"body":"running resin on winXP from cwd: c:/tmp\r\n\r\nresin.conf:\r\n\r\n\r\n      <web-app id=\"/solr\" character-encoding=\"utf-8\"\r\n        document-directory=\"C:/workspace/solr-clean/example/webapps/solr\" \r\n              archive-path=\"C:/workspace/solr-clean/example/webapps/solr.war\">\r\n\t    <env-entry>\r\n\t      <env-entry-name>solr/home</env-entry-name>\r\n\t      <env-entry-type>java.lang.String</env-entry-type>\r\n\t      <env-entry-value>C:/workspace/solr-clean/example/solr</env-entry-value>\r\n\t    </env-entry>\r\n\t  </web-app>\r\n\r\n\r\nwhen i run, i get:\r\n\r\nStarting Resin on Mon, 19 Feb 2007 14:05:42 -0800 (PST)\r\n\r\n[14:05:43.343] Server[] starting\r\n[14:05:43.343] \r\n[14:05:43.343] Windows XP 5.1 x86\r\n[14:05:43.343] Java 1.5.0_07-b03, 32, mixed mode, Cp1252, en, Sun Microsystems Inc.\r\n[14:05:43.343] resin.home = null\r\n[14:05:43.343] server.root = null\r\n[14:05:43.343] \r\n[14:05:43.390] http listening to *:8080\r\n[14:05:43.421] Host[] starting\r\n[14:05:43.906] WebApp[http://localhost:8080/solr] starting\r\n[14:05:43.937] SolrServer: init\r\n[14:05:43.937] SolrServlet.init()\r\n[14:05:44.000] Solr home defaulted to 'solr/' (system property solr.solr.home not set)\r\n[14:05:44.015] java.lang.ExceptionInInitializerError\r\n[14:05:44.015] \tat org.apache.solr.update.SolrIndexConfig.<clinit>(SolrIndexConfig.java:36)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrCore.<clinit>(SolrCore.java:73)\r\n[14:05:44.015] \tat org.apache.solr.servlet.SolrServlet.init(SolrServlet.java:48)\r\n[14:05:44.015] \tat javax.servlet.GenericServlet.init(GenericServlet.java:69)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletConfigImpl.createServletImpl(ServletConfigImpl.java:646)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletConfigImpl.createServlet(ServletConfigImpl.java:587)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletManager.init(ServletManager.java:154)\r\n[14:05:44.015] \tat com.caucho.server.webapp.Application.start(Application.java:1654)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.StartAutoRedeployAutoStrategy.startOnInit(StartAutoRedeployAutoStrategy.java:72)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startOnInit(DeployController.java:509)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployContainer.start(DeployContainer.java:153)\r\n[14:05:44.015] \tat com.caucho.server.webapp.ApplicationContainer.start(ApplicationContainer.java:670)\r\n[14:05:44.015] \tat com.caucho.server.host.Host.start(Host.java:420)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.StartAutoRedeployAutoStrategy.startOnInit(StartAutoRedeployAutoStrategy.java:72)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startOnInit(DeployController.java:509)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployContainer.start(DeployContainer.java:153)\r\n[14:05:44.015] \tat com.caucho.server.host.HostContainer.start(HostContainer.java:504)\r\n[14:05:44.015] \tat com.caucho.server.resin.ServletServer.start(ServletServer.java:971)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.AbstractDeployControllerStrategy.start(AbstractDeployControllerStrategy.java:56)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.start(DeployController.java:517)\r\n[14:05:44.015] \tat com.caucho.server.resin.ResinServer.start(ResinServer.java:546)\r\n[14:05:44.015] \tat com.caucho.server.resin.Resin.init(Resin.java)\r\n[14:05:44.015] \tat com.caucho.server.resin.Resin.main(Resin.java:625)\r\n[14:05:44.015] \tat com.caucho.server.http.ResinServer.main(ResinServer.java:61)\r\n[14:05:44.015] Caused by: java.lang.RuntimeException: Error in solrconfig.xml\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.<clinit>(SolrConfig.java:82)\r\n[14:05:44.015] \t... 27 more\r\n[14:05:44.015] Caused by: java.lang.RuntimeException: Can't find resource 'solrconfig.xml' in classpath or 'solr/conf/', cwd=C:\\tmp\r\n[14:05:44.015] \tat org.apache.solr.core.Config.openResource(Config.java:324)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.initConfig(SolrConfig.java:72)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.<clinit>(SolrConfig.java:80)\r\n[14:05:44.015] \t... 27 more\r\n[14:05:44.015] javax.servlet.ServletException: java.lang.ExceptionInInitializerError\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletConfigImpl.createServlet(ServletConfigImpl.java:618)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletManager.init(ServletManager.java:154)\r\n[14:05:44.015] \tat com.caucho.server.webapp.Application.start(Application.java:1654)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.StartAutoRedeployAutoStrategy.startOnInit(StartAutoRedeployAutoStrategy.java:72)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startOnInit(DeployController.java:509)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployContainer.start(DeployContainer.java:153)\r\n[14:05:44.015] \tat com.caucho.server.webapp.ApplicationContainer.start(ApplicationContainer.java:670)\r\n[14:05:44.015] \tat com.caucho.server.host.Host.start(Host.java:420)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.StartAutoRedeployAutoStrategy.startOnInit(StartAutoRedeployAutoStrategy.java:72)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startOnInit(DeployController.java:509)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployContainer.start(DeployContainer.java:153)\r\n[14:05:44.015] \tat com.caucho.server.host.HostContainer.start(HostContainer.java:504)\r\n[14:05:44.015] \tat com.caucho.server.resin.ServletServer.start(ServletServer.java:971)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.AbstractDeployControllerStrategy.start(AbstractDeployControllerStrategy.java:56)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.start(DeployController.java:517)\r\n[14:05:44.015] \tat com.caucho.server.resin.ResinServer.start(ResinServer.java:546)\r\n[14:05:44.015] \tat com.caucho.server.resin.Resin.init(Resin.java)\r\n[14:05:44.015] \tat com.caucho.server.resin.Resin.main(Resin.java:625)\r\n[14:05:44.015] \tat com.caucho.server.http.ResinServer.main(ResinServer.java:61)\r\n[14:05:44.015] Caused by: java.lang.ExceptionInInitializerError\r\n[14:05:44.015] \tat org.apache.solr.update.SolrIndexConfig.<clinit>(SolrIndexConfig.java:36)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrCore.<clinit>(SolrCore.java:73)\r\n[14:05:44.015] \tat org.apache.solr.servlet.SolrServlet.init(SolrServlet.java:48)\r\n[14:05:44.015] \tat javax.servlet.GenericServlet.init(GenericServlet.java:69)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletConfigImpl.createServletImpl(ServletConfigImpl.java:646)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletConfigImpl.createServlet(ServletConfigImpl.java:587)\r\n[14:05:44.015] \t... 21 more\r\n[14:05:44.015] Caused by: java.lang.RuntimeException: Error in solrconfig.xml\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.<clinit>(SolrConfig.java:82)\r\n[14:05:44.015] \t... 27 more\r\n[14:05:44.015] Caused by: java.lang.RuntimeException: Can't find resource 'solrconfig.xml' in classpath or 'solr/conf/', cwd=C:\\tmp\r\n[14:05:44.015] \tat org.apache.solr.core.Config.openResource(Config.java:324)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.initConfig(SolrConfig.java:72)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.<clinit>(SolrConfig.java:80)\r\n[14:05:44.015] \t... 27 more\r\n[14:05:44.015] javax.servlet.ServletException: java.lang.ExceptionInInitializerError\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletConfigImpl.createServlet(ServletConfigImpl.java:618)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletManager.init(ServletManager.java:154)\r\n[14:05:44.015] \tat com.caucho.server.webapp.Application.start(Application.java:1654)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.StartAutoRedeployAutoStrategy.startOnInit(StartAutoRedeployAutoStrategy.java:72)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startOnInit(DeployController.java:509)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployContainer.start(DeployContainer.java:153)\r\n[14:05:44.015] \tat com.caucho.server.webapp.ApplicationContainer.start(ApplicationContainer.java:670)\r\n[14:05:44.015] \tat com.caucho.server.host.Host.start(Host.java:420)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.StartAutoRedeployAutoStrategy.startOnInit(StartAutoRedeployAutoStrategy.java:72)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startOnInit(DeployController.java:509)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployContainer.start(DeployContainer.java:153)\r\n[14:05:44.015] \tat com.caucho.server.host.HostContainer.start(HostContainer.java:504)\r\n[14:05:44.015] \tat com.caucho.server.resin.ServletServer.start(ServletServer.java:971)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.startImpl(DeployController.java:621)\r\n[14:05:44.015] \tat com.caucho.server.deploy.AbstractDeployControllerStrategy.start(AbstractDeployControllerStrategy.java:56)\r\n[14:05:44.015] \tat com.caucho.server.deploy.DeployController.start(DeployController.java:517)\r\n[14:05:44.015] \tat com.caucho.server.resin.ResinServer.start(ResinServer.java:546)\r\n[14:05:44.015] \tat com.caucho.server.resin.Resin.init(Resin.java)\r\n[14:05:44.015] \tat com.caucho.server.resin.Resin.main(Resin.java:625)\r\n[14:05:44.015] \tat com.caucho.server.http.ResinServer.main(ResinServer.java:61)\r\n[14:05:44.015] Caused by: java.lang.ExceptionInInitializerError\r\n[14:05:44.015] \tat org.apache.solr.update.SolrIndexConfig.<clinit>(SolrIndexConfig.java:36)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrCore.<clinit>(SolrCore.java:73)\r\n[14:05:44.015] \tat org.apache.solr.servlet.SolrServlet.init(SolrServlet.java:48)\r\n[14:05:44.015] \tat javax.servlet.GenericServlet.init(GenericServlet.java:69)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletConfigImpl.createServletImpl(ServletConfigImpl.java:646)\r\n[14:05:44.015] \tat com.caucho.server.dispatch.ServletConfigImpl.createServlet(ServletConfigImpl.java:587)\r\n[14:05:44.015] \t... 21 more\r\n[14:05:44.015] Caused by: java.lang.RuntimeException: Error in solrconfig.xml\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.<clinit>(SolrConfig.java:82)\r\n[14:05:44.015] \t... 27 more\r\n[14:05:44.015] Caused by: java.lang.RuntimeException: Can't find resource 'solrconfig.xml' in classpath or 'solr/conf/', cwd=C:\\tmp\r\n[14:05:44.015] \tat org.apache.solr.core.Config.openResource(Config.java:324)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.initConfig(SolrConfig.java:72)\r\n[14:05:44.015] \tat org.apache.solr.core.SolrConfig.<clinit>(SolrConfig.java:80)\r\n[14:05:44.015] \t... 27 more\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"created":"2007-02-19T22:14:01.891+0000","updated":"2007-02-19T22:14:01.891+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12363177/comment/12474300","id":"12474300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"load-on-startup in the web.xml is what tells the servlet container which order to load things on startup (if not set, things are loaded on first use)\r\n\r\ni have no idea if the servlet spec says all servelets should be loaded before all filters, or if they are in the same \"load pool\"\r\n\r\nRyan: can you try setting a low load-on-startup for the dispatch filter (and change the values for hte servlets to be something high) and see if that solves the problem?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2007-02-19T22:26:38.909+0000","updated":"2007-02-19T22:26:38.909+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12363177/comment/12474302","id":"12474302","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"body":"I don't see anyway to set load-on-startup for filters.  It seems to only work for servlets.  I'm able to fix this problem two ways on resin:\r\n\r\n 1. remove \"<load-on-startup>1</load-on-startup>\" from SolrServer servlet\r\n 2. lazy load core = SolrCore.getSolrCore()\r\n\r\nI think 1 is the better option.  Filters are initalized are startup in most servlet containers.  aparently resin first handles the \"load-on-startup\" servlets, then moves on to the filters.  Jetty does the opposite.\r\n\r\nNote, the <load-on-startup>2</load-on-startup> for SolrUpdate does not affect anything.  that servlet just punts anyway.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"created":"2007-02-19T22:37:44.813+0000","updated":"2007-02-19T22:37:44.813+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12363177/comment/12474310","id":"12474310","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"hmmm ... servlet spec 2.4 says that all fitlers should be loaded before any servlets (see p78 in SRV.9.12) ... so unless that's changed between 2.3 nad 2.4 it's a resin bug.\r\n\r\nRyan: one thing to try is changing the web.xml to use the 2.4 XSD instead of the 2.3 DTD and see if that forces resin to be compliant about loading the filter first.\r\n\r\nin general, i think it's good to load Servlets on startup even if there is no special initialization code they need to run, because it helps validate that the servlet is there on startup, and reduces the request time for the \"first request\" to that servlet because the class is alrready loaded.\r\n\r\na third option you didn't mention would be moving all of the setInstanceDir logic using JNDI from the SolrDispatchFilter into Config.getInstanceDir ... off the top of my head i'm not sure why it was ever in the Dispatcher/SolrServlet in the first place.\r\n\r\nIn a nutshell, getInstanceDir should check if a dir has been set, if not try JNDI, then system prop, then default to CWD and call setInstanceDir.\r\n\r\n\r\nwhat do you think?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2007-02-19T23:30:00.771+0000","updated":"2007-02-19T23:30:00.771+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12363177/comment/12474314","id":"12474314","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"body":"\r\n> Ryan: one thing to try is changing the web.xml to use the 2.4 XSD instead of the 2.3 DTD\r\n\r\nno dice.  it must be a resin bug.\r\n\r\n> \r\n> in general, i think it's good to load Servlets on startup even if...\r\n\r\nagreed\r\n\r\n> \r\n> In a nutshell, getInstanceDir should check if a dir has been set, if not \r\n\r\n1. try JNDI, \r\n2. system prop, \r\n3. default to CWD\r\n\r\ncall setInstanceDir.\r\n\r\n> \r\n> what do you think?\r\n\r\nI like it!  as long as it only attempts the JNDI stuff if does not require extra libraries for a lightweight embedded version.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"created":"2007-02-19T23:44:00.918+0000","updated":"2007-02-19T23:44:00.918+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12363177/comment/12474319","id":"12474319","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"body":"quick patch.  it works for me...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ryantxu","name":"ryantxu","emailAddress":"ryantxu at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ryan McKinley","active":true},"created":"2007-02-19T23:59:41.034+0000","updated":"2007-02-19T23:59:41.034+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12363177/comment/12474331","id":"12474331","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"commited with two small changes...\r\n\r\n1) log any unexpected RuntimeExceptions durring JNDI checks as warnings instead of silently ignoring (expected exceptions when JNDI isn't available are already loged as \"info\")\r\n\r\n2) use !isInstanceDirInitalized() instead of testing ==null directly.\r\n\r\n\r\nthanks for finding this and implimenting the fix Ryan","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2007-02-20T01:42:58.931+0000","updated":"2007-02-20T01:42:58.931+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12363177/comment/12589321","id":"12589321","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"body":"This bug was modified as part of a bulk update using the criteria...\r\n\r\n   * Marked (\"Resolved\" or \"Closed\") and \"Fixed\"\r\n   * Had no \"Fix Version\" versions\r\n   * Was listed in the CHANGES.txt for 1.2\r\n\r\nThe Fix Version for all 39 issues found was set to 1.2, email notification\r\nwas suppressed to prevent excessive email.\r\n\r\nFor a list of all the issues modified, search jira comments for this\r\n(hopefully) unique string: 20080415hossman2","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hossman","name":"hossman","emailAddress":"hossman_apachejira at fucit dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=hossman&avatarId=21247","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=hossman&avatarId=21247","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=hossman&avatarId=21247","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=hossman&avatarId=21247"},"displayName":"Hoss Man","active":true},"created":"2008-04-15T23:44:45.628+0000","updated":"2008-04-15T23:44:45.628+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-166/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i03ygn:"}}