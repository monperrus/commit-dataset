{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12325048","self":"https://issues.apache.org/jira/rest/api/latest/issue/12325048","key":"DERBY-649","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-10-27 03:16:18.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22070","customfield_12310222":"1_*:*_1_*:*_7285986000_*|*_6_*:*_2_*:*_8283226000_*|*_5_*:*_1_*:*_30000_*|*_4_*:*_1_*:*_632000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-04-25T03:46:08.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-649/watchers","watchCount":0,"isWatching":false},"created":"2005-10-26T22:48:14.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-07-01T08:26:38.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"Frederic Moreau reports (http://mail-archives.apache.org/mod_mbox/db-derby-user/200510.mbox/browser):\n\nHello,\n\nThe optimizer does not take my indexes into account when I do a select on \na 'UNION ALL' type of view ; therefore, table scans are done and \nperformances are bad.\n\nNote : my indexes are taken into account if I try equivalent selects on \ntables (instead of views).\n\nPlease find below a sample illustrating the problem using the \nRUNTIMESTATISTICS calls.\n\nCould anynone help me on this subject ?\nThank you.\n\n\nMy cloudscape version is the 10.0.2.1 one.\nI also tried it on the 10.1.1.0 version (same result).\n\n  c:\\>java -classpath \n\"%CLOUDSCAPE_INSTALL%\\lib\\derbyclient.jar;%CLOUDSCAPE_INSTALL%\\lib\\derbytools.jar\" \n-Dij.driver=org.apache.derby.jdbc.ClientDriver \n-Dij.protocol=jdbc:derby://localhost:1527/ -Dij.user=APP -Dij.password=APP \n-Dij.maximumDisplayWidth=32768 org.apache.derby.tools.ij  ij> connect \n'testdb' ;\n\n  ij> ;\n  ij> create table test.table1(a integer, b integer, c integer);\n  ij> create index test.table1idx on test.table1(b);\n  ij> ;\n  ij> create table test.table2(a integer, b integer, c integer);\n  ij> create index test.table2idx on test.table2(b);\n  ij> ;\n  ij> create view test.view0 as select all a,b from test.table1 union all \nselect a,b from test.table2;\n  ij> ;\n  ij> CALL SYSCS_UTIL.SYSCS_SET_RUNTIMESTATISTICS(1);\n  ij> select a from test.table1 where b=25;\n  ij> VALUES SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();\n        ...\n        Index Scan ResultSet for TABLE1 using index TABLE1IDX at read \ncommitted isolation level using instantaneous share row locking chosen by \nthe optimizer\n        ...\n  ij> select a from test.table2 where b=25;\n  ij> VALUES SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();\n        ...\n        Index Scan ResultSet for TABLE2 using index TABLE2IDX at read \ncommitted isolation level using instantaneous share row locking chosen by \nthe optimizer\n        ...\n  ij> select a from test.view0 where b=25;\n  ij> VALUES SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();\n        ...\n        Table Scan ResultSet for TABLE1 at read committed isolation level \nusing share row locking chosen by the optimizer\n        ...\n        Table Scan ResultSet for TABLE2 at read committed isolation level \nusing share row locking chosen by the optimizer\n        ...\n  ij> ;\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40613","summary":"Useful indexes not used in UNION ALL","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"subtasks":[{"id":"12326846","key":"DERBY-772","self":"https://issues.apache.org/jira/rest/api/2/issue/12326846","fields":{"summary":"Handle pushing IN predicates into UNIONs. This would allow use of index if present improving performance.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}},{"id":"12327025","key":"DERBY-784","self":"https://issues.apache.org/jira/rest/api/2/issue/12327025","fields":{"summary":"Document predicate push down through union clause in Tuning guide where other similar optimizations are discussed.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}},{"id":"12327441","key":"DERBY-805","self":"https://issues.apache.org/jira/rest/api/2/issue/12327441","fields":{"summary":"Push join predicates into union and other set operations. DERBY-649 implemented scalar (single table) predicate pushdown. Adding join predicate push down could improve performance significantly.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}},{"id":"12329735","key":"DERBY-1073","self":"https://issues.apache.org/jira/rest/api/2/issue/12329735","fields":{"summary":"Reset optimizer timeout for subqueries on a per-round basis to allow consideration of plans that use pushed predicates.","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/7","id":"7","description":"The sub-task of the issue","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png","name":"Sub-task","subtask":true}}}],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":12,"total":12,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12356000","id":"12356000","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeff_lichtman","name":"jeff_lichtman","emailAddress":"swazoo at rcn dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeff Lichtman","active":true},"body":"The problem is probably that the qualification is not being pushed down into the union. In the example script, the select from the view is expanded to:\r\n\r\nselect a from (select all a,b from test.table1 union all\r\nselect a,b from test.table2) tab where b = 25\r\n\r\nAfter this expansion, the compilation phase should push the qualification down into the union:\r\n\r\nselect a from (select all a,b from test.table1 where b = 25 union all\r\nselect a,b from test.table2 where b = 25) tab\r\n\r\nThis should probably happen in the preprocessing phase.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jeff_lichtman","name":"jeff_lichtman","emailAddress":"swazoo at rcn dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jeff Lichtman","active":true},"created":"2005-10-27T03:16:18.000+0000","updated":"2005-10-27T03:16:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12358885","id":"12358885","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"I am trying to address this problem by trying to push predicates into UNION. For now, I am not handling the cases where the select list may have expressions and handling only simple column references. I am attempting to push predicates into both left and right ResultSets, much like PredicateList.pushExpressionsIntoSelect handles the case of single SelectNodes. Does this sound like a reasonable approach?\r\n\r\nMy initial attempts don't seem to make the query use the index... I suspect I am not correctly remapping column references once pushed inside the selects. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2005-11-30T17:08:26.000+0000","updated":"2005-11-30T17:08:26.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12360485","id":"12360485","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"I have a patch for this bug. While I am still testing it, I would appreciate any comments about my approach. I have a customer who is hurting a lot because of this bug. Once complete, I would like to put this fix into both 10.1.x and trunk versions.\r\n\r\nI have implemented a simpler solution to address this optimization for some cases where predicates are of the form <ColumnReference> <RELOP> <constant>. These causes really benifit the most by pushing predicates down these into inner selects of union, since that would enable optimizer to use applicable indexes on them.\r\n\r\nI will also enhance this patch to make it more generic for trunk later.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2005-12-15T15:17:09.000+0000","updated":"2005-12-15T15:17:09.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12360486","id":"12360486","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"First version of the patch. I am still testing and enhancing the patch. Appreciate any comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2005-12-15T15:18:23.000+0000","updated":"2005-12-15T15:18:23.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12360982","id":"12360982","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"-1 on the patch, causes a regression. Will also vote -1 on the subsequent patch for 772 as it is dependent on this patch.\r\n\r\nRun this simple script, at svn revision 357054 the output is expected including the\r\ntwo argument IN clause on the select from the view returning two rows.\r\nOnce this patch is applied, svn revision 357105, that select returns no rows.\r\n\r\nDROP VIEW V1;\r\nDROP TABLE D1;\r\nCREATE TABLE D1 (A INT, B VARCHAR(4) FOR BIT DATA);\r\n\r\nINSERT INTO D1 VALUES (1, x'600Eaaef') ; \r\nINSERT INTO D1 VALUES (2, x'83452213') ; \r\n\r\nselect * from D1 where B IN (x'600Eaaef',x'83452213') ;  \r\nselect * from D1 where B IN (x'83452213') ; \r\nselect * from D1 where B  IN (x'600Eaaef') ; \r\n\r\nCREATE VIEW V1 AS SELECT A,B FROM D1 UNION SELECT A,B FROM D1;\r\n\r\nSELECT * FROM V1;\r\n\r\n-- this fails! returns no rows\r\nselect * from V1 where B IN (x'600Eaaef',x'83452213') ;  \r\nselect * from V1 where B IN (x'83452213') ; \r\nselect * from V1 where B  IN (x'600Eaaef') ; ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2005-12-21T06:16:48.000+0000","updated":"2005-12-21T06:16:48.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12360997","id":"12360997","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"I think I've found the bug in the patch. I'd appreciate any optimizer experts looking at this.\r\n\r\nIn PredicateList.pushExpressionsIntoSelect when the predicate is copied, any type of binary relational node can be copied, but the new relational node create is always an quality node, it is not based upon the type being pushed.\r\n\r\nI'm replacing this code, difference is first argument to getNode() :\r\naround line 1438 - changes would also be made to te variable name, to correctly represent its use.\r\n\r\n\t\t\t\tBinaryRelationalOperatorNode newEquals = (BinaryRelationalOperatorNode)\r\n\t\t\t\t\t\t\tgetNodeFactory().getNode(\r\n\t\t\t\t\t\t\t\t\t\tC_NodeTypes.BINARY_EQUALS_OPERATOR_NODE,\r\n\t\t\t\t\t\t\t\t\t\tnewCRNode,\r\n\t\t\t\t\t\t\t\t\t\topNode.getRightOperand(),\r\n\t\t\t\t\t\t\t\t\t\tgetContextManager());\r\n\r\nwith\r\n\r\n\t\t\t\tBinaryRelationalOperatorNode newEquals = (BinaryRelationalOperatorNode)\r\n\t\t\t\t\t\t\tgetNodeFactory().getNode(\r\n\t\t\t\t\t\t\t\t\t    opNode.getNodeType(),\r\n\t\t\t\t\t\t\t\t\t\tnewCRNode,\r\n\t\t\t\t\t\t\t\t\t\topNode.getRightOperand(),\r\n\t\t\t\t\t\t\t\t\t\tgetContextManager());\r\n\r\nI'd incorrectly assumed in the review that the (incorrect) new equality node was related to the boolean constant TRUE being created. So sort of '(pushed expression) = TRUE' was being pushed and required for some reason. I knew there was a good reason I'd asked for comments on this code section:\r\n\r\n> Dec 15th 08:19\r\n> For example, why do we need a new nodes that\r\n> represent '= TRUE', I'm sure it's required but to a reader of the code\r\nit's not obvious why.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2005-12-21T08:50:01.000+0000","updated":"2005-12-21T08:50:01.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12361005","id":"12361005","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"body":"Hi Dan, your fix looks good. I would be tempted to sand it down a bit: Since the new relational operator could be something other than \"==\", you might want to call it \"newRelop\" rather than \"newEquals\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rhillegas","name":"rhillegas","emailAddress":"rhillegas at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Hillegas","active":true},"created":"2005-12-21T09:52:38.000+0000","updated":"2005-12-21T09:52:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12361063","id":"12361063","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Submiited a modified version of the patch thus removing my veto for this and the DERBY-772 patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2005-12-22T04:27:01.000+0000","updated":"2005-12-22T04:27:01.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12363153","id":"12363153","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"Fix ported from 10.1 branch to trunk.\r\n\r\nSending        java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\PredicateList.java\r\nSending        java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\ProjectRestrictNode.java\r\nSending        java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\SelectNode.java\r\nSending        java\\engine\\org\\apache\\derby\\impl\\sql\\compile\\UnionNode.java\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\master\\predicatesIntoViews.out\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\lang\\predicatesIntoViews.sql\r\nTransmitting file data ......\r\nCommitted revision 370247.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2006-01-19T05:23:44.000+0000","updated":"2006-01-19T05:23:44.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12363169","id":"12363169","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"Fix checked into both 10.1 and trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2006-01-19T06:41:20.000+0000","updated":"2006-01-19T06:41:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12363170","id":"12363170","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"Fix has been verified against customer database and query on 10.2 and 10.1.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2006-01-19T06:41:50.000+0000","updated":"2006-01-19T06:41:50.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12325048/comment/12376099","id":"12376099","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"Reopening to set Fix In to 10.1.3 also.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2006-04-25T03:35:36.000+0000","updated":"2006-04-25T03:35:36.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-649/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07bef:"}}