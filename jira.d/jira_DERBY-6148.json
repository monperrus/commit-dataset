{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12640488","self":"https://issues.apache.org/jira/rest/api/latest/issue/12640488","key":"DERBY-6148","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323475","id":"12323475","description":"Head of 10.8 branch starting 2014-01-13","name":"10.8.3.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323562","id":"12323562","description":"Head of 10.9 branch after releasing 10.9.1.0","name":"10.9.2.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326659","id":"12326659","description":"candidate for Second release for 10.10 branch","name":"10.10.2.0","archived":false,"released":true,"releaseDate":"2014-04-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324243","id":"12324243","description":"First release on the 10.11 branch","name":"10.11.1.1","archived":false,"released":true,"releaseDate":"2014-08-26"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2013-05-08 09:28:20.853","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"320948","customfield_12310222":"3_*:*_1_*:*_513346620_*|*_1_*:*_1_*:*_3875716880_*|*_6_*:*_1_*:*_1118892_*|*_5_*:*_2_*:*_364472513_*|*_4_*:*_1_*:*_105933","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-05-28T11:40:28.262+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-6148/watchers","watchCount":5,"isWatching":false},"created":"2013-04-03T10:54:27.445+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"9.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312876","id":"12312876","description":"","name":"10.3.2.1","archived":false,"released":true,"releaseDate":"2007-12-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313142","id":"12313142","description":"","name":"10.3.3.0","archived":false,"released":true,"releaseDate":"2008-05-12"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313345","id":"12313345","description":"","name":"10.4.2.0","archived":false,"released":true,"releaseDate":"2008-09-05"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313771","id":"12313771","description":"build: 764942, 14/Apr/09. Voted release: 28/Apr/09. Announced: 1/May/09","name":"10.5.1.1","archived":false,"released":true,"releaseDate":"2009-04-28"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314116","id":"12314116","description":"10.5.2 Release July 30 2009 (794445) Now deprecated","name":"10.5.2.0","archived":false,"released":true,"releaseDate":"2009-07-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12314117","id":"12314117","description":"Next release after 10.5.2.0 release candidate #1","name":"10.5.3.0","archived":false,"released":true,"releaseDate":"2009-08-21"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313727","id":"12313727","description":"Feature release","name":"10.6.1.0","archived":false,"released":true,"releaseDate":"2010-05-18"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315343","id":"12315343","description":"Derby 10.6.2.1 Release","name":"10.6.2.1","archived":false,"released":true,"releaseDate":"2010-10-06"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12315564","id":"12315564","description":"First release on the 10.7 branch.","name":"10.7.1.1","archived":false,"released":true,"releaseDate":"2010-12-14"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316362","id":"12316362","description":"First release on the 10.8 branch","name":"10.8.1.2","archived":false,"released":true,"releaseDate":"2011-04-29"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12317968","id":"12317968","description":"second release on the 10.8 branch","name":"10.8.2.2","archived":false,"released":true,"releaseDate":"2011-10-24"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323456","id":"12323456","description":"Third release on the 10.8 branch","name":"10.8.3.0","archived":false,"released":true,"releaseDate":"2012-11-16"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12316344","id":"12316344","description":"First release on the 10.9 branch","name":"10.9.1.0","archived":false,"released":true,"releaseDate":"2012-06-25"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12321550","id":"12321550","description":"First release on the 10.10 branch","name":"10.10.1.1","archived":false,"released":true,"releaseDate":"2013-04-15"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12369068","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12369068","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12407399","key":"DERBY-3926","self":"https://issues.apache.org/jira/rest/api/2/issue/12407399","fields":{"summary":"Incorrect ORDER BY caused by index","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}},{"id":"12369180","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12369180","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12431975","key":"DERBY-4331","self":"https://issues.apache.org/jira/rest/api/2/issue/12431975","fields":{"summary":"Join returns results in wrong order","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2014-04-16T02:41:25.700+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"I have a query that looks like this:\r\n\r\n  SELECT tests.id,tests.item,title FROM tests,item_usage\r\n  WHERE username=? AND user_role>?\r\n  AND item_usage.item=tests.item\r\n  ORDER BY tests.item,title\r\n\r\nThe result ordering is by item code followed by title, but the item codes are listed in the order in which they appear in the ITEMS table where they are the primary key rather than in ascending order as expected. If however I change the ORDER BY clause to sort by item_usage.item rather than tests.item, it works correctly, even though the two values are the same!\r\n\r\nThe same thing happens in another unrelated query involving item_usage, and the same workaround cures it.\r\n\r\nThe relevant tables are defined like so:\r\n\r\n  CREATE TABLE item_usage (\r\n    username    VARCHAR(15)   NOT NULL,\r\n    item        VARCHAR(15)   NOT NULL,\r\n    value       SMALLINT      DEFAULT 0,\r\n    CONSTRAINT item_usage_pk  PRIMARY KEY (username,item),\r\n    CONSTRAINT item_usage_1   FOREIGN KEY (username)\r\n                              REFERENCES users(username)\r\n                              ON DELETE CASCADE,\r\n    CONSTRAINT item_usage_2   FOREIGN KEY (item)\r\n                              REFERENCES items(item)\r\n                              ON DELETE CASCADE,\r\n    CONSTRAINT item_usage_3   CHECK (value BETWEEN 0 AND 4)\r\n  );\r\n\r\n  CREATE TABLE tests (\r\n    id          INTEGER       GENERATED ALWAYS AS IDENTITY,\r\n    item        VARCHAR(15)   NOT NULL,\r\n    title       VARCHAR(255)  NOT NULL,\r\n    disp        SMALLINT      NOT NULL DEFAULT 0,\r\n    starttime   TIMESTAMP     DEFAULT NULL,\r\n    endtime     TIMESTAMP     DEFAULT NULL,\r\n    offsetx     INTEGER       NOT NULL DEFAULT 0,\r\n    offsety     INTEGER       NOT NULL DEFAULT 0,\r\n    rate        INTEGER       NOT NULL DEFAULT 0,\r\n    duration    INTEGER       NOT NULL DEFAULT 0,\r\n    calibrate   INTEGER       NOT NULL DEFAULT 0,\r\n    deadline    TIMESTAMP     DEFAULT NULL,\r\n    stepsize    INTEGER       NOT NULL DEFAULT 0,\r\n    interval    INTEGER       NOT NULL DEFAULT 0,\r\n    stand       CHAR(1)       DEFAULT NULL,\r\n    hidden      CHAR(1)       DEFAULT NULL,\r\n    repeated    CHAR(1)       DEFAULT NULL,\r\n    private     CHAR(1)       DEFAULT NULL,\r\n    sequential  CHAR(1)       DEFAULT NULL,\r\n    final       CHAR(1)       DEFAULT NULL,\r\n    notes       CLOB          DEFAULT NULL,\r\n    testxml     CLOB          NOT NULL,\r\n    author      VARCHAR(15)   NOT NULL,\r\n    time        TIMESTAMP     NOT NULL,\r\n    CONSTRAINT tests_pk       PRIMARY KEY (id),\r\n    CONSTRAINT tests_1        UNIQUE (item, title),\r\n    CONSTRAINT tests_2        FOREIGN KEY (item)\r\n                              REFERENCES items(item)\r\n                              ON DELETE CASCADE,\r\n    CONSTRAINT tests_3        CHECK (disp BETWEEN 0 AND 100),\r\n    CONSTRAINT tests_4        CHECK (rate BETWEEN 0 AND 100),\r\n    CONSTRAINT tests_5        CHECK (stepsize BETWEEN 0 AND 100)\r\n  );\r\n\r\nIf I run the query manually I get this, as expected:\r\n\r\n  ID  ITEM    TITLE\r\n  37  60001   Test 1\r\n  42  60001   Test 2\r\n  51  60001   Test 3\r\n  17  61303   Test 2a\r\n  16  61303   Test 2b\r\n  7   7205731 Test 2a\r\n  8   7205731 Test 2b\r\n\r\nNow, this is actually part of a web app that should turn this into a list of options in a <select> item using the following code:\r\n\r\n  while (query.next()) {\r\n    println(\"<option value='\" + query.getInt(\"id\") + \"'>\"\r\n            + encode(query.getString(\"item\") + \": \"\r\n            + query.getString(\"title\")) + \"</option>\");\r\n  }\r\n\r\nWhat I actually get is this:\r\n\r\n  <option value=\"17\">61303: Test 2a</option>\r\n  <option value=\"16\">61303: Test 2b</option>\r\n  <option value=\"7\">7205731: Test 2a</option>\r\n  <option value=\"8\">7205731: Test 2b</option>\r\n  <option value=\"37\">60001: Test 1</option>\r\n  <option value=\"42\">60001: Test 2</option>\r\n  <option value=\"51\">60001: Test 3</option>\r\n\r\nThe results are sorted by item then by title, but the item order is the order in which they were originally inserted into the items table (where the item and item description are stored, referenced by item_usage.item) rather than by item code. \r\n\r\nI've tried to reproduce this behaviour in a simple example, but without success. I have logged the query plans for both versions; the log output is as follows, with the INCORRECT query (using ORDER BY tests.item) followed later by the CORRECT query (using ORDER BY item_usage.item):\r\n\r\n(moved queryplans to attachment; see attachment queryplans.txt -dagw)\r\n\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10421","value":"Seen in production","id":"10421"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10366","value":"Wrong query result","id":"10366"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"321289","summary":"Wrong sort elimination when using permuted join order","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Windows 7 64-bit, Ubuntu 32-bit; JRE 1.7.0_11+","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":29,"total":29,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13651741","id":"13651741","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Do you have a stand-alone repro for this? I'll try to recreate the error but I need table data...\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-08T09:28:20.853+0000","updated":"2013-05-08T09:28:20.853+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13651757","id":"13651757","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"It seems some part of the schema is missing too, e.g. user_role (from table users?) and table items.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-08T10:00:50.095+0000","updated":"2013-05-08T10:00:50.095+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13651772","id":"13651772","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"body":"\r\nI'm sorry, but I've tried to reproduce it without any success. It is always \r\nreproducible when I use the full DB, but I don't want to send you that, and all \r\nthe attempts I've made to strip it down to bare essentials have failed (i.e. it \r\nalways sorts correctly.\r\n\r\nI'll try again, exporting just the relevant tables from the DB, and if necessary \r\nsend you a schema and zipped copy of the DB I end up with.\r\n\r\nThanks for looking at this,\r\n-- \r\nJohn English\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"created":"2013-05-08T10:41:14.031+0000","updated":"2013-05-08T10:41:14.031+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13651892","id":"13651892","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"body":"\r\nI've finally managed to reproduce it; attached is a zipfile containing:\r\n* the table schemas (schema.sql)\r\n* a database using this schema taken from the live DB\r\n* a script that exhibits the fault with the attached DB (test.sql)\r\n\r\nDuring the course of my experiments, I've discovered that it seems to happen \r\nonly when the users table contains users with names involving 16-bit characters. \r\nIf you connect to the attached DB and do this:\r\n\r\n   DELETE FROM users WHERE username LIKE '3%';\r\n\r\nthe two queries in \"test.sql\" will then both work correctly!\r\n-- \r\nJohn English\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"created":"2013-05-08T13:41:14.438+0000","updated":"2013-05-08T13:41:14.438+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13652826","id":"13652826","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"body":"I've taken out a lot of extraneous detail from the attached DB without changing \r\nthe behaviour. I've played with renaming users and so on, and it seems that the \r\nbehaviour is no longer exhibited if you do either of these two things:\r\n\r\n  * ALTER TABLE item_usage DROP COLUMN value\r\n  * DELETE FROM users WHERE username LIKE 'USER%'\r\n\r\nThe new attachment contains the stripped-down DB.\r\n-- \r\nJohn English\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"created":"2013-05-09T09:15:13.812+0000","updated":"2013-05-09T09:15:13.812+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13653511","id":"13653511","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thanks, John! I am able to see the error in the Derby trunk code line :)\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-10T03:41:32.673+0000","updated":"2013-05-10T03:41:32.673+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13655190","id":"13655190","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Both queries read the left table ITEM_USAGE) in the join the same way: index scan using the index for the ITEM_USAGE_1 constraint, i.e. visiting all the rows containing the user 'TAMMY' and reading the base row for the value of ITEM.\r\n\r\nThe correct query wraps the join in a sort; the wrong one does not, apparently believing sorting of the join isn't necessary.\r\n\r\nNow, the correct query accesses the other joinee, TESTS, using a table scan, so obviously sorting is used.\r\n\r\nThe wrong query uses the index on the constraint TESTS_1 which covers the two columns on which we order, TESTS.ITEM and TESTS.TITLE, and also accesses the base row for TESTS.ID.  Now, this means that for each row in the left table (ITEM_USAGE), the rows read from the right table will be read in sorted order for TESTS.ITEM and TESTS.TITLE.\r\n\r\nBut there is more than one row in the left table (5 rows), so the total set of joined rows will not be sorted, as seen.\r\n\r\nNow, why Derby reaches the conclusion it can skip the sort, remains to be seen. I'll try to trace the logic that short circuits the sorting.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-11T07:38:10.560+0000","updated":"2013-05-13T00:54:09.002+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13655196","id":"13655196","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Uploading two optimizer traces: q1.txt is the wrong query, q2.txt is the one that works correctly (has sorting). We can see that q1 chooses a sort avoidance access path.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-11T08:20:40.356+0000","updated":"2013-05-11T08:20:40.356+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13655700","id":"13655700","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"I looked at the query tree after the preprocessing phase for the wrong query, and the sort requirement is still present, so I believe the optimizer somehow has reached the conclusion that the sortt is unnecessary due to the access path chosen. (cf. uploaded preprocessed1.txt and preprocessed2.txt).\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-13T00:42:32.897+0000","updated":"2013-05-13T00:42:32.897+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13655752","id":"13655752","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"It turns out that the optimizer switches the order of the tables in the join from \r\n\r\n   [TESTS, ITEM_USAGE] \r\n\r\nto\r\n\r\n  [ITEM_USAGE, TESTS]\r\n\r\nusing the ITEM_USAGE_1 index for the best plan. Interestingly, if I change the join order myself (so it would be the first permutation the optimizer tries), the results are correct, i.e. into \r\n\r\nSELECT tests.id,tests.item,title FROM item_usage, tests       /* changed to order chosen by optimizer */\r\n  WHERE username='TAMMY' AND item_usage.item=tests.item\r\n  ORDER BY tests.item,title;\r\n\r\nNow, if the order had been the one first considered in the original query, e.g. [TESTS, ITEM_USAGE] and still using the index TESTS_1 corresponding to the constraint UNIQUE (item, title),\r\nthen all the rows of the outer table would be sorted on the desired columns TESTS.ITEM, TESTS.TITLE. A theory may be that when the optimizer rejects that plan based on cost, if neglects to \"reset\" (or forget) the fact that sorting isn't needed when it turns to the other ordering, for which it *is* needed.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-13T04:42:32.641+0000","updated":"2013-05-13T04:50:58.200+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13659298","id":"13659298","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Uploading a patch which makes the failing query work and regressions passed. It is not for commit; I need add new regression tests at the minimum.\r\n\r\nThe previous hypothesis about lacking reset/forgetting info from the first (discarded) join permutation proved to not be the reason for the error.  I believe the root cause is an incorrect assumption in OrderByList#sortRequired(RowOrdering, JBitSet, OptimizableList). DERBY-3926 added the OptimizableList argument to this method. \r\n\r\nIn the logic, that argument is treated as the join ordering under consideration, cf. the Javadoc of RequiredRowOrdering#sortRequired; the interface OrderByList's method implements (quote):\r\n\r\n* \"@param optimizableList\tThe current join order being considered by \r\n*    the optimizer. We need to look into this to determine if the outer\r\n*    optimizables are single row resultset if the order by column is\r\n*    on an inner optimizable and that inner optimizable is not a one\r\n*    row resultset. DERBY-3926\r\n\r\nHowever, debugging, I see that the argument passed in from OptimizerImpl is always OptimizerImpl#optimizableList which is not permuted when join orders are considered. The permutation is described by OptimizerImpl#proposedJoinOrder, which is a map into OptimizerImpl#optimizableList.  See for example usage ca line 556:\r\n\r\n....optimizableList.getOptimizable(proposedJoinOrder[joinPosition]).getBestAccessPath()....\r\n\r\nNow in OrderByList#sortRequired, there is this piece of code:\r\n\r\n    // If we have come across the optimizable for the order\r\n    // by column in the join order, then we do not need to\r\n    // look at the inner optimizables in the join order. As\r\n    // long as the outer optimizables are one row\r\n    // resultset, or is ordered on the order by column (see\r\n    // below check), we are fine to consider sort\r\n    // avoidance.\r\n    if (considerOptimizable.getTableNumber() == \r\n        cr.getTableNumber())\r\n        break;\r\n\r\nThis test is meant to determine that the column reference cr (the current order by column under consideration) references the current (outer) optimizable. It will only get this this test for inner tables if the outer has only one row. And in the query that works as intended so when I textually reordered the FROM tables to match the chosen join order, that's exactly what happens: ITEMS_USAGE is the outer table and the cr's table number doesn't match it (both colums reference TESTS), so the break is not performed.\r\n\r\nHowever, in the failing case, this test actually checks against the *inner* table (TESTS), since the proposedJoinOrder map isn't used, so the break is executed. Then later in the same method, ca line 622, we check whether the order by columns are ordered against the rowOrdering of the current access path (the index on the unique constraint TESTS_1 which does contain both the order by columns), so sort avoidance is accepted.\r\n\r\nAfter I introduce the indirection map into the method, the check shown above will always fail for outer ITEMS_USAGE (no matter its textual order in the join): execution proceeds to the check for single row in the outer optimizable (ca. line 605), which fails, since the outer table (ITEMS_USAGE) may have more than one row with even with equality predicate on user ('TAMMY'), so sort avoidance is not accepted.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-16T06:45:31.500+0000","updated":"2013-05-16T06:52:59.693+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13659313","id":"13659313","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Btw, I also added a few code comment lines to OptimizerImpl to explain what \"pulling\" means (thanks to Bryan for the example).\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-16T07:01:04.683+0000","updated":"2013-05-16T07:01:48.179+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13661316","id":"13661316","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Uploading version 2 of this patch, which now includes a new regression test fixture which fails without the patch. I made the new test using the data in the uploaded repro database. \r\n\r\nBtw, John, is that OK, or should I obfuscate the user data in it? (there are user names...).\r\n\r\nI had to use optimizer directive to get it to choose the access paths and join method (nested loop) that failed; presumably the statistics in the original database are different and out of the date; in any case when I loaded a new database and created indexes, the optimizer chose to use a hash join instead of the failing plan if I didn't add the overrides.\r\n\r\nPlease review.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-18T07:10:40.440+0000","updated":"2013-05-18T07:11:32.909+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13661324","id":"13661324","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Linking to DERBY-4331 too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-18T09:16:13.815+0000","updated":"2013-05-18T09:16:13.815+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13661485","id":"13661485","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Regressions passed for version #2 of the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-19T03:56:52.043+0000","updated":"2013-05-19T03:56:52.043+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13662477","id":"13662477","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"Hi Dag, thanks for working on this jira and finding the solution of using proposedJoinOrder vs optimizableList in sortRequired method since proposedJoinOrder will have the order of the tables in the join order being considered by the optimizer. I am wondering with this change, if we should stop passing optimizableList since I don't see it being used anymore in OrderByList.sortRequired() method anymore. Thanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2013-05-20T23:59:31.525+0000","updated":"2013-05-20T23:59:31.525+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13662661","id":"13662661","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thanks, Mamta. optimizableList is still being used; proposedJoinOrder is just a map [1] into it, cf. these lines in sortRequired (with the patch applied):\r\n\r\n    :\r\n    // Get one outer optimizable at a time from the join\r\n    // order\r\n    Optimizable considerOptimizable = optimizableList.\r\n        getOptimizable(proposedJoinOrder[i]);\r\n    :\r\n\r\n[1] it maps join order index into fixed list index in optimizableList ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-21T04:13:14.541+0000","updated":"2013-05-21T04:13:14.541+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13662676","id":"13662676","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Attaching revision 3 with synthentic names in the new regression test. Deleting original repro db attachment and revision #2 patch for privacy reasons.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-21T04:47:33.943+0000","updated":"2013-05-21T04:50:04.989+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13662944","id":"13662944","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks for the clear explanation, Dag. The patch looks correct to me.\r\n\r\nI just have one question about this loop in OrderByList:\r\n\r\n+                   for (int i=0;\r\n+                        i < proposedJoinOrder.length &&\r\n+                            proposedJoinOrder[i] != -1; // -1: partial order\r\n+                        i++)\r\n\r\nI haven't verified, but I'm assuming that -1's are always last in the array, so that it's fine to break out immediately when one is found. The original code didn't skip any optimizables here, as far as I can see. Does that mean the original code never really tried to do sort avoidance when only partial order was required?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-05-21T12:45:22.117+0000","updated":"2013-05-21T12:45:22.117+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13663739","id":"13663739","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thanks, Knut. You are right, the original code didn't skip any optimizables. Of course, it accessed them directly, not via the map (which can contain -1s), so the access itself would work even though it would be meaningless/wrong. But if used, it would only serve to re-introduce[1] a sorting requirement; it would not in itself make us avoid more sorting than the original (wrong) code already did.\r\n\r\n[1] by checking if a table not included in the partial ordering is \"alwaysOrdered\" on the column in question","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-22T03:53:35.622+0000","updated":"2013-05-22T03:54:17.118+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13666021","id":"13666021","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Committed at svn 1485938, resolving.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-24T06:04:04.880+0000","updated":"2013-05-24T06:04:04.880+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13666022","id":"13666022","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Candidate for back-port.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-24T06:05:13.096+0000","updated":"2013-05-24T06:05:13.096+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13666095","id":"13666095","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Backported to 10.10 as svn 1485958.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-24T08:09:41.785+0000","updated":"2013-05-24T08:53:56.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13666110","id":"13666110","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Backported to 10.9 as svn 1485973.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-24T08:35:26.682+0000","updated":"2013-05-24T08:35:26.682+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13666124","id":"13666124","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Backported to 10.8 as svn 1485977.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-24T08:51:45.172+0000","updated":"2013-05-24T08:53:34.363+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13666126","id":"13666126","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"John, if you are ok with the fix, please close this issue now. Thanks for reporting this!\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-24T08:53:02.047+0000","updated":"2013-05-24T08:53:02.047+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13666350","id":"13666350","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The back-port to 10.8 seems to have caused a build failure:\r\n\r\nhttps://builds.apache.org/job/Derby-branch-10.8/\r\n\r\ncompile_types:\r\n    [javac] Compiling 1 source file to /x1/jenkins/jenkins-slave/workspace/Derby-branch-10.8/10.8-head/classes\r\n    [javac] /x1/jenkins/jenkins-slave/workspace/Derby-branch-10.8/10.8-head/java/engine/org/apache/derby/iapi/sql/dictionary/ConstraintDescriptor.java:460: toString() in java.lang.Object cannot be applied to (int[])\r\n    [javac]                     Arrays.toString(referencedColumns) + \"\\n\" +\r\n    [javac]                           ^\r\n    [javac] 1 error\r\n\r\nBUILD FAILED\r\n\r\nProbably because the Arrays.toString(int[]) method is not available on Java 1.4.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2013-05-24T14:21:50.343+0000","updated":"2013-05-24T14:21:50.343+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13667293","id":"13667293","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"body":"\r\nOK... errrm... how do I...?\r\n\r\n-- \r\nJohn English\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=john_english","name":"john_english","emailAddress":"john dot foreign at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John English","active":true},"created":"2013-05-26T12:00:22.913+0000","updated":"2013-05-26T12:00:22.913+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12640488/comment/13668241","id":"13668241","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Thanks, Knut. Backed out that offending line at svn 1486867, 1486879 and 1486880 for 10.8, 10.9 and 10.10 respectively.\r\n\r\nJohn, maybe only devs can do that, so I'll close it then.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2013-05-28T11:17:25.566+0000","updated":"2013-05-28T11:40:11.844+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-6148/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i1jdjz:"}}