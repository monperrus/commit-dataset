{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12507460","self":"https://issues.apache.org/jira/rest/api/latest/issue/12507460","key":"LUCENE-3111","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310110","id":"12310110","key":"LUCENE","name":"Lucene - Core","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310110&avatarId=10061","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310110&avatarId=10061","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310110&avatarId=10061","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310110&avatarId=10061"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314025","id":"12314025","description":"Alpha release of the 4.x series","name":"4.0-ALPHA","archived":false,"released":true,"releaseDate":"2012-07-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2011-05-17 16:38:42.406","customfield_12312323":null,"customfield_12310420":"10818","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_35042810_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-05-17T18:37:08.905+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LUCENE-3111/watchers","watchCount":1,"isWatching":false},"created":"2011-05-17T08:53:06.109+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-05-10T10:44:50.856+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[],"timeoriginalestimate":null,"description":"Was running some while(1) tests on the docvalues branch (r1103705) and the following test failed:\r\n\r\n{code}\r\n    [junit] Testsuite: org.apache.lucene.util.automaton.fst.TestFSTs\r\n    [junit] Testcase: testRandomWords(org.apache.lucene.util.automaton.fst.TestFSTs):\tFAILED\r\n    [junit] expected:<771> but was:<TwoLongs:771,771>\r\n    [junit] junit.framework.AssertionFailedError: expected:<771> but was:<TwoLongs:771,771>\r\n    [junit] \tat org.apache.lucene.util.automaton.fst.TestFSTs$FSTTester.verifyUnPruned(TestFSTs.java:540)\r\n    [junit] \tat org.apache.lucene.util.automaton.fst.TestFSTs$FSTTester.doTest(TestFSTs.java:496)\r\n    [junit] \tat org.apache.lucene.util.automaton.fst.TestFSTs$FSTTester.doTest(TestFSTs.java:359)\r\n    [junit] \tat org.apache.lucene.util.automaton.fst.TestFSTs.doTest(TestFSTs.java:319)\r\n    [junit] \tat org.apache.lucene.util.automaton.fst.TestFSTs.testRandomWords(TestFSTs.java:940)\r\n    [junit] \tat org.apache.lucene.util.automaton.fst.TestFSTs.testRandomWords(TestFSTs.java:915)\r\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:1282)\r\n    [junit] \tat org.apache.lucene.util.LuceneTestCase$LuceneTestCaseRunner.runChild(LuceneTestCase.java:1211)\r\n    [junit] \r\n    [junit] \r\n    [junit] Tests run: 7, Failures: 1, Errors: 0, Time elapsed: 7.628 sec\r\n    [junit] \r\n    [junit] ------------- Standard Error -----------------\r\n    [junit] NOTE: Ignoring nightly-only test method 'testBigSet'\r\n    [junit] NOTE: reproduce with: ant test -Dtestcase=TestFSTs -Dtestmethod=testRandomWords -Dtests.seed=-269475578956012681:0\r\n    [junit] NOTE: test params are: codec=PreFlex, locale=ar, timezone=America/Blanc-Sablon\r\n    [junit] NOTE: all tests run in this JVM:\r\n    [junit] [TestToken, TestCodecs, TestIndexReaderReopen, TestIndexWriterMerging, TestNoDeletionPolicy, TestParallelReaderEmptyIndex, TestParallelTermEnum, TestPerSegmentDeletes, TestSegmentReader, TestSegmentTermDocs, TestStressAdvance, TestTermVectorsReader, TestSurrogates, TestMultiFieldQueryParser, TestAutomatonQuery, TestBooleanScorer, TestFuzzyQuery, TestMultiTermConstantScore, TestNumericRangeQuery64, TestPositiveScoresOnlyCollector, TestPrefixFilter, TestQueryTermVector, TestScorerPerf, TestSloppyPhraseQuery, TestSpansAdvanced, TestWindowsMMap, TestRamUsageEstimator, TestSmallFloat, TestUnicodeUtil, TestFSTs]\r\n    [junit] NOTE: Linux 2.6.37-gentoo amd64/Sun Microsystems Inc. 1.6.0_25 (64-bit)/cpus=8,threads=1,free=137329960,total=208207872\r\n    [junit] ------------- ---------------- ---------------\r\n    [junit] TEST org.apache.lucene.util.automaton.fst.TestFSTs FAILED\r\n{code}\r\n\r\nI am not able to reproduce","customfield_10010":null,"timetracking":{},"customfield_12310120":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10121","value":"New","id":"10121"}],"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"24901","summary":"TestFSTs.testRandomWords failure","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selckin","name":"selckin","emailAddress":"selckin at selckin dot be","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"selckin","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=selckin","name":"selckin","emailAddress":"selckin at selckin dot be","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"selckin","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":13,"total":13,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13034868","id":"13034868","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"I'm also not able to reproduce...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2011-05-17T16:38:42.406+0000","updated":"2011-05-17T16:38:42.406+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13034876","id":"13034876","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"This sounds like a bug in either the test or test-infra.\r\n\r\nI'm not able to reproduce but if I run this test with -Dtests.iter=100, i'm able to produce a similar failure (again not reproducible).\r\n\r\nSo first I'd like to see if we can find the \"reproducibility bug\". This is the most important to me :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2011-05-17T16:50:31.873+0000","updated":"2011-05-17T16:50:31.873+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13034880","id":"13034880","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"ok, the problem is the test overrides setup() but doesnt call super.setup(), and it does the same with tearDown()\r\n\r\nCurrently the way LuceneTestCase checks this is very \"crude\", in other words if you make this mistake with one, or the other, but not both, it will catch it!\r\n\r\nThe only workaround i know of to find test bugs like this is to install findbugs. it has a specific check for this exact test bug! we could run it on all of our tests.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2011-05-17T16:54:33.852+0000","updated":"2011-05-17T16:54:33.852+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13034895","id":"13034895","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"Doh!\r\n\r\n+1 for findbugs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2011-05-17T17:14:06.485+0000","updated":"2011-05-17T17:14:06.485+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13034899","id":"13034899","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"OK this reproduces the bug, once you add the missing calls to super.setUp/tearDown:\r\n\r\n{noformat}\r\nant test -Dtestcase=TestFSTs -Dtestmethod=testRandomWords -Dtests.seed=6166279653770643480:6589011488658196383\r\n{noformat}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2011-05-17T17:18:54.368+0000","updated":"2011-05-17T17:18:54.368+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13034900","id":"13034900","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"I have an idea how i think i can make LuceneTestCase fail if a test does this... i'll see if i can improve the setup/tearDown checking this way so we don't have this issue again.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2011-05-17T17:22:12.909+0000","updated":"2011-05-17T17:22:12.909+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13034949","id":"13034949","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"See revision 1104452, 5 tests had this problem... I think LuceneTestCase can catch it always now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2011-05-17T18:33:22.676+0000","updated":"2011-05-17T18:33:22.676+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13034950","id":"13034950","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"body":"OK I found this -- if you try to add the same output, twice, for the empty string, then the builder fails to realize this is a TwoInts and makes a single int output!\r\n\r\nThank you random testing :)\r\n\r\nI'll commit shortly...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikemccand","name":"mikemccand","emailAddress":"lucene at mikemccandless dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Michael McCandless","active":true},"created":"2011-05-17T18:35:46.220+0000","updated":"2011-05-17T18:35:46.220+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13038160","id":"13038160","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simpatico","name":"simpatico","emailAddress":"gabriele at mysimpatico dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=simpatico&avatarId=10380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=simpatico&avatarId=10380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=simpatico&avatarId=10380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=simpatico&avatarId=10380"},"displayName":"Gabriele Kahlout","active":true},"body":"@rmuir: Why was this committed to the 3_X branch, and not only to the trunk, as r 1104527?\r\n\r\nAlso, sorry for my ignorance, but why is it needed? Isn't there an 'inheritance/abstract/template method pattern' way to achive the same?  \r\nAll I know is that it now breaks my Solr tests[1].\r\n\r\n[1] https://issues.apache.org/jira/browse/SOLR-2537?focusedCommentId=13038085&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13038085\r\nSteps to reproduce:\r\n{code}\r\nsvn co -r 1126620 http://svn.apache.org/repos/asf/lucene/dev/branches/branch_3x/\r\ncd branch_3x; ant get-maven-poms; mvn -N -Pbootstrap install; mvn -DskipTests install\r\nwget http://dp4j.sf.net/debug/embeddedServerTest.zip\r\nunzip embeddedServerTest.zip\r\ncd embeddedServerTest; mvn test\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simpatico","name":"simpatico","emailAddress":"gabriele at mysimpatico dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=simpatico&avatarId=10380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=simpatico&avatarId=10380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=simpatico&avatarId=10380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=simpatico&avatarId=10380"},"displayName":"Gabriele Kahlout","active":true},"created":"2011-05-23T19:36:44.474+0000","updated":"2011-05-23T19:37:48.224+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13038183","id":"13038183","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"{quote}\r\n@rmuir: Why was this committed to the 3_X branch, and not only to the trunk, as r 1104527?\r\n{quote}\r\n\r\nIn general, when it comes to improving tests I try to backport all improvements.\r\n\r\n{quote}\r\nAlso, sorry for my ignorance, but why is it needed?\r\n{quote}\r\n\r\nIts a bug to override setup()/teardown() and not call super.setup()/super.tearDown(). You can detect this bug with findbugs, but its far better for the tests to just check this.\r\n\r\nOtherwise, the test-framework (LuceneTestCase) won't work correctly, such as in this case where you don't have a reproducible random seed.\r\n\r\nI'm sorry if it breaks your tests, you just need to make sure your setup() calls super.setup() and your tearDown() calls super.tearDown()\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2011-05-23T20:12:42.444+0000","updated":"2011-05-23T20:12:42.444+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13038243","id":"13038243","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simpatico","name":"simpatico","emailAddress":"gabriele at mysimpatico dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=simpatico&avatarId=10380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=simpatico&avatarId=10380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=simpatico&avatarId=10380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=simpatico&avatarId=10380"},"displayName":"Gabriele Kahlout","active":true},"body":"{quote}you just need to make sure your setup() calls super.setup() and your tearDown() calls super.tearDown(){quoute}\r\nBut I am! Follows the code in the zipped project. Also, if I don't override those methods I shouldn't get this problem, but I do.\r\n\r\n{quote}\r\npublic class SolrConfigTest extends AbstractSolrTestCase {\r\n\r\n    @Override\r\n    public String getSolrHome() {\r\n        final String SOLR_HOME = System.getenv(\"SOLR_HOME\");\r\n        if (SOLR_HOME == null) {\r\n            throw new RuntimeException(\"Set $SOLR_HOME env var to execute.\");\r\n        }\r\n        return new File(SOLR_HOME).getAbsolutePath();\r\n    }\r\n\r\n    public String getSchemaFile() {\r\n        return getSolrHome() + \"/conf/schema.xml\";\r\n    }\r\n\r\n    public String getSolrConfigFile() {\r\n        return getSolrHome() + \"/conf/solrconfig.xml\";\r\n    }\r\n    private SolrServer server;\r\n\r\n    @Before\r\n    @Override\r\n    public void setUp() throws Exception {\r\n        super.setUp();\r\n        new EmbeddedSolrServer(h.getCoreContainer(), h.getCore().getName());\r\n    }\r\n\r\n    @Test\r\n    public void test() {\r\n        //just a dummy to have setUp() called\r\n    }\r\n}\r\n{quote}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=simpatico","name":"simpatico","emailAddress":"gabriele at mysimpatico dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=simpatico&avatarId=10380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=simpatico&avatarId=10380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=simpatico&avatarId=10380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=simpatico&avatarId=10380"},"displayName":"Gabriele Kahlout","active":true},"created":"2011-05-23T21:29:25.977+0000","updated":"2011-05-23T21:29:25.977+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13038269","id":"13038269","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"body":"{quote}\r\nbq. you just need to make sure your setup() calls super.setup() and your tearDown() calls super.tearDown()\r\n\r\nBut I am! Follows the code in the zipped project. Also, if I don't override those methods I shouldn't get this problem, but I do.\r\n{quote}\r\n\r\nI can reproduce - Gabriele's test class's setUp() method calls super.setUp(), but when I run the test the error message about needing to call super.setUp() is emitted, and the test fails.  I don't know how to diagnose this problem, though.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=steve_rowe","name":"steve_rowe","emailAddress":"sarowe at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Steve Rowe","active":true},"created":"2011-05-23T22:08:12.335+0000","updated":"2011-05-23T22:17:44.950+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12507460/comment/13046522","id":"13046522","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"body":"{quote}\r\nI can reproduce - Gabriele's test class's setUp() method calls super.setUp(), but when I run the test the error message about needing to call super.setUp() is emitted, and the test fails. I don't know how to diagnose this problem, though.\r\n{quote}\r\n\r\nYou must use junit 4.7 (not 4.8).\r\nIn junit 4.8 TestWatchMan.starting() is fired before the @Befores, but not in 4.7 (This behavior annoyed me in 4.7 by the way).\r\n\r\nI definitely don't mind opening a new issue to switch to 4.8 as a minimum requirement.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcmuir","name":"rcmuir","emailAddress":"rcmuir at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=rcmuir&avatarId=10150","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rcmuir&avatarId=10150","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rcmuir&avatarId=10150","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rcmuir&avatarId=10150"},"displayName":"Robert Muir","active":true},"created":"2011-06-09T13:13:14.201+0000","updated":"2011-06-09T13:13:14.201+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LUCENE-3111/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i04mfz:"}}