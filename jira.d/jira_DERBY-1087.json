{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12329964","self":"https://issues.apache.org/jira/rest/api/latest/issue/12329964","key":"DERBY-1087","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2006-03-08 20:48:10.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22299","customfield_12310222":"1_*:*_1_*:*_5892281000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_51242000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-05-16T00:10:24.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1087/watchers","watchCount":1,"isWatching":false},"created":"2006-03-08T19:25:43.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"6.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-05-16T14:24:26.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11407","id":"11407","name":"JDBC"},{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"Running the following code with different queries in the first statement produces different results.\nWhere t1 has two columns: \"a\" of type int is the primary key, and \"b\" of type varchar(50); and contains 10 rows of data.\n\n\n            Statement st1 = conn.createStatement(ResultSet.TYPE_FORWARD_ONLY, \n                    ResultSet.CONCUR_UPDATABLE);\n            Statement st2 = conn.createStatement();\n            \n            ResultSet rs = st1.executeQuery(\"SELECT a, b FROM t1\");\n            rs.next();\n            rs.next();\n            st2.executeUpdate(\"UPDATE t1 SET a = a + 20 WHERE a = \" + \n                    rs.getInt(1));\n            try {\n                rs.updateInt(1, rs.getInt(1) + 30);\n                rs.updateRow();\n            } catch (SQLException se) {\n                System.out.println(se.getMessage());\n            }\n            rs.close();\n            \n            rs = st2.executeQuery(\"SELECT a FROM t1\");\n            while(rs.next()) {\n                System.out.println(\"A = \" + rs.getInt(1));\n            }\n            rs.close();\n            \n            st2.close();\n            st1.close();\n\nIf the first query is \"select a, b from t1\", the output will be:\nA = 1\nA = 3\nA = 4\nA = 5\nA = 6\nA = 7\nA = 8\nA = 9\nA = 10\nA = 32\n\nIf the first query is \"SELECT a, b FROM t1 WHERE a <= 5\", the output will be:\nCursor 'SQLCUR0' is not on a row.\nA = 1\nA = 3\nA = 4\nA = 5\nA = 6\nA = 7\nA = 8\nA = 9\nA = 10\nA = 22\n\nIf the first query is \"SELECT a FROM t1\", the output will be:\nCursor 'SQLCUR0' is not on a row.\nA = 1\nA = 3\nA = 4\nA = 5\nA = 6\nA = 7\nA = 8\nA = 9\nA = 10\nA = 22\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40691","summary":"Updatable result sets behave different depending on the type of query used to generate the result set","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10102","value":"Patch Available","id":"10102"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":13,"total":13,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12369435","id":"12369435","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"> If the first query is \"SELECT a, b FROM t1 WHERE a <= 5\", the output will be:\r\n> Cursor 'SQLCUR0' is not on a row.\r\n> A = 1\r\n> A = 3\r\n> A = 4\r\n> A = 5\r\n> A = 6\r\n> A = 7\r\n> A = 8\r\n> A = 9\r\n> A = 10\r\n> A = 22\r\n\r\nThe fact that you get \"Cursor 'SQLCUR0' is not on a row.\" when using indexes seems like a bug.\r\nCan you confirm that if the query is \"SELECT a, b FROM t1 WHERE a <= 5\", and there is no index on the table (no primary key), you do not get this error ?\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-03-08T20:48:10.000+0000","updated":"2006-03-08T20:48:10.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12369446","id":"12369446","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"I have tried without the index and it actually fails too when the query is \"SELECT a, b FROM t1 WHERE a <= 5\". So actually there are two different problems:\r\n\r\n1. when you use \"SELECT a, b FROM t1 WHERE a <= 5\", the statement that updates the row will change the value of a so that it no longer qualifies (a is not <= 5) and that why you get the error that the cursor is not on a row.\r\n\r\n2. when you use \"SELECT a FROM t1\", since all of the projected columns are covered by the index, the results are not fetched from the heap, the index is used instead. When the update statement changes the value of a, the entry for a is no longer in the same position in the b-tree, causing the error.\r\n\r\nI will make the title of the JIRA issue less specific so that it covers both cases.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-03-08T21:44:28.000+0000","updated":"2006-03-08T21:44:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12373119","id":"12373119","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"Proposed resolution to the two issues presented in my last comment:\r\n\r\n1. Is actually the expected behavior in derby for forward-only updatable result sets in derby, so it is not a bug. I plan not to change this behavior.\r\n\r\n2. I am considering to remove the optimization for covering indexes (that makes the results to be fetched directly from the index instead of the heap) in the case where the query produces an updatable result set, since the same problem will happen for both forward-only and scrollable updatable result sets. Does anybody see a problem with this?\r\n\r\n\r\nFernanda wrote:\r\n____________________________________\r\nI have tried without the index and it actually fails too when the query is \"SELECT a, b FROM t1 WHERE a <= 5\". So actually there are two different problems:\r\n\r\n1. when you use \"SELECT a, b FROM t1 WHERE a <= 5\", the statement that updates the row will change the value of a so that it no longer qualifies (a is not <= 5) and that why you get the error that the cursor is not on a row.\r\n\r\n2. when you use \"SELECT a FROM t1\", since all of the projected columns are covered by the index, the results are not fetched from the heap, the index is used instead. When the update statement changes the value of a, the entry for a is no longer in the same position in the b-tree, causing the error.\r\n\r\n[...]\r\n____________________________________\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-04-04T23:30:58.000+0000","updated":"2006-04-04T23:30:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12377408","id":"12377408","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"Since I have not seen any objections to the resolution I proposed on the 4th of April, I am attaching a patch that removes the optimization for covering indexes (that makes the results to be fetched directly from the index instead of the heap) in the case where the query produces an updatable result set, since the same problem will happen for both forward-only and scrollable updatable result sets. This patch also includes a new test for both forward-only and scrollable insensitive updatable result sets with covering indexes.\r\n\r\nThis removes an optimization and is not an ideal solution. Someone later might be interested in looking updatable result sets work with the optimization (fetching data only from the index and not using the heap).\r\n\r\nFernanda wrote:\r\n_______________________________\r\nProposed resolution to the two issues presented in my last comment:\r\n\r\n1. Is actually the expected behavior in derby for forward-only updatable result sets in derby, so it is not a bug. I plan not to change this behavior.\r\n\r\n2. I am considering to remove the optimization for covering indexes (that makes the results to be fetched directly from the index instead of the heap) in the case where the query produces an updatable result set, since the same problem will happen for both forward-only and scrollable updatable result sets. Does anybody see a problem with this?\r\n_______________________________ ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-05-02T22:14:34.000+0000","updated":"2006-05-02T22:14:34.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12377409","id":"12377409","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"Can someone please review this patch?\r\n\r\nThank you in advance!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-05-02T22:15:31.000+0000","updated":"2006-05-02T22:15:31.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12378595","id":"12378595","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"I have downloaded the patch, and first only applied the test, to see that it failed before taking in the changes in the engine. It seems like the test now fails with a ClassCastException in TableScanResultSet:\r\nThere was 1 error:\r\n1) testUpdateUpdatedTuple(org.apache.derbyTesting.functionTests.tests.jdbcapi.URCoveringIndexTest)java.lang.ClassCastException\r\n        at org.apache.derby.impl.sql.execute.TableScanResultSet.getRowLocation(TableScanResultSet.java:907)\r\n        at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.getRowLocation(ProjectRestrictResultSet.java:408)\r\n        at org.apache.derby.impl.sql.execute.ScrollInsensitiveResultSet.getRowLocation(ScrollInsensitiveResultSet.java:942)\r\n        at org.apache.derby.impl.sql.execute.CurrentOfResultSet.getNextRowCore(CurrentOfResultSet.java:120)\r\n        at org.apache.derby.impl.sql.execute.ProjectRestrictResultSet.getNextRowCore(ProjectRestrictResultSet.java:258)\r\n        at org.apache.derby.impl.sql.execute.DMLWriteResultSet.getNextRowCore(DMLWriteResultSet.java:123)\r\n        at org.apache.derby.impl.sql.execute.UpdateResultSet.collectAffectedRows(UpdateResultSet.java:450)\r\n        at org.apache.derby.impl.sql.execute.UpdateResultSet.open(UpdateResultSet.java:272)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:361)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1181)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:584)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(EmbedStatement.java:176)\r\n        at org.apache.derbyTesting.functionTests.tests.jdbcapi.URCoveringIndexTest.testUpdateUpdatedTupleWithCoveringIndex(URCoveringIndexTest.java:96)\r\n        at org.apache.derbyTesting.functionTests.tests.jdbcapi.URCoveringIndexTest.testUpdateUpdatedTuple(URCoveringIndexTest.java:119)\r\n\r\nI have been able to reproduce this in a debugger. TableScanResultSet does a cast to RowLocation in line 907, however the DataValueColumn is at the time of the failure a SQLInteger, not a RowLocation.\r\n\r\nAfter applying the patch, I did not get any failures.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-09T16:55:10.000+0000","updated":"2006-05-09T16:55:10.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12378596","id":"12378596","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"Review:\r\n\r\nThe patch looks good, here are some minor comments:\r\n\r\n1. In java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java, consider using a call to forUpdate() method instead of using the  cursorTargetTable attribute directly.\r\n\r\n2. Testing: I do not think the testcase should be added to derbynetclientmats, since it is already added to jdbcapi (it is not really a network client change)\r\n\r\n3. Testing: Consider making 4 test methods instead of testing all variants in the same testmethod. Now, the test fails at the first case, and I do not get to see the results of the other variants. Also please add javadoc to all testcase methods.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-09T16:57:50.000+0000","updated":"2006-05-09T16:57:50.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12378903","id":"12378903","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"Patch derby-1087v2.diff addresses the review comments.\r\n\r\n1. I changed java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java to use a call to cursorTargetTable() method instead of using the cursorTargetTable attribute directly. I chose not to use forUpdate() as suggested because it is too generic.\r\n\r\n2. Removed the test from derbynetclientmats.\r\n\r\n3. Made 4 tests methods and added javadoc to the 4 of them.\r\n\r\n_______________________\r\nAndreas wrote:\r\nReview:\r\n\r\nThe patch looks good, here are some minor comments:\r\n\r\n1. In java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java, consider using a call to forUpdate() method instead of using the cursorTargetTable attribute directly.\r\n\r\n2. Testing: I do not think the testcase should be added to derbynetclientmats, since it is already added to jdbcapi (it is not really a network client change)\r\n\r\n3. Testing: Consider making 4 test methods instead of testing all variants in the same testmethod. Now, the test fails at the first case, and I do not get to see the results of the other variants. Also please add javadoc to all testcase methods. \r\n_______________________","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-05-10T19:34:25.000+0000","updated":"2006-05-10T19:34:25.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12379028","id":"12379028","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"Thanks for addressing all the changes. I do recommend that this patch get committed.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-11T14:30:18.000+0000","updated":"2006-05-11T14:30:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12379061","id":"12379061","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"I failed to notice that the test had been removed from jdbcapi, instead of derbynetclientmats\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-11T18:16:49.000+0000","updated":"2006-05-11T18:16:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12379083","id":"12379083","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"body":"Attached patch derby-1087v3.diff which removes the test from derbynetclientmats and added it back to jdbcapi. Thank you for reviewing the patch Andreas.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fernanda","name":"fernanda","emailAddress":"fernanda dot pizzorno dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Fernanda Pizzorno","active":true},"created":"2006-05-11T22:05:11.000+0000","updated":"2006-05-11T22:05:11.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12379084","id":"12379084","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"body":"Great, then I do not have any issues w.r.t this patch, and (again) recommend it being committed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=andreask","name":"andreask","emailAddress":"andreas dot korneliussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andreas Korneliussen","active":true},"created":"2006-05-11T22:17:17.000+0000","updated":"2006-05-11T22:17:17.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12329964/comment/12402355","id":"12402355","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"body":"Committed revision 406683.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bernt","name":"bernt","emailAddress":"bernt at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bernt M. Johnsen","active":true},"created":"2006-05-16T00:10:24.000+0000","updated":"2006-05-16T00:10:24.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1087/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07bvr:"}}