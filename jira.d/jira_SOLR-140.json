{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12361945","self":"https://issues.apache.org/jira/rest/api/latest/issue/12361945","key":"SOLR-140","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2007-02-05 23:52:33.658","customfield_12312323":null,"customfield_12310420":"7445","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1494822849_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-02-21T15:26:50.849+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-140/watchers","watchCount":0,"isWatching":false},"created":"2007-02-04T08:13:08.319+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312234","id":"12312234","description":"","name":"1.1.0","archived":false,"released":true,"releaseDate":"2006-12-22"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-02-21T15:26:50.845+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12310674","id":"12310674","name":"search","description":"Query the search collection"}],"timeoriginalestimate":null,"description":"Query strings that contain a single quote, properly escaped, break *as soon as you add a sort field*.\n\nFor example,\nIf  I want to search for the word ----   jam's   ---- \nincluding the single quote, I can.  But as soon as I add a sort criteria to the URL, it breaks.\n\nNote: %27 is a single quote encoded for URI's\n\nHere's the examples....\nhttp://10.0.101.11:8080/forsale/select/?q=jam%27s    -- this works (i get ~20 hits back)\nhttp://10.0.101.11:8080/forsale/select/?q=jam%27s;score%20desc --- this doesn't (get 0 hits back)\n\nSeems that if the first query works, it shouldn't be breakable just by telling it explicitly to sort on score??  All other sorts break in this scenario as well ( i.e., price, etc).\n\nemail rsp from Yonik:\nHmmm, Solr tries to be smart about splitting the query from the sort\nspecification.\nIf it sees a semicolon inside quotes (single or double), or backslash\nescaped, then it will treat it as part of the query.\n\nAn immediate workaround would be to query for \"jam's\" or jam\\'s\n\nIt would be helpful if you could open a JIRA issue for this.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"21042","summary":"single quote in search query will break any sorts","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=juancho","name":"juancho","emailAddress":"johnkleven at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Kleven","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=juancho","name":"juancho","emailAddress":"johnkleven at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Kleven","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"SOLR nightly build 2007-02-01, but old builds as well.  Ubuntu 6.06 LTS server.  Tomcat 5.5.20","customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12361945/comment/12470399","id":"12470399","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"A quick patch to the problem.\r\nNot a complete solution, but it should make the situation better, with little cost.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2007-02-05T23:52:33.658+0000","updated":"2007-02-05T23:52:33.658+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12361945/comment/12473494","id":"12473494","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=juancho","name":"juancho","emailAddress":"johnkleven at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Kleven","active":true},"body":"This patch didn't help me.  Details as follows:\r\n\r\nI applied the patch (split_sort.txt)\r\n\r\nI then recompiled this version:  apache-solr-1.1.0-incubating\r\n\r\nusing: ant compile then ant dist\r\n\r\nI then copied:\r\n/opt/apache-solr-1.1.0-incubating/dist/apache-solr-1.1.1-dev-incubating.war\r\n\r\nas solr.war, and deployed it via tomcat.\r\n\r\nUnfortunately, i could not find any differences in behaviour.\r\n\r\nIf I search for anything, and add a 's  (apostrophe s) AND use a sort (i.e.,\r\n;price or whatever) it returns me no hits.  I did notice that with both pre\r\nand post patched .war file, if you use an escape char (as u recommended) i.e.,\r\n\\'s it will work.\r\n\r\nMaybe i didn't do something right, not sure.  Thanks for the patch though,\r\nlet me know if you would like me to try another.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=juancho","name":"juancho","emailAddress":"johnkleven at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"John Kleven","active":true},"created":"2007-02-15T20:18:11.349+0000","updated":"2007-02-15T20:18:11.349+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12361945/comment/12473503","id":"12473503","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"Thanks for reminding me about this patch.\r\nI just tried it out again and it works for me, so I think it's probably an installation issue, or you have a more complicated query than I've tested with.\r\n\r\nWithout patch:\r\nhttp://localhost:8983/solr/select?indent=on&wt=json&q=solr%27s%3Bprice+desc&debugQuery=on\r\n\r\n{\r\n \"responseHeader\":{\r\n  \"status\":0,\r\n  \"QTime\":0,\r\n  \"params\":{\r\n\t\"wt\":\"json\",\r\n\t\"indent\":\"on\",\r\n\t\"q\":\"solr's;price desc\",\r\n\t\"debugQuery\":\"on\"}},\r\n \"response\":{\"numFound\":0,\"start\":0,\"docs\":[]\r\n },\r\n \"debug\":{\r\n  \"rawquerystring\":\"solr's;price desc\",\r\n  \"querystring\":\"solr's;price desc\",\r\n  \"parsedquery\":\"PhraseQuery(text:\\\"solr price\\\") text:desc\",\r\n  \"parsedquery_toString\":\"text:\\\"solr price\\\" text:desc\",\r\n  \"explain\":{}}}\r\n\r\nWith patch:\r\n{\r\n \"responseHeader\":{\r\n  \"status\":0,\r\n  \"QTime\":100,\r\n  \"params\":{\r\n\t\"wt\":\"json\",\r\n\t\"indent\":\"on\",\r\n\t\"q\":\"solr's;price desc\",\r\n\t\"debugQuery\":\"on\"}},\r\n \"response\":{\"numFound\":0,\"start\":0,\"docs\":[]\r\n },\r\n \"debug\":{\r\n  \"rawquerystring\":\"solr's;price desc\",\r\n  \"querystring\":\"solr's\",\r\n  \"parsedquery\":\"text:solr\",\r\n  \"parsedquery_toString\":\"text:solr\",\r\n  \"explain\":{}}}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2007-02-15T20:34:34.832+0000","updated":"2007-02-15T20:34:34.832+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12361945/comment/12473955","id":"12473955","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"Committed.\r\nPerhaps try the next nightly build (2007-02-18 or later) with the app server in /example to verify.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2007-02-17T20:47:20.050+0000","updated":"2007-02-17T20:47:20.050+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-140/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i03ymf:"}}