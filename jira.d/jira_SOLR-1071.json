{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12417016","self":"https://issues.apache.org/jira/rest/api/latest/issue/12417016","key":"SOLR-1071","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310230","id":"12310230","key":"SOLR","name":"Solr","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310230&avatarId=22151","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310230&avatarId=22151","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310230&avatarId=22151","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310230&avatarId=22151"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10150","id":"10150","description":"Lucene-related projects","name":"Lucene"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313351","id":"12313351","description":"","name":"1.4","archived":false,"released":true,"releaseDate":"2009-11-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2009-03-31 18:03:39.239","customfield_12312323":null,"customfield_12310420":"6564","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_15197630889_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2009-09-08T22:27:56.479+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-1071/watchers","watchCount":1,"isWatching":false},"created":"2009-03-17T00:54:05.590+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12312330":null,"customfield_12311120":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312486","id":"12312486","description":"","name":"1.3","archived":false,"released":true,"releaseDate":"2008-09-16"}],"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-11-10T15:50:35.958+0000","customfield_12312335":null,"customfield_12312336":null,"customfield_12311720":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312015","id":"12312015","name":"spellchecker","description":"Returning spelling suggestions"}],"timeoriginalestimate":null,"description":"When: wt=json & spellcheck.extendedResults=true & spellcheck.count > 1, the suggestions are returned in the following format:\r\n\r\n\"suggestions\":[\r\n\t\"amsterdm\",{\r\n\t \"numFound\":5,\r\n\t \"startOffset\":0,\r\n\t \"endOffset\":8,\r\n\t \"origFreq\":0,\r\n\t \"suggestion\":{\r\n\t  \"frequency\":8498,\r\n\t  \"word\":\"amsterdam\"},\r\n\t \"suggestion\":{\r\n\t  \"frequency\":1,\r\n\t  \"word\":\"amsterd\"},\r\n\t \"suggestion\":{\r\n\t  \"frequency\":8,\r\n\t  \"word\":\"amsterdams\"},\r\n\t \"suggestion\":{\r\n\t  \"frequency\":1,\r\n\t  \"word\":\"amstedam\"},\r\n\t \"suggestion\":{\r\n\t  \"frequency\":22,\r\n\t  \"word\":\"amsterdamse\"}},\r\n\t\"beak\",{\r\n\t \"numFound\":5,\r\n\t \"startOffset\":9,\r\n\t \"endOffset\":13,\r\n\t \"origFreq\":0,\r\n\t \"suggestion\":{\r\n\t  \"frequency\":379,\r\n\t  \"word\":\"beek\"},\r\n\t \"suggestion\":{\r\n\t  \"frequency\":26,\r\n\t  \"word\":\"beau\"},\r\n\t \"suggestion\":{\r\n\t  \"frequency\":26,\r\n\t  \"word\":\"baak\"},\r\n\t \"suggestion\":{\r\n\t  \"frequency\":15,\r\n\t  \"word\":\"teak\"},\r\n\t \"suggestion\":{\r\n\t  \"frequency\":11,\r\n\t  \"word\":\"beuk\"}},\r\n\t\"correctlySpelled\",false,\r\n\t\"collation\",\"amsterdam beek\"]}}\r\n\r\nThis is an invalid json as each term is associated with a JSON object which holds multiple \"suggestion\" attributes. When working with a JSON library only the last \"suggestion\" attribute is picked up.\r\n\r\n\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"20120","summary":"spellcheck.extendedResults returns an invalid JSON response when count > 1","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":29,"total":29,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694196","id":"12694196","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"I don't know much about JSON, but it is my understanding that it is all generated from the NamedList, so I'm not sure what the solution would be.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2009-03-31T18:03:39.239+0000","updated":"2009-03-31T18:03:39.239+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694199","id":"12694199","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djimenez","name":"djimenez","emailAddress":"djimenez at conduit-it dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Donovan Jimenez","active":true},"body":"the JSON response writer has a specific parameter for this case: json.nl\r\n\r\nIt allows the the user to specify how they want named lists (which don't necessarily have unique keys suited to a JSON object map) to be treated. The values are listed in the wiki documentation:\r\n\r\nhttp://wiki.apache.org/solr/SolJSON\r\n\r\nI believe it affects the treatment of all named lists in the response, so if you're using facets or the like, they'd also be affected.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djimenez","name":"djimenez","emailAddress":"djimenez at conduit-it dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Donovan Jimenez","active":true},"created":"2009-03-31T18:09:49.363+0000","updated":"2009-03-31T18:09:49.363+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694246","id":"12694246","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"Uri, does that solve your problem?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2009-03-31T20:20:00.334+0000","updated":"2009-03-31T20:20:00.334+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694295","id":"12694295","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"OK, so I checked it out and no, setting the {{json.nl}} parameter doesn't help in this case. I looked it up and the problem lays in the fact that the {{suggestions}} data structure is SimpleOrderedMap. SimpleOrderedMap structure are always renderer by the JsonResponseWriter as a map and are not influenced by the {{json.nl}} parameter. There are two possible solutions here as I see it:\r\n\r\n1. A simple fix that would just replace the current SimpleOrderedMap with an ordinary NamedList (see SpecllCheckComponent_fix.patch)\r\n   *Advantages:* More backward compatible\r\n   *Disadvantages:* you still need to use the {{json.nl}} parameter in order to get it to work (and the this parameter influences the complete response structure, not just the spellcheck output)\r\n\r\n\r\n2. A small change to the response data structure that will put all the suggestion items as an array value of one field named \"suggestionItems\" (see SpellCheckComponent_new_structure.patch)\r\n   *Advantages:* A proper and intuitive structure for the response\r\n   *Disadvantages:* probably less backward compatible as the first solution\r\n\r\n(NOTE: patches applied on the trunk version)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-03-31T21:52:04.342+0000","updated":"2009-03-31T21:52:04.342+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694707","id":"12694707","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"bq.  2. A small change to the response data structure that will put all the suggestion items as an array value of one field named \"suggestionItems\" \r\n\r\n+1... how about \"suggestions\" for the tag though.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-04-01T19:54:32.207+0000","updated":"2009-04-01T19:54:32.207+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694710","id":"12694710","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"At first I tagged it \"suggestions\" but then I thought it might be confusing having two such tags on different levels","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-04-01T20:07:25.285+0000","updated":"2009-04-01T20:07:25.285+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694727","id":"12694727","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djimenez","name":"djimenez","emailAddress":"djimenez at conduit-it dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Donovan Jimenez","active":true},"body":"Some other response writers, like Serialized PHP for example, always output an object or keyed array for named lists. Do they need to implement similar parameters as the JSON writer? Or, like the direction you seem to be going here, should all response structures avoid the use of named lists with repeating element names?\r\n\r\nThis seems, at least to me, like a more general issue of convention and guidelines in the search components.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djimenez","name":"djimenez","emailAddress":"djimenez at conduit-it dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Donovan Jimenez","active":true},"created":"2009-04-01T20:42:23.990+0000","updated":"2009-04-01T20:42:23.990+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694745","id":"12694745","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"bq. At first I tagged it \"suggestions\" but then I thought it might be confusing having two such tags on different levels \r\n\r\ngood point - I hadn't noticed it was the same as the top level tag.\r\nWe could use a different word altogether... say \"words\", \"terms\", \"replacements\", \"alternatives\",\"corrections\"?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-04-01T21:09:06.665+0000","updated":"2009-04-01T21:19:35.926+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12694763","id":"12694763","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"I think \"alternatives\" and \"corrections\" are best candidate semantically speaking. Personally, I like \"alternatives\" the most but \"corrections\" is good as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-04-01T21:41:52.088+0000","updated":"2009-04-01T21:43:12.748+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12701490","id":"12701490","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"Changed \"items\" to \"alternatives\" and updated the SpellCheckComponentTest class accordingly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-04-22T11:29:20.792+0000","updated":"2009-04-22T11:29:20.792+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12701492","id":"12701492","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"One more thing to consider: now this component is a bit inconsistent with its response format. When extendedResults is used, the suggestions are put in an array called \"alternatives\", while when it's not used the suggestions are put in an array called \"suggestion\". I think it will be wise to consider changing the later to \"alternatives\" as well, but of course it will break backward compatibility and as this component is probably widely used it's a risk. Another option is at least temporary for 1.4 release add support for another parameter (something like, spellcheck.version=1.3) that will then signal the component to render the response in the 1.3 format - a bit ugly, but it will at least solve the compatibility issues.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-04-22T11:35:45.663+0000","updated":"2009-04-22T11:35:45.663+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12735749","id":"12735749","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"bq. When extendedResults is used, the suggestions are put in an array called \"alternatives\", while when it's not used the suggestions are put in an array called \"suggestion\".\r\n\r\nI debated the two different structures for a while and ultimately decided that people would have to deal with it no matter what.  My suspicion was that people either use extendedResults or not and that they don't mix them, but perhaps I was wrong.  Even if they do mix them, they still need code for recognizing when there is a difference (unless they are just spitting back out the raw, which means it doesn't matter anyway), so I don't know if it matters either way.  Since this is out in the wild already, I think we should just fix the bug.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2009-07-27T20:09:43.495+0000","updated":"2009-07-27T20:09:43.495+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12735751","id":"12735751","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"One thought, though:\r\n\r\nWhy isn't this a JSONResponseWriter bug?  It seems to me that the code is using valid Solr data structures and that the problem lies in the fact that the JSONRW is not creating valid JSON output.  Say we fix this here in the SCC, it doesn't stop anyone from doing it anywhere else, which will just lead to more bugs later.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2009-07-27T20:15:20.890+0000","updated":"2009-07-27T20:15:20.890+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12735856","id":"12735856","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"bq. I debated the two different structures for a while and ultimately decided that people would have to deal with it no matter what. My suspicion was that people either use extendedResults or not and that they don't mix them, but perhaps I was wrong. Even if they do mix them, they still need code for recognizing when there is a difference (unless they are just spitting back out the raw, which means it doesn't matter anyway), so I don't know if it matters either way. Since this is out in the wild already, I think we should just fix the bug. \r\n\r\nI guess you're right - the users will have to handle the differences between the results anyway","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-07-28T00:36:48.669+0000","updated":"2009-07-28T00:36:48.669+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12735859","id":"12735859","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"I'm not sure it's a bug in the JSONRW, it seems to me that it was intentionally implemented to behave in this manner. It is confusing though, and indeed when developing components one has to keep in mind the consequences of using a _SimpleOrderedMap_ vs. a simple _NamedList_. \r\n\r\nI think there are several ways to tackle this:\r\n\r\n1. Do nothing. In which case people should always know the consequences of using a _SimpleOrderedMap_ vs. a simple _NamedList._ \r\n*Advantages:* you probably don't break existing functionality. No code changes need to take place.\r\n*Disadvantages:* (as you mentioned) more error prone - easier to introduce such bugs when writing new components. People need to know the best practices which are not enforced.\r\n\r\n2. In the _SimpleOrderedMap_, keep track of duplicate keys. If a _SimpleOrderedMap_ hold duplicate keys then it should not be rendered as a JSON object, but more like a normal _NamedList_\r\n*Advantages:* you probably break nothing.. if components already use duplicate keys in a _SimpleOrderedMap_ then most probably they've introduced this same bug.\r\n*Disadvantage:* Inconsistent in the sense that in different occasions a _SimpleOrderedMap_ will be rendered differently. If duplicate keys are added, then there's no added value in choosing _SimpleOrderedMap_ over a normal _NamedList_. Which brings me to the last option\r\n\r\n3. Make sure that _SimpleOrderedMap_ does not accept duplicates. Either by enforcing it (e.g. by throwing an exception) or just by overriding the values.\r\n*Advantages:* Gives the _SimpleOrderedMap_ a true meaning and a reason to exist. With this in place, it will be clear when and how it can be used. No changes need to be applied to the JSONRW.\r\n*Disadvantages:* Existing functionality might break, yet again... if duplicate keys are already used than this bug is introduced anyway. According to the Javadoc, the _SimpleOrderedMap_ implementation intentionality doesn't prevent duplicate keys... so there must be a reason for that.\r\n\r\nPersonally, I'm for option 3. The current implementation of _SimpleOrderedMap_ doesn't seem to add any functionality to the _NamedList_ class, so it seems to me this class was created just as a hint for the response writers to render it differently. The name \"SimpleOrderedMap\" also suggest a \"Map-like\" functionality which doesn't support duplicate keys. But again, I'm not sure about the original reasons for not preventing duplicate keys in the first place, so there might be something I'm missing here.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-07-28T00:37:34.051+0000","updated":"2009-07-28T00:37:34.051+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12740965","id":"12740965","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"bq. Why isn't this a JSONResponseWriter bug?\r\n\r\nJSON does not require unique keys.  It's certainly a good idea though.\r\n\r\nDonovan had it right:\r\nbq. This seems, at least to me, like a more general issue of convention and guidelines in the search components.\r\n\r\nIt's a bad idea to repeat keys... this isn't XML.  When access-by-key is more important, use SimpleOrderedMap... when position must be maintained, use NamedList.  In both cases, we should strive not to repeat keys.\r\n\r\nHere is what the current output is for non-extendedResults:\r\n{code}\r\n <lst name=\"suggestions\">\r\n  <lst name=\"hell\">\r\n\t<int name=\"numFound\">2</int>\r\n\t<int name=\"startOffset\">0</int>\r\n\t<int name=\"endOffset\">4</int>\r\n\t<arr name=\"suggestion\">\r\n\t <str>dell</str>\r\n\t <str>all</str>\r\n\t</arr>\r\n  </lst>\r\n </lst>\r\n{code}\r\n\r\nThe logical extension for extended results would be to simply replace each string in the array with a map.\r\n\r\n{code}\r\n  <lst name=\"hell\">\r\n\t<int name=\"numFound\">2</int>\r\n\t<int name=\"startOffset\">0</int>\r\n\t<int name=\"endOffset\">4</int>\r\n\t<int name=\"origFreq\">0</int>\r\n        <arr name=\"suggestion\">\r\n           <lst>\r\n\t\t <int name=\"frequency\">1</int>\r\n  \t         <str name=\"word\">dell</str>\r\n           </lst>\r\n           <lst>\r\n\t         <int name=\"frequency\">1</int>\r\n\t         <str name=\"word\">all</str>\r\n           </lst>\r\n\t</arr>\r\n  </lst>\r\n{code}\r\n\r\nIf extended results only ever added frequency, we could further simplify to have the suggest be the key and the freq be the val, but I don't know that we wouldn't want to add more metadata in the future.\r\n\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-08-08T21:04:11.017+0000","updated":"2009-08-08T21:04:11.017+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12750606","id":"12750606","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevvooe","name":"stevvooe","emailAddress":"sjaday at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Day","active":true},"body":"Why did this ever change to begin with? From the wiki, there is a clear definition of how it originally worked, that was compatible with the JSON Writer:\r\n\r\nhttp://wiki.apache.org/solr/SpellCheckComponent\r\n\r\nThe current format is obnoxiously verbose, even for XML.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=stevvooe","name":"stevvooe","emailAddress":"sjaday at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Day","active":true},"created":"2009-09-02T18:43:33.095+0000","updated":"2009-09-02T18:43:33.095+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12750659","id":"12750659","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"Because there are issues with the current format is json (and perhaps also in other formats)... see comments above","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-09-02T20:51:26.624+0000","updated":"2009-09-02T20:51:26.624+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752268","id":"12752268","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"I'm moving forward with the most straightforward fix... the string becomes a map for extended results.  So\r\n<str>dell</str> in non extended results becomes the following in extended results:\r\n<lst>  <str name=\"word\">dell</str> <int name=\"freq\">1</int> </lst>\r\n\r\nSo voice your objections now ;-)\r\n\r\nActually, the code to do the change is already done... the hard part is the tests... and there seems to be no unit tests for the SolrJ part that actually test the Suggestion class.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-09-07T21:45:00.465+0000","updated":"2009-09-07T21:45:22.140+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752282","id":"12752282","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"Attaching patch.\r\n\r\nHere is some example JSON output:\r\n{code}\r\n \"spellcheck\":{\r\n  \"suggestions\":[\r\n\t\"hell\",{\r\n\t \"numFound\":2,\r\n\t \"startOffset\":0,\r\n\t \"endOffset\":4,\r\n\t \"origFreq\":0,\r\n\t \"suggestion\":[{\r\n\t\t\"word\":\"dell\",\r\n\t\t\"freq\":4},\r\n\t  {\r\n\t\t\"word\":\"all\",\r\n\t\t\"freq\":4}]},\r\n\t\"correctlySpelled\",false]}}\r\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-09-07T23:05:56.836+0000","updated":"2009-09-07T23:05:56.836+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752285","id":"12752285","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"I haven't changed the SolrJ SpellCheckResponse class, but it does look like the naming could be improved.\r\n\r\nExample:\r\n  response.getSuggestions().get(0).getSuggestions().get(0);","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-09-07T23:13:19.591+0000","updated":"2009-09-07T23:13:19.591+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752417","id":"12752417","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"Looks good! \r\n\r\nAs for the naming, I really like your suggestion (in one of the comments above) to replace \"suggestion\" with \"alternatives\". So the client code can look something like:\r\n\r\n{code}\r\nresponse.getSuggestions().get(\"hell\").getAlternatives().get(0);\r\n{code}\r\n\r\nOne more thing - I think it will be more intuitive to use a SimpleOrderedMap instead of a NamedList for the \"suggestions\" node. for the xml response it won't make much difference I guess, but for the json one it will be more intuitive and easier to work with. So to take your example above, you'd get something like:\r\n\r\n{code}\r\n\"spellcheck\": {\r\n    \"suggestions\": {\r\n        \"hell\":{\r\n            \"numFound\":2,\r\n            \"startOffset\":0,\r\n            \"endOffset\":4,\r\n            \"origFreq\":0,\r\n            \"alternatives\":[\r\n                {\r\n                    \"word\":\"dell\",\r\n                    \"freq\":4\r\n                },\r\n                {\r\n                    \"word\":\"all\",\r\n                    \"freq\":4\r\n                }\r\n            ]\r\n        },\r\n        \"correctlySpelled\":false}}}\r\n{code}\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-09-08T09:58:49.200+0000","updated":"2009-09-08T09:58:49.200+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752423","id":"12752423","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"Thanks for the review Uri!\r\n\r\nbq. One more thing - I think it will be more intuitive to use a SimpleOrderedMap instead of a NamedList for the \"suggestions\" node.\r\n\r\nIt already does... it's just the client code that checks for NamedList (the parent of SimpleOrderedMap)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-09-08T10:24:37.543+0000","updated":"2009-09-08T10:24:37.543+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752448","id":"12752448","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"bq. It already does... it's just the client code that checks for NamedList (the parent of SimpleOrderedMap)\r\n\r\nNo... sorry, I mean the top most \"suggestions\" node. line 182 in the patched class.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-09-08T11:18:03.729+0000","updated":"2009-09-08T11:18:03.729+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752449","id":"12752449","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"bq. I mean the top most \"suggestions\" node.\r\nOh I see - I wasn't sure about that one... I guess it depends on how important order is in the top-level suggestions list?  It would break back compat for the non-extended results too (for JSON and friends).\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-09-08T11:36:15.512+0000","updated":"2009-09-08T11:36:15.512+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752472","id":"12752472","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"bq. I guess it depends on how important order is in the top-level suggestions list?\r\n\r\nI guess the order is not that important, it's just that using a SimpleOrderedMap will output a more intuitive JSON output to work with IMO.\r\n\r\nbq. It would break back compat for the non-extended results too (for JSON and friends).\r\n\r\nTrue... I didn't think about that one. hmm... well... I guess you can keep it as is then. I mean, it's not like you cannot work with the current format after all :-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-09-08T12:34:43.330+0000","updated":"2009-09-08T12:34:43.330+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752793","id":"12752793","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"body":"Committed!  The Solr release schedule is tight enough, I'll update the wiki docs during the Solr code freeze (unless someone beats me to it).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yseeley%40gmail.com","name":"yseeley@gmail.com","emailAddress":"yseeley at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yonik Seeley","active":true},"created":"2009-09-08T22:27:09.711+0000","updated":"2009-09-08T22:27:09.711+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12752841","id":"12752841","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"body":"cool! thanks for the effort Yonik. I've updated the wiki so you can focus on the release ;-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=uboness","name":"uboness","emailAddress":"uboness at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Uri Boness","active":true},"created":"2009-09-09T00:37:51.029+0000","updated":"2009-09-09T00:37:51.029+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12417016/comment/12775475","id":"12775475","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"body":"Bulk close Solr 1.4 issues","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=gsingers","name":"gsingers","emailAddress":"gsingers at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Grant Ingersoll","active":true},"created":"2009-11-10T15:50:35.928+0000","updated":"2009-11-10T15:50:35.928+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/SOLR-1071/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i03sxj:"}}