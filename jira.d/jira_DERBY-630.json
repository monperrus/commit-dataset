{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12318000","self":"https://issues.apache.org/jira/rest/api/latest/issue/12318000","key":"DERBY-630","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-10-17 14:35:56.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22059","customfield_12310222":"1_*:*_1_*:*_5111023000_*|*_6_*:*_2_*:*_18116759000_*|*_5_*:*_2_*:*_36609778097_*|*_4_*:*_1_*:*_8169081000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-10-15T15:42:31.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-630/watchers","watchCount":0,"isWatching":false},"created":"2005-10-17T06:20:43.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"4.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12313830","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12313830","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12353221","key":"DERBY-1960","self":"https://issues.apache.org/jira/rest/api/2/issue/12353221","fields":{"summary":"Handle null compilation schema to improve statement cache mechanism","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"New"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-12-13T09:04:44.095+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"When i create a brand new database, and execute the following statements all in one transaction or each of them in their own transaction, then it fails at trigger creation with null pointer exception. if i exclude the schema names from statement, then it runs fine. (If S1 is ommited from every statement then it runs fine). Once the version without the schema names run fine, i can run the version that has schema names, fine also. \n\ncreate schema S1;\n\ncreate table\n  S1.PRODUCT(\n    PRODUCT_ID VARCHAR(255) unique not null,\n    VERSION BIGINT\n  );\n  \ncreate table\n  S1.CATEGORY(\n    CAT_ID VARCHAR(255),\n    NAME varchar(255) not null,\n    VERSION BIGINT\n  );\n\ncreate table\n  S1.PROD_IN_CAT(\n    CAT_ID VARCHAR(255) not null,\n    PRODUCT_ID VARCHAR(255) not null,\n    VERSION BIGINT\n  );\n  \ncreate trigger S1.product_v \nafter update of version on S1.product\nreferencing new as n\nfor each row\nmode db2sql\n\tupdate S1.prod_in_cat set version = n.version where S1.prod_in_cat.product_id=n.product_id;\n\n\n\njava.lang.NullPointerException\n\tat org.apache.derby.impl.sql.catalog.SYSSTATEMENTSRowFactory.makeSYSSTATEMENTSrow(Unknown Source)\n\tat org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addSPSDescriptor(Unknown Source)\n\tat org.apache.derby.impl.sql.execute.CreateTriggerConstantAction.createSPS(Unknown Source)\n\tat org.apache.derby.impl.sql.execute.CreateTriggerConstantAction.executeConstantAction(Unknown Source)Stopping progress indicator for: Executing SQL\n\n\tat org.apache.derby.impl.sql.execute.MiscResultSet.open(Unknown Source)\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\n\tat org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39723","summary":"create trigger fails with null pointer exception","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mardacay","name":"mardacay","emailAddress":"mardacay at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"mardacay","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mardacay","name":"mardacay","emailAddress":"mardacay at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"mardacay","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"windows 2000, sun jdk 1.5.0","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":24,"total":24,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12332185","id":"12332185","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"body":"This looks like duplicate of bug (DERBY-85) NPE when creating a trigger on a table and default schema doesn't exist. If that is correct, we should mark this bug as duplicate.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mamtas","name":"mamtas","emailAddress":"msatoor at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mamta A. Satoor","active":true},"created":"2005-10-17T14:35:56.000+0000","updated":"2005-10-17T14:35:56.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12360470","id":"12360470","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Looks like a Duplicate of DERBY-85","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-12-15T10:04:26.000+0000","updated":"2005-12-15T10:04:26.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12360471","id":"12360471","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"dup of DERBY-85 which is In Progress","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2005-12-15T10:05:11.000+0000","updated":"2005-12-15T10:05:11.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12420714","id":"12420714","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slc","name":"slc","emailAddress":"home4slc at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Susan Cline","active":true},"body":"DERBY-630 is listed as a duplicate of DERBY-85 and was marked fixed in release 10.1.3, however, I believe it is not a duplicate, and although DERBY-85 is fixed in 10.1.3, DERBY-630 is not.\r\n\r\nthe test case for DERBY-85 consists of this:\r\n\r\ncreates a table in the non-default schema \r\ncreates a trigger in the default schema on a table in the non-default schema.\r\n\r\nthe test case for DERBY-630 consists of this:\r\n\r\ncreates a table in the non-default schema \r\ncreates a trigger in the non-default schema on a table in the non-default schema\r\n\r\nBelow is the output from the two test cases run against the 10.1.3 release,\r\nplus an additional one that shows creating a table in the default schema, then a trigger in the default schema on the table in the default schema does succeed.\r\n\r\n\r\nDERBY- 85:\r\n\r\nij> connect 'jdbc:derby:firstDB;create=true;user=someUser;password=somePwd'; \r\nij> create table itko.t1 (i int); \r\n0 rows inserted/updated/deleted \r\nij> create trigger trig1 after update on itko.t1 for each row mode db2sql select \r\n* from sys.systables; \r\n0 rows inserted/updated/deleted \r\n\r\nDERBY-630 (simplified test case):\r\n\r\nij> connect 'jdbc:derby:myDB;create=true;user=someUser;password=somePwd'; \r\nij> create table itko.t1 (i int); \r\n0 rows inserted/updated/deleted \r\nij> create trigger itko.trig1 after update on itko.t1 for each row mode db2sql s \r\nelect * from sys.systables; \r\nERROR XJ001: Java exception: ': java.lang.NullPointerException'. \r\n\r\nTest case showing creating everything in the default schema is OK:\r\n\r\nij> connect 'jdbc:derby:newDB;create=true;user=someUser;password=somePwd'; \r\nij> create table t1 (i int); \r\n0 rows inserted/updated/deleted \r\nij> create trigger trig1 after update on t1 for each row mode db2sql select * fr \r\nom sys.systables; \r\n0 rows inserted/updated/deleted \r\n\r\nSysinfo:\r\n\r\njava org.apache.derby.tools.sysinfo\r\n------------------ Java Information ------------------\r\nJava Version:    1.5.0_06\r\nJava Vendor:     Sun Microsystems Inc.\r\nJava home:       C:\\JDK\\jdk1.5.0_06\\jre\r\nJava classpath:  derby.jar;.;derbytools.jar;\r\nOS name:         Windows XP\r\nOS architecture: x86\r\nOS version:      5.1\r\nJava user name:  slc\r\nJava user home:  C:\\Documents and Settings\\Administrator\r\nJava user dir:   C:\\projects\\gilles_tool\\releases\\Nov_refresh\\installs\\db-derby-\r\n10.1.3.1-lib\\lib\r\njava.specification.name: Java Platform API Specification\r\njava.specification.version: 1.5\r\n--------- Derby Information --------\r\nJRE - JDBC: J2SE 5.0 - JDBC 3.0\r\n[C:\\projects\\gilles_tool\\releases\\Nov_refresh\\installs\\db-derby-10.1.3.1-lib\\lib\r\n\\derby.jar] 10.1.3.1 - (417277)\r\n[C:\\projects\\gilles_tool\\releases\\Nov_refresh\\installs\\db-derby-10.1.3.1-lib\\lib\r\n\\derbytools.jar] 10.1.3.1 - (417277)\r\n------------------------------------------------------\r\n----------------- Locale Information -----------------\r\n------------------------------------------------------\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=slc","name":"slc","emailAddress":"home4slc at yahoo dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Susan Cline","active":true},"created":"2006-07-13T02:31:10.000+0000","updated":"2006-07-13T02:31:10.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12424128","id":"12424128","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cybereal","name":"cybereal","emailAddress":"zacheryjensen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zachery Jensen","active":true},"body":"I can confirm this happening to me in version 10.1.3.1.\r\n\r\nThe test case above causes the issue.  It doesn't occur when creating the triggers on the APP schema.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=cybereal","name":"cybereal","emailAddress":"zacheryjensen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Zachery Jensen","active":true},"created":"2006-07-28T16:29:43.000+0000","updated":"2006-07-28T16:29:43.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12438834","id":"12438834","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"At execution time, it looks like CREATE TRIGGER expects a compilation schema UUID to be available.  Since the above example did not use the schema APP (which already exists after db creation time), the schema \"someUser\" is not created physically yet, so there won't be any UUID available.  When trying to retrieve its\r\nschema descriptor from the data dictionary, getSchemaDescriptor will return null, so trying to access the\r\nUUID will ultimately result in NPE.\r\n\r\nCREATE VIEW also suffers from this problem wth regards to compilation schema.  From looking at the code, it seems it is possible for the non-nullable column COMPILATIONSCHEMAID in SYS.SYSVIEWS to have SQL NULL value.  So to confirm this, I tried the following script on ij:\r\n\r\n> connect 'jdbc:derby:wombat;create=true;user=user2;password=pwd' as user2;\r\n> WARNING 01J01: Database 'wombat' not created, connection made to existing database instead.\r\n> ij(USER2)> create table ippo.t1 (i int);\r\n> 0 rows inserted/updated/deleted\r\n> ij(USER2)> create table ippo.t2 (i int);\r\n> 0 rows inserted/updated/deleted\r\n> ij(USER2)> create view ippo.v1(i) as values 1;\r\n> 0 rows inserted/updated/deleted\r\n> ij(USER2)> -- should return 0 row, as SYS.SYSVIEWS.COMPILATIONSCHEMAID column is not nullable\r\n> select t.tablename, v.compilationschemaid\r\n>    from sys.systables t, sys.sysviews v\r\n>    where t.tableid = v.tableid and t.tablename='V1' and v.compilationschemaid is null;\r\n> TABLENAME    |COMPILATIONSCHEMAID\r\n> ------------------------------------------------------------------------------\r\n> V1                       |NULL\r\n\r\nij> describe sys.sysviews;\r\nCOLUMN_NAME                 |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&\r\n------------------------------------------------------------------------------\r\nTABLEID                                |CHAR           |NULL|NULL  |36             |NULL                 |72                      |NO\r\nVIEWDEFINITION                |LONG VAR&|NULL|NULL  |32700      |NULL                 |NULL                |NO\r\nCHECKOPTION                   |CHAR           |NULL|NULL  |1               |NULL                 |2                         |NO\r\nCOMPILATIONSCHEMAID |CHAR           |NULL|NULL  |36             |NULL                 |72                      |NO\r\n4 rows selected\r\n\r\nSo the above script shows that CREATE VIEW also have a problem.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-09-30T02:43:53.000+0000","updated":"2006-09-30T02:43:53.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12439330","id":"12439330","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"I think to properly address this issue, the current implementation for CREATE TRIGGER needs \r\nto handle null compilation schema.  A compilation schema with null value indicates that the \r\ntrigger action statement text does not depend on the current schema.  This means:\r\n\r\n1.  It is safe to compile this statement in any schema since there is no dependency with \r\n    the CURRENT SCHEMA.  i.e.:  All relevent fields are qualified with a specific schema.\r\n\r\n2.  The statement cache mechanism can utilize this piece of information to enable \r\n    better statement plan sharing across different schemas; thus, avoiding unnecessary \r\n    statement compilation.  \r\n\r\n \r\nSo the proposal is:\r\n\r\na) Allow null compilation schema.  The system catalog first needs to change the \r\n   compiliation schema id column of SYS.SYSSTATEMENTS and SYS.SYSVIEWS system \r\n   table's nullability to true.  This would also require a soft upgrade for the \r\n   previous versions of Derby.  This step will resolve the NPE problem of this jira.\r\n\r\nb) Handle null compilation schema in statement preparation logic.  This can be filed\r\n   as a separate jira as improvement.  It may require some work on the SQL parser to \r\n   determine whether the compiled statement depends on the CURRENT SCHEMA or not, so \r\n   that the compilation schema can be properly set.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-02T22:18:03.000+0000","updated":"2006-10-02T22:18:03.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12439397","id":"12439397","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Attaching proposal patch derby630-trunk-diff01.txt for DERBY-630.  This patch fixes the NPE problem + allowing compilation schema uuid column to be nullable in both SYS.SYSSTATEMENTS and SYS.SYSVIEWS.  If this patch is reasonable, then a subsequent jira should be file to handle null compilation schema in the statement preparation logic as described in my previous comment.  derbyall passes with this patch.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-03T06:57:50.000+0000","updated":"2006-10-03T06:57:50.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12439540","id":"12439540","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Is a null schema the same as an implicit schema? Or is there a different concept being discussed here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-10-03T15:32:36.000+0000","updated":"2006-10-03T15:32:36.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12439569","id":"12439569","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Hi Bryan.  An implicit schema is not the same as a null compilation schema that I described.  An implicit schema or current schema, as we see in DERBY-85:\r\n\r\n<snip>\r\nij> connect 'jdbc:derby:firstDB;create=true;user=someUser;password=somePwd';\r\nij> create table itko.t1 (i int);\r\n0 rows inserted/updated/deleted\r\nij> create trigger trig1 after update on itko.t1 for each row mode db2sql select * from sys.systables; \r\n</snip>\r\n\r\nwill have a compilation schema 'someUser' (the trigger name is not qualified with a schema name, so it will use the current schema, 'someUser' which will be implicitly created at execution time).\r\n\r\nDERBY-630 poses a different problem where the current schema is not explicitly or implicitly created.  \r\n\r\n<snip>\r\nij> connect 'jdbc:derby:myDB;create=true;user=someUser;password=somePwd';\r\nij> create table itko.t1 (i int);\r\n0 rows inserted/updated/deleted\r\nij> create trigger itko.trig1 after update on itko.t1 for each row mode db2sql select * from sys.systables; \r\n</snip>\r\n\r\nSo this is one edge case where the compilation schema can be null since the current schema is not physically created yet, so the spsCompSchemaId is null.  At the CREATE TRIGGER execution time, it\r\nattempts to locate the CURRENT SCHEMA via the data dictionary but this will ultimately return null.  \r\nHence, when attempting to retrieve its UUID, NPE occurs. \r\n\r\nA compilation schema can also be set to null if the statement text does not have dependencies on the CURRENT SCHEMA but this logic does not seem to be implemented yet in Derby.  There are some\r\ncomments in the code but the actual implementation logic is incomplete.  The latter case can benefit statement cache plan sharing across connections in different schema.  The compilation schema is\r\nused as an identity part for the statement.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-03T17:32:58.000+0000","updated":"2006-10-03T17:32:58.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12441257","id":"12441257","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Anyone else have a chance to try out and review the patch for this issue?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-10T19:00:13.000+0000","updated":"2006-10-10T19:00:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12441596","id":"12441596","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Hi Yip, sorry I kind of lost track of this issue. Your explanation of the schema\r\nhandling seems reasonable to me. I intend to commit this patch.\r\n\r\nIf anybody else is reviewing this change, please let us know.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-10-12T01:51:16.000+0000","updated":"2006-10-12T01:51:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12441797","id":"12441797","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"The patch applies cleanly for me and builds without problem. The new tests fail as expected\r\nwithout the code changes, and pass as expected with the code changes. derbyall passes\r\ncleanly for me.\r\n\r\nOne question, though: I see that there is code in the patch which runs during the upgrade\r\npath. Has this code been tested? Are there automated tests of the ugprade processing,\r\nor is the testing manual?\r\n\r\nI am not very familiar with upgrade and so am not certain what sort of review is useful for\r\nthe upgrade changes. I read through the code and it makes sense, and your comments\r\nin the code are very useful. I'm just wondering about the testing, both manual and automated.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-10-12T16:51:20.000+0000","updated":"2006-10-12T16:51:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12441875","id":"12441875","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Hi Bryan.  I am glad that you brought this up.  In the current state of the trunk, the soft upgrade code that I put into the current patch will not get triggered since the release.properties file's beta property is set to true and the maint property has a value of 0 which indicates alpha.  Thus, the system will not allow an upgrade to occur.  i.e.:\r\n\r\n<snip>\r\nij version 10.3\r\nij> connect 'jdbc:derby:db102' user 'user1';\r\nERROR XJ040: Failed to start database 'db102', see the next exception for details.\r\nERROR XCW00: Unsupported upgrade from '10.2' to '10.3 beta'.\r\n</snip>\r\n\r\nI am not sure what the next release will be, so I didn't modify the release.properties file.  However, I did run the soft upgrade test manually to verify my code changes are executed correctly.  What I did was:\r\n\r\n1) Set the beta property to false and maint property to non-zero value (1000001, for example)\r\n\r\n2) In order for the soft upgrade to get triggered, the data dictionary(dd) version (currently 140 for 10.2.1.6) \r\nneeds to  be incremented to a higher version number than the on-disk version.  \r\n\r\n3) Create the database in 10.2.1.6, this will have dd version of 140.\r\n\r\n<snip>\r\nij version 10.2\r\nij> connect 'jdbc:derby:db102;create=true' user 'user1';\r\nWARNING 01J14: SQL authorization is being used without first enabling authentication.\r\nij> describe 'sys.sysstatements';\r\nCOLUMN_NAME         |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&\r\n------------------------------------------------------------------------------\r\nSTMTID              |CHAR     |NULL|NULL|36    |NULL      |72        |NO\r\nSTMTNAME            |VARCHAR  |NULL|NULL|128   |NULL      |256       |NO\r\nSCHEMAID            |CHAR     |NULL|NULL|36    |NULL      |72        |NO\r\nTYPE                |CHAR     |NULL|NULL|1     |NULL      |2         |NO\r\nVALID               |BOOLEAN  |NULL|NULL|1     |NULL      |NULL      |NO\r\nTEXT                |LONG VAR&|NULL|NULL|32700 |NULL      |NULL      |NO\r\nLASTCOMPILED        |TIMESTAMP|0   |10  |26    |NULL      |NULL      |YES\r\nCOMPILATIONSCHEMAID |CHAR     |NULL|NULL|36    |NULL      |72        |NO\r\nUSINGTEXT           |LONG VAR&|NULL|NULL|32700 |NULL      |NULL      |YES\r\n\r\n9 rows selected\r\n\r\nij> describe 'sys.sysviews';\r\nCOLUMN_NAME         |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&\r\n------------------------------------------------------------------------------\r\nTABLEID             |CHAR     |NULL|NULL|36    |NULL      |72        |NO\r\nVIEWDEFINITION      |LONG VAR&|NULL|NULL|32700 |NULL      |NULL      |NO\r\nCHECKOPTION         |CHAR     |NULL|NULL|1     |NULL      |2         |NO\r\nCOMPILATIONSCHEMAID |CHAR     |NULL|NULL|36    |NULL      |72        |NO\r\n\r\n4 rows selected\r\n</snip>\r\n\r\n\r\n4) Boot this 10.2 database using the trunk code with my patch(dd version for runtime is 141).\r\n<snip>\r\nij version 10.3\r\nij> connect 'jdbc:derby:db102' user 'user1';\r\nWARNING 01J14: SQL authorization is being used without first enabling authentication.\r\nij> describe 'sys.sysstatements';\r\nCOLUMN_NAME         |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&\r\n------------------------------------------------------------------------------\r\nSTMTID              |CHAR     |NULL|NULL|36    |NULL      |72        |NO\r\nSTMTNAME            |VARCHAR  |NULL|NULL|128   |NULL      |256       |NO\r\nSCHEMAID            |CHAR     |NULL|NULL|36    |NULL      |72        |NO\r\nTYPE                |CHAR     |NULL|NULL|1     |NULL      |2         |NO\r\nVALID               |BOOLEAN  |NULL|NULL|1     |NULL      |NULL      |NO\r\nTEXT                |LONG VAR&|NULL|NULL|32700 |NULL      |NULL      |NO\r\nLASTCOMPILED        |TIMESTAMP|0   |10  |26    |NULL      |NULL      |YES\r\nCOMPILATIONSCHEMAID |CHAR     |NULL|NULL|36    |NULL      |72        |YES\r\nUSINGTEXT           |LONG VAR&|NULL|NULL|32700 |NULL      |NULL      |YES\r\n\r\n9 rows selected\r\nij> describe 'sys.sysviews';\r\nCOLUMN_NAME         |TYPE_NAME|DEC&|NUM&|COLUM&|COLUMN_DEF|CHAR_OCTE&|IS_NULL&\r\n------------------------------------------------------------------------------\r\nTABLEID             |CHAR     |NULL|NULL|36    |NULL      |72        |NO\r\nVIEWDEFINITION      |LONG VAR&|NULL|NULL|32700 |NULL      |NULL      |NO\r\nCHECKOPTION         |CHAR     |NULL|NULL|1     |NULL      |2         |NO\r\nCOMPILATIONSCHEMAID |CHAR     |NULL|NULL|36    |NULL      |72        |YES\r\n\r\n4 rows selected\r\n</snip>\r\n\r\nNotice the COMPILATIONSCHEMAID's IS_NULLABLE column for both system tables are now set to true \r\nafter the soft upgrade.  So it works as expected. \r\n\r\nFor step 2 described above, the DD runtime version should have been incremented along with this fix \r\nand I noticed there is an 10.1 to 10.2 upgrade test available in the regression.  Perhaps I can \r\ninvestigate this abit more and make this verification step automated with this test.  \r\nI'll resubmit a follow-up patch.  \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-12T21:22:50.000+0000","updated":"2006-10-12T21:22:50.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12441883","id":"12441883","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Hmm...  I cannot seem to attach file to this jira as well:\r\n\r\nException trying to establish attachment directory. Check that the application server and JIRA have permissions to write to it: com.atlassian.jira.web.util.AttachmentException: Cannot write to attachment directory. Check that the application server and JIRA have permissions to write to: /usr/local/tomcat/tomcat-jira/attachments/DERBY/DERBY-630","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-12T23:14:18.000+0000","updated":"2006-10-12T23:14:18.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12442078","id":"12442078","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Attaching derby630-trunk-diff02.txt.  This patch contains the automated upgrade test from 10.1 to 10.3.  Running derbyall now, will post result when it completes.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-13T18:38:21.000+0000","updated":"2006-10-13T18:38:21.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12442102","id":"12442102","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"derbyall passes with patch derby630-trunk-diff02.txt.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-13T21:46:16.000+0000","updated":"2006-10-13T21:46:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12442103","id":"12442103","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks for investigating the automated upgrade test! I will have a look at the new patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-10-13T22:04:50.000+0000","updated":"2006-10-13T22:04:50.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12442304","id":"12442304","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Hi Yip, thanks very much for adding the upgrade test. It looks great, and it passes fine in my environment.\r\n\r\nHowever, I am wondering: should we fix DERBY-1689 first? More precisely, do you think that committing\r\nthis change will make it harder to address DERBY-1689? If not, I think I'm ready to commit this patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-10-14T15:24:36.000+0000","updated":"2006-10-14T15:24:36.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12442368","id":"12442368","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Hi Bryan.  Thanks for your continous review of the patches.  \r\n\r\nIf DERBY-1689 is still using the same upgrade test infrastructure, then this patch shouldn't make it harder to address the upgrade issue for 10.3.  \r\n\r\nThis patch has already activated the upgrade test for 10.1 to 10.3.  To enable 10.2 to 10.3 upgrade test as described in DERBY-1689, the 10.2 release jars needs to be check-in to the trunk code line first.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-15T05:55:41.000+0000","updated":"2006-10-15T05:55:41.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12442401","id":"12442401","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Thanks Yip and Deepa for the info on the upgrade testing infrastructure. I think\r\neverything is good to go here, so I committed patch diff02 to subversion as\r\nrevision 464215.\r\n\r\nThanks Yip for all the patches and explanations. Can you verify that the fix looks\r\ngood and close this issue? \r\n\r\nAlso, you made a comment about needing to file a follow-on issue to track the\r\nimprovement of the statement cache mechanism to avoid unnecessary\r\nstatement compilation. Did that follow-on issue get filed? If so, it would be\r\nnice to link that issue to this one.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-10-15T15:42:31.000+0000","updated":"2006-10-15T15:42:31.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12442412","id":"12442412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"body":"Hi Bryan, I opened DERBY-1960 for the second part of the proposal.  Thanks for committing the patch.\r\nOne question though, will this patch be back ported to 10.2 line?  I think the current patch cannot be apply \r\nto the 10.2 line since it involves data dictionary upgrade.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=yipng","name":"yipng","emailAddress":"yipng168 at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Yip Ng","active":true},"created":"2006-10-15T18:34:45.000+0000","updated":"2006-10-15T18:34:45.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12442416","id":"12442416","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"I am not intending to port this patch to 10.2. I agree with you that the upgrade requirements\r\nwould necessitate special handling. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2006-10-15T18:53:34.000+0000","updated":"2006-10-15T18:53:34.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12318000/comment/12551294","id":"12551294","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"body":"This issue has been resolved for over a year with no further movement. Closing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=fuzzylogic","name":"fuzzylogic","emailAddress":"mcintyre dot a at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Andrew McIntyre","active":true},"created":"2007-12-13T09:04:44.091+0000","updated":"2007-12-13T09:04:44.091+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-630/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i075wn:"}}