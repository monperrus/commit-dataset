{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12506563","self":"https://issues.apache.org/jira/rest/api/latest/issue/12506563","key":"CASSANDRA-2626","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310865","id":"12310865","key":"CASSANDRA","name":"Cassandra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310865&avatarId=12034","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310865&avatarId=12034","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310865&avatarId=12034","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310865&avatarId=12034"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11961","id":"11961","description":"Apache Cassandra related projects","name":"Cassandra"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316403","id":"12316403","description":"","name":"0.8.0","archived":false,"released":true,"releaseDate":"2011-06-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2011-05-09 05:22:03.994","customfield_12312322":null,"customfield_12312323":null,"customfield_12310222":"1_*:*_1_*:*_1433074453_*|*_5_*:*_2_*:*_25077079_*|*_4_*:*_1_*:*_58853062","customfield_12310420":"20738","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2011-05-26T18:28:20.324+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-2626/watchers","watchCount":5,"isWatching":false},"created":"2011-05-09T05:04:55.769+0000","customfield_10022":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12311124":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skamio","name":"skamio","emailAddress":"kamioshot at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shotaro Kamio","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-05-26T18:28:20.359+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312978","id":"12312978","name":"Core"}],"timeoriginalestimate":null,"description":"This is a trunk build from May 3.\r\n\r\nAfter adding  CASSANDRA-2401, I have gotten the following on several nodes.\r\nI am not 100% sure right now if it is related to 2401 but it may seem likely.\r\n\r\nUnfortunately, as often is the case with stack overflows, I don't see the start of the stack\r\n\r\nERROR [CompactionExecutor:17] 2011-05-09 07:56:32,479 AbstractCassandraDaemon.java (line 112) Fatal exception in thread Thread[CompactionExecutor:17,1,main]\r\njava.lang.StackOverflowError\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12480437","id":"12480437","filename":"2626.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-25T17:50:01.503+0000","size":1384,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12480437/2626.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12480545","id":"12480545","filename":"2626-v3.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-26T14:03:16.277+0000","size":4912,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12480545/2626-v3.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12480519","id":"12480519","filename":"CASSANDRA-2626.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skamio","name":"skamio","emailAddress":"kamioshot at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shotaro Kamio","active":true},"created":"2011-05-26T08:24:22.311+0000","size":1160,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12480519/CASSANDRA-2626.patch"}],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"93454","summary":"stack overflow while compacting","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=terjem","name":"terjem","emailAddress":"tmarthinussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Terje Marthinussen","active":true},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=terjem","name":"terjem","emailAddress":"tmarthinussen at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Terje Marthinussen","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"customfield_12311420":null,"customfield_12311421":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":13,"total":13,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13030612","id":"13030612","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"The only place we construct a UnmodifableCollection explicitly is Table.getColumnFamilyStores, which clearly doesn't nest enough UCs to blow a stack.  Something else must be doing that under the hood...\r\n\r\nDoesn't look 2401-related at all.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-09T05:22:03.994+0000","updated":"2011-05-09T05:22:03.994+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039115","id":"13039115","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skamio","name":"skamio","emailAddress":"kamioshot at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shotaro Kamio","active":true},"body":"I was able to reproduce the stack overflow problem on cassandra 0.8.0 trunk.\r\nThe DataTracker creates unmodifiableSet of 'Set<SSTableReader> compacting' on switching memtable and other operations. It creates unmodifiableSet one level deeper every time memtables is switched. When the number of switching memtable reaches some level and its size() is called, the stack overflow exception occurs if the call stack exceeds stack limit.\r\n\r\nStack trace below (dumped by simple wrapper class MyUnmodifiableSet) shows size() is called by constructor of HashSet in View.markCompacting() (DataTracker.java).\r\nIf the nesting is unavoidable, a solution is to use UnmodifiableSet in apache commons collections library. It doesn't create nests of unmodifiable collection.\r\n\r\n\r\nSteps to reproduce the stack overflow:\r\n1. Create single cassandra node with standard column families.\r\n2. Disable compaction and set MemtableThroughputInMB and MemtableOperationsInMillions to small value in order to flush memtables frequently.\r\n3. Insert many data for many keys.\r\n4. When number of sstables exceeds 2000 (this parameter may vary in environments), run \"nodetool compact\". The error will be logged.\r\n\r\n\r\n-------\r\n* Change for debug in DataTracker.java:\r\n{quote}\r\n        public View(Memtable memtable, Set<Memtable> pendingFlush, Set<SSTableReader> sstables, Set<SSTableReader> compacting)\r\n        \\{\r\n            this.memtable = memtable;\r\n  //             this.memtablesPendingFlush = Collections.unmodifiableSet(pendingFlush);\r\n  //             this.sstables = Collections.unmodifiableSet(sstables);\r\n  //             this.compacting = Collections.unmodifiableSet(compacting);\r\n\r\n            this.memtablesPendingFlush = new MyUnmodifiableSet(pendingFlush);\r\n            this.sstables              = new MyUnmodifiableSet(sstables);\r\n            this.compacting            = new MyUnmodifiableSet(compacting);\r\n        \\}\r\n{quote}\r\n-------\r\n* Stacktrace by Thread.dumpStack() in MyUnmodifiableSet.\r\n\r\n        at java.lang.Thread.dumpStack(Thread.java:1249)\r\n        at org.apache.cassandra.db.MyUnmodifiableSet.size(MyUnmodifiableSet.java:35)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at org.apache.cassandra.db.MyUnmodifiableSet.size(MyUnmodifiableSet.java:36)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at org.apache.cassandra.db.MyUnmodifiableSet.size(MyUnmodifiableSet.java:36)\r\n   ......\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at org.apache.cassandra.db.MyUnmodifiableSet.size(MyUnmodifiableSet.java:36)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at org.apache.cassandra.db.MyUnmodifiableSet.size(MyUnmodifiableSet.java:36)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at org.apache.cassandra.db.MyUnmodifiableSet.size(MyUnmodifiableSet.java:36)\r\n        at java.util.Collections$UnmodifiableCollection.size(Collections.java:998)\r\n        at org.apache.cassandra.db.MyUnmodifiableSet.size(MyUnmodifiableSet.java:36)\r\n        at java.util.HashSet.<init>(HashSet.java:99)\r\n        at org.apache.cassandra.db.DataTracker$View.markCompacting(DataTracker.java:495)\r\n        at org.apache.cassandra.db.DataTracker.markCompacting(DataTracker.java:188)\r\n        at org.apache.cassandra.db.CompactionManager$4.call(CompactionManager.java:312)\r\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:138)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\r\n        at java.lang.Thread.run(Thread.java:662)\r\n\r\n------","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skamio","name":"skamio","emailAddress":"kamioshot at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shotaro Kamio","active":true},"created":"2011-05-25T13:28:41.582+0000","updated":"2011-05-25T13:28:41.582+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039237","id":"13039237","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"Ah, you've nailed it. Thanks for tracking that down.\r\n\r\nPatch attached to avoid re-wrapping an already unmodifiable collection. (Surprised Collections.unmodifiable... doesn't do this.)\r\n\r\nWe may also want to look at using ImmutableSet (http://guava-libraries.googlecode.com/svn/trunk/javadoc/com/google/common/collect/ImmutableSet.html) instead of HashSet wrapped in UnmodifiableSet. (ImmutableSet claims to \"perform significantly better than HashSet for objects with very fast Object.hashCode() implementations.\")","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-25T17:50:01.546+0000","updated":"2011-05-25T17:50:01.546+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039247","id":"13039247","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"(Did a quick check on our other uses of Collections.unmodifiable*, didn't see any red flags.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-25T18:01:16.520+0000","updated":"2011-05-25T18:01:16.520+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039268","id":"13039268","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mdennis","name":"mdennis","emailAddress":"mdennis at riptano dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matthew F. Dennis","active":true},"body":"+1","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mdennis","name":"mdennis","emailAddress":"mdennis at riptano dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Matthew F. Dennis","active":true},"created":"2011-05-25T18:26:35.233+0000","updated":"2011-05-25T18:26:35.233+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039286","id":"13039286","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"committed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-25T19:09:30.216+0000","updated":"2011-05-25T19:09:30.216+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039469","id":"13039469","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=muga_nishizawa","name":"muga_nishizawa","emailAddress":"muga dot nishizawa at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Muga Nishizawa","active":true},"body":"Thanks for your quick response.  \r\n\r\nI'm not sure but I think that the fix doesn't work.  Types of pendingFlush, sstables and compacting objects are java.util.Collections.UnmodifiableSet.  Those are not instances of org.apache.commons.collections.set.UnmodifiableSet.  ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=muga_nishizawa","name":"muga_nishizawa","emailAddress":"muga dot nishizawa at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Muga Nishizawa","active":true},"created":"2011-05-26T01:24:48.811+0000","updated":"2011-05-26T01:46:16.298+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039480","id":"13039480","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brandon.williams","name":"brandon.williams","emailAddress":"driftx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brandon.williams&avatarId=10054","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brandon.williams&avatarId=10054","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brandon.williams&avatarId=10054","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brandon.williams&avatarId=10054"},"displayName":"Brandon Williams","active":true},"body":"Confirmed, stack gets blown with >2k sstables still.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brandon.williams","name":"brandon.williams","emailAddress":"driftx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brandon.williams&avatarId=10054","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brandon.williams&avatarId=10054","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brandon.williams&avatarId=10054","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brandon.williams&avatarId=10054"},"displayName":"Brandon Williams","active":true},"created":"2011-05-26T02:07:27.259+0000","updated":"2011-05-26T02:07:27.259+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039586","id":"13039586","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skamio","name":"skamio","emailAddress":"kamioshot at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shotaro Kamio","active":true},"body":"This patch prevents stack overflow. Apache commons UnmodifiableSet is used instead of java.util.Collections.UnmodifiableSet because the latter is not accessible due to package private.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=skamio","name":"skamio","emailAddress":"kamioshot at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shotaro Kamio","active":true},"created":"2011-05-26T08:24:22.345+0000","updated":"2011-05-26T08:24:22.345+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039694","id":"13039694","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"Oh no! Auto-import for the lose :(","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-26T13:16:09.085+0000","updated":"2011-05-26T13:16:09.085+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039715","id":"13039715","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"v3 takes a slightly different approach -- instead of accepting any Set in the constructor and decorating it w/ Unmodifiable, v3 restricts constructor to private access and makes the factory methods responsible for ensuring the set is unmodifiable, by using ImmutableSet as mentioned above.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-26T14:03:16.330+0000","updated":"2011-05-26T14:03:16.330+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039842","id":"13039842","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brandon.williams","name":"brandon.williams","emailAddress":"driftx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brandon.williams&avatarId=10054","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brandon.williams&avatarId=10054","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brandon.williams&avatarId=10054","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brandon.williams&avatarId=10054"},"displayName":"Brandon Williams","active":true},"body":"+1, I like this approach better too.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brandon.williams","name":"brandon.williams","emailAddress":"driftx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brandon.williams&avatarId=10054","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brandon.williams&avatarId=10054","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brandon.williams&avatarId=10054","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brandon.williams&avatarId=10054"},"displayName":"Brandon Williams","active":true},"created":"2011-05-26T18:06:45.989+0000","updated":"2011-05-26T18:06:45.989+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12506563/comment/13039853","id":"13039853","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"committed v3","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2011-05-26T18:28:20.332+0000","updated":"2011-05-26T18:28:20.332+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-2626/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0gchr:"}}