{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12373626","self":"https://issues.apache.org/jira/rest/api/latest/issue/12373626","key":"DERBY-2931","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2007-07-12 14:49:58.452","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"23324","customfield_12310222":"1_*:*_1_*:*_92526438_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_10310549757","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-07-13T14:42:54.675+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2931/watchers","watchCount":0,"isWatching":false},"created":"2007-07-12T13:00:48.237+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/1","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/blocker.png","name":"Blocker","id":"1"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2008-07-25T17:19:13.470+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11412","id":"11412","name":"Store"}],"timeoriginalestimate":null,"description":"1. Created at database system/wombat with ij version 10.2\n2. Ran jdbcapi/ConcurrencyTest with same current directory. All test cases but the first test fail with:\n\n30) testTruncateDuringScan(org.apache.derbyTesting.functionTests.tests.jdbcapi.ConcurrencyTest)junit.framework.ComparisonFailure: 'drop table t1' failed with unexpected SQL State expected:<[42Y55]> but was:<[XSDA7]>\n        at org.apache.derbyTesting.functionTests.tests.jdbcapi.SURDataModelSetup.createDataModel(SURDataModelSetup.java:70)\n        at org.apache.derbyTesting.functionTests.tests.jdbcapi.SURDataModelSetup.createDataModel(SURDataModelSetup.java:125)\n        at org.apache.derbyTesting.functionTests.tests.jdbcapi.ConcurrencyTest.setUp(ConcurrencyTest.java:54)\n        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88)\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)\n        at junit.extensions.TestSetup.run(TestSetup.java:25)\n        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)\n        at junit.extensions.TestSetup.run(TestSetup.java:25)\n        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)\n        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)\n        at junit.extensions.TestSetup.run(TestSetup.java:25)\n        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"39439","summary":"jdbcapi/ConcurrencyTest not able to drop table in soft upgrade mode","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oysteing","name":"oysteing","emailAddress":"oystein dot grovlen at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Øystein Grøvlen","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oysteing","name":"oysteing","emailAddress":"oystein dot grovlen at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Øystein Grøvlen","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Soft upgrade ","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":12,"total":12,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512099","id":"12512099","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oysteing","name":"oysteing","emailAddress":"oystein dot grovlen at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Øystein Grøvlen","active":true},"body":"If I boot the database in ij after running the ConcurrencyTest and try to drop the table, I get:\r\nij version 10.3\r\nij> connect  'jdbc:derby:system/wombat';\r\nij> drop table t1;\r\nERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\njava.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.seeNextException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source)        at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.Main.go(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source)\r\n        at org.apache.derby.tools.ij.main(Unknown Source)\r\nCaused by: java.sql.SQLException: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n        ... 18 more\r\nCaused by: java.sql.SQLException: Java exception: ': java.io.EOFException'.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.javaException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n        ... 15 more\r\nCaused by: java.io.EOFException\r\n        at org.apache.derby.iapi.services.io.ArrayInputStream.readUnsignedByte(Unknown Source)\r\n        at org.apache.derby.iapi.services.io.CompressedNumber.readInt(Unknown Source)\r\n        at org.apache.derby.impl.store.access.conglomerate.ConglomerateUtil.readCollationIdArray(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.Heap.localReadExternal(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.Heap.readExternalFromArray(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.StoredPage.restoreRecordFromSlot(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.BasePage.fetchFromSlot(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.HeapConglomerateFactory.readConglomerate(Unknown Source)\r\n        at org.apache.derby.impl.store.access.RAMAccessManager.conglomCacheFind(Unknown Source)\r\n        at org.apache.derby.impl.store.access.RAMTransaction.findExistingConglomerate(Unknown Source)\r\n        at org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.DDLConstantAction.lockTableForDDL(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.DropTableConstantAction.executeConstantAction(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.MiscResultSet.open(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)\r\n        ... 11 more\r\nERROR XJ001: Java exception: ': java.io.EOFException'.\r\njava.sql.SQLException: Java exception: ': java.io.EOFException'.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.Util.javaException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(Unknown Source)        at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.Main.go(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)\r\n        at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source)\r\n        at org.apache.derby.tools.ij.main(Unknown Source)\r\nCaused by: java.sql.SQLException: Java exception: ': java.io.EOFException'.\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)\r\n        ... 19 more\r\nCaused by: java.io.EOFException\r\n        at org.apache.derby.iapi.services.io.ArrayInputStream.readUnsignedByte(Unknown Source)\r\n        at org.apache.derby.iapi.services.io.CompressedNumber.readInt(Unknown Source)\r\n        at org.apache.derby.impl.store.access.conglomerate.ConglomerateUtil.readCollationIdArray(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.Heap.localReadExternal(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.Heap.readExternalFromArray(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.StoredPage.readRecordFromArray(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.StoredPage.restoreRecordFromSlot(Unknown Source)\r\n        at org.apache.derby.impl.store.raw.data.BasePage.fetchFromSlot(Unknown Source)\r\n        at org.apache.derby.impl.store.access.heap.HeapConglomerateFactory.readConglomerate(Unknown Source)\r\n        at org.apache.derby.impl.store.access.RAMAccessManager.conglomCacheFind(Unknown Source)\r\n        at org.apache.derby.impl.store.access.RAMTransaction.findExistingConglomerate(Unknown Source)\r\n        at org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.DDLConstantAction.lockTableForDDL(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.DropTableConstantAction.executeConstantAction(Unknown Source)\r\n        at org.apache.derby.impl.sql.execute.MiscResultSet.open(Unknown Source)\r\n        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)\r\n        ... 11 more\r\nij>\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oysteing","name":"oysteing","emailAddress":"oystein dot grovlen at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Øystein Grøvlen","active":true},"created":"2007-07-12T14:00:23.965+0000","updated":"2007-07-12T14:00:23.965+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512121","id":"12512121","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I found that the bug can be reproduced with these three steps:\r\n\r\n1. Create a database with 10.2:\r\n\r\nij version 10.2\r\nij> connect 'jdbc:derby:db;create=true';\r\nij> exit;\r\n\r\n2. Connect to the same database with 10.3 in soft upgrade mode and create a table, then exit ij:\r\n\r\nij version 10.3\r\nij> connect 'jdbc:derby:db';\r\nij> create table t (x int);\r\n0 rows inserted/updated/deleted\r\nij> exit;\r\n\r\n3. Connect with 10.3 again and try to fetch the contents of the table:\r\n\r\nij version 10.3\r\nij> connect 'jdbc:derby:db';\r\nij> select * from t;\r\nERROR XSDA7: Restore of a serializable or SQLData object of class , attempted to read more data than was originally stored\r\nERROR XJ001: Java exception: ': java.io.EOFException'.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2007-07-12T14:49:58.452+0000","updated":"2007-07-12T14:49:58.452+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512123","id":"12512123","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"I see the same error when soft upgrading from 10.1.3.1 to 10.3.1.1, but not from 10.1.3.1 to 10.2.2.0.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2007-07-12T14:51:18.700+0000","updated":"2007-07-12T14:51:18.700+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512134","id":"12512134","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Increasing priority to 'Blocker' since this seems like a serious error that users are likely to hit, and it might potentially corrupt existing databases.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2007-07-12T15:08:08.165+0000","updated":"2007-07-12T15:08:08.165+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512179","id":"12512179","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I'm looking at it now.  The stack indicates readExternal is looking for collation information, but in a soft upgraded table there should not be any.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2007-07-12T17:10:44.779+0000","updated":"2007-07-12T17:10:44.779+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512204","id":"12512204","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"derby2931.diff is proposed fix for derby2931 for the trunk.  Mostly comment changes and fixes the format id version used for accessing old format Heap's,\r\nit was incorrectly using the new one.  To reproduce you need to create pre-10.3 base table, and then in 10.3 somehow access that table not from cache.  \r\nEasiest is to shut down and startup again in a soft upgrade db, but bug would also happen if you managed to access enough tables to age out the created table from the container cache.  \r\n\r\nSo far I have run upgrade tests against fix applied to 10.3 branch and hand tested the change against the repro case that Knut describes in this JIRA entry.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2007-07-12T18:36:34.496+0000","updated":"2007-07-12T18:36:34.496+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512250","id":"12512250","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"This is a test case for this issue. I accidentally posted to the wrong issue.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2007-07-12T20:35:20.080+0000","updated":"2007-07-12T20:35:20.080+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512273","id":"12512273","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Thanks for writing the test case, Kathey. It looks good, but I was wondering whether it would be better to put it in BasicSetup rather than in Changes10_3. When it is in Changes10_3, it is only tested for upgrades from Derby<10.3, so if something similar sneaks in in future releases, we might miss it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2007-07-12T21:57:41.507+0000","updated":"2007-07-12T21:57:41.507+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512300","id":"12512300","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I've checked in fixes and updates to the upgrade test for both trunk and branch.  I not going to mark it fixed until Oystein has a chance to check it out in his test.  The changes to the upgrade test definitely showed the bug and were fixed by the checkin.  I included Kathy's test case in the upgrade changes as well as a slightly different test I had written.  \r\n\r\nI think the comments about putting the test in the basic class rather than 10.3 also apply to my test case but I won't have a chance to get to that for a bit. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2007-07-12T23:04:07.843+0000","updated":"2007-07-12T23:04:07.843+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512366","id":"12512366","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oysteing","name":"oysteing","emailAddress":"oystein dot grovlen at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Øystein Grøvlen","active":true},"body":"I applied Mike's patch, and the jdbcapi/ConcurrencyTest now runs without errors.  Thanks, for fixing this in such a short time!  (This fix also seems to have got rid of the serialization errors I saw in the BlobClob4BlobTest).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=oysteing","name":"oysteing","emailAddress":"oystein dot grovlen at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Øystein Grøvlen","active":true},"created":"2007-07-13T05:47:49.827+0000","updated":"2007-07-13T05:47:49.827+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512503","id":"12512503","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"marking fixed","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-07-13T14:42:54.598+0000","updated":"2007-07-13T14:42:54.598+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12373626/comment/12512505","id":"12512505","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"3rd time setting fixin.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-07-13T14:44:27.095+0000","updated":"2007-07-13T14:44:27.095+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-2931/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0745j:"}}