{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12385459","self":"https://issues.apache.org/jira/rest/api/latest/issue/12385459","key":"DERBY-3299","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2008-02-15 08:13:13.82","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"23554","customfield_12310222":"1_*:*_1_*:*_4210556204_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_452202196","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2008-02-20T16:40:28.955+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-3299/watchers","watchCount":0,"isWatching":false},"created":"2008-01-02T23:04:32.751+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"9.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311953","id":"12311953","description":"","name":"10.1.3.1","archived":false,"released":true,"releaseDate":"2006-06-30"},{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312027","id":"12312027","description":"","name":"10.2.2.0","archived":false,"released":true,"releaseDate":"2006-12-19"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12312876","id":"12312876","description":"","name":"10.3.2.1","archived":false,"released":true,"releaseDate":"2007-12-10"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12313111","id":"12313111","description":"","name":"10.4.1.3","archived":false,"released":true,"releaseDate":"2008-04-24"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[{"id":"12339439","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12339439","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12508599","key":"DERBY-5249","self":"https://issues.apache.org/jira/rest/api/2/issue/12508599","fields":{"summary":"A table created with 10.0.2.1 with constraints cannot be dropped with 10.5 due to NullPointerException with insane build or ASSERT FAILED Failed to find sharable conglomerate descriptor for index conglomerate  with sane build","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false}}}}],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-06-03T01:39:18.600+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"When there are multiple constraints on a single table and the constraints have the same set of columns (in the same order), Derby tries to optimize things by re-using a single backing index for all of the relevant constraints.  See the \"executeConstantAction()\" method of CreateIndexConstantAction.java (search for \"duplicate\").\n\nBut there is a bug in Derby where, if one of the constraints is unique and is dropped, the uniqueness \"attribute\" of the backing index is not updated accordingly.  This means that uniqueness may be incorrectly enforced where it is not required.\n\nTake the following example (\"Case 2\" from DERBY-2204):\n\n  ALTER TABLE NEWORDERS ADD CONSTRAINT\n      NEWORDERS_PK PRIMARY KEY(NO_W_ID, NO_D_ID, NO_O_ID);\n\n  ALTER TABLE NEWORDERS ADD CONSTRAINT\n      NO_O_FK FOREIGN KEY (NO_W_ID, NO_D_ID, NO_O_ID) REFERENCES ORDERS;\n\nFor these statements Derby will use a single backing index for both the primary constraint NEWORDERS_PK and the foreign key constraint NO_O_FK.  That backing index will be unique because the primary key must itself be unique.\n\nIf later we drop the primary key:\n\n  ALTER TABLE NEWORDERS DROP CONSTRAINT NEWORDERS_PK;\n\nthen the backing index needs to be converted from a unique index to a non-unique index (because a foreign key is not inherently unique).  But in Derby the uniqueness attribute remains unchanged, so attempts to insert a duplicate (NO_W_ID, NO_D_ID, NO_O_ID) row into NEWORDERS will fail with error 23505, when it should really succeed.\n\nI tried this out on 10.1.3.1 and the same behavior occurs there, so marking \"Affects\" versions for everything back to that...","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36431","summary":"Uniqueness violation error (23505) occurs after dropping a PK constraint if there exists a foreign key on the same columns.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":14,"total":14,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12555436","id":"12555436","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching a repro script to show the problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-01-02T23:05:13.467+0000","updated":"2008-01-02T23:05:13.467+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12566189","id":"12566189","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching d3299_v1.patch, which is a first attempt at addressing this issue.\r\n\r\nThe general approach taken by this patch is to \"update\" the physical conglomerate by first dropping the old conglomerate and then creating a new (non-unique) conglomerate.  So with respect to the example given in the description for this Jira, namely:\r\n\r\n  ALTER TABLE NEWORDERS ADD CONSTRAINT\r\n      NEWORDERS_PK PRIMARY KEY(NO_W_ID, NO_D_ID, NO_O_ID)\r\n\r\n  ALTER TABLE NEWORDERS ADD CONSTRAINT\r\n      NO_O_FK FOREIGN KEY (NO_W_ID, NO_D_ID, NO_O_ID) REFERENCES ORDERS; \r\n\r\nwhere NEWORDERS_PK and NO_O_FK share a unique physical conglomerate, the d3299_v1.patch will make it so that the statement:\r\n\r\n  ALTER TABLE NEWORDERS DROP CONSTRAINT NEWORDERS_PK\r\n\r\nleads to a) the dropping of the unique physical conglomerate backing NEWORDERS_PK and b) the creation of a new NON-unique physical conglomerate to back NO_O_FK. This will only happen in cases where the physical conglomerate has to change. So if, for example, there are two foreign keys on a single table with the same columns and sorting requirements, and one of those foreign keys is dropped, we would NOT need to update the physical conglomerate for the other foreign key, and thus we would skip the \"drop and re-create\" processing.\r\n\r\nThis particular change means that dropping a primary key whose backing conglomerate is shared by one or more foreign keys might take some time (due to the potential creation of an entirely new (non-unique) conglomerate, which must then be populated).\r\n\r\nThe other approach would be to see if there is a uniqueness \"switch\" within the physical conglomerate that we could trun off, thus allowing us to use the same physical conglomerate but to disable uniqueness checking.  If possible, that would almost certainly lead to faster DROP CONSTRAINT processing than the approach taken in d3299_v1.patch (when shared conglomerates are at play).\r\n\r\nHowever, I chose to go with the \"drop and re-create\" approach for two reasons. First, in the interest of supporting a \"modular\" store as much as possible, it seems cleaner to follow an approach which does not depend on classes or \"switches\" that are specific to a given disk storage implementation. The approach of dropping a unique conglomerate and creating a new, non-unique one should, in theory, be usable regardless of how the storage implementation treats unique vs non-unique indexes.  It may not be optimal, but it seems more flexible. The second reason I opted for this approach is that I have been working with an eye toward DERBY-2204, for which the \"drop and re-create\" approach seems like more of a necessity.  By resolving this issue in that manner, I'm hoping that changes for DERBY-2204 will be able to re-use or benefit from a good amount of the code that I'm proposing to add for this issue.\r\n\r\nIt is of course possible to improve upon the d3299_v1.patch in the future if performance of DROP CONSTRAINTs becomes an issue.  But for now I'm leaving that as a potential future enhancement...\r\n\r\nMore on the d3299_v1.patch:\r\n\r\n  - Adds several utility methods to DDLSingleTableConstantAction.java that\r\n    can be called by various constant action subclasses to drop a constraint\r\n    and/or a conglomerate descriptor.  In addition to performing the drop as\r\n    before, these utility methods also check to see if dropping the constraint\r\n    or index necessitates the \"update\" of a shared physical conglomerate.  If\r\n    so, the new methods will take the necessary steps to 1) drop the old physical\r\n    conglomerate, and 2) create a new physical conglomerate that correctly\r\n    satisifes all remaining conglomerate descriptors--i.e. all of the ones that\r\n    were sharing the dropped physical conglomerate.\r\n\r\n  - Changes all existing ConstantAction calls to ConstraintDescriptor.drop(...)\r\n    and ConglomerateDescriptor.drop(...) so that they now use the new utility\r\n    methods defined on DDLSingleTableConstantAction.  Due to current restrictions\r\n    in Derby--see esp. DERBY-3300 and DERBY-2204--there are a few places where\r\n    calling \"drop\" on a constraint/index won't ever lead to the dropping of a\r\n    shared physical conglomerate, so use of the new utility methods is not\r\n    strictly necessary.  But in the interest of a) completeness, and b) potential\r\n    changes for DERBY-2204 or DERBY-3300 in the future, this patch updates all\r\n    such \"drop()\" calls, nonetheless.\r\n\r\n    Note that in some scenarios--esp. AlterTableConstantAction.java and\r\n    DropTableConstantAction.java--we may want to drop the old physical\r\n    conglomerate and then either skip creation of the new one, or create\r\n    the new one \"later\".  The utility methods on DDLSingleTableConstantAction\r\n    are written to support such a division where necessary/beneficial.  See\r\n    code comments for details.\r\n\r\n  - Uses the existing CreateIndexConstantAction class to create new physical\r\n    conglomerates that \"replace\" shared ones that have been dropped.  The\r\n    patch introduces a new CreateIndexConstantAction constructor that allows\r\n    differentiation between creation of a \"normal\" index--for which we will\r\n    create a new conglomerate descriptor, add corresponding data to the\r\n    system catalogs, and (potentially) create a new physical conglomerate--\r\n    verses creation of a \"replacement\" index, where we just create a new\r\n    physical conglomerate based on an existing conglomerate descriptor.\r\n\r\n  - Adds a new JUnit test, lang/ConglomerateSharingTest.java, which includes\r\n    a test fixture for the \"convert to non-unique\" scenario described by this\r\n    Jira.  It also includes a fixture for testing the various scenarios in\r\n    which a constraint can be dropped, to verify that the logic surrounding\r\n    \"drop and re-create conglomerate\" processing is correctly executed (or\r\n    skipped) as appropriate.\r\n\r\n  - Updates one master file, RowLockIso.out, to reflect the fact that the\r\n    new utility methods in DDLSingleTableConstantAction.java acquire a lock\r\n    on the index in order to read the properties of the physical conglomerate\r\n    that is being dropped.  This is necessary so that those properties can\r\n    be propagated to the new (replacement) conglomerate if necessary.  In\r\n    RowLockIso.out, this difference shows itself by a \"lock count\" that is\r\n    now one greater than previously, after a \"drop index\" command has been\r\n    issued.\r\n\r\nAfter applying this patch I ran derbyall and suites.All with ibm142 on Linux and saw no failures.  Review comments/feedback would be much appreciated, especially since these changes will likely affect work for DERBY-2204 (and perhaps DERBY-3300) in the future.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-06T16:43:52.482+0000","updated":"2008-02-06T16:43:52.482+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12568630","id":"12568630","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"I broke the single _v1 patch down into 4 smaller, relatively modular patches in hopes of making things easier for any potential reviewers.  The patches are:\r\n\r\n 1. d3299_createIxAction_v1.patch: Changes/additions to CreateIndexConstantAction.java so that it can support the creation of \"replacement\" conglomerates, which will be necessary when the physical conglomerate for an index has been dropped but the index descriptor still exists.  In that case we need to create a new physical conglomerate to support the existing descriptor.  This can happen if multiple indexes share a physical conglomerate but then the conglomerate is dropped as part of \"drop index\" processing for one of the indexes. (Note that \"indexes\" here includes indexes which were created to back constraints).\r\n\r\n  2. d3299_caUtilMethods_v1.patch: Addition of utility methods to DDLSingleTableConstantAction.java that can be used by any ConstantAction classes which drop constraint or conglomerate descriptors.   The methods recognize when a \"replacement\" conglomerate is needed and make the necessary calls to create such a conglomerate.  See previous comment for details.\r\n\r\n  3. d3299_dropSharedConglom_v1.patch: Changes to ConglomerateDescriptor that include logic for detecting a \"replacement\" scenario, and logic to drop the old (shared) conglomerate in those scenarios.  Also changes the various ConstantAction classes which rely on the \"drop()\" methods of ConglomerateDescriptor and ConstraintDescriptor to use the utility methods added as part of caUtilMethods_v1.patch.  This is the patch which ultimately fixes this issue and \"activates\" the preceding two patches--and thus is the only one which changes the functional behavior of Derby.\r\n\r\n  4. d3299_tests_v1.patch: New JUnit tests for verifying the correct behavior when constraints share a physical conglomerate and then one of them is dropped.\r\n\r\nI'm attaching all 4 patches here, but plan to commit them one at a time, a day or two apart, to allow for any review comments/suggestions.  In the absence of review comments I'll just go ahead and commit each one in its own time.\r\n\r\nAs each patch is committed, the subsequent patches may need to be tweaked to allow for minor conflicts that exist between them.  I will posted updated patches as necessary--but the _v1 patches should at least allow reviewers to see the changes and make comments.\r\n\r\nNote to any reviewers: the patches build on each other: i.e. attempts to apply and build patch #2 will fail unless patch #1 has been applied first.\r\n\r\nI ran derbyall with d3299_createIxAction_v1.patch and it ran cleanly; I'm currently running suites.All.  If the latter passes, then I plan to commit that patch tomorrow (Thursday, Feb 14, PST).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-13T17:04:31.401+0000","updated":"2008-02-13T17:07:52.498+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12569039","id":"12569039","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"derbyall and suites.All using ibm142 ran cleanly with d3299_createIxAction_v1.patch, so I committed that with svn # 627836:\r\n\r\n  URL: http://svn.apache.org/viewvc?rev=627836&view=rev\r\n\r\nderbyall and suites.All also ran cleanly with d3299_caUtilMethods_v1.patch (which applied cleanly after createIxAction).  If tinderbox tests for createIxAction run cleanly, and if I hear no objections/feedback on d3299_caUtilMethods_v1.patch, I plan to commit the latter tomorrow (Feb 15 PST).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-14T18:46:08.381+0000","updated":"2008-02-14T18:46:08.381+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12569200","id":"12569200","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"body":"I took 'd3299_caUtilMethods_v1.patch' out for a spin. I haven't reviewed the code, but noticed that the JavaDoc for DDLSingleTableConstantAction.executeConglomReplacement uses an incorrect parameter name.\r\n\r\nI don't have any comments on the approach and code otherwise, I was just a little curious and had a quick look :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kristwaa","name":"kristwaa","emailAddress":"kristwaa at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=kristwaa&avatarId=14736","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kristwaa&avatarId=14736","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kristwaa&avatarId=14736","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kristwaa&avatarId=14736"},"displayName":"Kristian Waagan","active":true},"created":"2008-02-15T08:13:13.820+0000","updated":"2008-02-15T08:13:13.820+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12569311","id":"12569311","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"> I don't have any comments on the approach and code otherwise, I was just a\r\n> little curious and had a quick look\r\n\r\nThanks Kristian, every little bit helps :)  I'll make the javadoc fix before committing...","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-15T16:44:47.752+0000","updated":"2008-02-15T16:44:47.752+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12569431","id":"12569431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching d3299_caUtilMethods_v2.patch, which fixes the javadoc error mentioned by Kristian and also has some whitespace changes (to make use of tabs/spaces consistent).  I committed this patch with svn # 628181:\r\n\r\n  URL: http://svn.apache.org/viewvc?rev=628181&view=rev\r\n\r\nThis commit necessitates some cleanup/merging with the d3299_dropSharedConglom_v1.patch, so I will make the needed changes and post a dropSharedConglom_v2 patch shortly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-15T21:58:55.567+0000","updated":"2008-02-15T21:58:55.567+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12569448","id":"12569448","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Attaching d3299_dropSharedConglom_v2.patch, which has been updated to account for the commit of d3299_caUtilMethods_v2.patch.   This second version also has a minor change to the createNewBackingCongloms(...) method of AlterTableConstantAction--esp. _v2 removes an unnecessary parameter from that method.\r\n\r\nI've started derbyall with this patch applied; if all goes well and I hear no objections/feedback, I plan to commit it early next week (Mon or Tues PST).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-15T23:02:33.027+0000","updated":"2008-02-15T23:11:06.487+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12570310","id":"12570310","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Committed d3299_dropSharedConglom_v2.patch with svn # 629160:\r\n\r\n  URL: http://svn.apache.org/viewvc?rev=629160&view=rev\r\n\r\nAttaching d3299_tests_v2.patch, which is sync'ed with the latest codeline.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-19T17:03:25.975+0000","updated":"2008-02-19T17:03:25.975+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12570740","id":"12570740","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Committed d3299_tests_v2.patch with svn # 629527:\r\n\r\n  URL: http://svn.apache.org/viewvc?rev=629527&view=rev\r\n\r\nResolving issue as fixed in 10.4.  If the tinderbox runs are clean and no additional comments/feedback are offered over the next couple of days, I plan to close the issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-20T16:40:28.881+0000","updated":"2008-02-20T16:40:28.881+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12572274","id":"12572274","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"body":"Haven't heard any followup issues/concerns with this, so I'm marking it closed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=army","name":"army","emailAddress":"qozinx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"A B","active":true},"created":"2008-02-25T22:17:11.076+0000","updated":"2008-02-25T22:17:11.076+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/12593199","id":"12593199","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I had indicated that I might backport this change to 10.3, but looking at it more closely, I think I won't.  It contains several checkins and data dictionary changes, so I don't know that it is suitable for backport.  If someone thinks it is urgently needed in 10.3 and appropriate to backport let me know and I'll reconsider.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2008-04-30T01:26:17.798+0000","updated":"2008-04-30T01:26:17.798+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/13040485","id":"13040485","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"I think it makes sense to try to reduce the test case a bit and add it in as an upgrade test.\r\nBut just as a data point, I noticed that the duplicate row is created with 10.1.1.0 but not the latest on the 10.1.\r\nbranch, so likely a backported bug fix.    10.3.1.4 the earliest release of 10.3 didn't show the problem.\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-05-27T22:40:14.184+0000","updated":"2011-05-27T22:40:14.184+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12385459/comment/13040503","id":"13040503","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The last comment was mistakenly added to this issue instead of  DERBY-5249. I don't see how to delete \r\nwithout reopening the issue it so just disregard.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-05-27T23:41:31.409+0000","updated":"2011-05-27T23:41:31.409+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-3299/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06ll3:"}}