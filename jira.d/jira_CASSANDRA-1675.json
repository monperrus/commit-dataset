{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12478589","self":"https://issues.apache.org/jira/rest/api/latest/issue/12478589","key":"CASSANDRA-1675","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/4","id":"4","description":"An improvement or enhancement to an existing feature or task.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/improvement.png","name":"Improvement","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310865","id":"12310865","key":"CASSANDRA","name":"Cassandra","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310865&avatarId=12034","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310865&avatarId=12034","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310865&avatarId=12034","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310865&avatarId=12034"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/11961","id":"11961","description":"Apache Cassandra related projects","name":"Cassandra"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12315486","id":"12315486","description":"","name":"0.7.0 rc 1","archived":false,"released":true,"releaseDate":"2010-11-24"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12310220":"2010-10-28 16:07:46.514","customfield_12312322":null,"customfield_12312323":null,"customfield_12310222":"10002_*:*_1_*:*_2395954_*|*_1_*:*_1_*:*_96621_*|*_5_*:*_2_*:*_87534476_*|*_4_*:*_1_*:*_346477646","customfield_12310420":"28221","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2010-11-02T16:41:18.693+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-1675/watchers","watchCount":0,"isWatching":false},"created":"2010-10-28T15:26:13.996+0000","customfield_10022":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12311124":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcoli","name":"rcoli","emailAddress":"robert dot d dot a dot coli at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Coli","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-11-29T14:28:41.242+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/5","description":"A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/resolved.png","name":"Resolved","id":"5","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12312978","id":"12312978","name":"Core"}],"timeoriginalestimate":null,"description":"There are three different tunable settings available for memtable sizing. Tuning these is an important task to operations centric people, because it relates to JVM memory management. Currently, the code logs when you have hit one of the three thresholds, but it does not tell you which of the three you have hit.\r\n\r\nAttached patches against 0.6 and 0.7 branches add a log message for each of the thresholds, indicating which one has been reached. If you were to find yourself in the somewhat unlikely case of simultaneously hitting more than one, the new code would only tell you which one you hit first, because that's all the current codepath cares about.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12458254","id":"12458254","filename":"log.which.memtable.threshold.has.been.hit.against.0.6.at.1027222.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcoli","name":"rcoli","emailAddress":"robert dot d dot a dot coli at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Coli","active":true},"created":"2010-10-28T15:27:28.138+0000","size":2494,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12458254/log.which.memtable.threshold.has.been.hit.against.0.6.at.1027222.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12458253","id":"12458253","filename":"log.which.memtable.threshold.has.been.hit.against.trunk.1027208.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcoli","name":"rcoli","emailAddress":"robert dot d dot a dot coli at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Coli","active":true},"created":"2010-10-28T15:27:28.100+0000","size":2222,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12458253/log.which.memtable.threshold.has.been.hit.against.trunk.1027208.patch"}],"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"92515","summary":"log which memtable threshold has been hit","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcoli","name":"rcoli","emailAddress":"robert dot d dot a dot coli at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Coli","active":true},"subtasks":[],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rcoli","name":"rcoli","emailAddress":"robert dot d dot a dot coli at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Robert Coli","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"customfield_12311420":null,"customfield_12311421":null,"environment":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12478589/comment/12925856","id":"12925856","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"committed for 0.7 and trunk.  (0.6 patch does not build, and determining which threshold caused the flush is relatively easy if you are monitoring CFS jmx numbers.)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-10-28T16:07:46.514+0000","updated":"2010-10-28T16:07:46.514+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12478589/comment/12926333","id":"12926333","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brandon.williams","name":"brandon.williams","emailAddress":"driftx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brandon.williams&avatarId=10054","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brandon.williams&avatarId=10054","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brandon.williams&avatarId=10054","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brandon.williams&avatarId=10054"},"displayName":"Brandon Williams","active":true},"body":"Under load, this logs multiples times:\r\n\r\n INFO 16:28:34,674 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,676 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,674 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,674 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,674 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,674 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,678 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,676 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,676 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,676 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,675 Memtable for CF Standard1 has reached memtable_operations_in_millions 304087, enqueueing flush\r\n INFO 16:28:34,681 switching in a fresh Memtable for Standard1 at CommitLogContext(file='/var/lib/cassandra/commitlog/CommitLog-1288369673971.log', position=110971700)\r\n INFO 16:28:34,681 Enqueuing flush of Memtable-Standard1@2131039861(14906535 bytes, 304215 operations)\r\n INFO 16:28:34,682 Writing Memtable-Standard1@2131039861(14906535 bytes, 304215 operations)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=brandon.williams","name":"brandon.williams","emailAddress":"driftx at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=brandon.williams&avatarId=10054","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=brandon.williams&avatarId=10054","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=brandon.williams&avatarId=10054","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=brandon.williams&avatarId=10054"},"displayName":"Brandon Williams","active":true},"created":"2010-10-29T16:26:41.013+0000","updated":"2010-10-29T16:26:41.013+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12478589/comment/12926365","id":"12926365","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"One solution: drop the new logging lines and just add \"X ops out of Y threshold, W bytes out of Z throughput, M minutes out of T max age\" when it actually gets frozen","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-10-29T17:28:59.146+0000","updated":"2010-10-29T17:28:59.146+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12478589/comment/12927489","id":"12927489","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"body":"we already log\r\n\r\n{code}Enqueuing flush of Memtable-Standard1@1015483951(15792915 bytes, 309665 operations){code}\r\n\r\nwhich seems quite adequate to me to tell that we're hitting the .3M ops threshold rather than the 64MB throughput one. \r\n\r\nwill revert the change.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jbellis","name":"jbellis","emailAddress":"jbellis at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jbellis&avatarId=18380","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jbellis&avatarId=18380","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jbellis&avatarId=18380","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jbellis&avatarId=18380"},"displayName":"Jonathan Ellis","active":true},"created":"2010-11-02T16:41:18.652+0000","updated":"2010-11-02T16:41:18.652+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/CASSANDRA-1675/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0g6p3:"}}