{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12536506","self":"https://issues.apache.org/jira/rest/api/latest/issue/12536506","key":"DERBY-5560","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12323475","id":"12323475","description":"Head of 10.8 branch starting 2014-01-13","name":"10.8.3.3","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12323562","id":"12323562","description":"Head of 10.9 branch after releasing 10.9.1.0","name":"10.9.2.2","archived":false,"released":false},{"self":"https://issues.apache.org/jira/rest/api/2/version/12326659","id":"12326659","description":"candidate for Second release for 10.10 branch","name":"10.10.2.0","archived":false,"released":true,"releaseDate":"2014-04-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324243","id":"12324243","description":"First release on the 10.11 branch","name":"10.11.1.1","archived":false,"released":true,"releaseDate":"2014-08-26"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2011-12-28 19:01:57.664","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"222189","customfield_12310222":"1_*:*_1_*:*_51426778696_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2013-08-14T20:25:03.230+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-5560/watchers","watchCount":3,"isWatching":false},"created":"2011-12-28T15:12:04.585+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_triage10_11"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317968","id":"12317968","description":"second release on the 10.8 branch","name":"10.8.2.2","archived":false,"released":true,"releaseDate":"2011-10-24"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-01-21T00:23:04.717+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"There is a Java deadlock between LogicalConnection40 and ClientXAConnection40.  The order of calls that cause the deadlock are:\r\n\r\nThread 1\r\n----\r\nLogicalConnection.close\r\nClientPooledConnection.recycleConnection\r\n\r\nThread 2\r\n----\r\nClientPooledConnection.close\r\nLogicalConnection.nullPhysicalConnection\r\n\r\n\r\n\r\nThread 1 acquires a lock on the LogicalConnection and attempts to acquire a lock on the ClientPooledConnection\r\nThread 2 acquires a lock on the ClientPooledConnection and attempts to acquire a lock on the LogicalConnection\r\n\r\nIn production this occurs when one thread is committing a transaction and another thread is trying to close the connection.  This occurred because the Glassfish connection pool is setup to close all connections on any error on any connection and an error has been detected on another connection in the pool.\r\n\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10365","value":"Crash","id":"10365"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10362","value":"Performance","id":"10362"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10421","value":"Seen in production","id":"10421"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"35609","summary":"Java deadlock between LogicalConnection40 and ClientXAConnection40 (patch attached)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10422","value":"High Value Fix","id":"10422"},{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10102","value":"Patch Available","id":"10102"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Solaris 10\r\nGlassfish V2.1.1 \r\nClientXADataSource connection pool setup to close all connections on any error","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10051","value":"Urgent","id":"10051"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":15,"total":15,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13176749","id":"13176749","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"body":"Partial stack trace of first thread:\r\n\r\n\r\n\tat org.apache.derby.client.ClientPooledConnection.recycleConnection(ClientPooledConnection.java:353)\r\n\t- waiting to lock <0xfffffffc80843f18> (a org.apache.derby.client.ClientXAConnection40)\r\n\tat org.apache.derby.client.am.LogicalConnection.close(LogicalConnection.java:91)\r\n\t- locked <0xfffffffc85f35508> (a org.apache.derby.client.am.LogicalConnection40)\r\n\tat com.sun.gjc.spi.ManagedConnection.transactionCompleted(ManagedConnection.java:492)\r\n\tat com.sun.gjc.spi.XAResourceImpl.commit(XAResourceImpl.java:88)\r\n\tat com.sun.jts.jtsxa.OTSResourceImpl.commit_one_phase(OTSResourceImpl.java:166)\r\n\tat com.sun.jts.CosTransactions.RegisteredResources.commitOnePhase(RegisteredResources.java:1575)\r\n\tat com.sun.jts.CosTransactions.TopCoordinator.commitOnePhase(TopCoordinator.java:2949)\r\n\tat com.sun.jts.CosTransactions.CoordinatorTerm.commit(CoordinatorTerm.java:317)\r\n\tat com.sun.jts.CosTransactions.TerminatorImpl.commit(TerminatorImpl.java:250)\r\n\t- locked <0xfffffffc8597bea0> (a com.sun.jts.CosTransactions.TerminatorImpl)\r\n\tat com.sun.jts.CosTransactions.CurrentImpl.commit(CurrentImpl.java:623)\r\n\tat com.sun.jts.jta.TransactionManagerImpl.commit(TransactionManagerImpl.java:309)\r\n\tat com.sun.enterprise.distributedtx.J2EETransactionManagerImpl.commit(J2EETransactionManagerImpl.java:1003)\r\n\tat com.sun.enterprise.distributedtx.J2EETransactionManagerOpt.commit(J2EETransactionManagerOpt.java:398)\r\n\r\nPartial stack trace of second thread:\r\n\r\n\r\n\tat org.apache.derby.client.am.LogicalConnection.nullPhysicalConnection(LogicalConnection.java:64)\r\n\t- waiting to lock <0xfffffffc85f35508> (a org.apache.derby.client.am.LogicalConnection40)\r\n\tat org.apache.derby.client.ClientPooledConnection.close(ClientPooledConnection.java:204)\r\n\t- locked <0xfffffffc80843f18> (a org.apache.derby.client.ClientXAConnection40)\r\n\tat org.apache.derby.client.ClientXAConnection.close(ClientXAConnection.java:139)\r\n\t- locked <0xfffffffc80843f18> (a org.apache.derby.client.ClientXAConnection40)\r\n\tat com.sun.gjc.spi.ManagedConnection.destroy(ManagedConnection.java:276)\r\n\tat com.sun.enterprise.resource.ConnectorAllocator.destroyResource(ConnectorAllocator.java:175)\r\n\tat com.sun.enterprise.resource.AbstractResourcePool.destroyResource(AbstractResourcePool.java:986)\r\n\tat com.sun.enterprise.resource.AbstractResourcePool.emptyPool(AbstractResourcePool.java:1635)\r\n\t- locked <0xfffffffc72af99c0> (a com.sun.enterprise.resource.SJSASResourcePool)\r\n\tat com.sun.enterprise.resource.AbstractResourcePool.doFailAllConnectionsProcessing(AbstractResourcePool.java:1213)\r\n\tat com.sun.enterprise.resource.AbstractResourcePool.resourceErrorOccurred(AbstractResourcePool.java:1163)\r\n\t- locked <0xfffffffc72af99c0> (a com.sun.enterprise.resource.SJSASResourcePool)\r\n\tat com.sun.enterprise.resource.PoolManagerImpl.putbackResourceToPool(PoolManagerImpl.java:445)\r\n\tat com.sun.enterprise.resource.PoolManagerImpl.resourceErrorOccurred(PoolManagerImpl.java:411)\r\n\tat com.sun.enterprise.resource.ConnectorAllocator$ConnectionListenerImpl.connectionErrorOccurred(ConnectorAllocator.java:98)\r\n\tat com.sun.gjc.spi.ManagedConnection.connectionErrorOccurred(ManagedConnection.java:662)\r\n\tat com.sun.gjc.spi.ManagedConnectionFactory.getInvalidConnections(ManagedConnectionFactory.java:249)\r\n\tat com.sun.enterprise.resource.AbstractConnectorAllocator.getInvalidConnections(AbstractConnectorAllocator.java:99)\r\n\tat com.sun.enterprise.resource.AbstractConnectorAllocator.isConnectionValid(AbstractConnectorAllocator.java:111)\r\n\tat com.sun.enterprise.resource.AbstractResourcePool.isConnectionValid(AbstractResourcePool.java:722)\r\n\tat com.sun.enterprise.resource.AbstractResourcePool.getUnenlistedResource(AbstractResourcePool.java:668)\r\n\tat com.sun.enterprise.resource.AbstractResourcePool.internalGetResource(AbstractResourcePool.java:609)\r\n\tat com.sun.enterprise.resource.AbstractResourcePool.getResource(AbstractResourcePool.java:458)\r\n\tat com.sun.enterprise.resource.PoolManagerImpl.getResourceFromPool(PoolManagerImpl.java:248)\r\n\tat com.sun.enterprise.resource.PoolManagerImpl.getResource(PoolManagerImpl.java:176)\r\n\tat com.sun.enterprise.connectors.ConnectionManagerImpl.internalGetConnection(ConnectionManagerImpl.java:337)\r\n\tat com.sun.enterprise.connectors.ConnectionManagerImpl.allocateConnection(ConnectionManagerImpl.java:189)\r\n\tat com.sun.enterprise.connectors.ConnectionManagerImpl.allocateConnection(ConnectionManagerImpl.java:165)\r\n\tat com.sun.enterprise.connectors.ConnectionManagerImpl.allocateConnection(ConnectionManagerImpl.java:158)\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"created":"2011-12-28T18:38:29.206+0000","updated":"2011-12-28T18:38:29.206+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13176764","id":"13176764","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Some discussion regarding this issue is in this thread:\r\nhttp://old.nabble.com/Could-someone-give-me-some-guidance-on-DERBY-5560-to33046146.html\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2011-12-28T19:01:57.664+0000","updated":"2011-12-28T19:01:57.664+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13176800","id":"13176800","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"body":"From my looking at the code, the ClientPooledConnection is the owner of the LogicalConnection.  It is the one that creates the LogicalConnection.  So I am thinking that the synchronization on the ClientPooledConnection should be done before synchronization on the LogicalConnection.  The LogicalConnection has a reference to the ClientPooledConnection (pooledCollection_) that is never set to null once it is initialized.  I am thinking that the LogicalConnection.close could be rewritten as:\r\n\r\n   public void close() throws SQLException {\r\n        try {\r\n            synchronized (pooledConnection_) {\r\n                synchronized (this) {\r\n                    // we also need to loop thru all the logicalStatements and close them\r\n                    if (physicalConnection_ == null) {\r\n                        return;\r\n                    }\r\n                    if (physicalConnection_.agent_.loggingEnabled()) {\r\n                        physicalConnection_.agent_.logWriter_.traceEntry(this, \"close\");\r\n                    }\r\n\r\n                    if (physicalConnection_.isClosed()) // connection is closed or has become stale\r\n                    {\r\n                        pooledConnection_.informListeners(new SqlException(null,\r\n                                new ClientMessageId(\r\n                                SQLState.PHYSICAL_CONNECTION_ALREADY_CLOSED)));\r\n                    } else {\r\n                        physicalConnection_.checkForTransactionInProgress();\r\n                        physicalConnection_.closeForReuse(\r\n                                pooledConnection_.isStatementPoolingEnabled());\r\n                        if (!physicalConnection_.isGlobalPending_()) {\r\n                            pooledConnection_.recycleConnection();\r\n                        }\r\n                    }\r\n                    physicalConnection_ = null;\r\n                    pooledConnection_.nullLogicalConnection();\r\n                }\r\n            }\r\n        } catch (SqlException se) {\r\n            throw se.getSQLException();\r\n        }\r\n    }\r\n\r\n\r\nFirst synchronize on the the ClientPooledConnection and then on the LogicalConnection.  This will be in the same order as ClientPooledConnection.close() does.\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"created":"2011-12-28T20:30:09.416+0000","updated":"2011-12-28T20:30:09.416+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13178772","id":"13178772","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"body":"After looking at the code and locking patterns between the LogicalConnection and ClientPooledConnection, I have determined that the safest change is to just change the LogicalConnection.close to first synchronize on the ClientPooledConnection.\r\n\r\nThe ClientPooledConnection first synchronizes on itself and then calls the LogicalConnection.nullLogicalConnection which synchronizes on the LogicalConnection.  So that lock pattern is ClientPooledConnection and then LogicalConnection. \r\n\r\nThe patch changes the LogicalConnection.close method to do the same.  The patch makes the method not synchronized and then first synchronizes on the ClientPooledConnection and then the LogicalConnection.  The pattern is now the same.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"created":"2012-01-03T15:17:42.927+0000","updated":"2012-01-03T15:19:02.043+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13178776","id":"13178776","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"body":"Your approach seems reasonable to me, thanks for the clear explanation.\r\n\r\nI think it would be worth adding some comments to the class-level comments for\r\nthe two classes, to note the locking order convention we've adopted.\r\n\r\nHow could we improve our test suite in this area, to make it more likely that\r\nproblems like these would show up during development testing, rather than\r\nin production applications? Do you have any time to try to improve the tests?\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bryanpendleton","name":"bryanpendleton","emailAddress":"bpendleton dot derby at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Bryan Pendleton","active":true},"created":"2012-01-03T15:26:14.964+0000","updated":"2012-01-03T15:26:14.964+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13178778","id":"13178778","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"body":"I want to help more but am just coming up to speed on JUnit and Derby testing. \r\n\r\n I would like to help improve the testing of this but it may take a couple of weeks before I am useful.  My time is limited because I just spent the last two weeks trying to find and fix the problems that I did.  Now my regularly scheduled day job tasks that were delayed are beckoning.\r\n\r\nI will make an attempt to help in providing better testing however.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"created":"2012-01-03T15:32:20.349+0000","updated":"2012-01-03T15:32:20.349+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13210431","id":"13210431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Triage for 10.9. Marking Urgent, Crash (hang) and High Value Fix as we already have a patch.  Just need a volunteer to run tests and hopefully  add a test case and we can get this checked in.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2012-02-17T18:34:59.415+0000","updated":"2012-02-17T18:34:59.415+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13419080","id":"13419080","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"body":"I still am not able to help provide tests, but this is an important fix as it does occur in production.  I have been running with this patched in place at a large telecom running under Glassfish and have not seen this issue since the patch was put in place.\r\n\r\nIn upgrading to 10.9.1.0, I have had to reapplied this patch and provide a custom build.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bbergquist","name":"bbergquist","emailAddress":"brett at thebergquistfamily dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Brett Bergquist","active":true},"created":"2012-07-20T12:23:00.017+0000","updated":"2012-07-20T12:23:00.017+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13682835","id":"13682835","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"Brett has provided a patch and asked that it be committed. He has tested it in production but has not been able to provide a regression test. Marking patch available so the patch can be reviewed and possibly committed. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2013-06-13T22:21:36.478+0000","updated":"2013-06-13T22:21:36.478+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13736832","id":"13736832","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"The patch for this issue still applies cleanly. Unless anyone sees any issues I plan to run tests and commit.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2013-08-12T12:55:54.691+0000","updated":"2013-08-12T12:55:54.691+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13737164","id":"13737164","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1513218 from [~kmarsden] in branch 'code/trunk'\r\n[ https://svn.apache.org/r1513218 ]\r\n\r\nDERBY-5560 Java deadlock between LogicalConnection40 and ClientXAConnection40\r\n\r\nPatch contributed by Brett Bergquist","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-12T18:23:40.577+0000","updated":"2013-08-12T18:23:40.577+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13737412","id":"13737412","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1513274 from [~kmarsden] in branch 'code/branches/10.10'\r\n[ https://svn.apache.org/r1513274 ]\r\n\r\nDERBY-5560 Java deadlock between LogicalConnection40 and ClientXAConnection40\r\n\r\nPatch contributed by Brett Bergquist","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-12T21:55:46.700+0000","updated":"2013-08-12T21:55:46.700+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13739804","id":"13739804","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1513941 from [~kmarsden] in branch 'code/branches/10.9'\r\n[ https://svn.apache.org/r1513941 ]\r\n\r\nDERBY-5560 Java deadlock between LogicalConnection40 and ClientXAConnection40\r\n\r\nPatch contributed by Brett Bergquist","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-14T16:00:15.828+0000","updated":"2013-08-14T16:00:15.828+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/13740132","id":"13740132","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1514026 from [~kmarsden] in branch 'code/branches/10.8'\r\n[ https://svn.apache.org/r1514026 ]\r\n\r\nDERBY-5560 Java deadlock between LogicalConnection40 and ClientXAConnection40\r\n\r\nPatch contributed by Brett Bergquist","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2013-08-14T20:24:08.787+0000","updated":"2013-08-14T20:24:08.787+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12536506/comment/14284740","id":"14284740","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"bulk change to close all issues resolved but not closed and not changed since June 1, 2014.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2015-01-21T00:23:04.708+0000","updated":"2015-01-21T00:23:04.708+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-5560/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06gif:"}}