{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12326591","self":"https://issues.apache.org/jira/rest/api/latest/issue/12326591","key":"DERBY-750","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-12-13 03:13:55.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22127","customfield_12310222":"1_*:*_1_*:*_7113351000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_32968465656","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2006-03-04T07:10:10.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-750/watchers","watchCount":0,"isWatching":false},"created":"2005-12-11T23:14:19.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/11187","id":"11187","description":"","name":"10.2.1.6","archived":false,"released":true,"releaseDate":"2006-10-02"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-03-20T21:04:35.648+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11412","id":"11412","name":"Store"}],"timeoriginalestimate":null,"description":"OnlineBackupTest1.java intermittently hangs(endless loop - 100% cpu). I have seen this on \"all\" of the platforms we test on.\n\nSeen in \"derbyall\" itself and runs of derbyall sub-testsuites storemoe and storeall.\n\nSome cases:\n\nstoremore in\nhttp://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-354827.html\nhttp://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-355169.html\n  (Details, including sysinfo,  in http://www.multinet.no/~solberg/public/Apache/Derby/testlog/SunOS-5.10_i86pc-i386/355169.zip )\n\nstoreall in\nhttp://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-355569.html\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40157","summary":"OnlineBackupTest1.java intermittently hangs","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"SunOS-5.9 sun4u-sparc, Sun JVM 1.5.0_03\nSunOS-5.10 i86pc-i386, Sun JVM 1.5.0_04\nWindows XP / CYGWIN_NT-5.1 i686-unknow, Sun JVM1.5.0_05\nLinux-2.4.21-27.ELsmp i686-athlon, Sun JVM 1.5.0_03","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":6,"total":6,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12326591/comment/12360233","id":"12360233","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"body":"If some one sees this test hang,   please post the stack dump.  It does not  reproduce on my linux/windows envirorments.  Stack traces might help in  pinpointing  where it  is  looping forever. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"created":"2005-12-13T03:13:55.000+0000","updated":"2005-12-13T03:13:55.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12326591/comment/12360290","id":"12360290","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"body":"I started a loop doing \r\n  java org.apache.derbyTesting.functionTests.harness.RunTest store/OnlineBackupTest1.java\r\nand soon experienced the hang.\r\n\r\nps -auxwww | grep Online:\r\n-------------------------------------------------------------------------------\r\nos136789  4058 50.2  3.215019265472 pts/1    O 10:06:58 11:44 /usr/local/java/jdk/bin//java -Dderby.system.home=/export/home/tmp/os136789/adhoc/OnlineBackupTest1 -Dderby.infolog.append=true -Duser.dir=/export/home/tmp/os136789/adhoc -Dframework=embedded org.apache.derbyTesting.functionTests.tests.store.OnlineBackupTest1 -p /export/home/tmp/os136789/adhoc/OnlineBackupTest1/OnlineBackupTest1_app.properties\r\nos136789  4053  0.1  0.812132815144 pts/1    S 10:06:56  0:00 java org.apache.derbyTesting.functionTests.harness.RunTest store/OnlineBackupTest1.java\r\n-------------------------------------------------------------------------------\r\n\r\n kill -3 4058\r\n\r\nproduced the dump in attachement siv02_app.properties_OnlineBackupTest1.tmp\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=olesolberg","name":"olesolberg","emailAddress":"Ole dot Solberg at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ole Solberg","active":true},"created":"2005-12-13T18:47:20.000+0000","updated":"2005-12-13T18:47:20.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12326591/comment/12360634","id":"12360634","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"body":"Thanks for posting the stack Ole.  By looking at the stacks ,  my suspicion is  backup is looking at a table that is not completely created yet, \r\ncontainer file might be there but the  first page (Alloc page)  might have been created.  \r\n\r\nIt might take some time for me to fix this one ,  As a temporary solution  ,  attached patch comments \r\nout the  the section of the  the test that might be hitting this problem. \r\n\r\nIt would be great if some one can commit this patch. \r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"created":"2005-12-17T07:08:28.000+0000","updated":"2005-12-17T07:08:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12326591/comment/12365327","id":"12365327","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"body":"Problem was backup was trying to a read a pages from a container before the first\r\nallocation page for it is created with a invalid page number. First allocation page\r\nnumber is invalid only when first page is not created.\r\n\r\nThe reason backup sees containers in that state, backup finds the containers to \r\nbackup by scanning through the seg0 list files and gets access to the container\r\nconglomerate cache, cache returns the handles after the container file is\r\ncreated. \r\n\r\nFix is NOT  to backup containers whose first allocation page not yet created.  It is\r\nsafe to not backup containers in such case instead of waiting for container\r\ncreation to complete, redo of the log on restore will create them. \r\n\r\nRenabled the test case that hit this problem in OnlineBackupTest1.java ,  which was commented \r\nearlier.  \r\n   \r\nTESTS : derbyall test suite passed on Windows XP/JDK142\r\nIt would be great if some can review and commit this patch. \r\n\r\nsvn stat:\r\n\r\nM      java\\engine\\org\\apache\\derby\\impl\\store\\raw\\data\\FileContainer.java\r\nM      java\\engine\\org\\apache\\derby\\impl\\store\\raw\\data\\RAFContainer.java\r\nM      java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\OnlineBackupTest1.java\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tsuresh","name":"tsuresh","emailAddress":"suresh dot thalamati at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Suresh Thalamati","active":true},"created":"2006-02-07T04:28:24.000+0000","updated":"2006-02-07T04:28:24.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12326591/comment/12365493","id":"12365493","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"body":"I committed this to svn:\r\nm1_142:13>svn commit\r\n\r\nSending        java\\engine\\org\\apache\\derby\\impl\\store\\raw\\data\\FileContainer.ja\r\nva\r\nSending        java\\engine\\org\\apache\\derby\\impl\\store\\raw\\data\\RAFContainer.jav\r\na\r\nSending        java\\testing\\org\\apache\\derbyTesting\\functionTests\\tests\\store\\On\r\nlineBackupTest1.java\r\nTransmitting file data ...\r\nCommitted revision 375775.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mikem","name":"mikem","emailAddress":"mikem_app at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mike Matrigali","active":true},"created":"2006-02-08T08:37:51.000+0000","updated":"2006-02-08T08:37:51.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12326591/comment/12419819","id":"12419819","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"body":"set  fix version to 10.2","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kmarsden","name":"kmarsden","emailAddress":"kmarsdenderby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Kathey Marsden","active":true},"created":"2006-07-08T09:38:38.000+0000","updated":"2006-07-08T09:38:38.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-750/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i078l3:"}}