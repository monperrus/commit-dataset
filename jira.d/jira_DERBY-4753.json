{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12469897","self":"https://issues.apache.org/jira/rest/api/latest/issue/12469897","key":"DERBY-4753","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12326659","id":"12326659","description":"candidate for Second release for 10.10 branch","name":"10.10.2.0","archived":false,"released":true,"releaseDate":"2014-04-15"},{"self":"https://issues.apache.org/jira/rest/api/2/version/12324243","id":"12324243","description":"First release on the 10.11 branch","name":"10.11.1.1","archived":false,"released":true,"releaseDate":"2014-08-26"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2010-07-22 11:21:54.833","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"24446","customfield_12310222":"3_*:*_1_*:*_1023945134_*|*_1_*:*_1_*:*_113110951626_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2014-03-04T10:00:58.104+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4753/watchers","watchCount":3,"isWatching":false},"created":"2010-07-22T09:52:41.392+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":["derby_triage10_8"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314117","id":"12314117","description":"Next release after 10.5.2.0 release candidate #1","name":"10.5.3.0","archived":false,"released":true,"releaseDate":"2009-08-21"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2015-01-21T00:23:21.461+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"We are seeing the failure below occasionally.  It does not happen every time ... with the exact same database and call sequence it will happen about 1 out of 3 times.\r\n\r\nThe parameters on the getIndexInfo call are\r\nconnection.getMetaData().getIndexInfo(null, schemaName, tableName, false, false);\r\nschemaName and tableName are valid and definitely not null.\r\n\r\nCaused by: \r\njava.sql.SQLException: Syntax error: FALSE.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeQuery(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.doGetIndexInfo(Unknown Source)\r\n\tat org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.getIndexInfo(Unknown Source)\r\n\tat com.ibm.team.repository.service.db.provider.AbstractDbProvider.getIndexMetadata(AbstractDbProvider.java:381)\r\n\tat com.ibm.team.repository.service.db.provider.AbstractDbProvider.doesIndexExist(AbstractDbProvider.java:343)\r\n\t... 61 more\r\nCaused by: \r\nERROR 42X01: Syntax error: FALSE.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.checkInternalFeature(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.literal(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.valueSpecification(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.valueExpressionPrimary(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primary(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primaryExpressionXX(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primaryExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.unaryExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.multiplicativeExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.additiveExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.thenElseExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.whenThenExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.valueSpecification(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.valueExpressionPrimary(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primary(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primaryExpressionXX(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primaryExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.unaryExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.multiplicativeExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.additiveExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.valueExpressionPrimary(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primary(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primaryExpressionXX(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.primaryExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.unaryExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.multiplicativeExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.additiveExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.derivedColumn(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.selectSublist(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.selectColumnList(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.selectList(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.querySpecification(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.simpleTable(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.nonJoinQueryPrimary(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.nonJoinQueryTerm(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.queryExpression(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.preparableSelectStatement(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.preparableSQLDataStatement(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.StatementPart(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.SQLParser.Statement(Unknown Source)\r\n\tat org.apache.derby.impl.sql.compile.ParserImpl.parseStatement(Unknown Source)\r\n\tat org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source)\r\n\tat org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.rePrepare(Unknown Source)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)\r\n\t... 68 more\r\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10421","value":"Seen in production","id":"10421"}],"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"36765","summary":"\"ERROR 42X01: Syntax error: FALSE.\" during call to java.sql.DatabaseMetaData.getIndexInfo","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaney","name":"chaney","emailAddress":"cwchaney at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Chaney","active":true},"subtasks":[],"customfield_12310090":[{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10424","value":"Repro attached","id":"10424"}],"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chaney","name":"chaney","emailAddress":"cwchaney at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Craig Chaney","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Linux","customfield_12311020":null,"customfield_12310050":{"self":"https://issues.apache.org/jira/rest/api/2/customFieldOption/10052","value":"Normal","id":"10052"},"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":9,"total":9,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/12891096","id":"12891096","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"This is most likely going to work with the latest 10.7 development sources because FALSE is now accepted also in non-internal SQL, and the failing call to checkInternalFeature() from SQLParser.literal() has been removed. But, regardless of that, it looks like we have a bug that makes the compiler context lose the knowledge about it being an internal statement. Too bad we don't have a reliable repro for it.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2010-07-22T11:21:54.833+0000","updated":"2010-07-22T11:21:54.833+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/13539957","id":"13539957","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"As suggested above, newer versions accept the FALSE keyword also in non-internal queries. However, the getIndexInfo query uses other internal syntax, so this may still fail, just with a different syntax error.\r\n\r\nI noticed that the stack trace contained a call to GenericPreparedStatement.rePrepare(), so it looks like it happened after getIndexInfo() found out it was using a stale query plan and decided to recompile. When recompilation is invoked through that path, it ends up calling GenericStatement.prepare() with the forMetaData parameter set to false. This is the reason why the internal syntax isn't accepted.\r\n\r\nFollowing that clue, I managed to reproduce the syntax error, but only when running in soft-upgrade mode. Presumably, soft-upgrade mode is needed because the call to rePrepare() in GenericPreparedStatement.executeStmt() is guarded with a check for whether it is an SPS, and the SPS is not used in soft-upgrade.\r\n\r\nThe error can be reproduced by following these steps:\r\n\r\n1) Create an empty database using Derby 10.9.1.0:\r\n\r\n$ java -jar 10.9.1.0/derbyrun.jar ij\r\nij version 10.9\r\nij> connect 'jdbc:derby:db;create=true';\r\nij> exit;\r\n\r\n2) Using the Derby development trunk, run the attached Derby4753.java program with the properties derby.language.stalePlanCheckInterval=5 and derby.database.allowPreReleaseUpgrade=true:\r\n\r\n$ java -Dderby.language.stalePlanCheckInterval=5 -Dderby.database.allowPreReleaseUpgrade=true Derby4753\r\nException in thread \"main\" java.sql.SQLSyntaxErrorException: Syntax error: org.apache.derby.catalog.IndexDescriptor.isUnique.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:92)\r\n\tat org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:256)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:424)\r\n\tat org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)\r\n\tat org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2400)\r\n\tat org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:82)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1334)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1715)\r\n\tat org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeQuery(EmbedPreparedStatement.java:287)\r\n\tat org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.doGetIndexInfo(EmbedDatabaseMetaData.java:2830)\r\n\tat org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.getIndexInfo(EmbedDatabaseMetaData.java:2790)\r\n\tat Derby4753.checkIndexInfo(Derby4753.java:43)\r\n\tat Derby4753.main(Derby4753.java:26)\r\nCaused by: java.sql.SQLException: Syntax error: org.apache.derby.catalog.IndexDescriptor.isUnique.\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:42)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:122)\r\n\tat org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)\r\n\t... 12 more\r\nCaused by: ERROR 42X01: Syntax error: org.apache.derby.catalog.IndexDescriptor.isUnique.\r\n\tat org.apache.derby.iapi.error.StandardException.newException(StandardException.java:278)\r\n\tat org.apache.derby.impl.sql.compile.MethodCallNode.resolveMethodCall(MethodCallNode.java:784)\r\n\tat org.apache.derby.impl.sql.compile.NonStaticMethodCallNode.bindExpression(NonStaticMethodCallNode.java:186)\r\n\tat org.apache.derby.impl.sql.compile.JavaToSQLValueNode.bindExpression(JavaToSQLValueNode.java:237)\r\n\tat org.apache.derby.impl.sql.compile.ConditionalNode.bindExpression(ConditionalNode.java:388)\r\n\tat org.apache.derby.impl.sql.compile.ResultColumn.bindExpression(ResultColumn.java:737)\r\n\tat org.apache.derby.impl.sql.compile.ResultColumnList.bindExpressions(ResultColumnList.java:831)\r\n\tat org.apache.derby.impl.sql.compile.SelectNode.bindExpressions(SelectNode.java:580)\r\n\tat org.apache.derby.impl.sql.compile.DMLStatementNode.bindExpressions(DMLStatementNode.java:227)\r\n\tat org.apache.derby.impl.sql.compile.DMLStatementNode.bind(DMLStatementNode.java:140)\r\n\tat org.apache.derby.impl.sql.compile.CursorNode.bindStatement(CursorNode.java:267)\r\n\tat org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:400)\r\n\tat org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:99)\r\n\tat org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:85)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.rePrepare(GenericPreparedStatement.java:245)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:425)\r\n\tat org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:333)\r\n\tat org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1242)\r\n\t... 6 more\r\n\r\nThe repro works like this:\r\n\r\nIt invokes getIndexInfo() once so that the query is compiled. Then it creates a table with lots of columns, so that SYS.SYSCOLUMNS grows significantly. Then it re-executes getIndexInfo() a number of times. After the fifth execution (because derby.language.stalePlanCheckInterval=5) it checks if the query plan is stale. It discovers that SYS.SYSCOLUMNS has changed in size since the initial compilation, and decides the query needs to be recompiled. When re-compiling, it goes down the code path where internal syntax is not allowed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2012-12-27T13:49:33.421+0000","updated":"2012-12-27T13:49:33.421+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/13539960","id":"13539960","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"Setting the \"Repro attached\" flag. Changing component from JDBC to SQL since the problems seems to be caused by a bug in the SQL compiler.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2012-12-27T13:53:36.551+0000","updated":"2012-12-27T13:53:36.551+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/13541225","id":"13541225","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"body":"Good detective work! ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=dagw","name":"dagw","emailAddress":"dag dot wanvik at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=dagw&avatarId=16789","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=dagw&avatarId=16789","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=dagw&avatarId=16789","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=dagw&avatarId=16789"},"displayName":"Dag H. Wanvik","active":true},"created":"2012-12-31T02:14:02.269+0000","updated":"2012-12-31T02:14:02.269+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/13906953","id":"13906953","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"The repro no longer seems to reproduce the bug. Apparently, creating a single table with 1000 columns is not enough to make the query plan stale with the current code on trunk. Creating more tables seems to make it fail still, though.\r\n\r\nThe attached patch (d4753-1a.diff) has turned the repro into a test case in the upgrade test suite. The patch also contains a fix for the bug. The fix is simply to pass down the forMetaData flag from EmbedStatement to the code that recompiles the meta-data query. When given this flag, the compiler knows that internal syntax should be allowed, and the syntax error goes away.\r\n\r\nI'm running the full regression test suite on the patch now.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2014-02-20T13:34:59.367+0000","updated":"2014-02-20T13:34:59.367+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/13907049","id":"13907049","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"body":"All the regression tests ran cleanly with the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=knutanders","name":"knutanders","emailAddress":"knut dot hatlen at oracle dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Knut Anders Hatlen","active":true},"created":"2014-02-20T15:09:31.544+0000","updated":"2014-02-20T15:09:31.544+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/13908100","id":"13908100","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1570490 from [~knutanders] in branch 'code/trunk'\r\n[ https://svn.apache.org/r1570490 ]\r\n\r\nDERBY-4753: \"ERROR 42X01: Syntax error: FALSE.\" during call to java.sql.DatabaseMetaData.getIndexInfo\r\n\r\nWhen recompiling a meta-data query after detecting that its plan is\r\nstale, pass down a flag to the compiler to say that it's a meta-data\r\nquery and that use of internal syntax is allowed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2014-02-21T08:39:26.594+0000","updated":"2014-02-21T08:39:26.594+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/13919205","id":"13919205","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"body":"Commit 1573989 from [~knutanders] in branch 'code/branches/10.10'\r\n[ https://svn.apache.org/r1573989 ]\r\n\r\nDERBY-4753: \"ERROR 42X01: Syntax error: FALSE.\" during call to java.sql.DatabaseMetaData.getIndexInfo\r\n\r\nMerged revision 1570490 from trunk.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jira-bot","name":"jira-bot","emailAddress":"no-reply at urd dot zones dot apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"ASF subversion and git services","active":true},"created":"2014-03-04T10:00:43.332+0000","updated":"2014-03-04T10:00:43.332+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12469897/comment/14284786","id":"14284786","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"bulk change to close all issues resolved but not closed and not changed since June 1, 2014.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2015-01-21T00:23:21.441+0000","updated":"2015-01-21T00:23:21.441+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-4753/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06nnb:"}}