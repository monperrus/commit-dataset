{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"12343597","self":"https://issues.apache.org/jira/rest/api/latest/issue/12343597","key":"DERBY-1355","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312590","id":"12312590","description":"","name":"10.3.1.4","archived":false,"released":true,"releaseDate":"2007-08-10"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2007-05-18 07:34:29.544","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"22455","customfield_12310222":"3_*:*_1_*:*_1969678466_*|*_1_*:*_1_*:*_30628424486_*|*_5_*:*_1_*:*_0","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2007-06-09T02:07:56.952+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1355/watchers","watchCount":1,"isWatching":false},"created":"2006-05-27T19:06:14.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.png","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12310615","id":"12310615","description":"","name":"10.1.2.1","archived":false,"released":true,"releaseDate":"2005-11-18"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mayureshnirhali","name":"mayureshnirhali","emailAddress":"Mayuresh dot Nirhali at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mayuresh Nirhali","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2011-01-21T17:48:38.661+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11690","id":"11690","name":"Network Client"}],"timeoriginalestimate":null,"description":"With ClientDriver, resultSet.getMetaData().isAutoIncrement(column) always returns false. \n\nEmbeddedDriver correctly returns the true value (true or false)\n\nThe following code demonstrates the problem:\n===================================================================================\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.ResultSet;\nimport java.sql.ResultSetMetaData;\nimport java.sql.SQLException;\nimport java.sql.Statement;\n\nimport org.apache.derby.jdbc.ClientDriver;\nimport org.apache.derby.jdbc.EmbeddedDriver;\n\npublic class TestAutoIncrement {\n    private static final String URL_EMBEDDED = \"jdbc:derby:EmbeddedTestBase;\";\n\n    private static final String URL_CLIENT = \"jdbc:derby://localhost:1527/ClientTestBase;\";\n\n    public TestAutoIncrement() {\n        super();\n    }\n\n    public static void main(String[] args) throws SQLException {\n        System.out.println(new ClientDriver().getClass().getName()\n                + \" registered\");\n        System.out.println(new EmbeddedDriver().getClass().getName()\n                + \" registered\");\n        new TestAutoIncrement().test();\n    }\n\n    private void test() throws SQLException {\n        if (test(URL_EMBEDDED) != test(URL_CLIENT)) {\n            System.out.println(\"Embedded and client driver behave differently for isAutoIncrement().\");\n        } else {\n            System.out.println(\"Embedded and client driver behave the same for isAutoIncrement().\");\n        }\n    }\n\n    private boolean test(String url) throws SQLException {\n        boolean ai = false;\n        Connection connection = DriverManager.getConnection(url\n                + \"create=true;\");\n        Statement statement = connection.createStatement();\n        statement\n                .execute(\"CREATE TABLE TEST_TABEL (\"\n                        + \"ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),\"\n                        + \"VALUE INTEGER NOT NULL, PRIMARY KEY (ID))\");\n        statement.execute(\"INSERT INTO TEST_TABEL (VALUE) VALUES(1)\");\n        ResultSet resultSet = statement\n                .executeQuery(\"SELECT * FROM TEST_TABEL\");\n        ResultSetMetaData meta = resultSet.getMetaData();\n        ai = meta.isAutoIncrement(1);\n        System.out.println(\"For \" + url + \" \" + meta.getColumnName(1)\n                + \" isAutoIncrement: \" + ai);\n        connection.close();\n        try {\n            DriverManager.getConnection(url + \"shutdown=true;\");\n        } catch (SQLException e) {\n            System.out.println(e.getMessage());\n        }\n        return ai;\n    }\n\n}\n===================================================================================\nThe output I receive from the above program is:\n\norg.apache.derby.jdbc.ClientDriver registered\norg.apache.derby.jdbc.EmbeddedDriver registered\nFor jdbc:derby:EmbeddedTestBase; ID isAutoIncrement: true\nDatabase 'EmbeddedTestBase' shutdown.\nFor jdbc:derby://localhost:1527/ClientTestBase; ID isAutoIncrement: false\nDERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database \n'ClientTestBase' shutdown.\nEmbedded and client driver behave differently for isAutoIncrement().\n===================================================================================\nOuput from sysinfo:\n\n------------------ Java Information ------------------\nJava Version:    1.5.0_06\nJava Vendor:     Sun Microsystems Inc.\nJava home:       C:\\Program Files\\Java\\jre1.5.0_06\nJava classpath: \n.;C:\\PROGRA~1\\JMF21~1.1E\\lib\\sound.jar;C:\\PROGRA~1\\JMF21~1.1E\\lib\\jmf.jar;C:\\PROGRA~1\\JMF21~1.1E\\lib;C:\\WINDOWS\\java\\classes;C:\\WorkSpace\\PB \n3.0\\bin;C:\\WorkSpace\\Filipe\\bin;C:\\Documents and Settings\\Piet\\My \nDocuments\\Resources\\Jars\\ImgrRdr130.jar;C:\\Documents and Settings\\Piet\\My \nDocuments\\Resources\\Jars\\lucene-1.4.1.jar;C:\\Documents and Settings\\Piet\\My \nDocuments\\Resources\\Jars\\Multivalent20040415.jar;C:\\Workspace\\Stick\\bin;\nOS name:         Windows XP\nOS architecture: x86\nOS version:      5.1\nJava user name:  Piet\nJava user home:  C:\\Documents and Settings\\Piet\nJava user dir:   C:\\StickFolder\njava.specification.name: Java Platform API Specification\njava.specification.version: 1.5\n--------- Derby Information --------\nJRE - JDBC: J2SE 5.0 - JDBC 3.0\n[/org/apache/derby/info/DBMS.properties] 10.1.2.1 - (330608)\n[/org/apache/derby/info/tools.properties] 10.1.2.1 - (330608)\n[/org/apache/derby/info/net.properties] 10.1.2.1 - (330608)\n[/org/apache/derby/info/dnc.properties] 10.1.2.1 - (330608)\n------------------------------------------------------\n----------------- Locale Information -----------------\nCurrent Locale :  [Nederlands/Nederland [nl_NL]]\nFound support for locale: [de_DE]\n  version: 10.1.2.1 - (330608)\nFound support for locale: [es]\n  version: 10.1.2.1 - (330608)\nFound support for locale: [fr]\n  version: 10.1.2.1 - (330608)\nFound support for locale: [it]\n  version: 10.1.2.1 - (330608)\nFound support for locale: [ja_JP]\n  version: 10.1.2.1 - (330608)\nFound support for locale: [ko_KR]\n  version: 10.1.2.1 - (330608)\nFound support for locale: [pt_BR]\n  version: 10.1.2.1 - (330608)\nFound support for locale: [zh_CN]\n  version: 10.1.2.1 - (330608)\nFound support for locale: [zh_TW]\n  version: 10.1.2.1 - (330608)\n------------------------------------------------------\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"37571","summary":"ClientDriver ResultSetMetaData.isAutoIncrement(column) always returns false","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pietblok","name":"pietblok","emailAddress":"pbhome at wanadoo dot nl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Piet Blok","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pietblok","name":"pietblok","emailAddress":"pbhome at wanadoo dot nl","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Piet Blok","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":"Windows XP","customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343597/comment/12496802","id":"12496802","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mayureshnirhali","name":"mayureshnirhali","emailAddress":"Mayuresh dot Nirhali at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mayuresh Nirhali","active":true},"body":"I have created a quick patch for this.\r\n\r\nIt is evident from DRDA spec that, sqlxGenerated can tell if 'generated' attribute of a particular column is true. If the column is auto generated then sqlxgenerated will be 2. The same check can be used to validate AutoIncrement attribute in isAutoIncrement. I would like to know from the NetworkClient experts if this is the right fix.\r\n\r\nI have started the testruns and will also look into if there is an existing test which needs modification, else I will add a new case.\r\n\r\nThanks","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mayureshnirhali","name":"mayureshnirhali","emailAddress":"Mayuresh dot Nirhali at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mayuresh Nirhali","active":true},"created":"2007-05-18T07:34:29.544+0000","updated":"2007-05-18T07:34:29.544+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343597/comment/12498206","id":"12498206","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mayureshnirhali","name":"mayureshnirhali","emailAddress":"Mayuresh dot Nirhali at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mayuresh Nirhali","active":true},"body":"derbyall and Suites.All ran fine.\r\n\r\nI will now look into adding a new testcase in client testsuite.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mayureshnirhali","name":"mayureshnirhali","emailAddress":"Mayuresh dot Nirhali at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mayuresh Nirhali","active":true},"created":"2007-05-23T11:44:22.865+0000","updated":"2007-05-23T11:44:22.865+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343597/comment/12498579","id":"12498579","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mayureshnirhali","name":"mayureshnirhali","emailAddress":"Mayuresh dot Nirhali at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mayuresh Nirhali","active":true},"body":"Created another patch for the test changes.\r\n\r\nUpdated LangHarnessJavaTest to run AIjdbc test in client-server mode as well. The AIjdbc test reprodices the issue when run in clientserver mode.\r\n\r\nThe patches are ready for review.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mayureshnirhali","name":"mayureshnirhali","emailAddress":"Mayuresh dot Nirhali at Sun dot COM","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mayuresh Nirhali","active":true},"created":"2007-05-24T10:54:11.757+0000","updated":"2007-05-24T10:54:11.757+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12343597/comment/12502985","id":"12502985","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"body":"I applied test and client patches...\r\nI ran the AIjdbc test (with embedded & client), with and without the Client change, and test shows the problem before the fix, and does not show the problem after the fix. Ran lang._Suite for good measure.\r\n\r\nIn addition, I corrected text to be printed out in case of a failure in one of the\r\n test cases in test AIjdbc.java.\r\n\r\ncommitted fix and test change with revision 545681.\r\n\r\nRemoved 10.2.3.0 fixin value, because I do not intend to backport this to 10.2, although backporting at least the client change is probably no big effort for someone if it's needed. \r\n\r\nThx for the patches Mayuresh!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=myrna","name":"myrna","emailAddress":"m dot v dot lunteren at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Myrna van Lunteren","active":true},"created":"2007-06-09T02:07:56.891+0000","updated":"2007-06-09T02:07:56.891+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-1355/votes","votes":1,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i06smf:"}}