{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"27523","self":"https://issues.apache.org/jira/rest/api/latest/issue/27523","key":"DERBY-18","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2005-01-24 21:21:19.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21718","customfield_12310222":"1_*:*_1_*:*_20551636000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_3883000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2005-05-25T15:51:38.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-18/watchers","watchCount":0,"isWatching":false},"created":"2004-09-29T19:04:22.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10920","id":"10920","description":"initial source drop","name":"10.0.2.0","archived":false,"released":true,"releaseDate":"2004-08-30"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-07-08T10:05:32.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"Reporting for Kathey Marsden.\n\ncreate table t1(c1 int);  -- goes into app\nselect sys.t1.c1 from t1; -- should fail\nselect sys.b.c1 from t1 b; -- should fail\nselect * from t1, app.t1;  -- fails, should succeed\nselect t1.c1 from t1, app.t1; -- fails, should succeed\n\n- According to SQL92, the <table \nname> in a <table reference> exposes its name when it is not \nqualified (See 6.3 <table reference>, Syntax Rule 1).  Also, \nan unqualified <table name> is equivalent to one qualified \nwith the current default schema name (See 5.4 Names and \nidentifiers, Syntax Rule 8).  So, in the above queries,\n\nselect * from t1, app.t1  -- is the same as select * from \napp.t1, app.t1, and this is not SQL92 --- you have duplicate \nexposed <table name>s in the same scope (see 6.3 <table \nreference>, Syntax Rule 3). Derby can support it, but it's an \nextension.\n\nselect t1.c1 from t1, app.t1 -- is the same as select app.t1.c1 \nfrom app.t1, app.t1, and again supporting this would be an \nextension to SQL92.\n\nNote that if you say\nselect * from t1, t2 t1 --  this is also a duplication, as the \nexposed <table name> of the first table is app.t1 and the \nexposed <correlation name> of the second table is t1. these \nare different names, but 6.3 <table reference> Syntax Rule 4 \nrules out this case explicitly -- a <correlation name> \ncannot be the same as the unqualified part of any exposed \n<table name>.\n\nOne possibility is to go to a 2 pass method of column resolution:\n1st pass looks for an exact match on the qualifier (app.t1 \nmatches app.t1 but not t1, ...)\nif no match, then do 2nd pass where it looks for a match on \ntable id.\n(Look at OrderByColumn.bindOrderByColumn()\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40595","summary":"Exposed name matching has bugs when the column name is qualified with a schema name.","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tulika","name":"tulika","emailAddress":"tulika dot agrawal at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tulika Agrawal","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tulika","name":"tulika","emailAddress":"tulika dot agrawal at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Tulika Agrawal","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":4,"total":4,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/27523/comment/58008","id":"58008","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"set current schema app;\r\n\r\ncreate table t1(int c1 varchar(10));\r\n\r\ncreate schema s1;\r\ncreate table s1.t1(id1 int, d2 varchar(10));\r\n\r\nselect * from t1, app.t1;  ---> This fails, should succeed.\r\n\r\nInternally table names are handled correctly but the above problem occurs because of the equals() method in Tablename.java. \r\n\r\nHere the follwoing piece of code \r\n\r\n----------------------------------------------------------------------------------\r\nelse if ((schemaName == null) ||\r\n\t\t\t\t (otherTableName.getSchemaName() == null))\r\n\t\t{\r\n\t\t\treturn tableName.equals(otherTableName.getTableName());\r\n\t     }\r\n----------------------------------------------------------------------------------\r\n\r\ncauses the above error to occur. In this if either of the schema name is null, only the table names are compared and hence the error for the above statement.\r\n\r\nShould the equals method implementation be changed to take of this?\r\n  or\r\nShould we set the tables that have null schemas to the current schema or something along these lines?\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-01-24T21:21:19.000+0000","updated":"2005-01-24T21:21:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27523/comment/60888","id":"60888","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Applied patch from Shreyas.\r\n\r\nSending        java/engine/org/apache/derby/impl/sql/compile/CurrentOfNode.java\r\nSending        java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java\r\nSending        java/testing/org/apache/derbyTesting/functionTests/master/dml162.out\r\nSending        java/testing/org/apache/derbyTesting/functionTests/master/orderby.out\r\nSending        java/testing/org/apache/derbyTesting/functionTests/master/select.out\r\nSending        java/testing/org/apache/derbyTesting/functionTests/tests/lang/select.sql\r\nSending        java/testing/org/apache/derbyTesting/functionTests/tests/nist/dml162.sql\r\nTransmitting file data .......\r\nCommitted revision 157591.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2005-03-16T06:55:44.000+0000","updated":"2005-03-16T06:55:44.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27523/comment/66239","id":"66239","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"Fixed , as the earlier comment says","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-05-25T15:51:38.000+0000","updated":"2005-05-25T15:51:38.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27523/comment/66248","id":"66248","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"Patch submitted","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-05-25T16:56:21.000+0000","updated":"2005-05-25T16:56:21.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-18/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07baf:"}}